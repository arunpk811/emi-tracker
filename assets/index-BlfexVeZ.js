(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();var Ym={exports:{}},Vu={};var n2;function oR(){if(n2)return Vu;n2=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(n,i,o){var c=null;if(o!==void 0&&(c=""+o),i.key!==void 0&&(c=""+i.key),"key"in i){o={};for(var u in i)u!=="key"&&(o[u]=i[u])}else o=i;return i=o.ref,{$$typeof:t,type:n,key:c,ref:i!==void 0?i:null,props:o}}return Vu.Fragment=e,Vu.jsx=r,Vu.jsxs=r,Vu}var a2;function lR(){return a2||(a2=1,Ym.exports=oR()),Ym.exports}var R=lR(),Xm={exports:{}},et={};var i2;function cR(){if(i2)return et;i2=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),y=Symbol.iterator;function E(Q){return Q===null||typeof Q!="object"?null:(Q=y&&Q[y]||Q["@@iterator"],typeof Q=="function"?Q:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,A={};function B(Q,L,te){this.props=Q,this.context=L,this.refs=A,this.updater=te||S}B.prototype.isReactComponent={},B.prototype.setState=function(Q,L){if(typeof Q!="object"&&typeof Q!="function"&&Q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Q,L,"setState")},B.prototype.forceUpdate=function(Q){this.updater.enqueueForceUpdate(this,Q,"forceUpdate")};function I(){}I.prototype=B.prototype;function C(Q,L,te){this.props=Q,this.context=L,this.refs=A,this.updater=te||S}var G=C.prototype=new I;G.constructor=C,T(G,B.prototype),G.isPureReactComponent=!0;var K=Array.isArray;function Y(){}var b={H:null,A:null,T:null,S:null},N=Object.prototype.hasOwnProperty;function D(Q,L,te){var J=te.ref;return{$$typeof:t,type:Q,key:L,ref:J!==void 0?J:null,props:te}}function U(Q,L){return D(Q.type,L,Q.props)}function P(Q){return typeof Q=="object"&&Q!==null&&Q.$$typeof===t}function F(Q){var L={"=":"=0",":":"=2"};return"$"+Q.replace(/[=:]/g,function(te){return L[te]})}var O=/\/+/g;function we(Q,L){return typeof Q=="object"&&Q!==null&&Q.key!=null?F(""+Q.key):L.toString(36)}function Ce(Q){switch(Q.status){case"fulfilled":return Q.value;case"rejected":throw Q.reason;default:switch(typeof Q.status=="string"?Q.then(Y,Y):(Q.status="pending",Q.then(function(L){Q.status==="pending"&&(Q.status="fulfilled",Q.value=L)},function(L){Q.status==="pending"&&(Q.status="rejected",Q.reason=L)})),Q.status){case"fulfilled":return Q.value;case"rejected":throw Q.reason}}throw Q}function ne(Q,L,te,J,ee){var xe=typeof Q;(xe==="undefined"||xe==="boolean")&&(Q=null);var Re=!1;if(Q===null)Re=!0;else switch(xe){case"bigint":case"string":case"number":Re=!0;break;case"object":switch(Q.$$typeof){case t:case e:Re=!0;break;case m:return Re=Q._init,ne(Re(Q._payload),L,te,J,ee)}}if(Re)return ee=ee(Q),Re=J===""?"."+we(Q,0):J,K(ee)?(te="",Re!=null&&(te=Re.replace(O,"$&/")+"/"),ne(ee,L,te,"",function(Oe){return Oe})):ee!=null&&(P(ee)&&(ee=U(ee,te+(ee.key==null||Q&&Q.key===ee.key?"":(""+ee.key).replace(O,"$&/")+"/")+Re)),L.push(ee)),1;Re=0;var Me=J===""?".":J+":";if(K(Q))for(var Ie=0;Ie<Q.length;Ie++)J=Q[Ie],xe=Me+we(J,Ie),Re+=ne(J,L,te,xe,ee);else if(Ie=E(Q),typeof Ie=="function")for(Q=Ie.call(Q),Ie=0;!(J=Q.next()).done;)J=J.value,xe=Me+we(J,Ie++),Re+=ne(J,L,te,xe,ee);else if(xe==="object"){if(typeof Q.then=="function")return ne(Ce(Q),L,te,J,ee);throw L=String(Q),Error("Objects are not valid as a React child (found: "+(L==="[object Object]"?"object with keys {"+Object.keys(Q).join(", ")+"}":L)+"). If you meant to render a collection of children, use an array instead.")}return Re}function me(Q,L,te){if(Q==null)return Q;var J=[],ee=0;return ne(Q,J,"","",function(xe){return L.call(te,xe,ee++)}),J}function _e(Q){if(Q._status===-1){var L=Q._result;L=L(),L.then(function(te){(Q._status===0||Q._status===-1)&&(Q._status=1,Q._result=te)},function(te){(Q._status===0||Q._status===-1)&&(Q._status=2,Q._result=te)}),Q._status===-1&&(Q._status=0,Q._result=L)}if(Q._status===1)return Q._result.default;throw Q._result}var ae=typeof reportError=="function"?reportError:function(Q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var L=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Q=="object"&&Q!==null&&typeof Q.message=="string"?String(Q.message):String(Q),error:Q});if(!window.dispatchEvent(L))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Q);return}console.error(Q)},Le={map:me,forEach:function(Q,L,te){me(Q,function(){L.apply(this,arguments)},te)},count:function(Q){var L=0;return me(Q,function(){L++}),L},toArray:function(Q){return me(Q,function(L){return L})||[]},only:function(Q){if(!P(Q))throw Error("React.Children.only expected to receive a single React element child.");return Q}};return et.Activity=v,et.Children=Le,et.Component=B,et.Fragment=r,et.Profiler=i,et.PureComponent=C,et.StrictMode=n,et.Suspense=h,et.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=b,et.__COMPILER_RUNTIME={__proto__:null,c:function(Q){return b.H.useMemoCache(Q)}},et.cache=function(Q){return function(){return Q.apply(null,arguments)}},et.cacheSignal=function(){return null},et.cloneElement=function(Q,L,te){if(Q==null)throw Error("The argument must be a React element, but you passed "+Q+".");var J=T({},Q.props),ee=Q.key;if(L!=null)for(xe in L.key!==void 0&&(ee=""+L.key),L)!N.call(L,xe)||xe==="key"||xe==="__self"||xe==="__source"||xe==="ref"&&L.ref===void 0||(J[xe]=L[xe]);var xe=arguments.length-2;if(xe===1)J.children=te;else if(1<xe){for(var Re=Array(xe),Me=0;Me<xe;Me++)Re[Me]=arguments[Me+2];J.children=Re}return D(Q.type,ee,J)},et.createContext=function(Q){return Q={$$typeof:c,_currentValue:Q,_currentValue2:Q,_threadCount:0,Provider:null,Consumer:null},Q.Provider=Q,Q.Consumer={$$typeof:o,_context:Q},Q},et.createElement=function(Q,L,te){var J,ee={},xe=null;if(L!=null)for(J in L.key!==void 0&&(xe=""+L.key),L)N.call(L,J)&&J!=="key"&&J!=="__self"&&J!=="__source"&&(ee[J]=L[J]);var Re=arguments.length-2;if(Re===1)ee.children=te;else if(1<Re){for(var Me=Array(Re),Ie=0;Ie<Re;Ie++)Me[Ie]=arguments[Ie+2];ee.children=Me}if(Q&&Q.defaultProps)for(J in Re=Q.defaultProps,Re)ee[J]===void 0&&(ee[J]=Re[J]);return D(Q,xe,ee)},et.createRef=function(){return{current:null}},et.forwardRef=function(Q){return{$$typeof:u,render:Q}},et.isValidElement=P,et.lazy=function(Q){return{$$typeof:m,_payload:{_status:-1,_result:Q},_init:_e}},et.memo=function(Q,L){return{$$typeof:d,type:Q,compare:L===void 0?null:L}},et.startTransition=function(Q){var L=b.T,te={};b.T=te;try{var J=Q(),ee=b.S;ee!==null&&ee(te,J),typeof J=="object"&&J!==null&&typeof J.then=="function"&&J.then(Y,ae)}catch(xe){ae(xe)}finally{L!==null&&te.types!==null&&(L.types=te.types),b.T=L}},et.unstable_useCacheRefresh=function(){return b.H.useCacheRefresh()},et.use=function(Q){return b.H.use(Q)},et.useActionState=function(Q,L,te){return b.H.useActionState(Q,L,te)},et.useCallback=function(Q,L){return b.H.useCallback(Q,L)},et.useContext=function(Q){return b.H.useContext(Q)},et.useDebugValue=function(){},et.useDeferredValue=function(Q,L){return b.H.useDeferredValue(Q,L)},et.useEffect=function(Q,L){return b.H.useEffect(Q,L)},et.useEffectEvent=function(Q){return b.H.useEffectEvent(Q)},et.useId=function(){return b.H.useId()},et.useImperativeHandle=function(Q,L,te){return b.H.useImperativeHandle(Q,L,te)},et.useInsertionEffect=function(Q,L){return b.H.useInsertionEffect(Q,L)},et.useLayoutEffect=function(Q,L){return b.H.useLayoutEffect(Q,L)},et.useMemo=function(Q,L){return b.H.useMemo(Q,L)},et.useOptimistic=function(Q,L){return b.H.useOptimistic(Q,L)},et.useReducer=function(Q,L,te){return b.H.useReducer(Q,L,te)},et.useRef=function(Q){return b.H.useRef(Q)},et.useState=function(Q){return b.H.useState(Q)},et.useSyncExternalStore=function(Q,L,te){return b.H.useSyncExternalStore(Q,L,te)},et.useTransition=function(){return b.H.useTransition()},et.version="19.2.3",et}var s2;function h1(){return s2||(s2=1,Xm.exports=cR()),Xm.exports}var se=h1(),Km={exports:{}},Uu={},$m={exports:{}},Qm={};var o2;function uR(){return o2||(o2=1,(function(t){function e(ne,me){var _e=ne.length;ne.push(me);e:for(;0<_e;){var ae=_e-1>>>1,Le=ne[ae];if(0<i(Le,me))ne[ae]=me,ne[_e]=Le,_e=ae;else break e}}function r(ne){return ne.length===0?null:ne[0]}function n(ne){if(ne.length===0)return null;var me=ne[0],_e=ne.pop();if(_e!==me){ne[0]=_e;e:for(var ae=0,Le=ne.length,Q=Le>>>1;ae<Q;){var L=2*(ae+1)-1,te=ne[L],J=L+1,ee=ne[J];if(0>i(te,_e))J<Le&&0>i(ee,te)?(ne[ae]=ee,ne[J]=_e,ae=J):(ne[ae]=te,ne[L]=_e,ae=L);else if(J<Le&&0>i(ee,_e))ne[ae]=ee,ne[J]=_e,ae=J;else break e}}return me}function i(ne,me){var _e=ne.sortIndex-me.sortIndex;return _e!==0?_e:ne.id-me.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var c=Date,u=c.now();t.unstable_now=function(){return c.now()-u}}var h=[],d=[],m=1,v=null,y=3,E=!1,S=!1,T=!1,A=!1,B=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function G(ne){for(var me=r(d);me!==null;){if(me.callback===null)n(d);else if(me.startTime<=ne)n(d),me.sortIndex=me.expirationTime,e(h,me);else break;me=r(d)}}function K(ne){if(T=!1,G(ne),!S)if(r(h)!==null)S=!0,Y||(Y=!0,F());else{var me=r(d);me!==null&&Ce(K,me.startTime-ne)}}var Y=!1,b=-1,N=5,D=-1;function U(){return A?!0:!(t.unstable_now()-D<N)}function P(){if(A=!1,Y){var ne=t.unstable_now();D=ne;var me=!0;try{e:{S=!1,T&&(T=!1,I(b),b=-1),E=!0;var _e=y;try{t:{for(G(ne),v=r(h);v!==null&&!(v.expirationTime>ne&&U());){var ae=v.callback;if(typeof ae=="function"){v.callback=null,y=v.priorityLevel;var Le=ae(v.expirationTime<=ne);if(ne=t.unstable_now(),typeof Le=="function"){v.callback=Le,G(ne),me=!0;break t}v===r(h)&&n(h),G(ne)}else n(h);v=r(h)}if(v!==null)me=!0;else{var Q=r(d);Q!==null&&Ce(K,Q.startTime-ne),me=!1}}break e}finally{v=null,y=_e,E=!1}me=void 0}}finally{me?F():Y=!1}}}var F;if(typeof C=="function")F=function(){C(P)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,we=O.port2;O.port1.onmessage=P,F=function(){we.postMessage(null)}}else F=function(){B(P,0)};function Ce(ne,me){b=B(function(){ne(t.unstable_now())},me)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ne){ne.callback=null},t.unstable_forceFrameRate=function(ne){0>ne||125<ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<ne?Math.floor(1e3/ne):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_next=function(ne){switch(y){case 1:case 2:case 3:var me=3;break;default:me=y}var _e=y;y=me;try{return ne()}finally{y=_e}},t.unstable_requestPaint=function(){A=!0},t.unstable_runWithPriority=function(ne,me){switch(ne){case 1:case 2:case 3:case 4:case 5:break;default:ne=3}var _e=y;y=ne;try{return me()}finally{y=_e}},t.unstable_scheduleCallback=function(ne,me,_e){var ae=t.unstable_now();switch(typeof _e=="object"&&_e!==null?(_e=_e.delay,_e=typeof _e=="number"&&0<_e?ae+_e:ae):_e=ae,ne){case 1:var Le=-1;break;case 2:Le=250;break;case 5:Le=1073741823;break;case 4:Le=1e4;break;default:Le=5e3}return Le=_e+Le,ne={id:m++,callback:me,priorityLevel:ne,startTime:_e,expirationTime:Le,sortIndex:-1},_e>ae?(ne.sortIndex=_e,e(d,ne),r(h)===null&&ne===r(d)&&(T?(I(b),b=-1):T=!0,Ce(K,_e-ae))):(ne.sortIndex=Le,e(h,ne),S||E||(S=!0,Y||(Y=!0,F()))),ne},t.unstable_shouldYield=U,t.unstable_wrapCallback=function(ne){var me=y;return function(){var _e=y;y=me;try{return ne.apply(this,arguments)}finally{y=_e}}}})(Qm)),Qm}var l2;function fR(){return l2||(l2=1,$m.exports=uR()),$m.exports}var Jm={exports:{}},an={};var c2;function hR(){if(c2)return an;c2=1;var t=h1();function e(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)d+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},i=Symbol.for("react.portal");function o(h,d,m){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:v==null?null:""+v,children:h,containerInfo:d,implementation:m}}var c=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return an.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,an.createPortal=function(h,d){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return o(h,d,null,m)},an.flushSync=function(h){var d=c.T,m=n.p;try{if(c.T=null,n.p=2,h)return h()}finally{c.T=d,n.p=m,n.d.f()}},an.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(h,d))},an.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},an.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var m=d.as,v=u(m,d.crossOrigin),y=typeof d.integrity=="string"?d.integrity:void 0,E=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;m==="style"?n.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:v,integrity:y,fetchPriority:E}):m==="script"&&n.d.X(h,{crossOrigin:v,integrity:y,fetchPriority:E,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},an.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var m=u(d.as,d.crossOrigin);n.d.M(h,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(h)},an.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var m=d.as,v=u(m,d.crossOrigin);n.d.L(h,m,{crossOrigin:v,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},an.preloadModule=function(h,d){if(typeof h=="string")if(d){var m=u(d.as,d.crossOrigin);n.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(h)},an.requestFormReset=function(h){n.d.r(h)},an.unstable_batchedUpdates=function(h,d){return h(d)},an.useFormState=function(h,d,m){return c.H.useFormState(h,d,m)},an.useFormStatus=function(){return c.H.useHostTransitionStatus()},an.version="19.2.3",an}var u2;function dR(){if(u2)return Jm.exports;u2=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Jm.exports=hR(),Jm.exports}var f2;function pR(){if(f2)return Uu;f2=1;var t=fR(),e=h1(),r=dR();function n(a){var s="https://react.dev/errors/"+a;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)s+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+a+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function o(a){var s=a,l=a;if(a.alternate)for(;s.return;)s=s.return;else{a=s;do s=a,(s.flags&4098)!==0&&(l=s.return),a=s.return;while(a)}return s.tag===3?l:null}function c(a){if(a.tag===13){var s=a.memoizedState;if(s===null&&(a=a.alternate,a!==null&&(s=a.memoizedState)),s!==null)return s.dehydrated}return null}function u(a){if(a.tag===31){var s=a.memoizedState;if(s===null&&(a=a.alternate,a!==null&&(s=a.memoizedState)),s!==null)return s.dehydrated}return null}function h(a){if(o(a)!==a)throw Error(n(188))}function d(a){var s=a.alternate;if(!s){if(s=o(a),s===null)throw Error(n(188));return s!==a?null:a}for(var l=a,f=s;;){var g=l.return;if(g===null)break;var x=g.alternate;if(x===null){if(f=g.return,f!==null){l=f;continue}break}if(g.child===x.child){for(x=g.child;x;){if(x===l)return h(g),a;if(x===f)return h(g),s;x=x.sibling}throw Error(n(188))}if(l.return!==f.return)l=g,f=x;else{for(var w=!1,V=g.child;V;){if(V===l){w=!0,l=g,f=x;break}if(V===f){w=!0,f=g,l=x;break}V=V.sibling}if(!w){for(V=x.child;V;){if(V===l){w=!0,l=x,f=g;break}if(V===f){w=!0,f=x,l=g;break}V=V.sibling}if(!w)throw Error(n(189))}}if(l.alternate!==f)throw Error(n(190))}if(l.tag!==3)throw Error(n(188));return l.stateNode.current===l?a:s}function m(a){var s=a.tag;if(s===5||s===26||s===27||s===6)return a;for(a=a.child;a!==null;){if(s=m(a),s!==null)return s;a=a.sibling}return null}var v=Object.assign,y=Symbol.for("react.element"),E=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),B=Symbol.for("react.profiler"),I=Symbol.for("react.consumer"),C=Symbol.for("react.context"),G=Symbol.for("react.forward_ref"),K=Symbol.for("react.suspense"),Y=Symbol.for("react.suspense_list"),b=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),U=Symbol.for("react.memo_cache_sentinel"),P=Symbol.iterator;function F(a){return a===null||typeof a!="object"?null:(a=P&&a[P]||a["@@iterator"],typeof a=="function"?a:null)}var O=Symbol.for("react.client.reference");function we(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===O?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case T:return"Fragment";case B:return"Profiler";case A:return"StrictMode";case K:return"Suspense";case Y:return"SuspenseList";case D:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case S:return"Portal";case C:return a.displayName||"Context";case I:return(a._context.displayName||"Context")+".Consumer";case G:var s=a.render;return a=a.displayName,a||(a=s.displayName||s.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case b:return s=a.displayName||null,s!==null?s:we(a.type)||"Memo";case N:s=a._payload,a=a._init;try{return we(a(s))}catch{}}return null}var Ce=Array.isArray,ne=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,me=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,_e={pending:!1,data:null,method:null,action:null},ae=[],Le=-1;function Q(a){return{current:a}}function L(a){0>Le||(a.current=ae[Le],ae[Le]=null,Le--)}function te(a,s){Le++,ae[Le]=a.current,a.current=s}var J=Q(null),ee=Q(null),xe=Q(null),Re=Q(null);function Me(a,s){switch(te(xe,s),te(ee,a),te(J,null),s.nodeType){case 9:case 11:a=(a=s.documentElement)&&(a=a.namespaceURI)?b_(a):0;break;default:if(a=s.tagName,s=s.namespaceURI)s=b_(s),a=C_(s,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}L(J),te(J,a)}function Ie(){L(J),L(ee),L(xe)}function Oe(a){a.memoizedState!==null&&te(Re,a);var s=J.current,l=C_(s,a.type);s!==l&&(te(ee,a),te(J,l))}function ct(a){ee.current===a&&(L(J),L(ee)),Re.current===a&&(L(Re),Mu._currentValue=_e)}var Z,Vt;function nt(a){if(Z===void 0)try{throw Error()}catch(l){var s=l.stack.trim().match(/\n( *(at )?)/);Z=s&&s[1]||"",Vt=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Z+a+Vt}var Tt=!1;function Je(a,s){if(!a||Tt)return"";Tt=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(s){var Ae=function(){throw Error()};if(Object.defineProperty(Ae.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ae,[])}catch(ye){var ge=ye}Reflect.construct(a,[],Ae)}else{try{Ae.call()}catch(ye){ge=ye}a.call(Ae.prototype)}}else{try{throw Error()}catch(ye){ge=ye}(Ae=a())&&typeof Ae.catch=="function"&&Ae.catch(function(){})}}catch(ye){if(ye&&ge&&typeof ye.stack=="string")return[ye.stack,ge.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=f.DetermineComponentFrameRoot(),w=x[0],V=x[1];if(w&&V){var re=w.split(`
`),he=V.split(`
`);for(g=f=0;f<re.length&&!re[f].includes("DetermineComponentFrameRoot");)f++;for(;g<he.length&&!he[g].includes("DetermineComponentFrameRoot");)g++;if(f===re.length||g===he.length)for(f=re.length-1,g=he.length-1;1<=f&&0<=g&&re[f]!==he[g];)g--;for(;1<=f&&0<=g;f--,g--)if(re[f]!==he[g]){if(f!==1||g!==1)do if(f--,g--,0>g||re[f]!==he[g]){var Te=`
`+re[f].replace(" at new "," at ");return a.displayName&&Te.includes("<anonymous>")&&(Te=Te.replace("<anonymous>",a.displayName)),Te}while(1<=f&&0<=g);break}}}finally{Tt=!1,Error.prepareStackTrace=l}return(l=a?a.displayName||a.name:"")?nt(l):""}function Ve(a,s){switch(a.tag){case 26:case 27:case 5:return nt(a.type);case 16:return nt("Lazy");case 13:return a.child!==s&&s!==null?nt("Suspense Fallback"):nt("Suspense");case 19:return nt("SuspenseList");case 0:case 15:return Je(a.type,!1);case 11:return Je(a.type.render,!1);case 1:return Je(a.type,!0);case 31:return nt("Activity");default:return""}}function Gt(a){try{var s="",l=null;do s+=Ve(a,l),l=a,a=a.return;while(a);return s}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var St=Object.prototype.hasOwnProperty,Dt=t.unstable_scheduleCallback,Lr=t.unstable_cancelCallback,Ei=t.unstable_shouldYield,Un=t.unstable_requestPaint,Ot=t.unstable_now,Gr=t.unstable_getCurrentPriorityLevel,bn=t.unstable_ImmediatePriority,ba=t.unstable_UserBlockingPriority,er=t.unstable_NormalPriority,Cn=t.unstable_LowPriority,at=t.unstable_IdlePriority,Yt=t.log,qr=t.unstable_setDisableYieldValue,Ct=null,Qt=null;function xn(a){if(typeof Yt=="function"&&qr(a),Qt&&typeof Qt.setStrictMode=="function")try{Qt.setStrictMode(Ct,a)}catch{}}var ir=Math.clz32?Math.clz32:Eo,yl=Math.log,Ti=Math.LN2;function Eo(a){return a>>>=0,a===0?32:31-(yl(a)/Ti|0)|0}var jn=256,Si=262144,lr=4194304;function vn(a){var s=a&42;if(s!==0)return s;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function oa(a,s,l){var f=a.pendingLanes;if(f===0)return 0;var g=0,x=a.suspendedLanes,w=a.pingedLanes;a=a.warmLanes;var V=f&134217727;return V!==0?(f=V&~x,f!==0?g=vn(f):(w&=V,w!==0?g=vn(w):l||(l=V&~a,l!==0&&(g=vn(l))))):(V=f&~x,V!==0?g=vn(V):w!==0?g=vn(w):l||(l=f&~a,l!==0&&(g=vn(l)))),g===0?0:s!==0&&s!==g&&(s&x)===0&&(x=g&-g,l=s&-s,x>=l||x===32&&(l&4194048)!==0)?s:g}function zn(a,s){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&s)===0}function qc(a,s){switch(a){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _l(){var a=lr;return lr<<=1,(lr&62914560)===0&&(lr=4194304),a}function la(a){for(var s=[],l=0;31>l;l++)s.push(a);return s}function wi(a,s){a.pendingLanes|=s,s!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function Wc(a,s,l,f,g,x){var w=a.pendingLanes;a.pendingLanes=l,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=l,a.entangledLanes&=l,a.errorRecoveryDisabledLanes&=l,a.shellSuspendCounter=0;var V=a.entanglements,re=a.expirationTimes,he=a.hiddenUpdates;for(l=w&~l;0<l;){var Te=31-ir(l),Ae=1<<Te;V[Te]=0,re[Te]=-1;var ge=he[Te];if(ge!==null)for(he[Te]=null,Te=0;Te<ge.length;Te++){var ye=ge[Te];ye!==null&&(ye.lane&=-536870913)}l&=~Ae}f!==0&&Ai(a,f,0),x!==0&&g===0&&a.tag!==0&&(a.suspendedLanes|=x&~(w&~s))}function Ai(a,s,l){a.pendingLanes|=s,a.suspendedLanes&=~s;var f=31-ir(s);a.entangledLanes|=s,a.entanglements[f]=a.entanglements[f]|1073741824|l&261930}function bi(a,s){var l=a.entangledLanes|=s;for(a=a.entanglements;l;){var f=31-ir(l),g=1<<f;g&s|a[f]&s&&(a[f]|=s),l&=~g}}function To(a,s){var l=s&-s;return l=(l&42)!==0?1:Ci(l),(l&(a.suspendedLanes|s))!==0?0:l}function Ci(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function Ca(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function M(){var a=me.p;return a!==0?a:(a=window.event,a===void 0?32:$_(a.type))}function W(a,s){var l=me.p;try{return me.p=a,s()}finally{me.p=l}}var j=Math.random().toString(36).slice(2),H="__reactFiber$"+j,q="__reactProps$"+j,X="__reactContainer$"+j,ue="__reactEvents$"+j,Ee="__reactListeners$"+j,fe="__reactHandles$"+j,pe="__reactResources$"+j,de="__reactMarker$"+j;function Ne(a){delete a[H],delete a[q],delete a[ue],delete a[Ee],delete a[fe]}function Fe(a){var s=a[H];if(s)return s;for(var l=a.parentNode;l;){if(s=l[X]||l[H]){if(l=s.alternate,s.child!==null||l!==null&&l.child!==null)for(a=F_(a);a!==null;){if(l=a[H])return l;a=F_(a)}return s}a=l,l=a.parentNode}return null}function Ue(a){if(a=a[H]||a[X]){var s=a.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return a}return null}function De(a){var s=a.tag;if(s===5||s===26||s===27||s===6)return a.stateNode;throw Error(n(33))}function Be(a){var s=a[pe];return s||(s=a[pe]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Ge(a){a[de]=!0}var Ft=new Set,Mt={};function qt(a,s){rn(a,s),rn(a+"Capture",s)}function rn(a,s){for(Mt[a]=s,a=0;a<s.length;a++)Ft.add(s[a])}var Ra=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ka={},Hn={};function fs(a){return St.call(Hn,a)?!0:St.call(ka,a)?!1:Ra.test(a)?Hn[a]=!0:(ka[a]=!0,!1)}function nn(a,s,l){if(fs(s))if(l===null)a.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":a.removeAttribute(s);return;case"boolean":var f=s.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){a.removeAttribute(s);return}}a.setAttribute(s,""+l)}}function Gn(a,s,l){if(l===null)a.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(s);return}a.setAttribute(s,""+l)}}function yr(a,s,l,f){if(f===null)a.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(l);return}a.setAttributeNS(s,l,""+f)}}function Pr(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function hs(a){var s=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Yc(a,s,l){var f=Object.getOwnPropertyDescriptor(a.constructor.prototype,s);if(!a.hasOwnProperty(s)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var g=f.get,x=f.set;return Object.defineProperty(a,s,{configurable:!0,get:function(){return g.call(this)},set:function(w){l=""+w,x.call(this,w)}}),Object.defineProperty(a,s,{enumerable:f.enumerable}),{getValue:function(){return l},setValue:function(w){l=""+w},stopTracking:function(){a._valueTracker=null,delete a[s]}}}}function Lt(a){if(!a._valueTracker){var s=hs(a)?"checked":"value";a._valueTracker=Yc(a,s,""+a[s])}}function So(a){if(!a)return!1;var s=a._valueTracker;if(!s)return!0;var l=s.getValue(),f="";return a&&(f=hs(a)?a.checked?"true":"false":a.value),a=f,a!==l?(s.setValue(a),!0):!1}function Za(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var wo=/[\n"\\]/g;function Rn(a){return a.replace(wo,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function El(a,s,l,f,g,x,w,V){a.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?a.type=w:a.removeAttribute("type"),s!=null?w==="number"?(s===0&&a.value===""||a.value!=s)&&(a.value=""+Pr(s)):a.value!==""+Pr(s)&&(a.value=""+Pr(s)):w!=="submit"&&w!=="reset"||a.removeAttribute("value"),s!=null?Xc(a,w,Pr(s)):l!=null?Xc(a,w,Pr(l)):f!=null&&a.removeAttribute("value"),g==null&&x!=null&&(a.defaultChecked=!!x),g!=null&&(a.checked=g&&typeof g!="function"&&typeof g!="symbol"),V!=null&&typeof V!="function"&&typeof V!="symbol"&&typeof V!="boolean"?a.name=""+Pr(V):a.removeAttribute("name")}function Jf(a,s,l,f,g,x,w,V){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(a.type=x),s!=null||l!=null){if(!(x!=="submit"&&x!=="reset"||s!=null)){Lt(a);return}l=l!=null?""+Pr(l):"",s=s!=null?""+Pr(s):l,V||s===a.value||(a.value=s),a.defaultValue=s}f=f??g,f=typeof f!="function"&&typeof f!="symbol"&&!!f,a.checked=V?a.checked:!!f,a.defaultChecked=!!f,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(a.name=w),Lt(a)}function Xc(a,s,l){s==="number"&&Za(a.ownerDocument)===a||a.defaultValue===""+l||(a.defaultValue=""+l)}function ds(a,s,l,f){if(a=a.options,s){s={};for(var g=0;g<l.length;g++)s["$"+l[g]]=!0;for(l=0;l<a.length;l++)g=s.hasOwnProperty("$"+a[l].value),a[l].selected!==g&&(a[l].selected=g),g&&f&&(a[l].defaultSelected=!0)}else{for(l=""+Pr(l),s=null,g=0;g<a.length;g++){if(a[g].value===l){a[g].selected=!0,f&&(a[g].defaultSelected=!0);return}s!==null||a[g].disabled||(s=a[g])}s!==null&&(s.selected=!0)}}function Zf(a,s,l){if(s!=null&&(s=""+Pr(s),s!==a.value&&(a.value=s),l==null)){a.defaultValue!==s&&(a.defaultValue=s);return}a.defaultValue=l!=null?""+Pr(l):""}function ps(a,s,l,f){if(s==null){if(f!=null){if(l!=null)throw Error(n(92));if(Ce(f)){if(1<f.length)throw Error(n(93));f=f[0]}l=f}l==null&&(l=""),s=l}l=Pr(s),a.defaultValue=l,f=a.textContent,f===l&&f!==""&&f!==null&&(a.value=f),Lt(a)}function kn(a,s){if(s){var l=a.firstChild;if(l&&l===a.lastChild&&l.nodeType===3){l.nodeValue=s;return}}a.textContent=s}var e0=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Kc(a,s,l){var f=s.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?f?a.setProperty(s,""):s==="float"?a.cssFloat="":a[s]="":f?a.setProperty(s,l):typeof l!="number"||l===0||e0.has(s)?s==="float"?a.cssFloat=l:a[s]=(""+l).trim():a[s]=l+"px"}function $c(a,s,l){if(s!=null&&typeof s!="object")throw Error(n(62));if(a=a.style,l!=null){for(var f in l)!l.hasOwnProperty(f)||s!=null&&s.hasOwnProperty(f)||(f.indexOf("--")===0?a.setProperty(f,""):f==="float"?a.cssFloat="":a[f]="");for(var g in s)f=s[g],s.hasOwnProperty(g)&&l[g]!==f&&Kc(a,g,f)}else for(var x in s)s.hasOwnProperty(x)&&Kc(a,x,s[x])}function Tl(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var t0=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ms=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Sl(a){return ms.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function Ia(){}var Qc=null;function ca(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var gs=null,ei=null;function Ao(a){var s=Ue(a);if(s&&(a=s.stateNode)){var l=a[q]||null;e:switch(a=s.stateNode,s.type){case"input":if(El(a,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),s=l.name,l.type==="radio"&&s!=null){for(l=a;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Rn(""+s)+'"][type="radio"]'),s=0;s<l.length;s++){var f=l[s];if(f!==a&&f.form===a.form){var g=f[q]||null;if(!g)throw Error(n(90));El(f,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(s=0;s<l.length;s++)f=l[s],f.form===a.form&&So(f)}break e;case"textarea":Zf(a,l.value,l.defaultValue);break e;case"select":s=l.value,s!=null&&ds(a,!!l.multiple,s,!1)}}}var wl=!1;function xs(a,s,l){if(wl)return a(s,l);wl=!0;try{var f=a(s);return f}finally{if(wl=!1,(gs!==null||ei!==null)&&(X0(),gs&&(s=gs,a=ei,ei=gs=null,Ao(s),a)))for(s=0;s<a.length;s++)Ao(a[s])}}function Da(a,s){var l=a.stateNode;if(l===null)return null;var f=l[q]||null;if(f===null)return null;l=f[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(a=a.type,f=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!f;break e;default:a=!1}if(a)return null;if(l&&typeof l!="function")throw Error(n(231,s,typeof l));return l}var ua=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),bo=!1;if(ua)try{var Ut={};Object.defineProperty(Ut,"passive",{get:function(){bo=!0}}),window.addEventListener("test",Ut,Ut),window.removeEventListener("test",Ut,Ut)}catch{bo=!1}var ti=null,Jc=null,Co=null;function Zc(){if(Co)return Co;var a,s=Jc,l=s.length,f,g="value"in ti?ti.value:ti.textContent,x=g.length;for(a=0;a<l&&s[a]===g[a];a++);var w=l-a;for(f=1;f<=w&&s[l-f]===g[x-f];f++);return Co=g.slice(a,1<f?1-f:void 0)}function Ro(a){var s=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&s===13&&(a=13)):a=s,a===10&&(a=13),32<=a||a===13?a:0}function Ri(){return!0}function Na(){return!1}function Wr(a){function s(l,f,g,x,w){this._reactName=l,this._targetInst=g,this.type=f,this.nativeEvent=x,this.target=w,this.currentTarget=null;for(var V in a)a.hasOwnProperty(V)&&(l=a[V],this[V]=l?l(x):x[V]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?Ri:Na,this.isPropagationStopped=Na,this}return v(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Ri)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Ri)},persist:function(){},isPersistent:Ri}),s}var ki={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ri=Wr(ki),vs=v({},ki,{view:0,detail:0}),eu=Wr(vs),ys,Al,ni,bl=v({},vs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_s,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==ni&&(ni&&a.type==="mousemove"?(ys=a.screenX-ni.screenX,Al=a.screenY-ni.screenY):Al=ys=0,ni=a),ys)},movementY:function(a){return"movementY"in a?a.movementY:Al}}),tu=Wr(bl),ko=v({},bl,{dataTransfer:0}),r0=Wr(ko),n0=v({},vs,{relatedTarget:0}),Io=Wr(n0),ru=v({},ki,{animationName:0,elapsedTime:0,pseudoElement:0}),a0=Wr(ru),Cl=v({},ki,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),i0=Wr(Cl),s0=v({},ki,{data:0}),ai=Wr(s0),o0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},l0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},c0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function u0(a){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(a):(a=c0[a])?!!s[a]:!1}function _s(){return u0}var yn=v({},vs,{key:function(a){if(a.key){var s=o0[a.key]||a.key;if(s!=="Unidentified")return s}return a.type==="keypress"?(a=Ro(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?l0[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_s,charCode:function(a){return a.type==="keypress"?Ro(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Ro(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),f0=Wr(yn),h0=v({},bl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ii=Wr(h0),p=v({},vs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_s}),_=Wr(p),k=v({},ki,{propertyName:0,elapsedTime:0,pseudoElement:0}),z=Wr(k),le=v({},bl,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),ve=Wr(le),Pe=v({},ki,{newState:0,oldState:0}),it=Wr(Pe),dr=[9,13,27,32],Rt=ua&&"CompositionEvent"in window,tr=null;ua&&"documentMode"in document&&(tr=document.documentMode);var fa=ua&&"TextEvent"in window&&!tr,ii=ua&&(!Rt||tr&&8<tr&&11>=tr),Oa=" ",Fa=!1;function Do(a,s){switch(a){case"keyup":return dr.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Rl(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var kl=!1;function Db(a,s){switch(a){case"compositionend":return Rl(s);case"keypress":return s.which!==32?null:(Fa=!0,Oa);case"textInput":return a=s.data,a===Oa&&Fa?null:a;default:return null}}function Nb(a,s){if(kl)return a==="compositionend"||!Rt&&Do(a,s)?(a=Zc(),Co=Jc=ti=null,kl=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return ii&&s.locale!=="ko"?null:s.data;default:return null}}var Ob={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Px(a){var s=a&&a.nodeName&&a.nodeName.toLowerCase();return s==="input"?!!Ob[a.type]:s==="textarea"}function Bx(a,s,l,f){gs?ei?ei.push(f):ei=[f]:gs=f,s=th(s,"onChange"),0<s.length&&(l=new ri("onChange","change",null,l,f),a.push({event:l,listeners:s}))}var nu=null,au=null;function Fb(a){__(a,0)}function d0(a){var s=De(a);if(So(s))return a}function Vx(a,s){if(a==="change")return s}var Ux=!1;if(ua){var ep;if(ua){var tp="oninput"in document;if(!tp){var jx=document.createElement("div");jx.setAttribute("oninput","return;"),tp=typeof jx.oninput=="function"}ep=tp}else ep=!1;Ux=ep&&(!document.documentMode||9<document.documentMode)}function zx(){nu&&(nu.detachEvent("onpropertychange",Hx),au=nu=null)}function Hx(a){if(a.propertyName==="value"&&d0(au)){var s=[];Bx(s,au,a,ca(a)),xs(Fb,s)}}function Mb(a,s,l){a==="focusin"?(zx(),nu=s,au=l,nu.attachEvent("onpropertychange",Hx)):a==="focusout"&&zx()}function Lb(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return d0(au)}function Pb(a,s){if(a==="click")return d0(s)}function Bb(a,s){if(a==="input"||a==="change")return d0(s)}function Vb(a,s){return a===s&&(a!==0||1/a===1/s)||a!==a&&s!==s}var qn=typeof Object.is=="function"?Object.is:Vb;function iu(a,s){if(qn(a,s))return!0;if(typeof a!="object"||a===null||typeof s!="object"||s===null)return!1;var l=Object.keys(a),f=Object.keys(s);if(l.length!==f.length)return!1;for(f=0;f<l.length;f++){var g=l[f];if(!St.call(s,g)||!qn(a[g],s[g]))return!1}return!0}function Gx(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function qx(a,s){var l=Gx(a);a=0;for(var f;l;){if(l.nodeType===3){if(f=a+l.textContent.length,a<=s&&f>=s)return{node:l,offset:s-a};a=f}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Gx(l)}}function Wx(a,s){return a&&s?a===s?!0:a&&a.nodeType===3?!1:s&&s.nodeType===3?Wx(a,s.parentNode):"contains"in a?a.contains(s):a.compareDocumentPosition?!!(a.compareDocumentPosition(s)&16):!1:!1}function Yx(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var s=Za(a.document);s instanceof a.HTMLIFrameElement;){try{var l=typeof s.contentWindow.location.href=="string"}catch{l=!1}if(l)a=s.contentWindow;else break;s=Za(a.document)}return s}function rp(a){var s=a&&a.nodeName&&a.nodeName.toLowerCase();return s&&(s==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||s==="textarea"||a.contentEditable==="true")}var Ub=ua&&"documentMode"in document&&11>=document.documentMode,Il=null,np=null,su=null,ap=!1;function Xx(a,s,l){var f=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;ap||Il==null||Il!==Za(f)||(f=Il,"selectionStart"in f&&rp(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),su&&iu(su,f)||(su=f,f=th(np,"onSelect"),0<f.length&&(s=new ri("onSelect","select",null,s,l),a.push({event:s,listeners:f}),s.target=Il)))}function No(a,s){var l={};return l[a.toLowerCase()]=s.toLowerCase(),l["Webkit"+a]="webkit"+s,l["Moz"+a]="moz"+s,l}var Dl={animationend:No("Animation","AnimationEnd"),animationiteration:No("Animation","AnimationIteration"),animationstart:No("Animation","AnimationStart"),transitionrun:No("Transition","TransitionRun"),transitionstart:No("Transition","TransitionStart"),transitioncancel:No("Transition","TransitionCancel"),transitionend:No("Transition","TransitionEnd")},ip={},Kx={};ua&&(Kx=document.createElement("div").style,"AnimationEvent"in window||(delete Dl.animationend.animation,delete Dl.animationiteration.animation,delete Dl.animationstart.animation),"TransitionEvent"in window||delete Dl.transitionend.transition);function Oo(a){if(ip[a])return ip[a];if(!Dl[a])return a;var s=Dl[a],l;for(l in s)if(s.hasOwnProperty(l)&&l in Kx)return ip[a]=s[l];return a}var $x=Oo("animationend"),Qx=Oo("animationiteration"),Jx=Oo("animationstart"),jb=Oo("transitionrun"),zb=Oo("transitionstart"),Hb=Oo("transitioncancel"),Zx=Oo("transitionend"),ev=new Map,sp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");sp.push("scrollEnd");function Ma(a,s){ev.set(a,s),qt(s,[a])}var p0=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},ha=[],Nl=0,op=0;function m0(){for(var a=Nl,s=op=Nl=0;s<a;){var l=ha[s];ha[s++]=null;var f=ha[s];ha[s++]=null;var g=ha[s];ha[s++]=null;var x=ha[s];if(ha[s++]=null,f!==null&&g!==null){var w=f.pending;w===null?g.next=g:(g.next=w.next,w.next=g),f.pending=g}x!==0&&tv(l,g,x)}}function g0(a,s,l,f){ha[Nl++]=a,ha[Nl++]=s,ha[Nl++]=l,ha[Nl++]=f,op|=f,a.lanes|=f,a=a.alternate,a!==null&&(a.lanes|=f)}function lp(a,s,l,f){return g0(a,s,l,f),x0(a)}function Fo(a,s){return g0(a,null,null,s),x0(a)}function tv(a,s,l){a.lanes|=l;var f=a.alternate;f!==null&&(f.lanes|=l);for(var g=!1,x=a.return;x!==null;)x.childLanes|=l,f=x.alternate,f!==null&&(f.childLanes|=l),x.tag===22&&(a=x.stateNode,a===null||a._visibility&1||(g=!0)),a=x,x=x.return;return a.tag===3?(x=a.stateNode,g&&s!==null&&(g=31-ir(l),a=x.hiddenUpdates,f=a[g],f===null?a[g]=[s]:f.push(s),s.lane=l|536870912),x):null}function x0(a){if(50<Ru)throw Ru=0,xm=null,Error(n(185));for(var s=a.return;s!==null;)a=s,s=a.return;return a.tag===3?a.stateNode:null}var Ol={};function Gb(a,s,l,f){this.tag=a,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wn(a,s,l,f){return new Gb(a,s,l,f)}function cp(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Di(a,s){var l=a.alternate;return l===null?(l=Wn(a.tag,s,a.key,a.mode),l.elementType=a.elementType,l.type=a.type,l.stateNode=a.stateNode,l.alternate=a,a.alternate=l):(l.pendingProps=s,l.type=a.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=a.flags&65011712,l.childLanes=a.childLanes,l.lanes=a.lanes,l.child=a.child,l.memoizedProps=a.memoizedProps,l.memoizedState=a.memoizedState,l.updateQueue=a.updateQueue,s=a.dependencies,l.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},l.sibling=a.sibling,l.index=a.index,l.ref=a.ref,l.refCleanup=a.refCleanup,l}function rv(a,s){a.flags&=65011714;var l=a.alternate;return l===null?(a.childLanes=0,a.lanes=s,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,s=l.dependencies,a.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),a}function v0(a,s,l,f,g,x){var w=0;if(f=a,typeof a=="function")cp(a)&&(w=1);else if(typeof a=="string")w=KC(a,l,J.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case D:return a=Wn(31,l,s,g),a.elementType=D,a.lanes=x,a;case T:return Mo(l.children,g,x,s);case A:w=8,g|=24;break;case B:return a=Wn(12,l,s,g|2),a.elementType=B,a.lanes=x,a;case K:return a=Wn(13,l,s,g),a.elementType=K,a.lanes=x,a;case Y:return a=Wn(19,l,s,g),a.elementType=Y,a.lanes=x,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case C:w=10;break e;case I:w=9;break e;case G:w=11;break e;case b:w=14;break e;case N:w=16,f=null;break e}w=29,l=Error(n(130,a===null?"null":typeof a,"")),f=null}return s=Wn(w,l,s,g),s.elementType=a,s.type=f,s.lanes=x,s}function Mo(a,s,l,f){return a=Wn(7,a,f,s),a.lanes=l,a}function up(a,s,l){return a=Wn(6,a,null,s),a.lanes=l,a}function nv(a){var s=Wn(18,null,null,0);return s.stateNode=a,s}function fp(a,s,l){return s=Wn(4,a.children!==null?a.children:[],a.key,s),s.lanes=l,s.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},s}var av=new WeakMap;function da(a,s){if(typeof a=="object"&&a!==null){var l=av.get(a);return l!==void 0?l:(s={value:a,source:s,stack:Gt(s)},av.set(a,s),s)}return{value:a,source:s,stack:Gt(s)}}var Fl=[],Ml=0,y0=null,ou=0,pa=[],ma=0,Es=null,si=1,oi="";function Ni(a,s){Fl[Ml++]=ou,Fl[Ml++]=y0,y0=a,ou=s}function iv(a,s,l){pa[ma++]=si,pa[ma++]=oi,pa[ma++]=Es,Es=a;var f=si;a=oi;var g=32-ir(f)-1;f&=~(1<<g),l+=1;var x=32-ir(s)+g;if(30<x){var w=g-g%5;x=(f&(1<<w)-1).toString(32),f>>=w,g-=w,si=1<<32-ir(s)+g|l<<g|f,oi=x+a}else si=1<<x|l<<g|f,oi=a}function hp(a){a.return!==null&&(Ni(a,1),iv(a,1,0))}function dp(a){for(;a===y0;)y0=Fl[--Ml],Fl[Ml]=null,ou=Fl[--Ml],Fl[Ml]=null;for(;a===Es;)Es=pa[--ma],pa[ma]=null,oi=pa[--ma],pa[ma]=null,si=pa[--ma],pa[ma]=null}function sv(a,s){pa[ma++]=si,pa[ma++]=oi,pa[ma++]=Es,si=s.id,oi=s.overflow,Es=a}var Yr=null,Jt=null,xt=!1,Ts=null,ga=!1,pp=Error(n(519));function Ss(a){var s=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw lu(da(s,a)),pp}function ov(a){var s=a.stateNode,l=a.type,f=a.memoizedProps;switch(s[H]=a,s[q]=f,l){case"dialog":ft("cancel",s),ft("close",s);break;case"iframe":case"object":case"embed":ft("load",s);break;case"video":case"audio":for(l=0;l<Iu.length;l++)ft(Iu[l],s);break;case"source":ft("error",s);break;case"img":case"image":case"link":ft("error",s),ft("load",s);break;case"details":ft("toggle",s);break;case"input":ft("invalid",s),Jf(s,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":ft("invalid",s);break;case"textarea":ft("invalid",s),ps(s,f.value,f.defaultValue,f.children)}l=f.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||s.textContent===""+l||f.suppressHydrationWarning===!0||w_(s.textContent,l)?(f.popover!=null&&(ft("beforetoggle",s),ft("toggle",s)),f.onScroll!=null&&ft("scroll",s),f.onScrollEnd!=null&&ft("scrollend",s),f.onClick!=null&&(s.onclick=Ia),s=!0):s=!1,s||Ss(a,!0)}function lv(a){for(Yr=a.return;Yr;)switch(Yr.tag){case 5:case 31:case 13:ga=!1;return;case 27:case 3:ga=!0;return;default:Yr=Yr.return}}function Ll(a){if(a!==Yr)return!1;if(!xt)return lv(a),xt=!0,!1;var s=a.tag,l;if((l=s!==3&&s!==27)&&((l=s===5)&&(l=a.type,l=!(l!=="form"&&l!=="button")||Nm(a.type,a.memoizedProps)),l=!l),l&&Jt&&Ss(a),lv(a),s===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));Jt=O_(a)}else if(s===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));Jt=O_(a)}else s===27?(s=Jt,Ps(a.type)?(a=Pm,Pm=null,Jt=a):Jt=s):Jt=Yr?va(a.stateNode.nextSibling):null;return!0}function Lo(){Jt=Yr=null,xt=!1}function mp(){var a=Ts;return a!==null&&(On===null?On=a:On.push.apply(On,a),Ts=null),a}function lu(a){Ts===null?Ts=[a]:Ts.push(a)}var gp=Q(null),Po=null,Oi=null;function ws(a,s,l){te(gp,s._currentValue),s._currentValue=l}function Fi(a){a._currentValue=gp.current,L(gp)}function xp(a,s,l){for(;a!==null;){var f=a.alternate;if((a.childLanes&s)!==s?(a.childLanes|=s,f!==null&&(f.childLanes|=s)):f!==null&&(f.childLanes&s)!==s&&(f.childLanes|=s),a===l)break;a=a.return}}function vp(a,s,l,f){var g=a.child;for(g!==null&&(g.return=a);g!==null;){var x=g.dependencies;if(x!==null){var w=g.child;x=x.firstContext;e:for(;x!==null;){var V=x;x=g;for(var re=0;re<s.length;re++)if(V.context===s[re]){x.lanes|=l,V=x.alternate,V!==null&&(V.lanes|=l),xp(x.return,l,a),f||(w=null);break e}x=V.next}}else if(g.tag===18){if(w=g.return,w===null)throw Error(n(341));w.lanes|=l,x=w.alternate,x!==null&&(x.lanes|=l),xp(w,l,a),w=null}else w=g.child;if(w!==null)w.return=g;else for(w=g;w!==null;){if(w===a){w=null;break}if(g=w.sibling,g!==null){g.return=w.return,w=g;break}w=w.return}g=w}}function Pl(a,s,l,f){a=null;for(var g=s,x=!1;g!==null;){if(!x){if((g.flags&524288)!==0)x=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var w=g.alternate;if(w===null)throw Error(n(387));if(w=w.memoizedProps,w!==null){var V=g.type;qn(g.pendingProps.value,w.value)||(a!==null?a.push(V):a=[V])}}else if(g===Re.current){if(w=g.alternate,w===null)throw Error(n(387));w.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(a!==null?a.push(Mu):a=[Mu])}g=g.return}a!==null&&vp(s,a,l,f),s.flags|=262144}function _0(a){for(a=a.firstContext;a!==null;){if(!qn(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function Bo(a){Po=a,Oi=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function Xr(a){return cv(Po,a)}function E0(a,s){return Po===null&&Bo(a),cv(a,s)}function cv(a,s){var l=s._currentValue;if(s={context:s,memoizedValue:l,next:null},Oi===null){if(a===null)throw Error(n(308));Oi=s,a.dependencies={lanes:0,firstContext:s},a.flags|=524288}else Oi=Oi.next=s;return l}var qb=typeof AbortController<"u"?AbortController:function(){var a=[],s=this.signal={aborted:!1,addEventListener:function(l,f){a.push(f)}};this.abort=function(){s.aborted=!0,a.forEach(function(l){return l()})}},Wb=t.unstable_scheduleCallback,Yb=t.unstable_NormalPriority,_r={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function yp(){return{controller:new qb,data:new Map,refCount:0}}function cu(a){a.refCount--,a.refCount===0&&Wb(Yb,function(){a.controller.abort()})}var uu=null,_p=0,Bl=0,Vl=null;function Xb(a,s){if(uu===null){var l=uu=[];_p=0,Bl=Sm(),Vl={status:"pending",value:void 0,then:function(f){l.push(f)}}}return _p++,s.then(uv,uv),s}function uv(){if(--_p===0&&uu!==null){Vl!==null&&(Vl.status="fulfilled");var a=uu;uu=null,Bl=0,Vl=null;for(var s=0;s<a.length;s++)(0,a[s])()}}function Kb(a,s){var l=[],f={status:"pending",value:null,reason:null,then:function(g){l.push(g)}};return a.then(function(){f.status="fulfilled",f.value=s;for(var g=0;g<l.length;g++)(0,l[g])(s)},function(g){for(f.status="rejected",f.reason=g,g=0;g<l.length;g++)(0,l[g])(void 0)}),f}var fv=ne.S;ne.S=function(a,s){Xy=Ot(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&Xb(a,s),fv!==null&&fv(a,s)};var Vo=Q(null);function Ep(){var a=Vo.current;return a!==null?a:Wt.pooledCache}function T0(a,s){s===null?te(Vo,Vo.current):te(Vo,s.pool)}function hv(){var a=Ep();return a===null?null:{parent:_r._currentValue,pool:a}}var Ul=Error(n(460)),Tp=Error(n(474)),S0=Error(n(542)),w0={then:function(){}};function dv(a){return a=a.status,a==="fulfilled"||a==="rejected"}function pv(a,s,l){switch(l=a[l],l===void 0?a.push(s):l!==s&&(s.then(Ia,Ia),s=l),s.status){case"fulfilled":return s.value;case"rejected":throw a=s.reason,gv(a),a;default:if(typeof s.status=="string")s.then(Ia,Ia);else{if(a=Wt,a!==null&&100<a.shellSuspendCounter)throw Error(n(482));a=s,a.status="pending",a.then(function(f){if(s.status==="pending"){var g=s;g.status="fulfilled",g.value=f}},function(f){if(s.status==="pending"){var g=s;g.status="rejected",g.reason=f}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw a=s.reason,gv(a),a}throw jo=s,Ul}}function Uo(a){try{var s=a._init;return s(a._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(jo=l,Ul):l}}var jo=null;function mv(){if(jo===null)throw Error(n(459));var a=jo;return jo=null,a}function gv(a){if(a===Ul||a===S0)throw Error(n(483))}var jl=null,fu=0;function A0(a){var s=fu;return fu+=1,jl===null&&(jl=[]),pv(jl,a,s)}function hu(a,s){s=s.props.ref,a.ref=s!==void 0?s:null}function b0(a,s){throw s.$$typeof===y?Error(n(525)):(a=Object.prototype.toString.call(s),Error(n(31,a==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":a)))}function xv(a){function s(oe,ie){if(a){var ce=oe.deletions;ce===null?(oe.deletions=[ie],oe.flags|=16):ce.push(ie)}}function l(oe,ie){if(!a)return null;for(;ie!==null;)s(oe,ie),ie=ie.sibling;return null}function f(oe){for(var ie=new Map;oe!==null;)oe.key!==null?ie.set(oe.key,oe):ie.set(oe.index,oe),oe=oe.sibling;return ie}function g(oe,ie){return oe=Di(oe,ie),oe.index=0,oe.sibling=null,oe}function x(oe,ie,ce){return oe.index=ce,a?(ce=oe.alternate,ce!==null?(ce=ce.index,ce<ie?(oe.flags|=67108866,ie):ce):(oe.flags|=67108866,ie)):(oe.flags|=1048576,ie)}function w(oe){return a&&oe.alternate===null&&(oe.flags|=67108866),oe}function V(oe,ie,ce,Se){return ie===null||ie.tag!==6?(ie=up(ce,oe.mode,Se),ie.return=oe,ie):(ie=g(ie,ce),ie.return=oe,ie)}function re(oe,ie,ce,Se){var Ye=ce.type;return Ye===T?Te(oe,ie,ce.props.children,Se,ce.key):ie!==null&&(ie.elementType===Ye||typeof Ye=="object"&&Ye!==null&&Ye.$$typeof===N&&Uo(Ye)===ie.type)?(ie=g(ie,ce.props),hu(ie,ce),ie.return=oe,ie):(ie=v0(ce.type,ce.key,ce.props,null,oe.mode,Se),hu(ie,ce),ie.return=oe,ie)}function he(oe,ie,ce,Se){return ie===null||ie.tag!==4||ie.stateNode.containerInfo!==ce.containerInfo||ie.stateNode.implementation!==ce.implementation?(ie=fp(ce,oe.mode,Se),ie.return=oe,ie):(ie=g(ie,ce.children||[]),ie.return=oe,ie)}function Te(oe,ie,ce,Se,Ye){return ie===null||ie.tag!==7?(ie=Mo(ce,oe.mode,Se,Ye),ie.return=oe,ie):(ie=g(ie,ce),ie.return=oe,ie)}function Ae(oe,ie,ce){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return ie=up(""+ie,oe.mode,ce),ie.return=oe,ie;if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case E:return ce=v0(ie.type,ie.key,ie.props,null,oe.mode,ce),hu(ce,ie),ce.return=oe,ce;case S:return ie=fp(ie,oe.mode,ce),ie.return=oe,ie;case N:return ie=Uo(ie),Ae(oe,ie,ce)}if(Ce(ie)||F(ie))return ie=Mo(ie,oe.mode,ce,null),ie.return=oe,ie;if(typeof ie.then=="function")return Ae(oe,A0(ie),ce);if(ie.$$typeof===C)return Ae(oe,E0(oe,ie),ce);b0(oe,ie)}return null}function ge(oe,ie,ce,Se){var Ye=ie!==null?ie.key:null;if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return Ye!==null?null:V(oe,ie,""+ce,Se);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case E:return ce.key===Ye?re(oe,ie,ce,Se):null;case S:return ce.key===Ye?he(oe,ie,ce,Se):null;case N:return ce=Uo(ce),ge(oe,ie,ce,Se)}if(Ce(ce)||F(ce))return Ye!==null?null:Te(oe,ie,ce,Se,null);if(typeof ce.then=="function")return ge(oe,ie,A0(ce),Se);if(ce.$$typeof===C)return ge(oe,ie,E0(oe,ce),Se);b0(oe,ce)}return null}function ye(oe,ie,ce,Se,Ye){if(typeof Se=="string"&&Se!==""||typeof Se=="number"||typeof Se=="bigint")return oe=oe.get(ce)||null,V(ie,oe,""+Se,Ye);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case E:return oe=oe.get(Se.key===null?ce:Se.key)||null,re(ie,oe,Se,Ye);case S:return oe=oe.get(Se.key===null?ce:Se.key)||null,he(ie,oe,Se,Ye);case N:return Se=Uo(Se),ye(oe,ie,ce,Se,Ye)}if(Ce(Se)||F(Se))return oe=oe.get(ce)||null,Te(ie,oe,Se,Ye,null);if(typeof Se.then=="function")return ye(oe,ie,ce,A0(Se),Ye);if(Se.$$typeof===C)return ye(oe,ie,ce,E0(ie,Se),Ye);b0(ie,Se)}return null}function He(oe,ie,ce,Se){for(var Ye=null,At=null,qe=ie,lt=ie=0,dt=null;qe!==null&&lt<ce.length;lt++){qe.index>lt?(dt=qe,qe=null):dt=qe.sibling;var bt=ge(oe,qe,ce[lt],Se);if(bt===null){qe===null&&(qe=dt);break}a&&qe&&bt.alternate===null&&s(oe,qe),ie=x(bt,ie,lt),At===null?Ye=bt:At.sibling=bt,At=bt,qe=dt}if(lt===ce.length)return l(oe,qe),xt&&Ni(oe,lt),Ye;if(qe===null){for(;lt<ce.length;lt++)qe=Ae(oe,ce[lt],Se),qe!==null&&(ie=x(qe,ie,lt),At===null?Ye=qe:At.sibling=qe,At=qe);return xt&&Ni(oe,lt),Ye}for(qe=f(qe);lt<ce.length;lt++)dt=ye(qe,oe,lt,ce[lt],Se),dt!==null&&(a&&dt.alternate!==null&&qe.delete(dt.key===null?lt:dt.key),ie=x(dt,ie,lt),At===null?Ye=dt:At.sibling=dt,At=dt);return a&&qe.forEach(function(zs){return s(oe,zs)}),xt&&Ni(oe,lt),Ye}function Xe(oe,ie,ce,Se){if(ce==null)throw Error(n(151));for(var Ye=null,At=null,qe=ie,lt=ie=0,dt=null,bt=ce.next();qe!==null&&!bt.done;lt++,bt=ce.next()){qe.index>lt?(dt=qe,qe=null):dt=qe.sibling;var zs=ge(oe,qe,bt.value,Se);if(zs===null){qe===null&&(qe=dt);break}a&&qe&&zs.alternate===null&&s(oe,qe),ie=x(zs,ie,lt),At===null?Ye=zs:At.sibling=zs,At=zs,qe=dt}if(bt.done)return l(oe,qe),xt&&Ni(oe,lt),Ye;if(qe===null){for(;!bt.done;lt++,bt=ce.next())bt=Ae(oe,bt.value,Se),bt!==null&&(ie=x(bt,ie,lt),At===null?Ye=bt:At.sibling=bt,At=bt);return xt&&Ni(oe,lt),Ye}for(qe=f(qe);!bt.done;lt++,bt=ce.next())bt=ye(qe,oe,lt,bt.value,Se),bt!==null&&(a&&bt.alternate!==null&&qe.delete(bt.key===null?lt:bt.key),ie=x(bt,ie,lt),At===null?Ye=bt:At.sibling=bt,At=bt);return a&&qe.forEach(function(sR){return s(oe,sR)}),xt&&Ni(oe,lt),Ye}function Ht(oe,ie,ce,Se){if(typeof ce=="object"&&ce!==null&&ce.type===T&&ce.key===null&&(ce=ce.props.children),typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case E:e:{for(var Ye=ce.key;ie!==null;){if(ie.key===Ye){if(Ye=ce.type,Ye===T){if(ie.tag===7){l(oe,ie.sibling),Se=g(ie,ce.props.children),Se.return=oe,oe=Se;break e}}else if(ie.elementType===Ye||typeof Ye=="object"&&Ye!==null&&Ye.$$typeof===N&&Uo(Ye)===ie.type){l(oe,ie.sibling),Se=g(ie,ce.props),hu(Se,ce),Se.return=oe,oe=Se;break e}l(oe,ie);break}else s(oe,ie);ie=ie.sibling}ce.type===T?(Se=Mo(ce.props.children,oe.mode,Se,ce.key),Se.return=oe,oe=Se):(Se=v0(ce.type,ce.key,ce.props,null,oe.mode,Se),hu(Se,ce),Se.return=oe,oe=Se)}return w(oe);case S:e:{for(Ye=ce.key;ie!==null;){if(ie.key===Ye)if(ie.tag===4&&ie.stateNode.containerInfo===ce.containerInfo&&ie.stateNode.implementation===ce.implementation){l(oe,ie.sibling),Se=g(ie,ce.children||[]),Se.return=oe,oe=Se;break e}else{l(oe,ie);break}else s(oe,ie);ie=ie.sibling}Se=fp(ce,oe.mode,Se),Se.return=oe,oe=Se}return w(oe);case N:return ce=Uo(ce),Ht(oe,ie,ce,Se)}if(Ce(ce))return He(oe,ie,ce,Se);if(F(ce)){if(Ye=F(ce),typeof Ye!="function")throw Error(n(150));return ce=Ye.call(ce),Xe(oe,ie,ce,Se)}if(typeof ce.then=="function")return Ht(oe,ie,A0(ce),Se);if(ce.$$typeof===C)return Ht(oe,ie,E0(oe,ce),Se);b0(oe,ce)}return typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint"?(ce=""+ce,ie!==null&&ie.tag===6?(l(oe,ie.sibling),Se=g(ie,ce),Se.return=oe,oe=Se):(l(oe,ie),Se=up(ce,oe.mode,Se),Se.return=oe,oe=Se),w(oe)):l(oe,ie)}return function(oe,ie,ce,Se){try{fu=0;var Ye=Ht(oe,ie,ce,Se);return jl=null,Ye}catch(qe){if(qe===Ul||qe===S0)throw qe;var At=Wn(29,qe,null,oe.mode);return At.lanes=Se,At.return=oe,At}}}var zo=xv(!0),vv=xv(!1),As=!1;function Sp(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function wp(a,s){a=a.updateQueue,s.updateQueue===a&&(s.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function bs(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function Cs(a,s,l){var f=a.updateQueue;if(f===null)return null;if(f=f.shared,(kt&2)!==0){var g=f.pending;return g===null?s.next=s:(s.next=g.next,g.next=s),f.pending=s,s=x0(a),tv(a,null,l),s}return g0(a,f,s,l),x0(a)}function du(a,s,l){if(s=s.updateQueue,s!==null&&(s=s.shared,(l&4194048)!==0)){var f=s.lanes;f&=a.pendingLanes,l|=f,s.lanes=l,bi(a,l)}}function Ap(a,s){var l=a.updateQueue,f=a.alternate;if(f!==null&&(f=f.updateQueue,l===f)){var g=null,x=null;if(l=l.firstBaseUpdate,l!==null){do{var w={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};x===null?g=x=w:x=x.next=w,l=l.next}while(l!==null);x===null?g=x=s:x=x.next=s}else g=x=s;l={baseState:f.baseState,firstBaseUpdate:g,lastBaseUpdate:x,shared:f.shared,callbacks:f.callbacks},a.updateQueue=l;return}a=l.lastBaseUpdate,a===null?l.firstBaseUpdate=s:a.next=s,l.lastBaseUpdate=s}var bp=!1;function pu(){if(bp){var a=Vl;if(a!==null)throw a}}function mu(a,s,l,f){bp=!1;var g=a.updateQueue;As=!1;var x=g.firstBaseUpdate,w=g.lastBaseUpdate,V=g.shared.pending;if(V!==null){g.shared.pending=null;var re=V,he=re.next;re.next=null,w===null?x=he:w.next=he,w=re;var Te=a.alternate;Te!==null&&(Te=Te.updateQueue,V=Te.lastBaseUpdate,V!==w&&(V===null?Te.firstBaseUpdate=he:V.next=he,Te.lastBaseUpdate=re))}if(x!==null){var Ae=g.baseState;w=0,Te=he=re=null,V=x;do{var ge=V.lane&-536870913,ye=ge!==V.lane;if(ye?(ht&ge)===ge:(f&ge)===ge){ge!==0&&ge===Bl&&(bp=!0),Te!==null&&(Te=Te.next={lane:0,tag:V.tag,payload:V.payload,callback:null,next:null});e:{var He=a,Xe=V;ge=s;var Ht=l;switch(Xe.tag){case 1:if(He=Xe.payload,typeof He=="function"){Ae=He.call(Ht,Ae,ge);break e}Ae=He;break e;case 3:He.flags=He.flags&-65537|128;case 0:if(He=Xe.payload,ge=typeof He=="function"?He.call(Ht,Ae,ge):He,ge==null)break e;Ae=v({},Ae,ge);break e;case 2:As=!0}}ge=V.callback,ge!==null&&(a.flags|=64,ye&&(a.flags|=8192),ye=g.callbacks,ye===null?g.callbacks=[ge]:ye.push(ge))}else ye={lane:ge,tag:V.tag,payload:V.payload,callback:V.callback,next:null},Te===null?(he=Te=ye,re=Ae):Te=Te.next=ye,w|=ge;if(V=V.next,V===null){if(V=g.shared.pending,V===null)break;ye=V,V=ye.next,ye.next=null,g.lastBaseUpdate=ye,g.shared.pending=null}}while(!0);Te===null&&(re=Ae),g.baseState=re,g.firstBaseUpdate=he,g.lastBaseUpdate=Te,x===null&&(g.shared.lanes=0),Ns|=w,a.lanes=w,a.memoizedState=Ae}}function yv(a,s){if(typeof a!="function")throw Error(n(191,a));a.call(s)}function _v(a,s){var l=a.callbacks;if(l!==null)for(a.callbacks=null,a=0;a<l.length;a++)yv(l[a],s)}var zl=Q(null),C0=Q(0);function Ev(a,s){a=Hi,te(C0,a),te(zl,s),Hi=a|s.baseLanes}function Cp(){te(C0,Hi),te(zl,zl.current)}function Rp(){Hi=C0.current,L(zl),L(C0)}var Yn=Q(null),xa=null;function Rs(a){var s=a.alternate;te(pr,pr.current&1),te(Yn,a),xa===null&&(s===null||zl.current!==null||s.memoizedState!==null)&&(xa=a)}function kp(a){te(pr,pr.current),te(Yn,a),xa===null&&(xa=a)}function Tv(a){a.tag===22?(te(pr,pr.current),te(Yn,a),xa===null&&(xa=a)):ks()}function ks(){te(pr,pr.current),te(Yn,Yn.current)}function Xn(a){L(Yn),xa===a&&(xa=null),L(pr)}var pr=Q(0);function R0(a){for(var s=a;s!==null;){if(s.tag===13){var l=s.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||Mm(l)||Lm(l)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Mi=0,st=null,jt=null,Er=null,k0=!1,Hl=!1,Ho=!1,I0=0,gu=0,Gl=null,$b=0;function cr(){throw Error(n(321))}function Ip(a,s){if(s===null)return!1;for(var l=0;l<s.length&&l<a.length;l++)if(!qn(a[l],s[l]))return!1;return!0}function Dp(a,s,l,f,g,x){return Mi=x,st=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,ne.H=a===null||a.memoizedState===null?iy:Wp,Ho=!1,x=l(f,g),Ho=!1,Hl&&(x=wv(s,l,f,g)),Sv(a),x}function Sv(a){ne.H=yu;var s=jt!==null&&jt.next!==null;if(Mi=0,Er=jt=st=null,k0=!1,gu=0,Gl=null,s)throw Error(n(300));a===null||Tr||(a=a.dependencies,a!==null&&_0(a)&&(Tr=!0))}function wv(a,s,l,f){st=a;var g=0;do{if(Hl&&(Gl=null),gu=0,Hl=!1,25<=g)throw Error(n(301));if(g+=1,Er=jt=null,a.updateQueue!=null){var x=a.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}ne.H=sy,x=s(l,f)}while(Hl);return x}function Qb(){var a=ne.H,s=a.useState()[0];return s=typeof s.then=="function"?xu(s):s,a=a.useState()[0],(jt!==null?jt.memoizedState:null)!==a&&(st.flags|=1024),s}function Np(){var a=I0!==0;return I0=0,a}function Op(a,s,l){s.updateQueue=a.updateQueue,s.flags&=-2053,a.lanes&=~l}function Fp(a){if(k0){for(a=a.memoizedState;a!==null;){var s=a.queue;s!==null&&(s.pending=null),a=a.next}k0=!1}Mi=0,Er=jt=st=null,Hl=!1,gu=I0=0,Gl=null}function _n(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Er===null?st.memoizedState=Er=a:Er=Er.next=a,Er}function mr(){if(jt===null){var a=st.alternate;a=a!==null?a.memoizedState:null}else a=jt.next;var s=Er===null?st.memoizedState:Er.next;if(s!==null)Er=s,jt=a;else{if(a===null)throw st.alternate===null?Error(n(467)):Error(n(310));jt=a,a={memoizedState:jt.memoizedState,baseState:jt.baseState,baseQueue:jt.baseQueue,queue:jt.queue,next:null},Er===null?st.memoizedState=Er=a:Er=Er.next=a}return Er}function D0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function xu(a){var s=gu;return gu+=1,Gl===null&&(Gl=[]),a=pv(Gl,a,s),s=st,(Er===null?s.memoizedState:Er.next)===null&&(s=s.alternate,ne.H=s===null||s.memoizedState===null?iy:Wp),a}function N0(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return xu(a);if(a.$$typeof===C)return Xr(a)}throw Error(n(438,String(a)))}function Mp(a){var s=null,l=st.updateQueue;if(l!==null&&(s=l.memoCache),s==null){var f=st.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(s={data:f.data.map(function(g){return g.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),l===null&&(l=D0(),st.updateQueue=l),l.memoCache=s,l=s.data[s.index],l===void 0)for(l=s.data[s.index]=Array(a),f=0;f<a;f++)l[f]=U;return s.index++,l}function Li(a,s){return typeof s=="function"?s(a):s}function O0(a){var s=mr();return Lp(s,jt,a)}function Lp(a,s,l){var f=a.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=l;var g=a.baseQueue,x=f.pending;if(x!==null){if(g!==null){var w=g.next;g.next=x.next,x.next=w}s.baseQueue=g=x,f.pending=null}if(x=a.baseState,g===null)a.memoizedState=x;else{s=g.next;var V=w=null,re=null,he=s,Te=!1;do{var Ae=he.lane&-536870913;if(Ae!==he.lane?(ht&Ae)===Ae:(Mi&Ae)===Ae){var ge=he.revertLane;if(ge===0)re!==null&&(re=re.next={lane:0,revertLane:0,gesture:null,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null}),Ae===Bl&&(Te=!0);else if((Mi&ge)===ge){he=he.next,ge===Bl&&(Te=!0);continue}else Ae={lane:0,revertLane:he.revertLane,gesture:null,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null},re===null?(V=re=Ae,w=x):re=re.next=Ae,st.lanes|=ge,Ns|=ge;Ae=he.action,Ho&&l(x,Ae),x=he.hasEagerState?he.eagerState:l(x,Ae)}else ge={lane:Ae,revertLane:he.revertLane,gesture:he.gesture,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null},re===null?(V=re=ge,w=x):re=re.next=ge,st.lanes|=Ae,Ns|=Ae;he=he.next}while(he!==null&&he!==s);if(re===null?w=x:re.next=V,!qn(x,a.memoizedState)&&(Tr=!0,Te&&(l=Vl,l!==null)))throw l;a.memoizedState=x,a.baseState=w,a.baseQueue=re,f.lastRenderedState=x}return g===null&&(f.lanes=0),[a.memoizedState,f.dispatch]}function Pp(a){var s=mr(),l=s.queue;if(l===null)throw Error(n(311));l.lastRenderedReducer=a;var f=l.dispatch,g=l.pending,x=s.memoizedState;if(g!==null){l.pending=null;var w=g=g.next;do x=a(x,w.action),w=w.next;while(w!==g);qn(x,s.memoizedState)||(Tr=!0),s.memoizedState=x,s.baseQueue===null&&(s.baseState=x),l.lastRenderedState=x}return[x,f]}function Av(a,s,l){var f=st,g=mr(),x=xt;if(x){if(l===void 0)throw Error(n(407));l=l()}else l=s();var w=!qn((jt||g).memoizedState,l);if(w&&(g.memoizedState=l,Tr=!0),g=g.queue,Up(Rv.bind(null,f,g,a),[a]),g.getSnapshot!==s||w||Er!==null&&Er.memoizedState.tag&1){if(f.flags|=2048,ql(9,{destroy:void 0},Cv.bind(null,f,g,l,s),null),Wt===null)throw Error(n(349));x||(Mi&127)!==0||bv(f,s,l)}return l}function bv(a,s,l){a.flags|=16384,a={getSnapshot:s,value:l},s=st.updateQueue,s===null?(s=D0(),st.updateQueue=s,s.stores=[a]):(l=s.stores,l===null?s.stores=[a]:l.push(a))}function Cv(a,s,l,f){s.value=l,s.getSnapshot=f,kv(s)&&Iv(a)}function Rv(a,s,l){return l(function(){kv(s)&&Iv(a)})}function kv(a){var s=a.getSnapshot;a=a.value;try{var l=s();return!qn(a,l)}catch{return!0}}function Iv(a){var s=Fo(a,2);s!==null&&Fn(s,a,2)}function Bp(a){var s=_n();if(typeof a=="function"){var l=a;if(a=l(),Ho){xn(!0);try{l()}finally{xn(!1)}}}return s.memoizedState=s.baseState=a,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Li,lastRenderedState:a},s}function Dv(a,s,l,f){return a.baseState=l,Lp(a,jt,typeof f=="function"?f:Li)}function Jb(a,s,l,f,g){if(L0(a))throw Error(n(485));if(a=s.action,a!==null){var x={payload:g,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){x.listeners.push(w)}};ne.T!==null?l(!0):x.isTransition=!1,f(x),l=s.pending,l===null?(x.next=s.pending=x,Nv(s,x)):(x.next=l.next,s.pending=l.next=x)}}function Nv(a,s){var l=s.action,f=s.payload,g=a.state;if(s.isTransition){var x=ne.T,w={};ne.T=w;try{var V=l(g,f),re=ne.S;re!==null&&re(w,V),Ov(a,s,V)}catch(he){Vp(a,s,he)}finally{x!==null&&w.types!==null&&(x.types=w.types),ne.T=x}}else try{x=l(g,f),Ov(a,s,x)}catch(he){Vp(a,s,he)}}function Ov(a,s,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(f){Fv(a,s,f)},function(f){return Vp(a,s,f)}):Fv(a,s,l)}function Fv(a,s,l){s.status="fulfilled",s.value=l,Mv(s),a.state=l,s=a.pending,s!==null&&(l=s.next,l===s?a.pending=null:(l=l.next,s.next=l,Nv(a,l)))}function Vp(a,s,l){var f=a.pending;if(a.pending=null,f!==null){f=f.next;do s.status="rejected",s.reason=l,Mv(s),s=s.next;while(s!==f)}a.action=null}function Mv(a){a=a.listeners;for(var s=0;s<a.length;s++)(0,a[s])()}function Lv(a,s){return s}function Pv(a,s){if(xt){var l=Wt.formState;if(l!==null){e:{var f=st;if(xt){if(Jt){t:{for(var g=Jt,x=ga;g.nodeType!==8;){if(!x){g=null;break t}if(g=va(g.nextSibling),g===null){g=null;break t}}x=g.data,g=x==="F!"||x==="F"?g:null}if(g){Jt=va(g.nextSibling),f=g.data==="F!";break e}}Ss(f)}f=!1}f&&(s=l[0])}}return l=_n(),l.memoizedState=l.baseState=s,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Lv,lastRenderedState:s},l.queue=f,l=ry.bind(null,st,f),f.dispatch=l,f=Bp(!1),x=qp.bind(null,st,!1,f.queue),f=_n(),g={state:s,dispatch:null,action:a,pending:null},f.queue=g,l=Jb.bind(null,st,g,x,l),g.dispatch=l,f.memoizedState=a,[s,l,!1]}function Bv(a){var s=mr();return Vv(s,jt,a)}function Vv(a,s,l){if(s=Lp(a,s,Lv)[0],a=O0(Li)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var f=xu(s)}catch(w){throw w===Ul?S0:w}else f=s;s=mr();var g=s.queue,x=g.dispatch;return l!==s.memoizedState&&(st.flags|=2048,ql(9,{destroy:void 0},Zb.bind(null,g,l),null)),[f,x,a]}function Zb(a,s){a.action=s}function Uv(a){var s=mr(),l=jt;if(l!==null)return Vv(s,l,a);mr(),s=s.memoizedState,l=mr();var f=l.queue.dispatch;return l.memoizedState=a,[s,f,!1]}function ql(a,s,l,f){return a={tag:a,create:l,deps:f,inst:s,next:null},s=st.updateQueue,s===null&&(s=D0(),st.updateQueue=s),l=s.lastEffect,l===null?s.lastEffect=a.next=a:(f=l.next,l.next=a,a.next=f,s.lastEffect=a),a}function jv(){return mr().memoizedState}function F0(a,s,l,f){var g=_n();st.flags|=a,g.memoizedState=ql(1|s,{destroy:void 0},l,f===void 0?null:f)}function M0(a,s,l,f){var g=mr();f=f===void 0?null:f;var x=g.memoizedState.inst;jt!==null&&f!==null&&Ip(f,jt.memoizedState.deps)?g.memoizedState=ql(s,x,l,f):(st.flags|=a,g.memoizedState=ql(1|s,x,l,f))}function zv(a,s){F0(8390656,8,a,s)}function Up(a,s){M0(2048,8,a,s)}function eC(a){st.flags|=4;var s=st.updateQueue;if(s===null)s=D0(),st.updateQueue=s,s.events=[a];else{var l=s.events;l===null?s.events=[a]:l.push(a)}}function Hv(a){var s=mr().memoizedState;return eC({ref:s,nextImpl:a}),function(){if((kt&2)!==0)throw Error(n(440));return s.impl.apply(void 0,arguments)}}function Gv(a,s){return M0(4,2,a,s)}function qv(a,s){return M0(4,4,a,s)}function Wv(a,s){if(typeof s=="function"){a=a();var l=s(a);return function(){typeof l=="function"?l():s(null)}}if(s!=null)return a=a(),s.current=a,function(){s.current=null}}function Yv(a,s,l){l=l!=null?l.concat([a]):null,M0(4,4,Wv.bind(null,s,a),l)}function jp(){}function Xv(a,s){var l=mr();s=s===void 0?null:s;var f=l.memoizedState;return s!==null&&Ip(s,f[1])?f[0]:(l.memoizedState=[a,s],a)}function Kv(a,s){var l=mr();s=s===void 0?null:s;var f=l.memoizedState;if(s!==null&&Ip(s,f[1]))return f[0];if(f=a(),Ho){xn(!0);try{a()}finally{xn(!1)}}return l.memoizedState=[f,s],f}function zp(a,s,l){return l===void 0||(Mi&1073741824)!==0&&(ht&261930)===0?a.memoizedState=s:(a.memoizedState=l,a=$y(),st.lanes|=a,Ns|=a,l)}function $v(a,s,l,f){return qn(l,s)?l:zl.current!==null?(a=zp(a,l,f),qn(a,s)||(Tr=!0),a):(Mi&42)===0||(Mi&1073741824)!==0&&(ht&261930)===0?(Tr=!0,a.memoizedState=l):(a=$y(),st.lanes|=a,Ns|=a,s)}function Qv(a,s,l,f,g){var x=me.p;me.p=x!==0&&8>x?x:8;var w=ne.T,V={};ne.T=V,qp(a,!1,s,l);try{var re=g(),he=ne.S;if(he!==null&&he(V,re),re!==null&&typeof re=="object"&&typeof re.then=="function"){var Te=Kb(re,f);vu(a,s,Te,Qn(a))}else vu(a,s,f,Qn(a))}catch(Ae){vu(a,s,{then:function(){},status:"rejected",reason:Ae},Qn())}finally{me.p=x,w!==null&&V.types!==null&&(w.types=V.types),ne.T=w}}function tC(){}function Hp(a,s,l,f){if(a.tag!==5)throw Error(n(476));var g=Jv(a).queue;Qv(a,g,s,_e,l===null?tC:function(){return Zv(a),l(f)})}function Jv(a){var s=a.memoizedState;if(s!==null)return s;s={memoizedState:_e,baseState:_e,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Li,lastRenderedState:_e},next:null};var l={};return s.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Li,lastRenderedState:l},next:null},a.memoizedState=s,a=a.alternate,a!==null&&(a.memoizedState=s),s}function Zv(a){var s=Jv(a);s.next===null&&(s=a.alternate.memoizedState),vu(a,s.next.queue,{},Qn())}function Gp(){return Xr(Mu)}function ey(){return mr().memoizedState}function ty(){return mr().memoizedState}function rC(a){for(var s=a.return;s!==null;){switch(s.tag){case 24:case 3:var l=Qn();a=bs(l);var f=Cs(s,a,l);f!==null&&(Fn(f,s,l),du(f,s,l)),s={cache:yp()},a.payload=s;return}s=s.return}}function nC(a,s,l){var f=Qn();l={lane:f,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},L0(a)?ny(s,l):(l=lp(a,s,l,f),l!==null&&(Fn(l,a,f),ay(l,s,f)))}function ry(a,s,l){var f=Qn();vu(a,s,l,f)}function vu(a,s,l,f){var g={lane:f,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(L0(a))ny(s,g);else{var x=a.alternate;if(a.lanes===0&&(x===null||x.lanes===0)&&(x=s.lastRenderedReducer,x!==null))try{var w=s.lastRenderedState,V=x(w,l);if(g.hasEagerState=!0,g.eagerState=V,qn(V,w))return g0(a,s,g,0),Wt===null&&m0(),!1}catch{}if(l=lp(a,s,g,f),l!==null)return Fn(l,a,f),ay(l,s,f),!0}return!1}function qp(a,s,l,f){if(f={lane:2,revertLane:Sm(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},L0(a)){if(s)throw Error(n(479))}else s=lp(a,l,f,2),s!==null&&Fn(s,a,2)}function L0(a){var s=a.alternate;return a===st||s!==null&&s===st}function ny(a,s){Hl=k0=!0;var l=a.pending;l===null?s.next=s:(s.next=l.next,l.next=s),a.pending=s}function ay(a,s,l){if((l&4194048)!==0){var f=s.lanes;f&=a.pendingLanes,l|=f,s.lanes=l,bi(a,l)}}var yu={readContext:Xr,use:N0,useCallback:cr,useContext:cr,useEffect:cr,useImperativeHandle:cr,useLayoutEffect:cr,useInsertionEffect:cr,useMemo:cr,useReducer:cr,useRef:cr,useState:cr,useDebugValue:cr,useDeferredValue:cr,useTransition:cr,useSyncExternalStore:cr,useId:cr,useHostTransitionStatus:cr,useFormState:cr,useActionState:cr,useOptimistic:cr,useMemoCache:cr,useCacheRefresh:cr};yu.useEffectEvent=cr;var iy={readContext:Xr,use:N0,useCallback:function(a,s){return _n().memoizedState=[a,s===void 0?null:s],a},useContext:Xr,useEffect:zv,useImperativeHandle:function(a,s,l){l=l!=null?l.concat([a]):null,F0(4194308,4,Wv.bind(null,s,a),l)},useLayoutEffect:function(a,s){return F0(4194308,4,a,s)},useInsertionEffect:function(a,s){F0(4,2,a,s)},useMemo:function(a,s){var l=_n();s=s===void 0?null:s;var f=a();if(Ho){xn(!0);try{a()}finally{xn(!1)}}return l.memoizedState=[f,s],f},useReducer:function(a,s,l){var f=_n();if(l!==void 0){var g=l(s);if(Ho){xn(!0);try{l(s)}finally{xn(!1)}}}else g=s;return f.memoizedState=f.baseState=g,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:g},f.queue=a,a=a.dispatch=nC.bind(null,st,a),[f.memoizedState,a]},useRef:function(a){var s=_n();return a={current:a},s.memoizedState=a},useState:function(a){a=Bp(a);var s=a.queue,l=ry.bind(null,st,s);return s.dispatch=l,[a.memoizedState,l]},useDebugValue:jp,useDeferredValue:function(a,s){var l=_n();return zp(l,a,s)},useTransition:function(){var a=Bp(!1);return a=Qv.bind(null,st,a.queue,!0,!1),_n().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,s,l){var f=st,g=_n();if(xt){if(l===void 0)throw Error(n(407));l=l()}else{if(l=s(),Wt===null)throw Error(n(349));(ht&127)!==0||bv(f,s,l)}g.memoizedState=l;var x={value:l,getSnapshot:s};return g.queue=x,zv(Rv.bind(null,f,x,a),[a]),f.flags|=2048,ql(9,{destroy:void 0},Cv.bind(null,f,x,l,s),null),l},useId:function(){var a=_n(),s=Wt.identifierPrefix;if(xt){var l=oi,f=si;l=(f&~(1<<32-ir(f)-1)).toString(32)+l,s="_"+s+"R_"+l,l=I0++,0<l&&(s+="H"+l.toString(32)),s+="_"}else l=$b++,s="_"+s+"r_"+l.toString(32)+"_";return a.memoizedState=s},useHostTransitionStatus:Gp,useFormState:Pv,useActionState:Pv,useOptimistic:function(a){var s=_n();s.memoizedState=s.baseState=a;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=l,s=qp.bind(null,st,!0,l),l.dispatch=s,[a,s]},useMemoCache:Mp,useCacheRefresh:function(){return _n().memoizedState=rC.bind(null,st)},useEffectEvent:function(a){var s=_n(),l={impl:a};return s.memoizedState=l,function(){if((kt&2)!==0)throw Error(n(440));return l.impl.apply(void 0,arguments)}}},Wp={readContext:Xr,use:N0,useCallback:Xv,useContext:Xr,useEffect:Up,useImperativeHandle:Yv,useInsertionEffect:Gv,useLayoutEffect:qv,useMemo:Kv,useReducer:O0,useRef:jv,useState:function(){return O0(Li)},useDebugValue:jp,useDeferredValue:function(a,s){var l=mr();return $v(l,jt.memoizedState,a,s)},useTransition:function(){var a=O0(Li)[0],s=mr().memoizedState;return[typeof a=="boolean"?a:xu(a),s]},useSyncExternalStore:Av,useId:ey,useHostTransitionStatus:Gp,useFormState:Bv,useActionState:Bv,useOptimistic:function(a,s){var l=mr();return Dv(l,jt,a,s)},useMemoCache:Mp,useCacheRefresh:ty};Wp.useEffectEvent=Hv;var sy={readContext:Xr,use:N0,useCallback:Xv,useContext:Xr,useEffect:Up,useImperativeHandle:Yv,useInsertionEffect:Gv,useLayoutEffect:qv,useMemo:Kv,useReducer:Pp,useRef:jv,useState:function(){return Pp(Li)},useDebugValue:jp,useDeferredValue:function(a,s){var l=mr();return jt===null?zp(l,a,s):$v(l,jt.memoizedState,a,s)},useTransition:function(){var a=Pp(Li)[0],s=mr().memoizedState;return[typeof a=="boolean"?a:xu(a),s]},useSyncExternalStore:Av,useId:ey,useHostTransitionStatus:Gp,useFormState:Uv,useActionState:Uv,useOptimistic:function(a,s){var l=mr();return jt!==null?Dv(l,jt,a,s):(l.baseState=a,[a,l.queue.dispatch])},useMemoCache:Mp,useCacheRefresh:ty};sy.useEffectEvent=Hv;function Yp(a,s,l,f){s=a.memoizedState,l=l(f,s),l=l==null?s:v({},s,l),a.memoizedState=l,a.lanes===0&&(a.updateQueue.baseState=l)}var Xp={enqueueSetState:function(a,s,l){a=a._reactInternals;var f=Qn(),g=bs(f);g.payload=s,l!=null&&(g.callback=l),s=Cs(a,g,f),s!==null&&(Fn(s,a,f),du(s,a,f))},enqueueReplaceState:function(a,s,l){a=a._reactInternals;var f=Qn(),g=bs(f);g.tag=1,g.payload=s,l!=null&&(g.callback=l),s=Cs(a,g,f),s!==null&&(Fn(s,a,f),du(s,a,f))},enqueueForceUpdate:function(a,s){a=a._reactInternals;var l=Qn(),f=bs(l);f.tag=2,s!=null&&(f.callback=s),s=Cs(a,f,l),s!==null&&(Fn(s,a,l),du(s,a,l))}};function oy(a,s,l,f,g,x,w){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(f,x,w):s.prototype&&s.prototype.isPureReactComponent?!iu(l,f)||!iu(g,x):!0}function ly(a,s,l,f){a=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(l,f),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(l,f),s.state!==a&&Xp.enqueueReplaceState(s,s.state,null)}function Go(a,s){var l=s;if("ref"in s){l={};for(var f in s)f!=="ref"&&(l[f]=s[f])}if(a=a.defaultProps){l===s&&(l=v({},l));for(var g in a)l[g]===void 0&&(l[g]=a[g])}return l}function cy(a){p0(a)}function uy(a){console.error(a)}function fy(a){p0(a)}function P0(a,s){try{var l=a.onUncaughtError;l(s.value,{componentStack:s.stack})}catch(f){setTimeout(function(){throw f})}}function hy(a,s,l){try{var f=a.onCaughtError;f(l.value,{componentStack:l.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function Kp(a,s,l){return l=bs(l),l.tag=3,l.payload={element:null},l.callback=function(){P0(a,s)},l}function dy(a){return a=bs(a),a.tag=3,a}function py(a,s,l,f){var g=l.type.getDerivedStateFromError;if(typeof g=="function"){var x=f.value;a.payload=function(){return g(x)},a.callback=function(){hy(s,l,f)}}var w=l.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(a.callback=function(){hy(s,l,f),typeof g!="function"&&(Os===null?Os=new Set([this]):Os.add(this));var V=f.stack;this.componentDidCatch(f.value,{componentStack:V!==null?V:""})})}function aC(a,s,l,f,g){if(l.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(s=l.alternate,s!==null&&Pl(s,l,g,!0),l=Yn.current,l!==null){switch(l.tag){case 31:case 13:return xa===null?K0():l.alternate===null&&ur===0&&(ur=3),l.flags&=-257,l.flags|=65536,l.lanes=g,f===w0?l.flags|=16384:(s=l.updateQueue,s===null?l.updateQueue=new Set([f]):s.add(f),_m(a,f,g)),!1;case 22:return l.flags|=65536,f===w0?l.flags|=16384:(s=l.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([f])},l.updateQueue=s):(l=s.retryQueue,l===null?s.retryQueue=new Set([f]):l.add(f)),_m(a,f,g)),!1}throw Error(n(435,l.tag))}return _m(a,f,g),K0(),!1}if(xt)return s=Yn.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=g,f!==pp&&(a=Error(n(422),{cause:f}),lu(da(a,l)))):(f!==pp&&(s=Error(n(423),{cause:f}),lu(da(s,l))),a=a.current.alternate,a.flags|=65536,g&=-g,a.lanes|=g,f=da(f,l),g=Kp(a.stateNode,f,g),Ap(a,g),ur!==4&&(ur=2)),!1;var x=Error(n(520),{cause:f});if(x=da(x,l),Cu===null?Cu=[x]:Cu.push(x),ur!==4&&(ur=2),s===null)return!0;f=da(f,l),l=s;do{switch(l.tag){case 3:return l.flags|=65536,a=g&-g,l.lanes|=a,a=Kp(l.stateNode,f,a),Ap(l,a),!1;case 1:if(s=l.type,x=l.stateNode,(l.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Os===null||!Os.has(x))))return l.flags|=65536,g&=-g,l.lanes|=g,g=dy(g),py(g,a,l,f),Ap(l,g),!1}l=l.return}while(l!==null);return!1}var $p=Error(n(461)),Tr=!1;function Kr(a,s,l,f){s.child=a===null?vv(s,null,l,f):zo(s,a.child,l,f)}function my(a,s,l,f,g){l=l.render;var x=s.ref;if("ref"in f){var w={};for(var V in f)V!=="ref"&&(w[V]=f[V])}else w=f;return Bo(s),f=Dp(a,s,l,w,x,g),V=Np(),a!==null&&!Tr?(Op(a,s,g),Pi(a,s,g)):(xt&&V&&hp(s),s.flags|=1,Kr(a,s,f,g),s.child)}function gy(a,s,l,f,g){if(a===null){var x=l.type;return typeof x=="function"&&!cp(x)&&x.defaultProps===void 0&&l.compare===null?(s.tag=15,s.type=x,xy(a,s,x,f,g)):(a=v0(l.type,null,f,s,s.mode,g),a.ref=s.ref,a.return=s,s.child=a)}if(x=a.child,!am(a,g)){var w=x.memoizedProps;if(l=l.compare,l=l!==null?l:iu,l(w,f)&&a.ref===s.ref)return Pi(a,s,g)}return s.flags|=1,a=Di(x,f),a.ref=s.ref,a.return=s,s.child=a}function xy(a,s,l,f,g){if(a!==null){var x=a.memoizedProps;if(iu(x,f)&&a.ref===s.ref)if(Tr=!1,s.pendingProps=f=x,am(a,g))(a.flags&131072)!==0&&(Tr=!0);else return s.lanes=a.lanes,Pi(a,s,g)}return Qp(a,s,l,f,g)}function vy(a,s,l,f){var g=f.children,x=a!==null?a.memoizedState:null;if(a===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((s.flags&128)!==0){if(x=x!==null?x.baseLanes|l:l,a!==null){for(f=s.child=a.child,g=0;f!==null;)g=g|f.lanes|f.childLanes,f=f.sibling;f=g&~x}else f=0,s.child=null;return yy(a,s,x,l,f)}if((l&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},a!==null&&T0(s,x!==null?x.cachePool:null),x!==null?Ev(s,x):Cp(),Tv(s);else return f=s.lanes=536870912,yy(a,s,x!==null?x.baseLanes|l:l,l,f)}else x!==null?(T0(s,x.cachePool),Ev(s,x),ks(),s.memoizedState=null):(a!==null&&T0(s,null),Cp(),ks());return Kr(a,s,g,l),s.child}function _u(a,s){return a!==null&&a.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function yy(a,s,l,f,g){var x=Ep();return x=x===null?null:{parent:_r._currentValue,pool:x},s.memoizedState={baseLanes:l,cachePool:x},a!==null&&T0(s,null),Cp(),Tv(s),a!==null&&Pl(a,s,f,!0),s.childLanes=g,null}function B0(a,s){return s=U0({mode:s.mode,children:s.children},a.mode),s.ref=a.ref,a.child=s,s.return=a,s}function _y(a,s,l){return zo(s,a.child,null,l),a=B0(s,s.pendingProps),a.flags|=2,Xn(s),s.memoizedState=null,a}function iC(a,s,l){var f=s.pendingProps,g=(s.flags&128)!==0;if(s.flags&=-129,a===null){if(xt){if(f.mode==="hidden")return a=B0(s,f),s.lanes=536870912,_u(null,a);if(kp(s),(a=Jt)?(a=N_(a,ga),a=a!==null&&a.data==="&"?a:null,a!==null&&(s.memoizedState={dehydrated:a,treeContext:Es!==null?{id:si,overflow:oi}:null,retryLane:536870912,hydrationErrors:null},l=nv(a),l.return=s,s.child=l,Yr=s,Jt=null)):a=null,a===null)throw Ss(s);return s.lanes=536870912,null}return B0(s,f)}var x=a.memoizedState;if(x!==null){var w=x.dehydrated;if(kp(s),g)if(s.flags&256)s.flags&=-257,s=_y(a,s,l);else if(s.memoizedState!==null)s.child=a.child,s.flags|=128,s=null;else throw Error(n(558));else if(Tr||Pl(a,s,l,!1),g=(l&a.childLanes)!==0,Tr||g){if(f=Wt,f!==null&&(w=To(f,l),w!==0&&w!==x.retryLane))throw x.retryLane=w,Fo(a,w),Fn(f,a,w),$p;K0(),s=_y(a,s,l)}else a=x.treeContext,Jt=va(w.nextSibling),Yr=s,xt=!0,Ts=null,ga=!1,a!==null&&sv(s,a),s=B0(s,f),s.flags|=4096;return s}return a=Di(a.child,{mode:f.mode,children:f.children}),a.ref=s.ref,s.child=a,a.return=s,a}function V0(a,s){var l=s.ref;if(l===null)a!==null&&a.ref!==null&&(s.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(n(284));(a===null||a.ref!==l)&&(s.flags|=4194816)}}function Qp(a,s,l,f,g){return Bo(s),l=Dp(a,s,l,f,void 0,g),f=Np(),a!==null&&!Tr?(Op(a,s,g),Pi(a,s,g)):(xt&&f&&hp(s),s.flags|=1,Kr(a,s,l,g),s.child)}function Ey(a,s,l,f,g,x){return Bo(s),s.updateQueue=null,l=wv(s,f,l,g),Sv(a),f=Np(),a!==null&&!Tr?(Op(a,s,x),Pi(a,s,x)):(xt&&f&&hp(s),s.flags|=1,Kr(a,s,l,x),s.child)}function Ty(a,s,l,f,g){if(Bo(s),s.stateNode===null){var x=Ol,w=l.contextType;typeof w=="object"&&w!==null&&(x=Xr(w)),x=new l(f,x),s.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=Xp,s.stateNode=x,x._reactInternals=s,x=s.stateNode,x.props=f,x.state=s.memoizedState,x.refs={},Sp(s),w=l.contextType,x.context=typeof w=="object"&&w!==null?Xr(w):Ol,x.state=s.memoizedState,w=l.getDerivedStateFromProps,typeof w=="function"&&(Yp(s,l,w,f),x.state=s.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(w=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),w!==x.state&&Xp.enqueueReplaceState(x,x.state,null),mu(s,f,x,g),pu(),x.state=s.memoizedState),typeof x.componentDidMount=="function"&&(s.flags|=4194308),f=!0}else if(a===null){x=s.stateNode;var V=s.memoizedProps,re=Go(l,V);x.props=re;var he=x.context,Te=l.contextType;w=Ol,typeof Te=="object"&&Te!==null&&(w=Xr(Te));var Ae=l.getDerivedStateFromProps;Te=typeof Ae=="function"||typeof x.getSnapshotBeforeUpdate=="function",V=s.pendingProps!==V,Te||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(V||he!==w)&&ly(s,x,f,w),As=!1;var ge=s.memoizedState;x.state=ge,mu(s,f,x,g),pu(),he=s.memoizedState,V||ge!==he||As?(typeof Ae=="function"&&(Yp(s,l,Ae,f),he=s.memoizedState),(re=As||oy(s,l,re,f,ge,he,w))?(Te||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(s.flags|=4194308)):(typeof x.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=f,s.memoizedState=he),x.props=f,x.state=he,x.context=w,f=re):(typeof x.componentDidMount=="function"&&(s.flags|=4194308),f=!1)}else{x=s.stateNode,wp(a,s),w=s.memoizedProps,Te=Go(l,w),x.props=Te,Ae=s.pendingProps,ge=x.context,he=l.contextType,re=Ol,typeof he=="object"&&he!==null&&(re=Xr(he)),V=l.getDerivedStateFromProps,(he=typeof V=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(w!==Ae||ge!==re)&&ly(s,x,f,re),As=!1,ge=s.memoizedState,x.state=ge,mu(s,f,x,g),pu();var ye=s.memoizedState;w!==Ae||ge!==ye||As||a!==null&&a.dependencies!==null&&_0(a.dependencies)?(typeof V=="function"&&(Yp(s,l,V,f),ye=s.memoizedState),(Te=As||oy(s,l,Te,f,ge,ye,re)||a!==null&&a.dependencies!==null&&_0(a.dependencies))?(he||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(f,ye,re),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(f,ye,re)),typeof x.componentDidUpdate=="function"&&(s.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof x.componentDidUpdate!="function"||w===a.memoizedProps&&ge===a.memoizedState||(s.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||w===a.memoizedProps&&ge===a.memoizedState||(s.flags|=1024),s.memoizedProps=f,s.memoizedState=ye),x.props=f,x.state=ye,x.context=re,f=Te):(typeof x.componentDidUpdate!="function"||w===a.memoizedProps&&ge===a.memoizedState||(s.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||w===a.memoizedProps&&ge===a.memoizedState||(s.flags|=1024),f=!1)}return x=f,V0(a,s),f=(s.flags&128)!==0,x||f?(x=s.stateNode,l=f&&typeof l.getDerivedStateFromError!="function"?null:x.render(),s.flags|=1,a!==null&&f?(s.child=zo(s,a.child,null,g),s.child=zo(s,null,l,g)):Kr(a,s,l,g),s.memoizedState=x.state,a=s.child):a=Pi(a,s,g),a}function Sy(a,s,l,f){return Lo(),s.flags|=256,Kr(a,s,l,f),s.child}var Jp={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Zp(a){return{baseLanes:a,cachePool:hv()}}function em(a,s,l){return a=a!==null?a.childLanes&~l:0,s&&(a|=$n),a}function wy(a,s,l){var f=s.pendingProps,g=!1,x=(s.flags&128)!==0,w;if((w=x)||(w=a!==null&&a.memoizedState===null?!1:(pr.current&2)!==0),w&&(g=!0,s.flags&=-129),w=(s.flags&32)!==0,s.flags&=-33,a===null){if(xt){if(g?Rs(s):ks(),(a=Jt)?(a=N_(a,ga),a=a!==null&&a.data!=="&"?a:null,a!==null&&(s.memoizedState={dehydrated:a,treeContext:Es!==null?{id:si,overflow:oi}:null,retryLane:536870912,hydrationErrors:null},l=nv(a),l.return=s,s.child=l,Yr=s,Jt=null)):a=null,a===null)throw Ss(s);return Lm(a)?s.lanes=32:s.lanes=536870912,null}var V=f.children;return f=f.fallback,g?(ks(),g=s.mode,V=U0({mode:"hidden",children:V},g),f=Mo(f,g,l,null),V.return=s,f.return=s,V.sibling=f,s.child=V,f=s.child,f.memoizedState=Zp(l),f.childLanes=em(a,w,l),s.memoizedState=Jp,_u(null,f)):(Rs(s),tm(s,V))}var re=a.memoizedState;if(re!==null&&(V=re.dehydrated,V!==null)){if(x)s.flags&256?(Rs(s),s.flags&=-257,s=rm(a,s,l)):s.memoizedState!==null?(ks(),s.child=a.child,s.flags|=128,s=null):(ks(),V=f.fallback,g=s.mode,f=U0({mode:"visible",children:f.children},g),V=Mo(V,g,l,null),V.flags|=2,f.return=s,V.return=s,f.sibling=V,s.child=f,zo(s,a.child,null,l),f=s.child,f.memoizedState=Zp(l),f.childLanes=em(a,w,l),s.memoizedState=Jp,s=_u(null,f));else if(Rs(s),Lm(V)){if(w=V.nextSibling&&V.nextSibling.dataset,w)var he=w.dgst;w=he,f=Error(n(419)),f.stack="",f.digest=w,lu({value:f,source:null,stack:null}),s=rm(a,s,l)}else if(Tr||Pl(a,s,l,!1),w=(l&a.childLanes)!==0,Tr||w){if(w=Wt,w!==null&&(f=To(w,l),f!==0&&f!==re.retryLane))throw re.retryLane=f,Fo(a,f),Fn(w,a,f),$p;Mm(V)||K0(),s=rm(a,s,l)}else Mm(V)?(s.flags|=192,s.child=a.child,s=null):(a=re.treeContext,Jt=va(V.nextSibling),Yr=s,xt=!0,Ts=null,ga=!1,a!==null&&sv(s,a),s=tm(s,f.children),s.flags|=4096);return s}return g?(ks(),V=f.fallback,g=s.mode,re=a.child,he=re.sibling,f=Di(re,{mode:"hidden",children:f.children}),f.subtreeFlags=re.subtreeFlags&65011712,he!==null?V=Di(he,V):(V=Mo(V,g,l,null),V.flags|=2),V.return=s,f.return=s,f.sibling=V,s.child=f,_u(null,f),f=s.child,V=a.child.memoizedState,V===null?V=Zp(l):(g=V.cachePool,g!==null?(re=_r._currentValue,g=g.parent!==re?{parent:re,pool:re}:g):g=hv(),V={baseLanes:V.baseLanes|l,cachePool:g}),f.memoizedState=V,f.childLanes=em(a,w,l),s.memoizedState=Jp,_u(a.child,f)):(Rs(s),l=a.child,a=l.sibling,l=Di(l,{mode:"visible",children:f.children}),l.return=s,l.sibling=null,a!==null&&(w=s.deletions,w===null?(s.deletions=[a],s.flags|=16):w.push(a)),s.child=l,s.memoizedState=null,l)}function tm(a,s){return s=U0({mode:"visible",children:s},a.mode),s.return=a,a.child=s}function U0(a,s){return a=Wn(22,a,null,s),a.lanes=0,a}function rm(a,s,l){return zo(s,a.child,null,l),a=tm(s,s.pendingProps.children),a.flags|=2,s.memoizedState=null,a}function Ay(a,s,l){a.lanes|=s;var f=a.alternate;f!==null&&(f.lanes|=s),xp(a.return,s,l)}function nm(a,s,l,f,g,x){var w=a.memoizedState;w===null?a.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:f,tail:l,tailMode:g,treeForkCount:x}:(w.isBackwards=s,w.rendering=null,w.renderingStartTime=0,w.last=f,w.tail=l,w.tailMode=g,w.treeForkCount=x)}function by(a,s,l){var f=s.pendingProps,g=f.revealOrder,x=f.tail;f=f.children;var w=pr.current,V=(w&2)!==0;if(V?(w=w&1|2,s.flags|=128):w&=1,te(pr,w),Kr(a,s,f,l),f=xt?ou:0,!V&&a!==null&&(a.flags&128)!==0)e:for(a=s.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&Ay(a,l,s);else if(a.tag===19)Ay(a,l,s);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(g){case"forwards":for(l=s.child,g=null;l!==null;)a=l.alternate,a!==null&&R0(a)===null&&(g=l),l=l.sibling;l=g,l===null?(g=s.child,s.child=null):(g=l.sibling,l.sibling=null),nm(s,!1,g,l,x,f);break;case"backwards":case"unstable_legacy-backwards":for(l=null,g=s.child,s.child=null;g!==null;){if(a=g.alternate,a!==null&&R0(a)===null){s.child=g;break}a=g.sibling,g.sibling=l,l=g,g=a}nm(s,!0,l,null,x,f);break;case"together":nm(s,!1,null,null,void 0,f);break;default:s.memoizedState=null}return s.child}function Pi(a,s,l){if(a!==null&&(s.dependencies=a.dependencies),Ns|=s.lanes,(l&s.childLanes)===0)if(a!==null){if(Pl(a,s,l,!1),(l&s.childLanes)===0)return null}else return null;if(a!==null&&s.child!==a.child)throw Error(n(153));if(s.child!==null){for(a=s.child,l=Di(a,a.pendingProps),s.child=l,l.return=s;a.sibling!==null;)a=a.sibling,l=l.sibling=Di(a,a.pendingProps),l.return=s;l.sibling=null}return s.child}function am(a,s){return(a.lanes&s)!==0?!0:(a=a.dependencies,!!(a!==null&&_0(a)))}function sC(a,s,l){switch(s.tag){case 3:Me(s,s.stateNode.containerInfo),ws(s,_r,a.memoizedState.cache),Lo();break;case 27:case 5:Oe(s);break;case 4:Me(s,s.stateNode.containerInfo);break;case 10:ws(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,kp(s),null;break;case 13:var f=s.memoizedState;if(f!==null)return f.dehydrated!==null?(Rs(s),s.flags|=128,null):(l&s.child.childLanes)!==0?wy(a,s,l):(Rs(s),a=Pi(a,s,l),a!==null?a.sibling:null);Rs(s);break;case 19:var g=(a.flags&128)!==0;if(f=(l&s.childLanes)!==0,f||(Pl(a,s,l,!1),f=(l&s.childLanes)!==0),g){if(f)return by(a,s,l);s.flags|=128}if(g=s.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),te(pr,pr.current),f)break;return null;case 22:return s.lanes=0,vy(a,s,l,s.pendingProps);case 24:ws(s,_r,a.memoizedState.cache)}return Pi(a,s,l)}function Cy(a,s,l){if(a!==null)if(a.memoizedProps!==s.pendingProps)Tr=!0;else{if(!am(a,l)&&(s.flags&128)===0)return Tr=!1,sC(a,s,l);Tr=(a.flags&131072)!==0}else Tr=!1,xt&&(s.flags&1048576)!==0&&iv(s,ou,s.index);switch(s.lanes=0,s.tag){case 16:e:{var f=s.pendingProps;if(a=Uo(s.elementType),s.type=a,typeof a=="function")cp(a)?(f=Go(a,f),s.tag=1,s=Ty(null,s,a,f,l)):(s.tag=0,s=Qp(null,s,a,f,l));else{if(a!=null){var g=a.$$typeof;if(g===G){s.tag=11,s=my(null,s,a,f,l);break e}else if(g===b){s.tag=14,s=gy(null,s,a,f,l);break e}}throw s=we(a)||a,Error(n(306,s,""))}}return s;case 0:return Qp(a,s,s.type,s.pendingProps,l);case 1:return f=s.type,g=Go(f,s.pendingProps),Ty(a,s,f,g,l);case 3:e:{if(Me(s,s.stateNode.containerInfo),a===null)throw Error(n(387));f=s.pendingProps;var x=s.memoizedState;g=x.element,wp(a,s),mu(s,f,null,l);var w=s.memoizedState;if(f=w.cache,ws(s,_r,f),f!==x.cache&&vp(s,[_r],l,!0),pu(),f=w.element,x.isDehydrated)if(x={element:f,isDehydrated:!1,cache:w.cache},s.updateQueue.baseState=x,s.memoizedState=x,s.flags&256){s=Sy(a,s,f,l);break e}else if(f!==g){g=da(Error(n(424)),s),lu(g),s=Sy(a,s,f,l);break e}else for(a=s.stateNode.containerInfo,a.nodeType===9?a=a.body:a=a.nodeName==="HTML"?a.ownerDocument.body:a,Jt=va(a.firstChild),Yr=s,xt=!0,Ts=null,ga=!0,l=vv(s,null,f,l),s.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(Lo(),f===g){s=Pi(a,s,l);break e}Kr(a,s,f,l)}s=s.child}return s;case 26:return V0(a,s),a===null?(l=B_(s.type,null,s.pendingProps,null))?s.memoizedState=l:xt||(l=s.type,a=s.pendingProps,f=rh(xe.current).createElement(l),f[H]=s,f[q]=a,$r(f,l,a),Ge(f),s.stateNode=f):s.memoizedState=B_(s.type,a.memoizedProps,s.pendingProps,a.memoizedState),null;case 27:return Oe(s),a===null&&xt&&(f=s.stateNode=M_(s.type,s.pendingProps,xe.current),Yr=s,ga=!0,g=Jt,Ps(s.type)?(Pm=g,Jt=va(f.firstChild)):Jt=g),Kr(a,s,s.pendingProps.children,l),V0(a,s),a===null&&(s.flags|=4194304),s.child;case 5:return a===null&&xt&&((g=f=Jt)&&(f=LC(f,s.type,s.pendingProps,ga),f!==null?(s.stateNode=f,Yr=s,Jt=va(f.firstChild),ga=!1,g=!0):g=!1),g||Ss(s)),Oe(s),g=s.type,x=s.pendingProps,w=a!==null?a.memoizedProps:null,f=x.children,Nm(g,x)?f=null:w!==null&&Nm(g,w)&&(s.flags|=32),s.memoizedState!==null&&(g=Dp(a,s,Qb,null,null,l),Mu._currentValue=g),V0(a,s),Kr(a,s,f,l),s.child;case 6:return a===null&&xt&&((a=l=Jt)&&(l=PC(l,s.pendingProps,ga),l!==null?(s.stateNode=l,Yr=s,Jt=null,a=!0):a=!1),a||Ss(s)),null;case 13:return wy(a,s,l);case 4:return Me(s,s.stateNode.containerInfo),f=s.pendingProps,a===null?s.child=zo(s,null,f,l):Kr(a,s,f,l),s.child;case 11:return my(a,s,s.type,s.pendingProps,l);case 7:return Kr(a,s,s.pendingProps,l),s.child;case 8:return Kr(a,s,s.pendingProps.children,l),s.child;case 12:return Kr(a,s,s.pendingProps.children,l),s.child;case 10:return f=s.pendingProps,ws(s,s.type,f.value),Kr(a,s,f.children,l),s.child;case 9:return g=s.type._context,f=s.pendingProps.children,Bo(s),g=Xr(g),f=f(g),s.flags|=1,Kr(a,s,f,l),s.child;case 14:return gy(a,s,s.type,s.pendingProps,l);case 15:return xy(a,s,s.type,s.pendingProps,l);case 19:return by(a,s,l);case 31:return iC(a,s,l);case 22:return vy(a,s,l,s.pendingProps);case 24:return Bo(s),f=Xr(_r),a===null?(g=Ep(),g===null&&(g=Wt,x=yp(),g.pooledCache=x,x.refCount++,x!==null&&(g.pooledCacheLanes|=l),g=x),s.memoizedState={parent:f,cache:g},Sp(s),ws(s,_r,g)):((a.lanes&l)!==0&&(wp(a,s),mu(s,null,null,l),pu()),g=a.memoizedState,x=s.memoizedState,g.parent!==f?(g={parent:f,cache:f},s.memoizedState=g,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=g),ws(s,_r,f)):(f=x.cache,ws(s,_r,f),f!==g.cache&&vp(s,[_r],l,!0))),Kr(a,s,s.pendingProps.children,l),s.child;case 29:throw s.pendingProps}throw Error(n(156,s.tag))}function Bi(a){a.flags|=4}function im(a,s,l,f,g){if((s=(a.mode&32)!==0)&&(s=!1),s){if(a.flags|=16777216,(g&335544128)===g)if(a.stateNode.complete)a.flags|=8192;else if(e_())a.flags|=8192;else throw jo=w0,Tp}else a.flags&=-16777217}function Ry(a,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!H_(s))if(e_())a.flags|=8192;else throw jo=w0,Tp}function j0(a,s){s!==null&&(a.flags|=4),a.flags&16384&&(s=a.tag!==22?_l():536870912,a.lanes|=s,Kl|=s)}function Eu(a,s){if(!xt)switch(a.tailMode){case"hidden":s=a.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?a.tail=null:l.sibling=null;break;case"collapsed":l=a.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?s||a.tail===null?a.tail=null:a.tail.sibling=null:f.sibling=null}}function Zt(a){var s=a.alternate!==null&&a.alternate.child===a.child,l=0,f=0;if(s)for(var g=a.child;g!==null;)l|=g.lanes|g.childLanes,f|=g.subtreeFlags&65011712,f|=g.flags&65011712,g.return=a,g=g.sibling;else for(g=a.child;g!==null;)l|=g.lanes|g.childLanes,f|=g.subtreeFlags,f|=g.flags,g.return=a,g=g.sibling;return a.subtreeFlags|=f,a.childLanes=l,s}function oC(a,s,l){var f=s.pendingProps;switch(dp(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zt(s),null;case 1:return Zt(s),null;case 3:return l=s.stateNode,f=null,a!==null&&(f=a.memoizedState.cache),s.memoizedState.cache!==f&&(s.flags|=2048),Fi(_r),Ie(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(a===null||a.child===null)&&(Ll(s)?Bi(s):a===null||a.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,mp())),Zt(s),null;case 26:var g=s.type,x=s.memoizedState;return a===null?(Bi(s),x!==null?(Zt(s),Ry(s,x)):(Zt(s),im(s,g,null,f,l))):x?x!==a.memoizedState?(Bi(s),Zt(s),Ry(s,x)):(Zt(s),s.flags&=-16777217):(a=a.memoizedProps,a!==f&&Bi(s),Zt(s),im(s,g,a,f,l)),null;case 27:if(ct(s),l=xe.current,g=s.type,a!==null&&s.stateNode!=null)a.memoizedProps!==f&&Bi(s);else{if(!f){if(s.stateNode===null)throw Error(n(166));return Zt(s),null}a=J.current,Ll(s)?ov(s):(a=M_(g,f,l),s.stateNode=a,Bi(s))}return Zt(s),null;case 5:if(ct(s),g=s.type,a!==null&&s.stateNode!=null)a.memoizedProps!==f&&Bi(s);else{if(!f){if(s.stateNode===null)throw Error(n(166));return Zt(s),null}if(x=J.current,Ll(s))ov(s);else{var w=rh(xe.current);switch(x){case 1:x=w.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:x=w.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":x=w.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":x=w.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":x=w.createElement("div"),x.innerHTML="<script><\/script>",x=x.removeChild(x.firstChild);break;case"select":x=typeof f.is=="string"?w.createElement("select",{is:f.is}):w.createElement("select"),f.multiple?x.multiple=!0:f.size&&(x.size=f.size);break;default:x=typeof f.is=="string"?w.createElement(g,{is:f.is}):w.createElement(g)}}x[H]=s,x[q]=f;e:for(w=s.child;w!==null;){if(w.tag===5||w.tag===6)x.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===s)break e;for(;w.sibling===null;){if(w.return===null||w.return===s)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}s.stateNode=x;e:switch($r(x,g,f),g){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&Bi(s)}}return Zt(s),im(s,s.type,a===null?null:a.memoizedProps,s.pendingProps,l),null;case 6:if(a&&s.stateNode!=null)a.memoizedProps!==f&&Bi(s);else{if(typeof f!="string"&&s.stateNode===null)throw Error(n(166));if(a=xe.current,Ll(s)){if(a=s.stateNode,l=s.memoizedProps,f=null,g=Yr,g!==null)switch(g.tag){case 27:case 5:f=g.memoizedProps}a[H]=s,a=!!(a.nodeValue===l||f!==null&&f.suppressHydrationWarning===!0||w_(a.nodeValue,l)),a||Ss(s,!0)}else a=rh(a).createTextNode(f),a[H]=s,s.stateNode=a}return Zt(s),null;case 31:if(l=s.memoizedState,a===null||a.memoizedState!==null){if(f=Ll(s),l!==null){if(a===null){if(!f)throw Error(n(318));if(a=s.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(557));a[H]=s}else Lo(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Zt(s),a=!1}else l=mp(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=l),a=!0;if(!a)return s.flags&256?(Xn(s),s):(Xn(s),null);if((s.flags&128)!==0)throw Error(n(558))}return Zt(s),null;case 13:if(f=s.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(g=Ll(s),f!==null&&f.dehydrated!==null){if(a===null){if(!g)throw Error(n(318));if(g=s.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(n(317));g[H]=s}else Lo(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Zt(s),g=!1}else g=mp(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=g),g=!0;if(!g)return s.flags&256?(Xn(s),s):(Xn(s),null)}return Xn(s),(s.flags&128)!==0?(s.lanes=l,s):(l=f!==null,a=a!==null&&a.memoizedState!==null,l&&(f=s.child,g=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(g=f.alternate.memoizedState.cachePool.pool),x=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(x=f.memoizedState.cachePool.pool),x!==g&&(f.flags|=2048)),l!==a&&l&&(s.child.flags|=8192),j0(s,s.updateQueue),Zt(s),null);case 4:return Ie(),a===null&&Cm(s.stateNode.containerInfo),Zt(s),null;case 10:return Fi(s.type),Zt(s),null;case 19:if(L(pr),f=s.memoizedState,f===null)return Zt(s),null;if(g=(s.flags&128)!==0,x=f.rendering,x===null)if(g)Eu(f,!1);else{if(ur!==0||a!==null&&(a.flags&128)!==0)for(a=s.child;a!==null;){if(x=R0(a),x!==null){for(s.flags|=128,Eu(f,!1),a=x.updateQueue,s.updateQueue=a,j0(s,a),s.subtreeFlags=0,a=l,l=s.child;l!==null;)rv(l,a),l=l.sibling;return te(pr,pr.current&1|2),xt&&Ni(s,f.treeForkCount),s.child}a=a.sibling}f.tail!==null&&Ot()>W0&&(s.flags|=128,g=!0,Eu(f,!1),s.lanes=4194304)}else{if(!g)if(a=R0(x),a!==null){if(s.flags|=128,g=!0,a=a.updateQueue,s.updateQueue=a,j0(s,a),Eu(f,!0),f.tail===null&&f.tailMode==="hidden"&&!x.alternate&&!xt)return Zt(s),null}else 2*Ot()-f.renderingStartTime>W0&&l!==536870912&&(s.flags|=128,g=!0,Eu(f,!1),s.lanes=4194304);f.isBackwards?(x.sibling=s.child,s.child=x):(a=f.last,a!==null?a.sibling=x:s.child=x,f.last=x)}return f.tail!==null?(a=f.tail,f.rendering=a,f.tail=a.sibling,f.renderingStartTime=Ot(),a.sibling=null,l=pr.current,te(pr,g?l&1|2:l&1),xt&&Ni(s,f.treeForkCount),a):(Zt(s),null);case 22:case 23:return Xn(s),Rp(),f=s.memoizedState!==null,a!==null?a.memoizedState!==null!==f&&(s.flags|=8192):f&&(s.flags|=8192),f?(l&536870912)!==0&&(s.flags&128)===0&&(Zt(s),s.subtreeFlags&6&&(s.flags|=8192)):Zt(s),l=s.updateQueue,l!==null&&j0(s,l.retryQueue),l=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(l=a.memoizedState.cachePool.pool),f=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),f!==l&&(s.flags|=2048),a!==null&&L(Vo),null;case 24:return l=null,a!==null&&(l=a.memoizedState.cache),s.memoizedState.cache!==l&&(s.flags|=2048),Fi(_r),Zt(s),null;case 25:return null;case 30:return null}throw Error(n(156,s.tag))}function lC(a,s){switch(dp(s),s.tag){case 1:return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 3:return Fi(_r),Ie(),a=s.flags,(a&65536)!==0&&(a&128)===0?(s.flags=a&-65537|128,s):null;case 26:case 27:case 5:return ct(s),null;case 31:if(s.memoizedState!==null){if(Xn(s),s.alternate===null)throw Error(n(340));Lo()}return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 13:if(Xn(s),a=s.memoizedState,a!==null&&a.dehydrated!==null){if(s.alternate===null)throw Error(n(340));Lo()}return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 19:return L(pr),null;case 4:return Ie(),null;case 10:return Fi(s.type),null;case 22:case 23:return Xn(s),Rp(),a!==null&&L(Vo),a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 24:return Fi(_r),null;case 25:return null;default:return null}}function ky(a,s){switch(dp(s),s.tag){case 3:Fi(_r),Ie();break;case 26:case 27:case 5:ct(s);break;case 4:Ie();break;case 31:s.memoizedState!==null&&Xn(s);break;case 13:Xn(s);break;case 19:L(pr);break;case 10:Fi(s.type);break;case 22:case 23:Xn(s),Rp(),a!==null&&L(Vo);break;case 24:Fi(_r)}}function Tu(a,s){try{var l=s.updateQueue,f=l!==null?l.lastEffect:null;if(f!==null){var g=f.next;l=g;do{if((l.tag&a)===a){f=void 0;var x=l.create,w=l.inst;f=x(),w.destroy=f}l=l.next}while(l!==g)}}catch(V){Bt(s,s.return,V)}}function Is(a,s,l){try{var f=s.updateQueue,g=f!==null?f.lastEffect:null;if(g!==null){var x=g.next;f=x;do{if((f.tag&a)===a){var w=f.inst,V=w.destroy;if(V!==void 0){w.destroy=void 0,g=s;var re=l,he=V;try{he()}catch(Te){Bt(g,re,Te)}}}f=f.next}while(f!==x)}}catch(Te){Bt(s,s.return,Te)}}function Iy(a){var s=a.updateQueue;if(s!==null){var l=a.stateNode;try{_v(s,l)}catch(f){Bt(a,a.return,f)}}}function Dy(a,s,l){l.props=Go(a.type,a.memoizedProps),l.state=a.memoizedState;try{l.componentWillUnmount()}catch(f){Bt(a,s,f)}}function Su(a,s){try{var l=a.ref;if(l!==null){switch(a.tag){case 26:case 27:case 5:var f=a.stateNode;break;case 30:f=a.stateNode;break;default:f=a.stateNode}typeof l=="function"?a.refCleanup=l(f):l.current=f}}catch(g){Bt(a,s,g)}}function li(a,s){var l=a.ref,f=a.refCleanup;if(l!==null)if(typeof f=="function")try{f()}catch(g){Bt(a,s,g)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(g){Bt(a,s,g)}else l.current=null}function Ny(a){var s=a.type,l=a.memoizedProps,f=a.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":l.autoFocus&&f.focus();break e;case"img":l.src?f.src=l.src:l.srcSet&&(f.srcset=l.srcSet)}}catch(g){Bt(a,a.return,g)}}function sm(a,s,l){try{var f=a.stateNode;IC(f,a.type,l,s),f[q]=s}catch(g){Bt(a,a.return,g)}}function Oy(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&Ps(a.type)||a.tag===4}function om(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||Oy(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&Ps(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function lm(a,s,l){var f=a.tag;if(f===5||f===6)a=a.stateNode,s?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(a,s):(s=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,s.appendChild(a),l=l._reactRootContainer,l!=null||s.onclick!==null||(s.onclick=Ia));else if(f!==4&&(f===27&&Ps(a.type)&&(l=a.stateNode,s=null),a=a.child,a!==null))for(lm(a,s,l),a=a.sibling;a!==null;)lm(a,s,l),a=a.sibling}function z0(a,s,l){var f=a.tag;if(f===5||f===6)a=a.stateNode,s?l.insertBefore(a,s):l.appendChild(a);else if(f!==4&&(f===27&&Ps(a.type)&&(l=a.stateNode),a=a.child,a!==null))for(z0(a,s,l),a=a.sibling;a!==null;)z0(a,s,l),a=a.sibling}function Fy(a){var s=a.stateNode,l=a.memoizedProps;try{for(var f=a.type,g=s.attributes;g.length;)s.removeAttributeNode(g[0]);$r(s,f,l),s[H]=a,s[q]=l}catch(x){Bt(a,a.return,x)}}var Vi=!1,Sr=!1,cm=!1,My=typeof WeakSet=="function"?WeakSet:Set,Br=null;function cC(a,s){if(a=a.containerInfo,Im=ch,a=Yx(a),rp(a)){if("selectionStart"in a)var l={start:a.selectionStart,end:a.selectionEnd};else e:{l=(l=a.ownerDocument)&&l.defaultView||window;var f=l.getSelection&&l.getSelection();if(f&&f.rangeCount!==0){l=f.anchorNode;var g=f.anchorOffset,x=f.focusNode;f=f.focusOffset;try{l.nodeType,x.nodeType}catch{l=null;break e}var w=0,V=-1,re=-1,he=0,Te=0,Ae=a,ge=null;t:for(;;){for(var ye;Ae!==l||g!==0&&Ae.nodeType!==3||(V=w+g),Ae!==x||f!==0&&Ae.nodeType!==3||(re=w+f),Ae.nodeType===3&&(w+=Ae.nodeValue.length),(ye=Ae.firstChild)!==null;)ge=Ae,Ae=ye;for(;;){if(Ae===a)break t;if(ge===l&&++he===g&&(V=w),ge===x&&++Te===f&&(re=w),(ye=Ae.nextSibling)!==null)break;Ae=ge,ge=Ae.parentNode}Ae=ye}l=V===-1||re===-1?null:{start:V,end:re}}else l=null}l=l||{start:0,end:0}}else l=null;for(Dm={focusedElem:a,selectionRange:l},ch=!1,Br=s;Br!==null;)if(s=Br,a=s.child,(s.subtreeFlags&1028)!==0&&a!==null)a.return=s,Br=a;else for(;Br!==null;){switch(s=Br,x=s.alternate,a=s.flags,s.tag){case 0:if((a&4)!==0&&(a=s.updateQueue,a=a!==null?a.events:null,a!==null))for(l=0;l<a.length;l++)g=a[l],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&x!==null){a=void 0,l=s,g=x.memoizedProps,x=x.memoizedState,f=l.stateNode;try{var He=Go(l.type,g);a=f.getSnapshotBeforeUpdate(He,x),f.__reactInternalSnapshotBeforeUpdate=a}catch(Xe){Bt(l,l.return,Xe)}}break;case 3:if((a&1024)!==0){if(a=s.stateNode.containerInfo,l=a.nodeType,l===9)Fm(a);else if(l===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":Fm(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(n(163))}if(a=s.sibling,a!==null){a.return=s.return,Br=a;break}Br=s.return}}function Ly(a,s,l){var f=l.flags;switch(l.tag){case 0:case 11:case 15:ji(a,l),f&4&&Tu(5,l);break;case 1:if(ji(a,l),f&4)if(a=l.stateNode,s===null)try{a.componentDidMount()}catch(w){Bt(l,l.return,w)}else{var g=Go(l.type,s.memoizedProps);s=s.memoizedState;try{a.componentDidUpdate(g,s,a.__reactInternalSnapshotBeforeUpdate)}catch(w){Bt(l,l.return,w)}}f&64&&Iy(l),f&512&&Su(l,l.return);break;case 3:if(ji(a,l),f&64&&(a=l.updateQueue,a!==null)){if(s=null,l.child!==null)switch(l.child.tag){case 27:case 5:s=l.child.stateNode;break;case 1:s=l.child.stateNode}try{_v(a,s)}catch(w){Bt(l,l.return,w)}}break;case 27:s===null&&f&4&&Fy(l);case 26:case 5:ji(a,l),s===null&&f&4&&Ny(l),f&512&&Su(l,l.return);break;case 12:ji(a,l);break;case 31:ji(a,l),f&4&&Vy(a,l);break;case 13:ji(a,l),f&4&&Uy(a,l),f&64&&(a=l.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(l=vC.bind(null,l),BC(a,l))));break;case 22:if(f=l.memoizedState!==null||Vi,!f){s=s!==null&&s.memoizedState!==null||Sr,g=Vi;var x=Sr;Vi=f,(Sr=s)&&!x?zi(a,l,(l.subtreeFlags&8772)!==0):ji(a,l),Vi=g,Sr=x}break;case 30:break;default:ji(a,l)}}function Py(a){var s=a.alternate;s!==null&&(a.alternate=null,Py(s)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(s=a.stateNode,s!==null&&Ne(s)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var rr=null,In=!1;function Ui(a,s,l){for(l=l.child;l!==null;)By(a,s,l),l=l.sibling}function By(a,s,l){if(Qt&&typeof Qt.onCommitFiberUnmount=="function")try{Qt.onCommitFiberUnmount(Ct,l)}catch{}switch(l.tag){case 26:Sr||li(l,s),Ui(a,s,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Sr||li(l,s);var f=rr,g=In;Ps(l.type)&&(rr=l.stateNode,In=!1),Ui(a,s,l),Nu(l.stateNode),rr=f,In=g;break;case 5:Sr||li(l,s);case 6:if(f=rr,g=In,rr=null,Ui(a,s,l),rr=f,In=g,rr!==null)if(In)try{(rr.nodeType===9?rr.body:rr.nodeName==="HTML"?rr.ownerDocument.body:rr).removeChild(l.stateNode)}catch(x){Bt(l,s,x)}else try{rr.removeChild(l.stateNode)}catch(x){Bt(l,s,x)}break;case 18:rr!==null&&(In?(a=rr,I_(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,l.stateNode),nc(a)):I_(rr,l.stateNode));break;case 4:f=rr,g=In,rr=l.stateNode.containerInfo,In=!0,Ui(a,s,l),rr=f,In=g;break;case 0:case 11:case 14:case 15:Is(2,l,s),Sr||Is(4,l,s),Ui(a,s,l);break;case 1:Sr||(li(l,s),f=l.stateNode,typeof f.componentWillUnmount=="function"&&Dy(l,s,f)),Ui(a,s,l);break;case 21:Ui(a,s,l);break;case 22:Sr=(f=Sr)||l.memoizedState!==null,Ui(a,s,l),Sr=f;break;default:Ui(a,s,l)}}function Vy(a,s){if(s.memoizedState===null&&(a=s.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{nc(a)}catch(l){Bt(s,s.return,l)}}}function Uy(a,s){if(s.memoizedState===null&&(a=s.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{nc(a)}catch(l){Bt(s,s.return,l)}}function uC(a){switch(a.tag){case 31:case 13:case 19:var s=a.stateNode;return s===null&&(s=a.stateNode=new My),s;case 22:return a=a.stateNode,s=a._retryCache,s===null&&(s=a._retryCache=new My),s;default:throw Error(n(435,a.tag))}}function H0(a,s){var l=uC(a);s.forEach(function(f){if(!l.has(f)){l.add(f);var g=yC.bind(null,a,f);f.then(g,g)}})}function Dn(a,s){var l=s.deletions;if(l!==null)for(var f=0;f<l.length;f++){var g=l[f],x=a,w=s,V=w;e:for(;V!==null;){switch(V.tag){case 27:if(Ps(V.type)){rr=V.stateNode,In=!1;break e}break;case 5:rr=V.stateNode,In=!1;break e;case 3:case 4:rr=V.stateNode.containerInfo,In=!0;break e}V=V.return}if(rr===null)throw Error(n(160));By(x,w,g),rr=null,In=!1,x=g.alternate,x!==null&&(x.return=null),g.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)jy(s,a),s=s.sibling}var La=null;function jy(a,s){var l=a.alternate,f=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:Dn(s,a),Nn(a),f&4&&(Is(3,a,a.return),Tu(3,a),Is(5,a,a.return));break;case 1:Dn(s,a),Nn(a),f&512&&(Sr||l===null||li(l,l.return)),f&64&&Vi&&(a=a.updateQueue,a!==null&&(f=a.callbacks,f!==null&&(l=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=l===null?f:l.concat(f))));break;case 26:var g=La;if(Dn(s,a),Nn(a),f&512&&(Sr||l===null||li(l,l.return)),f&4){var x=l!==null?l.memoizedState:null;if(f=a.memoizedState,l===null)if(f===null)if(a.stateNode===null){e:{f=a.type,l=a.memoizedProps,g=g.ownerDocument||g;t:switch(f){case"title":x=g.getElementsByTagName("title")[0],(!x||x[de]||x[H]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=g.createElement(f),g.head.insertBefore(x,g.querySelector("head > title"))),$r(x,f,l),x[H]=a,Ge(x),f=x;break e;case"link":var w=j_("link","href",g).get(f+(l.href||""));if(w){for(var V=0;V<w.length;V++)if(x=w[V],x.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&x.getAttribute("rel")===(l.rel==null?null:l.rel)&&x.getAttribute("title")===(l.title==null?null:l.title)&&x.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){w.splice(V,1);break t}}x=g.createElement(f),$r(x,f,l),g.head.appendChild(x);break;case"meta":if(w=j_("meta","content",g).get(f+(l.content||""))){for(V=0;V<w.length;V++)if(x=w[V],x.getAttribute("content")===(l.content==null?null:""+l.content)&&x.getAttribute("name")===(l.name==null?null:l.name)&&x.getAttribute("property")===(l.property==null?null:l.property)&&x.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&x.getAttribute("charset")===(l.charSet==null?null:l.charSet)){w.splice(V,1);break t}}x=g.createElement(f),$r(x,f,l),g.head.appendChild(x);break;default:throw Error(n(468,f))}x[H]=a,Ge(x),f=x}a.stateNode=f}else z_(g,a.type,a.stateNode);else a.stateNode=U_(g,f,a.memoizedProps);else x!==f?(x===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):x.count--,f===null?z_(g,a.type,a.stateNode):U_(g,f,a.memoizedProps)):f===null&&a.stateNode!==null&&sm(a,a.memoizedProps,l.memoizedProps)}break;case 27:Dn(s,a),Nn(a),f&512&&(Sr||l===null||li(l,l.return)),l!==null&&f&4&&sm(a,a.memoizedProps,l.memoizedProps);break;case 5:if(Dn(s,a),Nn(a),f&512&&(Sr||l===null||li(l,l.return)),a.flags&32){g=a.stateNode;try{kn(g,"")}catch(He){Bt(a,a.return,He)}}f&4&&a.stateNode!=null&&(g=a.memoizedProps,sm(a,g,l!==null?l.memoizedProps:g)),f&1024&&(cm=!0);break;case 6:if(Dn(s,a),Nn(a),f&4){if(a.stateNode===null)throw Error(n(162));f=a.memoizedProps,l=a.stateNode;try{l.nodeValue=f}catch(He){Bt(a,a.return,He)}}break;case 3:if(ih=null,g=La,La=nh(s.containerInfo),Dn(s,a),La=g,Nn(a),f&4&&l!==null&&l.memoizedState.isDehydrated)try{nc(s.containerInfo)}catch(He){Bt(a,a.return,He)}cm&&(cm=!1,zy(a));break;case 4:f=La,La=nh(a.stateNode.containerInfo),Dn(s,a),Nn(a),La=f;break;case 12:Dn(s,a),Nn(a);break;case 31:Dn(s,a),Nn(a),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,H0(a,f)));break;case 13:Dn(s,a),Nn(a),a.child.flags&8192&&a.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(q0=Ot()),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,H0(a,f)));break;case 22:g=a.memoizedState!==null;var re=l!==null&&l.memoizedState!==null,he=Vi,Te=Sr;if(Vi=he||g,Sr=Te||re,Dn(s,a),Sr=Te,Vi=he,Nn(a),f&8192)e:for(s=a.stateNode,s._visibility=g?s._visibility&-2:s._visibility|1,g&&(l===null||re||Vi||Sr||qo(a)),l=null,s=a;;){if(s.tag===5||s.tag===26){if(l===null){re=l=s;try{if(x=re.stateNode,g)w=x.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{V=re.stateNode;var Ae=re.memoizedProps.style,ge=Ae!=null&&Ae.hasOwnProperty("display")?Ae.display:null;V.style.display=ge==null||typeof ge=="boolean"?"":(""+ge).trim()}}catch(He){Bt(re,re.return,He)}}}else if(s.tag===6){if(l===null){re=s;try{re.stateNode.nodeValue=g?"":re.memoizedProps}catch(He){Bt(re,re.return,He)}}}else if(s.tag===18){if(l===null){re=s;try{var ye=re.stateNode;g?D_(ye,!0):D_(re.stateNode,!1)}catch(He){Bt(re,re.return,He)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===a)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;l===s&&(l=null),s=s.return}l===s&&(l=null),s.sibling.return=s.return,s=s.sibling}f&4&&(f=a.updateQueue,f!==null&&(l=f.retryQueue,l!==null&&(f.retryQueue=null,H0(a,l))));break;case 19:Dn(s,a),Nn(a),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,H0(a,f)));break;case 30:break;case 21:break;default:Dn(s,a),Nn(a)}}function Nn(a){var s=a.flags;if(s&2){try{for(var l,f=a.return;f!==null;){if(Oy(f)){l=f;break}f=f.return}if(l==null)throw Error(n(160));switch(l.tag){case 27:var g=l.stateNode,x=om(a);z0(a,x,g);break;case 5:var w=l.stateNode;l.flags&32&&(kn(w,""),l.flags&=-33);var V=om(a);z0(a,V,w);break;case 3:case 4:var re=l.stateNode.containerInfo,he=om(a);lm(a,he,re);break;default:throw Error(n(161))}}catch(Te){Bt(a,a.return,Te)}a.flags&=-3}s&4096&&(a.flags&=-4097)}function zy(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var s=a;zy(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),a=a.sibling}}function ji(a,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)Ly(a,s.alternate,s),s=s.sibling}function qo(a){for(a=a.child;a!==null;){var s=a;switch(s.tag){case 0:case 11:case 14:case 15:Is(4,s,s.return),qo(s);break;case 1:li(s,s.return);var l=s.stateNode;typeof l.componentWillUnmount=="function"&&Dy(s,s.return,l),qo(s);break;case 27:Nu(s.stateNode);case 26:case 5:li(s,s.return),qo(s);break;case 22:s.memoizedState===null&&qo(s);break;case 30:qo(s);break;default:qo(s)}a=a.sibling}}function zi(a,s,l){for(l=l&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var f=s.alternate,g=a,x=s,w=x.flags;switch(x.tag){case 0:case 11:case 15:zi(g,x,l),Tu(4,x);break;case 1:if(zi(g,x,l),f=x,g=f.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(he){Bt(f,f.return,he)}if(f=x,g=f.updateQueue,g!==null){var V=f.stateNode;try{var re=g.shared.hiddenCallbacks;if(re!==null)for(g.shared.hiddenCallbacks=null,g=0;g<re.length;g++)yv(re[g],V)}catch(he){Bt(f,f.return,he)}}l&&w&64&&Iy(x),Su(x,x.return);break;case 27:Fy(x);case 26:case 5:zi(g,x,l),l&&f===null&&w&4&&Ny(x),Su(x,x.return);break;case 12:zi(g,x,l);break;case 31:zi(g,x,l),l&&w&4&&Vy(g,x);break;case 13:zi(g,x,l),l&&w&4&&Uy(g,x);break;case 22:x.memoizedState===null&&zi(g,x,l),Su(x,x.return);break;case 30:break;default:zi(g,x,l)}s=s.sibling}}function um(a,s){var l=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(l=a.memoizedState.cachePool.pool),a=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(a=s.memoizedState.cachePool.pool),a!==l&&(a!=null&&a.refCount++,l!=null&&cu(l))}function fm(a,s){a=null,s.alternate!==null&&(a=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==a&&(s.refCount++,a!=null&&cu(a))}function Pa(a,s,l,f){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Hy(a,s,l,f),s=s.sibling}function Hy(a,s,l,f){var g=s.flags;switch(s.tag){case 0:case 11:case 15:Pa(a,s,l,f),g&2048&&Tu(9,s);break;case 1:Pa(a,s,l,f);break;case 3:Pa(a,s,l,f),g&2048&&(a=null,s.alternate!==null&&(a=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==a&&(s.refCount++,a!=null&&cu(a)));break;case 12:if(g&2048){Pa(a,s,l,f),a=s.stateNode;try{var x=s.memoizedProps,w=x.id,V=x.onPostCommit;typeof V=="function"&&V(w,s.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(re){Bt(s,s.return,re)}}else Pa(a,s,l,f);break;case 31:Pa(a,s,l,f);break;case 13:Pa(a,s,l,f);break;case 23:break;case 22:x=s.stateNode,w=s.alternate,s.memoizedState!==null?x._visibility&2?Pa(a,s,l,f):wu(a,s):x._visibility&2?Pa(a,s,l,f):(x._visibility|=2,Wl(a,s,l,f,(s.subtreeFlags&10256)!==0||!1)),g&2048&&um(w,s);break;case 24:Pa(a,s,l,f),g&2048&&fm(s.alternate,s);break;default:Pa(a,s,l,f)}}function Wl(a,s,l,f,g){for(g=g&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var x=a,w=s,V=l,re=f,he=w.flags;switch(w.tag){case 0:case 11:case 15:Wl(x,w,V,re,g),Tu(8,w);break;case 23:break;case 22:var Te=w.stateNode;w.memoizedState!==null?Te._visibility&2?Wl(x,w,V,re,g):wu(x,w):(Te._visibility|=2,Wl(x,w,V,re,g)),g&&he&2048&&um(w.alternate,w);break;case 24:Wl(x,w,V,re,g),g&&he&2048&&fm(w.alternate,w);break;default:Wl(x,w,V,re,g)}s=s.sibling}}function wu(a,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var l=a,f=s,g=f.flags;switch(f.tag){case 22:wu(l,f),g&2048&&um(f.alternate,f);break;case 24:wu(l,f),g&2048&&fm(f.alternate,f);break;default:wu(l,f)}s=s.sibling}}var Au=8192;function Yl(a,s,l){if(a.subtreeFlags&Au)for(a=a.child;a!==null;)Gy(a,s,l),a=a.sibling}function Gy(a,s,l){switch(a.tag){case 26:Yl(a,s,l),a.flags&Au&&a.memoizedState!==null&&$C(l,La,a.memoizedState,a.memoizedProps);break;case 5:Yl(a,s,l);break;case 3:case 4:var f=La;La=nh(a.stateNode.containerInfo),Yl(a,s,l),La=f;break;case 22:a.memoizedState===null&&(f=a.alternate,f!==null&&f.memoizedState!==null?(f=Au,Au=16777216,Yl(a,s,l),Au=f):Yl(a,s,l));break;default:Yl(a,s,l)}}function qy(a){var s=a.alternate;if(s!==null&&(a=s.child,a!==null)){s.child=null;do s=a.sibling,a.sibling=null,a=s;while(a!==null)}}function bu(a){var s=a.deletions;if((a.flags&16)!==0){if(s!==null)for(var l=0;l<s.length;l++){var f=s[l];Br=f,Yy(f,a)}qy(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Wy(a),a=a.sibling}function Wy(a){switch(a.tag){case 0:case 11:case 15:bu(a),a.flags&2048&&Is(9,a,a.return);break;case 3:bu(a);break;case 12:bu(a);break;case 22:var s=a.stateNode;a.memoizedState!==null&&s._visibility&2&&(a.return===null||a.return.tag!==13)?(s._visibility&=-3,G0(a)):bu(a);break;default:bu(a)}}function G0(a){var s=a.deletions;if((a.flags&16)!==0){if(s!==null)for(var l=0;l<s.length;l++){var f=s[l];Br=f,Yy(f,a)}qy(a)}for(a=a.child;a!==null;){switch(s=a,s.tag){case 0:case 11:case 15:Is(8,s,s.return),G0(s);break;case 22:l=s.stateNode,l._visibility&2&&(l._visibility&=-3,G0(s));break;default:G0(s)}a=a.sibling}}function Yy(a,s){for(;Br!==null;){var l=Br;switch(l.tag){case 0:case 11:case 15:Is(8,l,s);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var f=l.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:cu(l.memoizedState.cache)}if(f=l.child,f!==null)f.return=l,Br=f;else e:for(l=a;Br!==null;){f=Br;var g=f.sibling,x=f.return;if(Py(f),f===l){Br=null;break e}if(g!==null){g.return=x,Br=g;break e}Br=x}}}var fC={getCacheForType:function(a){var s=Xr(_r),l=s.data.get(a);return l===void 0&&(l=a(),s.data.set(a,l)),l},cacheSignal:function(){return Xr(_r).controller.signal}},hC=typeof WeakMap=="function"?WeakMap:Map,kt=0,Wt=null,ut=null,ht=0,Pt=0,Kn=null,Ds=!1,Xl=!1,hm=!1,Hi=0,ur=0,Ns=0,Wo=0,dm=0,$n=0,Kl=0,Cu=null,On=null,pm=!1,q0=0,Xy=0,W0=1/0,Y0=null,Os=null,Ir=0,Fs=null,$l=null,Gi=0,mm=0,gm=null,Ky=null,Ru=0,xm=null;function Qn(){return(kt&2)!==0&&ht!==0?ht&-ht:ne.T!==null?Sm():M()}function $y(){if($n===0)if((ht&536870912)===0||xt){var a=Si;Si<<=1,(Si&3932160)===0&&(Si=262144),$n=a}else $n=536870912;return a=Yn.current,a!==null&&(a.flags|=32),$n}function Fn(a,s,l){(a===Wt&&(Pt===2||Pt===9)||a.cancelPendingCommit!==null)&&(Ql(a,0),Ms(a,ht,$n,!1)),wi(a,l),((kt&2)===0||a!==Wt)&&(a===Wt&&((kt&2)===0&&(Wo|=l),ur===4&&Ms(a,ht,$n,!1)),ci(a))}function Qy(a,s,l){if((kt&6)!==0)throw Error(n(327));var f=!l&&(s&127)===0&&(s&a.expiredLanes)===0||zn(a,s),g=f?mC(a,s):ym(a,s,!0),x=f;do{if(g===0){Xl&&!f&&Ms(a,s,0,!1);break}else{if(l=a.current.alternate,x&&!dC(l)){g=ym(a,s,!1),x=!1;continue}if(g===2){if(x=s,a.errorRecoveryDisabledLanes&x)var w=0;else w=a.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){s=w;e:{var V=a;g=Cu;var re=V.current.memoizedState.isDehydrated;if(re&&(Ql(V,w).flags|=256),w=ym(V,w,!1),w!==2){if(hm&&!re){V.errorRecoveryDisabledLanes|=x,Wo|=x,g=4;break e}x=On,On=g,x!==null&&(On===null?On=x:On.push.apply(On,x))}g=w}if(x=!1,g!==2)continue}}if(g===1){Ql(a,0),Ms(a,s,0,!0);break}e:{switch(f=a,x=g,x){case 0:case 1:throw Error(n(345));case 4:if((s&4194048)!==s)break;case 6:Ms(f,s,$n,!Ds);break e;case 2:On=null;break;case 3:case 5:break;default:throw Error(n(329))}if((s&62914560)===s&&(g=q0+300-Ot(),10<g)){if(Ms(f,s,$n,!Ds),oa(f,0,!0)!==0)break e;Gi=s,f.timeoutHandle=R_(Jy.bind(null,f,l,On,Y0,pm,s,$n,Wo,Kl,Ds,x,"Throttled",-0,0),g);break e}Jy(f,l,On,Y0,pm,s,$n,Wo,Kl,Ds,x,null,-0,0)}}break}while(!0);ci(a)}function Jy(a,s,l,f,g,x,w,V,re,he,Te,Ae,ge,ye){if(a.timeoutHandle=-1,Ae=s.subtreeFlags,Ae&8192||(Ae&16785408)===16785408){Ae={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ia},Gy(s,x,Ae);var He=(x&62914560)===x?q0-Ot():(x&4194048)===x?Xy-Ot():0;if(He=QC(Ae,He),He!==null){Gi=x,a.cancelPendingCommit=He(s_.bind(null,a,s,x,l,f,g,w,V,re,Te,Ae,null,ge,ye)),Ms(a,x,w,!he);return}}s_(a,s,x,l,f,g,w,V,re)}function dC(a){for(var s=a;;){var l=s.tag;if((l===0||l===11||l===15)&&s.flags&16384&&(l=s.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var f=0;f<l.length;f++){var g=l[f],x=g.getSnapshot;g=g.value;try{if(!qn(x(),g))return!1}catch{return!1}}if(l=s.child,s.subtreeFlags&16384&&l!==null)l.return=s,s=l;else{if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Ms(a,s,l,f){s&=~dm,s&=~Wo,a.suspendedLanes|=s,a.pingedLanes&=~s,f&&(a.warmLanes|=s),f=a.expirationTimes;for(var g=s;0<g;){var x=31-ir(g),w=1<<x;f[x]=-1,g&=~w}l!==0&&Ai(a,l,s)}function X0(){return(kt&6)===0?(ku(0),!1):!0}function vm(){if(ut!==null){if(Pt===0)var a=ut.return;else a=ut,Oi=Po=null,Fp(a),jl=null,fu=0,a=ut;for(;a!==null;)ky(a.alternate,a),a=a.return;ut=null}}function Ql(a,s){var l=a.timeoutHandle;l!==-1&&(a.timeoutHandle=-1,OC(l)),l=a.cancelPendingCommit,l!==null&&(a.cancelPendingCommit=null,l()),Gi=0,vm(),Wt=a,ut=l=Di(a.current,null),ht=s,Pt=0,Kn=null,Ds=!1,Xl=zn(a,s),hm=!1,Kl=$n=dm=Wo=Ns=ur=0,On=Cu=null,pm=!1,(s&8)!==0&&(s|=s&32);var f=a.entangledLanes;if(f!==0)for(a=a.entanglements,f&=s;0<f;){var g=31-ir(f),x=1<<g;s|=a[g],f&=~x}return Hi=s,m0(),l}function Zy(a,s){st=null,ne.H=yu,s===Ul||s===S0?(s=mv(),Pt=3):s===Tp?(s=mv(),Pt=4):Pt=s===$p?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Kn=s,ut===null&&(ur=1,P0(a,da(s,a.current)))}function e_(){var a=Yn.current;return a===null?!0:(ht&4194048)===ht?xa===null:(ht&62914560)===ht||(ht&536870912)!==0?a===xa:!1}function t_(){var a=ne.H;return ne.H=yu,a===null?yu:a}function r_(){var a=ne.A;return ne.A=fC,a}function K0(){ur=4,Ds||(ht&4194048)!==ht&&Yn.current!==null||(Xl=!0),(Ns&134217727)===0&&(Wo&134217727)===0||Wt===null||Ms(Wt,ht,$n,!1)}function ym(a,s,l){var f=kt;kt|=2;var g=t_(),x=r_();(Wt!==a||ht!==s)&&(Y0=null,Ql(a,s)),s=!1;var w=ur;e:do try{if(Pt!==0&&ut!==null){var V=ut,re=Kn;switch(Pt){case 8:vm(),w=6;break e;case 3:case 2:case 9:case 6:Yn.current===null&&(s=!0);var he=Pt;if(Pt=0,Kn=null,Jl(a,V,re,he),l&&Xl){w=0;break e}break;default:he=Pt,Pt=0,Kn=null,Jl(a,V,re,he)}}pC(),w=ur;break}catch(Te){Zy(a,Te)}while(!0);return s&&a.shellSuspendCounter++,Oi=Po=null,kt=f,ne.H=g,ne.A=x,ut===null&&(Wt=null,ht=0,m0()),w}function pC(){for(;ut!==null;)n_(ut)}function mC(a,s){var l=kt;kt|=2;var f=t_(),g=r_();Wt!==a||ht!==s?(Y0=null,W0=Ot()+500,Ql(a,s)):Xl=zn(a,s);e:do try{if(Pt!==0&&ut!==null){s=ut;var x=Kn;t:switch(Pt){case 1:Pt=0,Kn=null,Jl(a,s,x,1);break;case 2:case 9:if(dv(x)){Pt=0,Kn=null,a_(s);break}s=function(){Pt!==2&&Pt!==9||Wt!==a||(Pt=7),ci(a)},x.then(s,s);break e;case 3:Pt=7;break e;case 4:Pt=5;break e;case 7:dv(x)?(Pt=0,Kn=null,a_(s)):(Pt=0,Kn=null,Jl(a,s,x,7));break;case 5:var w=null;switch(ut.tag){case 26:w=ut.memoizedState;case 5:case 27:var V=ut;if(w?H_(w):V.stateNode.complete){Pt=0,Kn=null;var re=V.sibling;if(re!==null)ut=re;else{var he=V.return;he!==null?(ut=he,$0(he)):ut=null}break t}}Pt=0,Kn=null,Jl(a,s,x,5);break;case 6:Pt=0,Kn=null,Jl(a,s,x,6);break;case 8:vm(),ur=6;break e;default:throw Error(n(462))}}gC();break}catch(Te){Zy(a,Te)}while(!0);return Oi=Po=null,ne.H=f,ne.A=g,kt=l,ut!==null?0:(Wt=null,ht=0,m0(),ur)}function gC(){for(;ut!==null&&!Ei();)n_(ut)}function n_(a){var s=Cy(a.alternate,a,Hi);a.memoizedProps=a.pendingProps,s===null?$0(a):ut=s}function a_(a){var s=a,l=s.alternate;switch(s.tag){case 15:case 0:s=Ey(l,s,s.pendingProps,s.type,void 0,ht);break;case 11:s=Ey(l,s,s.pendingProps,s.type.render,s.ref,ht);break;case 5:Fp(s);default:ky(l,s),s=ut=rv(s,Hi),s=Cy(l,s,Hi)}a.memoizedProps=a.pendingProps,s===null?$0(a):ut=s}function Jl(a,s,l,f){Oi=Po=null,Fp(s),jl=null,fu=0;var g=s.return;try{if(aC(a,g,s,l,ht)){ur=1,P0(a,da(l,a.current)),ut=null;return}}catch(x){if(g!==null)throw ut=g,x;ur=1,P0(a,da(l,a.current)),ut=null;return}s.flags&32768?(xt||f===1?a=!0:Xl||(ht&536870912)!==0?a=!1:(Ds=a=!0,(f===2||f===9||f===3||f===6)&&(f=Yn.current,f!==null&&f.tag===13&&(f.flags|=16384))),i_(s,a)):$0(s)}function $0(a){var s=a;do{if((s.flags&32768)!==0){i_(s,Ds);return}a=s.return;var l=oC(s.alternate,s,Hi);if(l!==null){ut=l;return}if(s=s.sibling,s!==null){ut=s;return}ut=s=a}while(s!==null);ur===0&&(ur=5)}function i_(a,s){do{var l=lC(a.alternate,a);if(l!==null){l.flags&=32767,ut=l;return}if(l=a.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!s&&(a=a.sibling,a!==null)){ut=a;return}ut=a=l}while(a!==null);ur=6,ut=null}function s_(a,s,l,f,g,x,w,V,re){a.cancelPendingCommit=null;do Q0();while(Ir!==0);if((kt&6)!==0)throw Error(n(327));if(s!==null){if(s===a.current)throw Error(n(177));if(x=s.lanes|s.childLanes,x|=op,Wc(a,l,x,w,V,re),a===Wt&&(ut=Wt=null,ht=0),$l=s,Fs=a,Gi=l,mm=x,gm=g,Ky=f,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,_C(er,function(){return f_(),null})):(a.callbackNode=null,a.callbackPriority=0),f=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||f){f=ne.T,ne.T=null,g=me.p,me.p=2,w=kt,kt|=4;try{cC(a,s,l)}finally{kt=w,me.p=g,ne.T=f}}Ir=1,o_(),l_(),c_()}}function o_(){if(Ir===1){Ir=0;var a=Fs,s=$l,l=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||l){l=ne.T,ne.T=null;var f=me.p;me.p=2;var g=kt;kt|=4;try{jy(s,a);var x=Dm,w=Yx(a.containerInfo),V=x.focusedElem,re=x.selectionRange;if(w!==V&&V&&V.ownerDocument&&Wx(V.ownerDocument.documentElement,V)){if(re!==null&&rp(V)){var he=re.start,Te=re.end;if(Te===void 0&&(Te=he),"selectionStart"in V)V.selectionStart=he,V.selectionEnd=Math.min(Te,V.value.length);else{var Ae=V.ownerDocument||document,ge=Ae&&Ae.defaultView||window;if(ge.getSelection){var ye=ge.getSelection(),He=V.textContent.length,Xe=Math.min(re.start,He),Ht=re.end===void 0?Xe:Math.min(re.end,He);!ye.extend&&Xe>Ht&&(w=Ht,Ht=Xe,Xe=w);var oe=qx(V,Xe),ie=qx(V,Ht);if(oe&&ie&&(ye.rangeCount!==1||ye.anchorNode!==oe.node||ye.anchorOffset!==oe.offset||ye.focusNode!==ie.node||ye.focusOffset!==ie.offset)){var ce=Ae.createRange();ce.setStart(oe.node,oe.offset),ye.removeAllRanges(),Xe>Ht?(ye.addRange(ce),ye.extend(ie.node,ie.offset)):(ce.setEnd(ie.node,ie.offset),ye.addRange(ce))}}}}for(Ae=[],ye=V;ye=ye.parentNode;)ye.nodeType===1&&Ae.push({element:ye,left:ye.scrollLeft,top:ye.scrollTop});for(typeof V.focus=="function"&&V.focus(),V=0;V<Ae.length;V++){var Se=Ae[V];Se.element.scrollLeft=Se.left,Se.element.scrollTop=Se.top}}ch=!!Im,Dm=Im=null}finally{kt=g,me.p=f,ne.T=l}}a.current=s,Ir=2}}function l_(){if(Ir===2){Ir=0;var a=Fs,s=$l,l=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||l){l=ne.T,ne.T=null;var f=me.p;me.p=2;var g=kt;kt|=4;try{Ly(a,s.alternate,s)}finally{kt=g,me.p=f,ne.T=l}}Ir=3}}function c_(){if(Ir===4||Ir===3){Ir=0,Un();var a=Fs,s=$l,l=Gi,f=Ky;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?Ir=5:(Ir=0,$l=Fs=null,u_(a,a.pendingLanes));var g=a.pendingLanes;if(g===0&&(Os=null),Ca(l),s=s.stateNode,Qt&&typeof Qt.onCommitFiberRoot=="function")try{Qt.onCommitFiberRoot(Ct,s,void 0,(s.current.flags&128)===128)}catch{}if(f!==null){s=ne.T,g=me.p,me.p=2,ne.T=null;try{for(var x=a.onRecoverableError,w=0;w<f.length;w++){var V=f[w];x(V.value,{componentStack:V.stack})}}finally{ne.T=s,me.p=g}}(Gi&3)!==0&&Q0(),ci(a),g=a.pendingLanes,(l&261930)!==0&&(g&42)!==0?a===xm?Ru++:(Ru=0,xm=a):Ru=0,ku(0)}}function u_(a,s){(a.pooledCacheLanes&=s)===0&&(s=a.pooledCache,s!=null&&(a.pooledCache=null,cu(s)))}function Q0(){return o_(),l_(),c_(),f_()}function f_(){if(Ir!==5)return!1;var a=Fs,s=mm;mm=0;var l=Ca(Gi),f=ne.T,g=me.p;try{me.p=32>l?32:l,ne.T=null,l=gm,gm=null;var x=Fs,w=Gi;if(Ir=0,$l=Fs=null,Gi=0,(kt&6)!==0)throw Error(n(331));var V=kt;if(kt|=4,Wy(x.current),Hy(x,x.current,w,l),kt=V,ku(0,!1),Qt&&typeof Qt.onPostCommitFiberRoot=="function")try{Qt.onPostCommitFiberRoot(Ct,x)}catch{}return!0}finally{me.p=g,ne.T=f,u_(a,s)}}function h_(a,s,l){s=da(l,s),s=Kp(a.stateNode,s,2),a=Cs(a,s,2),a!==null&&(wi(a,2),ci(a))}function Bt(a,s,l){if(a.tag===3)h_(a,a,l);else for(;s!==null;){if(s.tag===3){h_(s,a,l);break}else if(s.tag===1){var f=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Os===null||!Os.has(f))){a=da(l,a),l=dy(2),f=Cs(s,l,2),f!==null&&(py(l,f,s,a),wi(f,2),ci(f));break}}s=s.return}}function _m(a,s,l){var f=a.pingCache;if(f===null){f=a.pingCache=new hC;var g=new Set;f.set(s,g)}else g=f.get(s),g===void 0&&(g=new Set,f.set(s,g));g.has(l)||(hm=!0,g.add(l),a=xC.bind(null,a,s,l),s.then(a,a))}function xC(a,s,l){var f=a.pingCache;f!==null&&f.delete(s),a.pingedLanes|=a.suspendedLanes&l,a.warmLanes&=~l,Wt===a&&(ht&l)===l&&(ur===4||ur===3&&(ht&62914560)===ht&&300>Ot()-q0?(kt&2)===0&&Ql(a,0):dm|=l,Kl===ht&&(Kl=0)),ci(a)}function d_(a,s){s===0&&(s=_l()),a=Fo(a,s),a!==null&&(wi(a,s),ci(a))}function vC(a){var s=a.memoizedState,l=0;s!==null&&(l=s.retryLane),d_(a,l)}function yC(a,s){var l=0;switch(a.tag){case 31:case 13:var f=a.stateNode,g=a.memoizedState;g!==null&&(l=g.retryLane);break;case 19:f=a.stateNode;break;case 22:f=a.stateNode._retryCache;break;default:throw Error(n(314))}f!==null&&f.delete(s),d_(a,l)}function _C(a,s){return Dt(a,s)}var J0=null,Zl=null,Em=!1,Z0=!1,Tm=!1,Ls=0;function ci(a){a!==Zl&&a.next===null&&(Zl===null?J0=Zl=a:Zl=Zl.next=a),Z0=!0,Em||(Em=!0,TC())}function ku(a,s){if(!Tm&&Z0){Tm=!0;do for(var l=!1,f=J0;f!==null;){if(a!==0){var g=f.pendingLanes;if(g===0)var x=0;else{var w=f.suspendedLanes,V=f.pingedLanes;x=(1<<31-ir(42|a)+1)-1,x&=g&~(w&~V),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(l=!0,x_(f,x))}else x=ht,x=oa(f,f===Wt?x:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(x&3)===0||zn(f,x)||(l=!0,x_(f,x));f=f.next}while(l);Tm=!1}}function EC(){p_()}function p_(){Z0=Em=!1;var a=0;Ls!==0&&NC()&&(a=Ls);for(var s=Ot(),l=null,f=J0;f!==null;){var g=f.next,x=m_(f,s);x===0?(f.next=null,l===null?J0=g:l.next=g,g===null&&(Zl=l)):(l=f,(a!==0||(x&3)!==0)&&(Z0=!0)),f=g}Ir!==0&&Ir!==5||ku(a),Ls!==0&&(Ls=0)}function m_(a,s){for(var l=a.suspendedLanes,f=a.pingedLanes,g=a.expirationTimes,x=a.pendingLanes&-62914561;0<x;){var w=31-ir(x),V=1<<w,re=g[w];re===-1?((V&l)===0||(V&f)!==0)&&(g[w]=qc(V,s)):re<=s&&(a.expiredLanes|=V),x&=~V}if(s=Wt,l=ht,l=oa(a,a===s?l:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),f=a.callbackNode,l===0||a===s&&(Pt===2||Pt===9)||a.cancelPendingCommit!==null)return f!==null&&f!==null&&Lr(f),a.callbackNode=null,a.callbackPriority=0;if((l&3)===0||zn(a,l)){if(s=l&-l,s===a.callbackPriority)return s;switch(f!==null&&Lr(f),Ca(l)){case 2:case 8:l=ba;break;case 32:l=er;break;case 268435456:l=at;break;default:l=er}return f=g_.bind(null,a),l=Dt(l,f),a.callbackPriority=s,a.callbackNode=l,s}return f!==null&&f!==null&&Lr(f),a.callbackPriority=2,a.callbackNode=null,2}function g_(a,s){if(Ir!==0&&Ir!==5)return a.callbackNode=null,a.callbackPriority=0,null;var l=a.callbackNode;if(Q0()&&a.callbackNode!==l)return null;var f=ht;return f=oa(a,a===Wt?f:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),f===0?null:(Qy(a,f,s),m_(a,Ot()),a.callbackNode!=null&&a.callbackNode===l?g_.bind(null,a):null)}function x_(a,s){if(Q0())return null;Qy(a,s,!0)}function TC(){FC(function(){(kt&6)!==0?Dt(bn,EC):p_()})}function Sm(){if(Ls===0){var a=Bl;a===0&&(a=jn,jn<<=1,(jn&261888)===0&&(jn=256)),Ls=a}return Ls}function v_(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:Sl(""+a)}function y_(a,s){var l=s.ownerDocument.createElement("input");return l.name=s.name,l.value=s.value,a.id&&l.setAttribute("form",a.id),s.parentNode.insertBefore(l,s),a=new FormData(a),l.parentNode.removeChild(l),a}function SC(a,s,l,f,g){if(s==="submit"&&l&&l.stateNode===g){var x=v_((g[q]||null).action),w=f.submitter;w&&(s=(s=w[q]||null)?v_(s.formAction):w.getAttribute("formAction"),s!==null&&(x=s,w=null));var V=new ri("action","action",null,f,g);a.push({event:V,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Ls!==0){var re=w?y_(g,w):new FormData(g);Hp(l,{pending:!0,data:re,method:g.method,action:x},null,re)}}else typeof x=="function"&&(V.preventDefault(),re=w?y_(g,w):new FormData(g),Hp(l,{pending:!0,data:re,method:g.method,action:x},x,re))},currentTarget:g}]})}}for(var wm=0;wm<sp.length;wm++){var Am=sp[wm],wC=Am.toLowerCase(),AC=Am[0].toUpperCase()+Am.slice(1);Ma(wC,"on"+AC)}Ma($x,"onAnimationEnd"),Ma(Qx,"onAnimationIteration"),Ma(Jx,"onAnimationStart"),Ma("dblclick","onDoubleClick"),Ma("focusin","onFocus"),Ma("focusout","onBlur"),Ma(jb,"onTransitionRun"),Ma(zb,"onTransitionStart"),Ma(Hb,"onTransitionCancel"),Ma(Zx,"onTransitionEnd"),rn("onMouseEnter",["mouseout","mouseover"]),rn("onMouseLeave",["mouseout","mouseover"]),rn("onPointerEnter",["pointerout","pointerover"]),rn("onPointerLeave",["pointerout","pointerover"]),qt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),qt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),qt("onBeforeInput",["compositionend","keypress","textInput","paste"]),qt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),qt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),qt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Iu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Iu));function __(a,s){s=(s&4)!==0;for(var l=0;l<a.length;l++){var f=a[l],g=f.event;f=f.listeners;e:{var x=void 0;if(s)for(var w=f.length-1;0<=w;w--){var V=f[w],re=V.instance,he=V.currentTarget;if(V=V.listener,re!==x&&g.isPropagationStopped())break e;x=V,g.currentTarget=he;try{x(g)}catch(Te){p0(Te)}g.currentTarget=null,x=re}else for(w=0;w<f.length;w++){if(V=f[w],re=V.instance,he=V.currentTarget,V=V.listener,re!==x&&g.isPropagationStopped())break e;x=V,g.currentTarget=he;try{x(g)}catch(Te){p0(Te)}g.currentTarget=null,x=re}}}}function ft(a,s){var l=s[ue];l===void 0&&(l=s[ue]=new Set);var f=a+"__bubble";l.has(f)||(E_(s,a,2,!1),l.add(f))}function bm(a,s,l){var f=0;s&&(f|=4),E_(l,a,f,s)}var eh="_reactListening"+Math.random().toString(36).slice(2);function Cm(a){if(!a[eh]){a[eh]=!0,Ft.forEach(function(l){l!=="selectionchange"&&(bC.has(l)||bm(l,!1,a),bm(l,!0,a))});var s=a.nodeType===9?a:a.ownerDocument;s===null||s[eh]||(s[eh]=!0,bm("selectionchange",!1,s))}}function E_(a,s,l,f){switch($_(s)){case 2:var g=eR;break;case 8:g=tR;break;default:g=zm}l=g.bind(null,s,l,a),g=void 0,!bo||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(g=!0),f?g!==void 0?a.addEventListener(s,l,{capture:!0,passive:g}):a.addEventListener(s,l,!0):g!==void 0?a.addEventListener(s,l,{passive:g}):a.addEventListener(s,l,!1)}function Rm(a,s,l,f,g){var x=f;if((s&1)===0&&(s&2)===0&&f!==null)e:for(;;){if(f===null)return;var w=f.tag;if(w===3||w===4){var V=f.stateNode.containerInfo;if(V===g)break;if(w===4)for(w=f.return;w!==null;){var re=w.tag;if((re===3||re===4)&&w.stateNode.containerInfo===g)return;w=w.return}for(;V!==null;){if(w=Fe(V),w===null)return;if(re=w.tag,re===5||re===6||re===26||re===27){f=x=w;continue e}V=V.parentNode}}f=f.return}xs(function(){var he=x,Te=ca(l),Ae=[];e:{var ge=ev.get(a);if(ge!==void 0){var ye=ri,He=a;switch(a){case"keypress":if(Ro(l)===0)break e;case"keydown":case"keyup":ye=f0;break;case"focusin":He="focus",ye=Io;break;case"focusout":He="blur",ye=Io;break;case"beforeblur":case"afterblur":ye=Io;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ye=tu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ye=r0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ye=_;break;case $x:case Qx:case Jx:ye=a0;break;case Zx:ye=z;break;case"scroll":case"scrollend":ye=eu;break;case"wheel":ye=ve;break;case"copy":case"cut":case"paste":ye=i0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ye=Ii;break;case"toggle":case"beforetoggle":ye=it}var Xe=(s&4)!==0,Ht=!Xe&&(a==="scroll"||a==="scrollend"),oe=Xe?ge!==null?ge+"Capture":null:ge;Xe=[];for(var ie=he,ce;ie!==null;){var Se=ie;if(ce=Se.stateNode,Se=Se.tag,Se!==5&&Se!==26&&Se!==27||ce===null||oe===null||(Se=Da(ie,oe),Se!=null&&Xe.push(Du(ie,Se,ce))),Ht)break;ie=ie.return}0<Xe.length&&(ge=new ye(ge,He,null,l,Te),Ae.push({event:ge,listeners:Xe}))}}if((s&7)===0){e:{if(ge=a==="mouseover"||a==="pointerover",ye=a==="mouseout"||a==="pointerout",ge&&l!==Qc&&(He=l.relatedTarget||l.fromElement)&&(Fe(He)||He[X]))break e;if((ye||ge)&&(ge=Te.window===Te?Te:(ge=Te.ownerDocument)?ge.defaultView||ge.parentWindow:window,ye?(He=l.relatedTarget||l.toElement,ye=he,He=He?Fe(He):null,He!==null&&(Ht=o(He),Xe=He.tag,He!==Ht||Xe!==5&&Xe!==27&&Xe!==6)&&(He=null)):(ye=null,He=he),ye!==He)){if(Xe=tu,Se="onMouseLeave",oe="onMouseEnter",ie="mouse",(a==="pointerout"||a==="pointerover")&&(Xe=Ii,Se="onPointerLeave",oe="onPointerEnter",ie="pointer"),Ht=ye==null?ge:De(ye),ce=He==null?ge:De(He),ge=new Xe(Se,ie+"leave",ye,l,Te),ge.target=Ht,ge.relatedTarget=ce,Se=null,Fe(Te)===he&&(Xe=new Xe(oe,ie+"enter",He,l,Te),Xe.target=ce,Xe.relatedTarget=Ht,Se=Xe),Ht=Se,ye&&He)t:{for(Xe=CC,oe=ye,ie=He,ce=0,Se=oe;Se;Se=Xe(Se))ce++;Se=0;for(var Ye=ie;Ye;Ye=Xe(Ye))Se++;for(;0<ce-Se;)oe=Xe(oe),ce--;for(;0<Se-ce;)ie=Xe(ie),Se--;for(;ce--;){if(oe===ie||ie!==null&&oe===ie.alternate){Xe=oe;break t}oe=Xe(oe),ie=Xe(ie)}Xe=null}else Xe=null;ye!==null&&T_(Ae,ge,ye,Xe,!1),He!==null&&Ht!==null&&T_(Ae,Ht,He,Xe,!0)}}e:{if(ge=he?De(he):window,ye=ge.nodeName&&ge.nodeName.toLowerCase(),ye==="select"||ye==="input"&&ge.type==="file")var At=Vx;else if(Px(ge))if(Ux)At=Bb;else{At=Lb;var qe=Mb}else ye=ge.nodeName,!ye||ye.toLowerCase()!=="input"||ge.type!=="checkbox"&&ge.type!=="radio"?he&&Tl(he.elementType)&&(At=Vx):At=Pb;if(At&&(At=At(a,he))){Bx(Ae,At,l,Te);break e}qe&&qe(a,ge,he),a==="focusout"&&he&&ge.type==="number"&&he.memoizedProps.value!=null&&Xc(ge,"number",ge.value)}switch(qe=he?De(he):window,a){case"focusin":(Px(qe)||qe.contentEditable==="true")&&(Il=qe,np=he,su=null);break;case"focusout":su=np=Il=null;break;case"mousedown":ap=!0;break;case"contextmenu":case"mouseup":case"dragend":ap=!1,Xx(Ae,l,Te);break;case"selectionchange":if(Ub)break;case"keydown":case"keyup":Xx(Ae,l,Te)}var lt;if(Rt)e:{switch(a){case"compositionstart":var dt="onCompositionStart";break e;case"compositionend":dt="onCompositionEnd";break e;case"compositionupdate":dt="onCompositionUpdate";break e}dt=void 0}else kl?Do(a,l)&&(dt="onCompositionEnd"):a==="keydown"&&l.keyCode===229&&(dt="onCompositionStart");dt&&(ii&&l.locale!=="ko"&&(kl||dt!=="onCompositionStart"?dt==="onCompositionEnd"&&kl&&(lt=Zc()):(ti=Te,Jc="value"in ti?ti.value:ti.textContent,kl=!0)),qe=th(he,dt),0<qe.length&&(dt=new ai(dt,a,null,l,Te),Ae.push({event:dt,listeners:qe}),lt?dt.data=lt:(lt=Rl(l),lt!==null&&(dt.data=lt)))),(lt=fa?Db(a,l):Nb(a,l))&&(dt=th(he,"onBeforeInput"),0<dt.length&&(qe=new ai("onBeforeInput","beforeinput",null,l,Te),Ae.push({event:qe,listeners:dt}),qe.data=lt)),SC(Ae,a,he,l,Te)}__(Ae,s)})}function Du(a,s,l){return{instance:a,listener:s,currentTarget:l}}function th(a,s){for(var l=s+"Capture",f=[];a!==null;){var g=a,x=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||x===null||(g=Da(a,l),g!=null&&f.unshift(Du(a,g,x)),g=Da(a,s),g!=null&&f.push(Du(a,g,x))),a.tag===3)return f;a=a.return}return[]}function CC(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function T_(a,s,l,f,g){for(var x=s._reactName,w=[];l!==null&&l!==f;){var V=l,re=V.alternate,he=V.stateNode;if(V=V.tag,re!==null&&re===f)break;V!==5&&V!==26&&V!==27||he===null||(re=he,g?(he=Da(l,x),he!=null&&w.unshift(Du(l,he,re))):g||(he=Da(l,x),he!=null&&w.push(Du(l,he,re)))),l=l.return}w.length!==0&&a.push({event:s,listeners:w})}var RC=/\r\n?/g,kC=/\u0000|\uFFFD/g;function S_(a){return(typeof a=="string"?a:""+a).replace(RC,`
`).replace(kC,"")}function w_(a,s){return s=S_(s),S_(a)===s}function zt(a,s,l,f,g,x){switch(l){case"children":typeof f=="string"?s==="body"||s==="textarea"&&f===""||kn(a,f):(typeof f=="number"||typeof f=="bigint")&&s!=="body"&&kn(a,""+f);break;case"className":Gn(a,"class",f);break;case"tabIndex":Gn(a,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":Gn(a,l,f);break;case"style":$c(a,f,x);break;case"data":if(s!=="object"){Gn(a,"data",f);break}case"src":case"href":if(f===""&&(s!=="a"||l!=="href")){a.removeAttribute(l);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){a.removeAttribute(l);break}f=Sl(""+f),a.setAttribute(l,f);break;case"action":case"formAction":if(typeof f=="function"){a.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(l==="formAction"?(s!=="input"&&zt(a,s,"name",g.name,g,null),zt(a,s,"formEncType",g.formEncType,g,null),zt(a,s,"formMethod",g.formMethod,g,null),zt(a,s,"formTarget",g.formTarget,g,null)):(zt(a,s,"encType",g.encType,g,null),zt(a,s,"method",g.method,g,null),zt(a,s,"target",g.target,g,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){a.removeAttribute(l);break}f=Sl(""+f),a.setAttribute(l,f);break;case"onClick":f!=null&&(a.onclick=Ia);break;case"onScroll":f!=null&&ft("scroll",a);break;case"onScrollEnd":f!=null&&ft("scrollend",a);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(l=f.__html,l!=null){if(g.children!=null)throw Error(n(60));a.innerHTML=l}}break;case"multiple":a.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":a.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){a.removeAttribute("xlink:href");break}l=Sl(""+f),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(l,""+f):a.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(l,""):a.removeAttribute(l);break;case"capture":case"download":f===!0?a.setAttribute(l,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(l,f):a.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?a.setAttribute(l,f):a.removeAttribute(l);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?a.removeAttribute(l):a.setAttribute(l,f);break;case"popover":ft("beforetoggle",a),ft("toggle",a),nn(a,"popover",f);break;case"xlinkActuate":yr(a,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":yr(a,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":yr(a,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":yr(a,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":yr(a,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":yr(a,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":yr(a,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":yr(a,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":yr(a,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":nn(a,"is",f);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=t0.get(l)||l,nn(a,l,f))}}function km(a,s,l,f,g,x){switch(l){case"style":$c(a,f,x);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(l=f.__html,l!=null){if(g.children!=null)throw Error(n(60));a.innerHTML=l}}break;case"children":typeof f=="string"?kn(a,f):(typeof f=="number"||typeof f=="bigint")&&kn(a,""+f);break;case"onScroll":f!=null&&ft("scroll",a);break;case"onScrollEnd":f!=null&&ft("scrollend",a);break;case"onClick":f!=null&&(a.onclick=Ia);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Mt.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(g=l.endsWith("Capture"),s=l.slice(2,g?l.length-7:void 0),x=a[q]||null,x=x!=null?x[l]:null,typeof x=="function"&&a.removeEventListener(s,x,g),typeof f=="function")){typeof x!="function"&&x!==null&&(l in a?a[l]=null:a.hasAttribute(l)&&a.removeAttribute(l)),a.addEventListener(s,f,g);break e}l in a?a[l]=f:f===!0?a.setAttribute(l,""):nn(a,l,f)}}}function $r(a,s,l){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ft("error",a),ft("load",a);var f=!1,g=!1,x;for(x in l)if(l.hasOwnProperty(x)){var w=l[x];if(w!=null)switch(x){case"src":f=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:zt(a,s,x,w,l,null)}}g&&zt(a,s,"srcSet",l.srcSet,l,null),f&&zt(a,s,"src",l.src,l,null);return;case"input":ft("invalid",a);var V=x=w=g=null,re=null,he=null;for(f in l)if(l.hasOwnProperty(f)){var Te=l[f];if(Te!=null)switch(f){case"name":g=Te;break;case"type":w=Te;break;case"checked":re=Te;break;case"defaultChecked":he=Te;break;case"value":x=Te;break;case"defaultValue":V=Te;break;case"children":case"dangerouslySetInnerHTML":if(Te!=null)throw Error(n(137,s));break;default:zt(a,s,f,Te,l,null)}}Jf(a,x,V,re,he,w,g,!1);return;case"select":ft("invalid",a),f=w=x=null;for(g in l)if(l.hasOwnProperty(g)&&(V=l[g],V!=null))switch(g){case"value":x=V;break;case"defaultValue":w=V;break;case"multiple":f=V;default:zt(a,s,g,V,l,null)}s=x,l=w,a.multiple=!!f,s!=null?ds(a,!!f,s,!1):l!=null&&ds(a,!!f,l,!0);return;case"textarea":ft("invalid",a),x=g=f=null;for(w in l)if(l.hasOwnProperty(w)&&(V=l[w],V!=null))switch(w){case"value":f=V;break;case"defaultValue":g=V;break;case"children":x=V;break;case"dangerouslySetInnerHTML":if(V!=null)throw Error(n(91));break;default:zt(a,s,w,V,l,null)}ps(a,f,g,x);return;case"option":for(re in l)l.hasOwnProperty(re)&&(f=l[re],f!=null)&&(re==="selected"?a.selected=f&&typeof f!="function"&&typeof f!="symbol":zt(a,s,re,f,l,null));return;case"dialog":ft("beforetoggle",a),ft("toggle",a),ft("cancel",a),ft("close",a);break;case"iframe":case"object":ft("load",a);break;case"video":case"audio":for(f=0;f<Iu.length;f++)ft(Iu[f],a);break;case"image":ft("error",a),ft("load",a);break;case"details":ft("toggle",a);break;case"embed":case"source":case"link":ft("error",a),ft("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(he in l)if(l.hasOwnProperty(he)&&(f=l[he],f!=null))switch(he){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:zt(a,s,he,f,l,null)}return;default:if(Tl(s)){for(Te in l)l.hasOwnProperty(Te)&&(f=l[Te],f!==void 0&&km(a,s,Te,f,l,void 0));return}}for(V in l)l.hasOwnProperty(V)&&(f=l[V],f!=null&&zt(a,s,V,f,l,null))}function IC(a,s,l,f){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,x=null,w=null,V=null,re=null,he=null,Te=null;for(ye in l){var Ae=l[ye];if(l.hasOwnProperty(ye)&&Ae!=null)switch(ye){case"checked":break;case"value":break;case"defaultValue":re=Ae;default:f.hasOwnProperty(ye)||zt(a,s,ye,null,f,Ae)}}for(var ge in f){var ye=f[ge];if(Ae=l[ge],f.hasOwnProperty(ge)&&(ye!=null||Ae!=null))switch(ge){case"type":x=ye;break;case"name":g=ye;break;case"checked":he=ye;break;case"defaultChecked":Te=ye;break;case"value":w=ye;break;case"defaultValue":V=ye;break;case"children":case"dangerouslySetInnerHTML":if(ye!=null)throw Error(n(137,s));break;default:ye!==Ae&&zt(a,s,ge,ye,f,Ae)}}El(a,w,V,re,he,Te,x,g);return;case"select":ye=w=V=ge=null;for(x in l)if(re=l[x],l.hasOwnProperty(x)&&re!=null)switch(x){case"value":break;case"multiple":ye=re;default:f.hasOwnProperty(x)||zt(a,s,x,null,f,re)}for(g in f)if(x=f[g],re=l[g],f.hasOwnProperty(g)&&(x!=null||re!=null))switch(g){case"value":ge=x;break;case"defaultValue":V=x;break;case"multiple":w=x;default:x!==re&&zt(a,s,g,x,f,re)}s=V,l=w,f=ye,ge!=null?ds(a,!!l,ge,!1):!!f!=!!l&&(s!=null?ds(a,!!l,s,!0):ds(a,!!l,l?[]:"",!1));return;case"textarea":ye=ge=null;for(V in l)if(g=l[V],l.hasOwnProperty(V)&&g!=null&&!f.hasOwnProperty(V))switch(V){case"value":break;case"children":break;default:zt(a,s,V,null,f,g)}for(w in f)if(g=f[w],x=l[w],f.hasOwnProperty(w)&&(g!=null||x!=null))switch(w){case"value":ge=g;break;case"defaultValue":ye=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(n(91));break;default:g!==x&&zt(a,s,w,g,f,x)}Zf(a,ge,ye);return;case"option":for(var He in l)ge=l[He],l.hasOwnProperty(He)&&ge!=null&&!f.hasOwnProperty(He)&&(He==="selected"?a.selected=!1:zt(a,s,He,null,f,ge));for(re in f)ge=f[re],ye=l[re],f.hasOwnProperty(re)&&ge!==ye&&(ge!=null||ye!=null)&&(re==="selected"?a.selected=ge&&typeof ge!="function"&&typeof ge!="symbol":zt(a,s,re,ge,f,ye));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Xe in l)ge=l[Xe],l.hasOwnProperty(Xe)&&ge!=null&&!f.hasOwnProperty(Xe)&&zt(a,s,Xe,null,f,ge);for(he in f)if(ge=f[he],ye=l[he],f.hasOwnProperty(he)&&ge!==ye&&(ge!=null||ye!=null))switch(he){case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(n(137,s));break;default:zt(a,s,he,ge,f,ye)}return;default:if(Tl(s)){for(var Ht in l)ge=l[Ht],l.hasOwnProperty(Ht)&&ge!==void 0&&!f.hasOwnProperty(Ht)&&km(a,s,Ht,void 0,f,ge);for(Te in f)ge=f[Te],ye=l[Te],!f.hasOwnProperty(Te)||ge===ye||ge===void 0&&ye===void 0||km(a,s,Te,ge,f,ye);return}}for(var oe in l)ge=l[oe],l.hasOwnProperty(oe)&&ge!=null&&!f.hasOwnProperty(oe)&&zt(a,s,oe,null,f,ge);for(Ae in f)ge=f[Ae],ye=l[Ae],!f.hasOwnProperty(Ae)||ge===ye||ge==null&&ye==null||zt(a,s,Ae,ge,f,ye)}function A_(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function DC(){if(typeof performance.getEntriesByType=="function"){for(var a=0,s=0,l=performance.getEntriesByType("resource"),f=0;f<l.length;f++){var g=l[f],x=g.transferSize,w=g.initiatorType,V=g.duration;if(x&&V&&A_(w)){for(w=0,V=g.responseEnd,f+=1;f<l.length;f++){var re=l[f],he=re.startTime;if(he>V)break;var Te=re.transferSize,Ae=re.initiatorType;Te&&A_(Ae)&&(re=re.responseEnd,w+=Te*(re<V?1:(V-he)/(re-he)))}if(--f,s+=8*(x+w)/(g.duration/1e3),a++,10<a)break}}if(0<a)return s/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var Im=null,Dm=null;function rh(a){return a.nodeType===9?a:a.ownerDocument}function b_(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function C_(a,s){if(a===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&s==="foreignObject"?0:a}function Nm(a,s){return a==="textarea"||a==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Om=null;function NC(){var a=window.event;return a&&a.type==="popstate"?a===Om?!1:(Om=a,!0):(Om=null,!1)}var R_=typeof setTimeout=="function"?setTimeout:void 0,OC=typeof clearTimeout=="function"?clearTimeout:void 0,k_=typeof Promise=="function"?Promise:void 0,FC=typeof queueMicrotask=="function"?queueMicrotask:typeof k_<"u"?function(a){return k_.resolve(null).then(a).catch(MC)}:R_;function MC(a){setTimeout(function(){throw a})}function Ps(a){return a==="head"}function I_(a,s){var l=s,f=0;do{var g=l.nextSibling;if(a.removeChild(l),g&&g.nodeType===8)if(l=g.data,l==="/$"||l==="/&"){if(f===0){a.removeChild(g),nc(s);return}f--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")f++;else if(l==="html")Nu(a.ownerDocument.documentElement);else if(l==="head"){l=a.ownerDocument.head,Nu(l);for(var x=l.firstChild;x;){var w=x.nextSibling,V=x.nodeName;x[de]||V==="SCRIPT"||V==="STYLE"||V==="LINK"&&x.rel.toLowerCase()==="stylesheet"||l.removeChild(x),x=w}}else l==="body"&&Nu(a.ownerDocument.body);l=g}while(l);nc(s)}function D_(a,s){var l=a;a=0;do{var f=l.nextSibling;if(l.nodeType===1?s?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(s?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),f&&f.nodeType===8)if(l=f.data,l==="/$"){if(a===0)break;a--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||a++;l=f}while(l)}function Fm(a){var s=a.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var l=s;switch(s=s.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Fm(l),Ne(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}a.removeChild(l)}}function LC(a,s,l,f){for(;a.nodeType===1;){var g=l;if(a.nodeName.toLowerCase()!==s.toLowerCase()){if(!f&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(f){if(!a[de])switch(s){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(x=a.getAttribute("rel"),x==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(x!==g.rel||a.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||a.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||a.getAttribute("title")!==(g.title==null?null:g.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(x=a.getAttribute("src"),(x!==(g.src==null?null:g.src)||a.getAttribute("type")!==(g.type==null?null:g.type)||a.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&x&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(s==="input"&&a.type==="hidden"){var x=g.name==null?null:""+g.name;if(g.type==="hidden"&&a.getAttribute("name")===x)return a}else return a;if(a=va(a.nextSibling),a===null)break}return null}function PC(a,s,l){if(s==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!l||(a=va(a.nextSibling),a===null))return null;return a}function N_(a,s){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!s||(a=va(a.nextSibling),a===null))return null;return a}function Mm(a){return a.data==="$?"||a.data==="$~"}function Lm(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function BC(a,s){var l=a.ownerDocument;if(a.data==="$~")a._reactRetry=s;else if(a.data!=="$?"||l.readyState!=="loading")s();else{var f=function(){s(),l.removeEventListener("DOMContentLoaded",f)};l.addEventListener("DOMContentLoaded",f),a._reactRetry=f}}function va(a){for(;a!=null;a=a.nextSibling){var s=a.nodeType;if(s===1||s===3)break;if(s===8){if(s=a.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return a}var Pm=null;function O_(a){a=a.nextSibling;for(var s=0;a;){if(a.nodeType===8){var l=a.data;if(l==="/$"||l==="/&"){if(s===0)return va(a.nextSibling);s--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||s++}a=a.nextSibling}return null}function F_(a){a=a.previousSibling;for(var s=0;a;){if(a.nodeType===8){var l=a.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(s===0)return a;s--}else l!=="/$"&&l!=="/&"||s++}a=a.previousSibling}return null}function M_(a,s,l){switch(s=rh(l),a){case"html":if(a=s.documentElement,!a)throw Error(n(452));return a;case"head":if(a=s.head,!a)throw Error(n(453));return a;case"body":if(a=s.body,!a)throw Error(n(454));return a;default:throw Error(n(451))}}function Nu(a){for(var s=a.attributes;s.length;)a.removeAttributeNode(s[0]);Ne(a)}var ya=new Map,L_=new Set;function nh(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var qi=me.d;me.d={f:VC,r:UC,D:jC,C:zC,L:HC,m:GC,X:WC,S:qC,M:YC};function VC(){var a=qi.f(),s=X0();return a||s}function UC(a){var s=Ue(a);s!==null&&s.tag===5&&s.type==="form"?Zv(s):qi.r(a)}var ec=typeof document>"u"?null:document;function P_(a,s,l){var f=ec;if(f&&typeof s=="string"&&s){var g=Rn(s);g='link[rel="'+a+'"][href="'+g+'"]',typeof l=="string"&&(g+='[crossorigin="'+l+'"]'),L_.has(g)||(L_.add(g),a={rel:a,crossOrigin:l,href:s},f.querySelector(g)===null&&(s=f.createElement("link"),$r(s,"link",a),Ge(s),f.head.appendChild(s)))}}function jC(a){qi.D(a),P_("dns-prefetch",a,null)}function zC(a,s){qi.C(a,s),P_("preconnect",a,s)}function HC(a,s,l){qi.L(a,s,l);var f=ec;if(f&&a&&s){var g='link[rel="preload"][as="'+Rn(s)+'"]';s==="image"&&l&&l.imageSrcSet?(g+='[imagesrcset="'+Rn(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(g+='[imagesizes="'+Rn(l.imageSizes)+'"]')):g+='[href="'+Rn(a)+'"]';var x=g;switch(s){case"style":x=tc(a);break;case"script":x=rc(a)}ya.has(x)||(a=v({rel:"preload",href:s==="image"&&l&&l.imageSrcSet?void 0:a,as:s},l),ya.set(x,a),f.querySelector(g)!==null||s==="style"&&f.querySelector(Ou(x))||s==="script"&&f.querySelector(Fu(x))||(s=f.createElement("link"),$r(s,"link",a),Ge(s),f.head.appendChild(s)))}}function GC(a,s){qi.m(a,s);var l=ec;if(l&&a){var f=s&&typeof s.as=="string"?s.as:"script",g='link[rel="modulepreload"][as="'+Rn(f)+'"][href="'+Rn(a)+'"]',x=g;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=rc(a)}if(!ya.has(x)&&(a=v({rel:"modulepreload",href:a},s),ya.set(x,a),l.querySelector(g)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(Fu(x)))return}f=l.createElement("link"),$r(f,"link",a),Ge(f),l.head.appendChild(f)}}}function qC(a,s,l){qi.S(a,s,l);var f=ec;if(f&&a){var g=Be(f).hoistableStyles,x=tc(a);s=s||"default";var w=g.get(x);if(!w){var V={loading:0,preload:null};if(w=f.querySelector(Ou(x)))V.loading=5;else{a=v({rel:"stylesheet",href:a,"data-precedence":s},l),(l=ya.get(x))&&Bm(a,l);var re=w=f.createElement("link");Ge(re),$r(re,"link",a),re._p=new Promise(function(he,Te){re.onload=he,re.onerror=Te}),re.addEventListener("load",function(){V.loading|=1}),re.addEventListener("error",function(){V.loading|=2}),V.loading|=4,ah(w,s,f)}w={type:"stylesheet",instance:w,count:1,state:V},g.set(x,w)}}}function WC(a,s){qi.X(a,s);var l=ec;if(l&&a){var f=Be(l).hoistableScripts,g=rc(a),x=f.get(g);x||(x=l.querySelector(Fu(g)),x||(a=v({src:a,async:!0},s),(s=ya.get(g))&&Vm(a,s),x=l.createElement("script"),Ge(x),$r(x,"link",a),l.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},f.set(g,x))}}function YC(a,s){qi.M(a,s);var l=ec;if(l&&a){var f=Be(l).hoistableScripts,g=rc(a),x=f.get(g);x||(x=l.querySelector(Fu(g)),x||(a=v({src:a,async:!0,type:"module"},s),(s=ya.get(g))&&Vm(a,s),x=l.createElement("script"),Ge(x),$r(x,"link",a),l.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},f.set(g,x))}}function B_(a,s,l,f){var g=(g=xe.current)?nh(g):null;if(!g)throw Error(n(446));switch(a){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(s=tc(l.href),l=Be(g).hoistableStyles,f=l.get(s),f||(f={type:"style",instance:null,count:0,state:null},l.set(s,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){a=tc(l.href);var x=Be(g).hoistableStyles,w=x.get(a);if(w||(g=g.ownerDocument||g,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(a,w),(x=g.querySelector(Ou(a)))&&!x._p&&(w.instance=x,w.state.loading=5),ya.has(a)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},ya.set(a,l),x||XC(g,a,l,w.state))),s&&f===null)throw Error(n(528,""));return w}if(s&&f!==null)throw Error(n(529,""));return null;case"script":return s=l.async,l=l.src,typeof l=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=rc(l),l=Be(g).hoistableScripts,f=l.get(s),f||(f={type:"script",instance:null,count:0,state:null},l.set(s,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,a))}}function tc(a){return'href="'+Rn(a)+'"'}function Ou(a){return'link[rel="stylesheet"]['+a+"]"}function V_(a){return v({},a,{"data-precedence":a.precedence,precedence:null})}function XC(a,s,l,f){a.querySelector('link[rel="preload"][as="style"]['+s+"]")?f.loading=1:(s=a.createElement("link"),f.preload=s,s.addEventListener("load",function(){return f.loading|=1}),s.addEventListener("error",function(){return f.loading|=2}),$r(s,"link",l),Ge(s),a.head.appendChild(s))}function rc(a){return'[src="'+Rn(a)+'"]'}function Fu(a){return"script[async]"+a}function U_(a,s,l){if(s.count++,s.instance===null)switch(s.type){case"style":var f=a.querySelector('style[data-href~="'+Rn(l.href)+'"]');if(f)return s.instance=f,Ge(f),f;var g=v({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return f=(a.ownerDocument||a).createElement("style"),Ge(f),$r(f,"style",g),ah(f,l.precedence,a),s.instance=f;case"stylesheet":g=tc(l.href);var x=a.querySelector(Ou(g));if(x)return s.state.loading|=4,s.instance=x,Ge(x),x;f=V_(l),(g=ya.get(g))&&Bm(f,g),x=(a.ownerDocument||a).createElement("link"),Ge(x);var w=x;return w._p=new Promise(function(V,re){w.onload=V,w.onerror=re}),$r(x,"link",f),s.state.loading|=4,ah(x,l.precedence,a),s.instance=x;case"script":return x=rc(l.src),(g=a.querySelector(Fu(x)))?(s.instance=g,Ge(g),g):(f=l,(g=ya.get(x))&&(f=v({},l),Vm(f,g)),a=a.ownerDocument||a,g=a.createElement("script"),Ge(g),$r(g,"link",f),a.head.appendChild(g),s.instance=g);case"void":return null;default:throw Error(n(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(f=s.instance,s.state.loading|=4,ah(f,l.precedence,a));return s.instance}function ah(a,s,l){for(var f=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=f.length?f[f.length-1]:null,x=g,w=0;w<f.length;w++){var V=f[w];if(V.dataset.precedence===s)x=V;else if(x!==g)break}x?x.parentNode.insertBefore(a,x.nextSibling):(s=l.nodeType===9?l.head:l,s.insertBefore(a,s.firstChild))}function Bm(a,s){a.crossOrigin==null&&(a.crossOrigin=s.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=s.referrerPolicy),a.title==null&&(a.title=s.title)}function Vm(a,s){a.crossOrigin==null&&(a.crossOrigin=s.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=s.referrerPolicy),a.integrity==null&&(a.integrity=s.integrity)}var ih=null;function j_(a,s,l){if(ih===null){var f=new Map,g=ih=new Map;g.set(l,f)}else g=ih,f=g.get(l),f||(f=new Map,g.set(l,f));if(f.has(a))return f;for(f.set(a,null),l=l.getElementsByTagName(a),g=0;g<l.length;g++){var x=l[g];if(!(x[de]||x[H]||a==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var w=x.getAttribute(s)||"";w=a+w;var V=f.get(w);V?V.push(x):f.set(w,[x])}}return f}function z_(a,s,l){a=a.ownerDocument||a,a.head.insertBefore(l,s==="title"?a.querySelector("head > title"):null)}function KC(a,s,l){if(l===1||s.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(a=s.disabled,typeof s.precedence=="string"&&a==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function H_(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function $C(a,s,l,f){if(l.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var g=tc(f.href),x=s.querySelector(Ou(g));if(x){s=x._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(a.count++,a=sh.bind(a),s.then(a,a)),l.state.loading|=4,l.instance=x,Ge(x);return}x=s.ownerDocument||s,f=V_(f),(g=ya.get(g))&&Bm(f,g),x=x.createElement("link"),Ge(x);var w=x;w._p=new Promise(function(V,re){w.onload=V,w.onerror=re}),$r(x,"link",f),l.instance=x}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(l,s),(s=l.state.preload)&&(l.state.loading&3)===0&&(a.count++,l=sh.bind(a),s.addEventListener("load",l),s.addEventListener("error",l))}}var Um=0;function QC(a,s){return a.stylesheets&&a.count===0&&lh(a,a.stylesheets),0<a.count||0<a.imgCount?function(l){var f=setTimeout(function(){if(a.stylesheets&&lh(a,a.stylesheets),a.unsuspend){var x=a.unsuspend;a.unsuspend=null,x()}},6e4+s);0<a.imgBytes&&Um===0&&(Um=62500*DC());var g=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&lh(a,a.stylesheets),a.unsuspend)){var x=a.unsuspend;a.unsuspend=null,x()}},(a.imgBytes>Um?50:800)+s);return a.unsuspend=l,function(){a.unsuspend=null,clearTimeout(f),clearTimeout(g)}}:null}function sh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)lh(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var oh=null;function lh(a,s){a.stylesheets=null,a.unsuspend!==null&&(a.count++,oh=new Map,s.forEach(JC,a),oh=null,sh.call(a))}function JC(a,s){if(!(s.state.loading&4)){var l=oh.get(a);if(l)var f=l.get(null);else{l=new Map,oh.set(a,l);for(var g=a.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<g.length;x++){var w=g[x];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(l.set(w.dataset.precedence,w),f=w)}f&&l.set(null,f)}g=s.instance,w=g.getAttribute("data-precedence"),x=l.get(w)||f,x===f&&l.set(null,g),l.set(w,g),this.count++,f=sh.bind(this),g.addEventListener("load",f),g.addEventListener("error",f),x?x.parentNode.insertBefore(g,x.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(g,a.firstChild)),s.state.loading|=4}}var Mu={$$typeof:C,Provider:null,Consumer:null,_currentValue:_e,_currentValue2:_e,_threadCount:0};function ZC(a,s,l,f,g,x,w,V,re){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=la(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=la(0),this.hiddenUpdates=la(null),this.identifierPrefix=f,this.onUncaughtError=g,this.onCaughtError=x,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=re,this.incompleteTransitions=new Map}function G_(a,s,l,f,g,x,w,V,re,he,Te,Ae){return a=new ZC(a,s,l,w,re,he,Te,Ae,V),s=1,x===!0&&(s|=24),x=Wn(3,null,null,s),a.current=x,x.stateNode=a,s=yp(),s.refCount++,a.pooledCache=s,s.refCount++,x.memoizedState={element:f,isDehydrated:l,cache:s},Sp(x),a}function q_(a){return a?(a=Ol,a):Ol}function W_(a,s,l,f,g,x){g=q_(g),f.context===null?f.context=g:f.pendingContext=g,f=bs(s),f.payload={element:l},x=x===void 0?null:x,x!==null&&(f.callback=x),l=Cs(a,f,s),l!==null&&(Fn(l,a,s),du(l,a,s))}function Y_(a,s){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var l=a.retryLane;a.retryLane=l!==0&&l<s?l:s}}function jm(a,s){Y_(a,s),(a=a.alternate)&&Y_(a,s)}function X_(a){if(a.tag===13||a.tag===31){var s=Fo(a,67108864);s!==null&&Fn(s,a,67108864),jm(a,67108864)}}function K_(a){if(a.tag===13||a.tag===31){var s=Qn();s=Ci(s);var l=Fo(a,s);l!==null&&Fn(l,a,s),jm(a,s)}}var ch=!0;function eR(a,s,l,f){var g=ne.T;ne.T=null;var x=me.p;try{me.p=2,zm(a,s,l,f)}finally{me.p=x,ne.T=g}}function tR(a,s,l,f){var g=ne.T;ne.T=null;var x=me.p;try{me.p=8,zm(a,s,l,f)}finally{me.p=x,ne.T=g}}function zm(a,s,l,f){if(ch){var g=Hm(f);if(g===null)Rm(a,s,f,uh,l),Q_(a,f);else if(nR(g,a,s,l,f))f.stopPropagation();else if(Q_(a,f),s&4&&-1<rR.indexOf(a)){for(;g!==null;){var x=Ue(g);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var w=vn(x.pendingLanes);if(w!==0){var V=x;for(V.pendingLanes|=2,V.entangledLanes|=2;w;){var re=1<<31-ir(w);V.entanglements[1]|=re,w&=~re}ci(x),(kt&6)===0&&(W0=Ot()+500,ku(0))}}break;case 31:case 13:V=Fo(x,2),V!==null&&Fn(V,x,2),X0(),jm(x,2)}if(x=Hm(f),x===null&&Rm(a,s,f,uh,l),x===g)break;g=x}g!==null&&f.stopPropagation()}else Rm(a,s,f,null,l)}}function Hm(a){return a=ca(a),Gm(a)}var uh=null;function Gm(a){if(uh=null,a=Fe(a),a!==null){var s=o(a);if(s===null)a=null;else{var l=s.tag;if(l===13){if(a=c(s),a!==null)return a;a=null}else if(l===31){if(a=u(s),a!==null)return a;a=null}else if(l===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;a=null}else s!==a&&(a=null)}}return uh=a,null}function $_(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Gr()){case bn:return 2;case ba:return 8;case er:case Cn:return 32;case at:return 268435456;default:return 32}default:return 32}}var qm=!1,Bs=null,Vs=null,Us=null,Lu=new Map,Pu=new Map,js=[],rR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Q_(a,s){switch(a){case"focusin":case"focusout":Bs=null;break;case"dragenter":case"dragleave":Vs=null;break;case"mouseover":case"mouseout":Us=null;break;case"pointerover":case"pointerout":Lu.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pu.delete(s.pointerId)}}function Bu(a,s,l,f,g,x){return a===null||a.nativeEvent!==x?(a={blockedOn:s,domEventName:l,eventSystemFlags:f,nativeEvent:x,targetContainers:[g]},s!==null&&(s=Ue(s),s!==null&&X_(s)),a):(a.eventSystemFlags|=f,s=a.targetContainers,g!==null&&s.indexOf(g)===-1&&s.push(g),a)}function nR(a,s,l,f,g){switch(s){case"focusin":return Bs=Bu(Bs,a,s,l,f,g),!0;case"dragenter":return Vs=Bu(Vs,a,s,l,f,g),!0;case"mouseover":return Us=Bu(Us,a,s,l,f,g),!0;case"pointerover":var x=g.pointerId;return Lu.set(x,Bu(Lu.get(x)||null,a,s,l,f,g)),!0;case"gotpointercapture":return x=g.pointerId,Pu.set(x,Bu(Pu.get(x)||null,a,s,l,f,g)),!0}return!1}function J_(a){var s=Fe(a.target);if(s!==null){var l=o(s);if(l!==null){if(s=l.tag,s===13){if(s=c(l),s!==null){a.blockedOn=s,W(a.priority,function(){K_(l)});return}}else if(s===31){if(s=u(l),s!==null){a.blockedOn=s,W(a.priority,function(){K_(l)});return}}else if(s===3&&l.stateNode.current.memoizedState.isDehydrated){a.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}a.blockedOn=null}function fh(a){if(a.blockedOn!==null)return!1;for(var s=a.targetContainers;0<s.length;){var l=Hm(a.nativeEvent);if(l===null){l=a.nativeEvent;var f=new l.constructor(l.type,l);Qc=f,l.target.dispatchEvent(f),Qc=null}else return s=Ue(l),s!==null&&X_(s),a.blockedOn=l,!1;s.shift()}return!0}function Z_(a,s,l){fh(a)&&l.delete(s)}function aR(){qm=!1,Bs!==null&&fh(Bs)&&(Bs=null),Vs!==null&&fh(Vs)&&(Vs=null),Us!==null&&fh(Us)&&(Us=null),Lu.forEach(Z_),Pu.forEach(Z_)}function hh(a,s){a.blockedOn===s&&(a.blockedOn=null,qm||(qm=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,aR)))}var dh=null;function e2(a){dh!==a&&(dh=a,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){dh===a&&(dh=null);for(var s=0;s<a.length;s+=3){var l=a[s],f=a[s+1],g=a[s+2];if(typeof f!="function"){if(Gm(f||l)===null)continue;break}var x=Ue(l);x!==null&&(a.splice(s,3),s-=3,Hp(x,{pending:!0,data:g,method:l.method,action:f},f,g))}}))}function nc(a){function s(re){return hh(re,a)}Bs!==null&&hh(Bs,a),Vs!==null&&hh(Vs,a),Us!==null&&hh(Us,a),Lu.forEach(s),Pu.forEach(s);for(var l=0;l<js.length;l++){var f=js[l];f.blockedOn===a&&(f.blockedOn=null)}for(;0<js.length&&(l=js[0],l.blockedOn===null);)J_(l),l.blockedOn===null&&js.shift();if(l=(a.ownerDocument||a).$$reactFormReplay,l!=null)for(f=0;f<l.length;f+=3){var g=l[f],x=l[f+1],w=g[q]||null;if(typeof x=="function")w||e2(l);else if(w){var V=null;if(x&&x.hasAttribute("formAction")){if(g=x,w=x[q]||null)V=w.formAction;else if(Gm(g)!==null)continue}else V=w.action;typeof V=="function"?l[f+1]=V:(l.splice(f,3),f-=3),e2(l)}}}function t2(){function a(x){x.canIntercept&&x.info==="react-transition"&&x.intercept({handler:function(){return new Promise(function(w){return g=w})},focusReset:"manual",scroll:"manual"})}function s(){g!==null&&(g(),g=null),f||setTimeout(l,20)}function l(){if(!f&&!navigation.transition){var x=navigation.currentEntry;x&&x.url!=null&&navigation.navigate(x.url,{state:x.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,g=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(l,100),function(){f=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),g!==null&&(g(),g=null)}}}function Wm(a){this._internalRoot=a}ph.prototype.render=Wm.prototype.render=function(a){var s=this._internalRoot;if(s===null)throw Error(n(409));var l=s.current,f=Qn();W_(l,f,a,s,null,null)},ph.prototype.unmount=Wm.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var s=a.containerInfo;W_(a.current,2,null,a,null,null),X0(),s[X]=null}};function ph(a){this._internalRoot=a}ph.prototype.unstable_scheduleHydration=function(a){if(a){var s=M();a={blockedOn:null,target:a,priority:s};for(var l=0;l<js.length&&s!==0&&s<js[l].priority;l++);js.splice(l,0,a),l===0&&J_(a)}};var r2=e.version;if(r2!=="19.2.3")throw Error(n(527,r2,"19.2.3"));me.findDOMNode=function(a){var s=a._reactInternals;if(s===void 0)throw typeof a.render=="function"?Error(n(188)):(a=Object.keys(a).join(","),Error(n(268,a)));return a=d(s),a=a!==null?m(a):null,a=a===null?null:a.stateNode,a};var iR={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:ne,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var mh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mh.isDisabled&&mh.supportsFiber)try{Ct=mh.inject(iR),Qt=mh}catch{}}return Uu.createRoot=function(a,s){if(!i(a))throw Error(n(299));var l=!1,f="",g=cy,x=uy,w=fy;return s!=null&&(s.unstable_strictMode===!0&&(l=!0),s.identifierPrefix!==void 0&&(f=s.identifierPrefix),s.onUncaughtError!==void 0&&(g=s.onUncaughtError),s.onCaughtError!==void 0&&(x=s.onCaughtError),s.onRecoverableError!==void 0&&(w=s.onRecoverableError)),s=G_(a,1,!1,null,null,l,f,null,g,x,w,t2),a[X]=s.current,Cm(a),new Wm(s)},Uu.hydrateRoot=function(a,s,l){if(!i(a))throw Error(n(299));var f=!1,g="",x=cy,w=uy,V=fy,re=null;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(x=l.onUncaughtError),l.onCaughtError!==void 0&&(w=l.onCaughtError),l.onRecoverableError!==void 0&&(V=l.onRecoverableError),l.formState!==void 0&&(re=l.formState)),s=G_(a,1,!0,s,l??null,f,g,re,x,w,V,t2),s.context=q_(null),l=s.current,f=Qn(),f=Ci(f),g=bs(f),g.callback=null,Cs(l,g,f),l=f,s.current.lanes=l,wi(s,l),ci(s),a[X]=s.current,Cm(a),new ph(s)},Uu.version="19.2.3",Uu}var h2;function mR(){if(h2)return Km.exports;h2=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Km.exports=pR(),Km.exports}var gR=mR();var d2="popstate";function xR(t={}){function e(i,o){let{pathname:c="/",search:u="",hash:h=""}=ul(i.location.hash.substring(1));return!c.startsWith("/")&&!c.startsWith(".")&&(c="/"+c),Ag("",{pathname:c,search:u,hash:h},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function r(i,o){let c=i.document.querySelector("base"),u="";if(c&&c.getAttribute("href")){let h=i.location.href,d=h.indexOf("#");u=d===-1?h:h.slice(0,d)}return u+"#"+(typeof o=="string"?o:hf(o))}function n(i,o){na(i.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(o)})`)}return yR(e,r,n,t)}function ar(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function na(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function vR(){return Math.random().toString(36).substring(2,10)}function p2(t,e){return{usr:t.state,key:t.key,idx:e}}function Ag(t,e,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?ul(e):e,state:r,key:e&&e.key||n||vR()}}function hf({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function ul(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function yR(t,e,r,n={}){let{window:i=document.defaultView,v5Compat:o=!1}=n,c=i.history,u="POP",h=null,d=m();d==null&&(d=0,c.replaceState({...c.state,idx:d},""));function m(){return(c.state||{idx:null}).idx}function v(){u="POP";let A=m(),B=A==null?null:A-d;d=A,h&&h({action:u,location:T.location,delta:B})}function y(A,B){u="PUSH";let I=Ag(T.location,A,B);r&&r(I,A),d=m()+1;let C=p2(I,d),G=T.createHref(I);try{c.pushState(C,"",G)}catch(K){if(K instanceof DOMException&&K.name==="DataCloneError")throw K;i.location.assign(G)}o&&h&&h({action:u,location:T.location,delta:1})}function E(A,B){u="REPLACE";let I=Ag(T.location,A,B);r&&r(I,A),d=m();let C=p2(I,d),G=T.createHref(I);c.replaceState(C,"",G),o&&h&&h({action:u,location:T.location,delta:0})}function S(A){return _R(A)}let T={get action(){return u},get location(){return t(i,c)},listen(A){if(h)throw new Error("A history only accepts one active listener");return i.addEventListener(d2,v),h=A,()=>{i.removeEventListener(d2,v),h=null}},createHref(A){return e(i,A)},createURL:S,encodeLocation(A){let B=S(A);return{pathname:B.pathname,search:B.search,hash:B.hash}},push:y,replace:E,go(A){return c.go(A)}};return T}function _R(t,e=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),ar(r,"No window.location.(origin|href) available to create URL");let n=typeof t=="string"?t:hf(t);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function eS(t,e,r="/"){return ER(t,e,r,!1)}function ER(t,e,r,n){let i=typeof e=="string"?ul(e):e,o=ts(i.pathname||"/",r);if(o==null)return null;let c=tS(t);TR(c);let u=null;for(let h=0;u==null&&h<c.length;++h){let d=OR(o);u=DR(c[h],d,n)}return u}function tS(t,e=[],r=[],n="",i=!1){let o=(c,u,h=i,d)=>{let m={relativePath:d===void 0?c.path||"":d,caseSensitive:c.caseSensitive===!0,childrenIndex:u,route:c};if(m.relativePath.startsWith("/")){if(!m.relativePath.startsWith(n)&&h)return;ar(m.relativePath.startsWith(n),`Absolute route path "${m.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),m.relativePath=m.relativePath.slice(n.length)}let v=$i([n,m.relativePath]),y=r.concat(m);c.children&&c.children.length>0&&(ar(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${v}".`),tS(c.children,e,y,v,h)),!(c.path==null&&!c.index)&&e.push({path:v,score:kR(v,c.index),routesMeta:y})};return t.forEach((c,u)=>{if(c.path===""||!c.path?.includes("?"))o(c,u);else for(let h of rS(c.path))o(c,u,!0,h)}),e}function rS(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),o=r.replace(/\?$/,"");if(n.length===0)return i?[o,""]:[o];let c=rS(n.join("/")),u=[];return u.push(...c.map(h=>h===""?o:[o,h].join("/"))),i&&u.push(...c),u.map(h=>t.startsWith("/")&&h===""?"/":h)}function TR(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:IR(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var SR=/^:[\w-]+$/,wR=3,AR=2,bR=1,CR=10,RR=-2,m2=t=>t==="*";function kR(t,e){let r=t.split("/"),n=r.length;return r.some(m2)&&(n+=RR),e&&(n+=AR),r.filter(i=>!m2(i)).reduce((i,o)=>i+(SR.test(o)?wR:o===""?bR:CR),n)}function IR(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function DR(t,e,r=!1){let{routesMeta:n}=t,i={},o="/",c=[];for(let u=0;u<n.length;++u){let h=n[u],d=u===n.length-1,m=o==="/"?e:e.slice(o.length)||"/",v=Gh({path:h.relativePath,caseSensitive:h.caseSensitive,end:d},m),y=h.route;if(!v&&d&&r&&!n[n.length-1].route.index&&(v=Gh({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},m)),!v)return null;Object.assign(i,v.params),c.push({params:i,pathname:$i([o,v.pathname]),pathnameBase:PR($i([o,v.pathnameBase])),route:y}),v.pathnameBase!=="/"&&(o=$i([o,v.pathnameBase]))}return c}function Gh(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=NR(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let o=i[0],c=o.replace(/(.)\/+$/,"$1"),u=i.slice(1);return{params:n.reduce((d,{paramName:m,isOptional:v},y)=>{if(m==="*"){let S=u[y]||"";c=o.slice(0,o.length-S.length).replace(/(.)\/+$/,"$1")}const E=u[y];return v&&!E?d[m]=void 0:d[m]=(E||"").replace(/%2F/g,"/"),d},{}),pathname:o,pathnameBase:c,pattern:t}}function NR(t,e=!1,r=!0){na(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,h)=>(n.push({paramName:u,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function OR(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return na(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function ts(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}var nS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,FR=t=>nS.test(t);function MR(t,e="/"){let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?ul(t):t,o;if(r)if(FR(r))o=r;else{if(r.includes("//")){let c=r;r=r.replace(/\/\/+/g,"/"),na(!1,`Pathnames cannot have embedded double slashes - normalizing ${c} -> ${r}`)}r.startsWith("/")?o=g2(r.substring(1),"/"):o=g2(r,e)}else o=e;return{pathname:o,search:BR(n),hash:VR(i)}}function g2(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function Zm(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function LR(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function d1(t){let e=LR(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function p1(t,e,r,n=!1){let i;typeof t=="string"?i=ul(t):(i={...t},ar(!i.pathname||!i.pathname.includes("?"),Zm("?","pathname","search",i)),ar(!i.pathname||!i.pathname.includes("#"),Zm("#","pathname","hash",i)),ar(!i.search||!i.search.includes("#"),Zm("#","search","hash",i)));let o=t===""||i.pathname==="",c=o?"/":i.pathname,u;if(c==null)u=r;else{let v=e.length-1;if(!n&&c.startsWith("..")){let y=c.split("/");for(;y[0]==="..";)y.shift(),v-=1;i.pathname=y.join("/")}u=v>=0?e[v]:"/"}let h=MR(i,u),d=c&&c!=="/"&&c.endsWith("/"),m=(o||c===".")&&r.endsWith("/");return!h.pathname.endsWith("/")&&(d||m)&&(h.pathname+="/"),h}var $i=t=>t.join("/").replace(/\/\/+/g,"/"),PR=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),BR=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,VR=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,UR=class{constructor(t,e,r,n=!1){this.status=t,this.statusText=e||"",this.internal=n,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}};function jR(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function zR(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var aS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function iS(t,e){let r=t;if(typeof r!="string"||!nS.test(r))return{absoluteURL:void 0,isExternal:!1,to:r};let n=r,i=!1;if(aS)try{let o=new URL(window.location.href),c=r.startsWith("//")?new URL(o.protocol+r):new URL(r),u=ts(c.pathname,e);c.origin===o.origin&&u!=null?r=u+c.search+c.hash:i=!0}catch{na(!1,`<Link to="${r}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:n,isExternal:i,to:r}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var sS=["POST","PUT","PATCH","DELETE"];new Set(sS);var HR=["GET",...sS];new Set(HR);var Dc=se.createContext(null);Dc.displayName="DataRouter";var wd=se.createContext(null);wd.displayName="DataRouterState";var GR=se.createContext(!1),oS=se.createContext({isTransitioning:!1});oS.displayName="ViewTransition";var qR=se.createContext(new Map);qR.displayName="Fetchers";var WR=se.createContext(null);WR.displayName="Await";var ia=se.createContext(null);ia.displayName="Navigation";var Rf=se.createContext(null);Rf.displayName="Location";var Ja=se.createContext({outlet:null,matches:[],isDataRoute:!1});Ja.displayName="Route";var m1=se.createContext(null);m1.displayName="RouteError";var lS="REACT_ROUTER_ERROR",YR="REDIRECT",XR="ROUTE_ERROR_RESPONSE";function KR(t){if(t.startsWith(`${lS}:${YR}:{`))try{let e=JSON.parse(t.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function $R(t){if(t.startsWith(`${lS}:${XR}:{`))try{let e=JSON.parse(t.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new UR(e.status,e.statusText,e.data)}catch{}}function QR(t,{relative:e}={}){ar(Nc(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=se.useContext(ia),{hash:i,pathname:o,search:c}=kf(t,{relative:e}),u=o;return r!=="/"&&(u=o==="/"?r:$i([r,o])),n.createHref({pathname:u,search:c,hash:i})}function Nc(){return se.useContext(Rf)!=null}function ls(){return ar(Nc(),"useLocation() may be used only in the context of a <Router> component."),se.useContext(Rf).location}var cS="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function uS(t){se.useContext(ia).static||se.useLayoutEffect(t)}function sa(){let{isDataRoute:t}=se.useContext(Ja);return t?fk():JR()}function JR(){ar(Nc(),"useNavigate() may be used only in the context of a <Router> component.");let t=se.useContext(Dc),{basename:e,navigator:r}=se.useContext(ia),{matches:n}=se.useContext(Ja),{pathname:i}=ls(),o=JSON.stringify(d1(n)),c=se.useRef(!1);return uS(()=>{c.current=!0}),se.useCallback((h,d={})=>{if(na(c.current,cS),!c.current)return;if(typeof h=="number"){r.go(h);return}let m=p1(h,JSON.parse(o),i,d.relative==="path");t==null&&e!=="/"&&(m.pathname=m.pathname==="/"?e:$i([e,m.pathname])),(d.replace?r.replace:r.push)(m,d.state,d)},[e,r,o,i,t])}se.createContext(null);function ZR(){let{matches:t}=se.useContext(Ja),e=t[t.length-1];return e?e.params:{}}function kf(t,{relative:e}={}){let{matches:r}=se.useContext(Ja),{pathname:n}=ls(),i=JSON.stringify(d1(r));return se.useMemo(()=>p1(t,JSON.parse(i),n,e==="path"),[t,i,n,e])}function ek(t,e){return fS(t,e)}function fS(t,e,r,n,i){ar(Nc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=se.useContext(ia),{matches:c}=se.useContext(Ja),u=c[c.length-1],h=u?u.params:{},d=u?u.pathname:"/",m=u?u.pathnameBase:"/",v=u&&u.route;{let I=v&&v.path||"";dS(d,!v||I.endsWith("*")||I.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${I}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${I}"> to <Route path="${I==="/"?"*":`${I}/*`}">.`)}let y=ls(),E;if(e){let I=typeof e=="string"?ul(e):e;ar(m==="/"||I.pathname?.startsWith(m),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${m}" but pathname "${I.pathname}" was given in the \`location\` prop.`),E=I}else E=y;let S=E.pathname||"/",T=S;if(m!=="/"){let I=m.replace(/^\//,"").split("/");T="/"+S.replace(/^\//,"").split("/").slice(I.length).join("/")}let A=eS(t,{pathname:T});na(v||A!=null,`No routes matched location "${E.pathname}${E.search}${E.hash}" `),na(A==null||A[A.length-1].route.element!==void 0||A[A.length-1].route.Component!==void 0||A[A.length-1].route.lazy!==void 0,`Matched leaf route at location "${E.pathname}${E.search}${E.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let B=ik(A&&A.map(I=>Object.assign({},I,{params:Object.assign({},h,I.params),pathname:$i([m,o.encodeLocation?o.encodeLocation(I.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:I.pathname]),pathnameBase:I.pathnameBase==="/"?m:$i([m,o.encodeLocation?o.encodeLocation(I.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:I.pathnameBase])})),c,r,n,i);return e&&B?se.createElement(Rf.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...E},navigationType:"POP"}},B):B}function tk(){let t=uk(),e=jR(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:n},o={padding:"2px 4px",backgroundColor:n},c=null;return console.error("Error handled by React Router default ErrorBoundary:",t),c=se.createElement(se.Fragment,null,se.createElement("p",null," Hey developer "),se.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",se.createElement("code",{style:o},"ErrorBoundary")," or"," ",se.createElement("code",{style:o},"errorElement")," prop on your route.")),se.createElement(se.Fragment,null,se.createElement("h2",null,"Unexpected Application Error!"),se.createElement("h3",{style:{fontStyle:"italic"}},e),r?se.createElement("pre",{style:i},r):null,c)}var rk=se.createElement(tk,null),hS=class extends se.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const r=$R(t.digest);r&&(t=r)}let e=t!==void 0?se.createElement(Ja.Provider,{value:this.props.routeContext},se.createElement(m1.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?se.createElement(nk,{error:t},e):e}};hS.contextType=GR;var eg=new WeakMap;function nk({children:t,error:e}){let{basename:r}=se.useContext(ia);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let n=KR(e.digest);if(n){let i=eg.get(e);if(i)throw i;let o=iS(n.location,r);if(aS&&!eg.get(e))if(o.isExternal||n.reloadDocument)window.location.href=o.absoluteURL||o.to;else{const c=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(o.to,{replace:n.replace}));throw eg.set(e,c),c}return se.createElement("meta",{httpEquiv:"refresh",content:`0;url=${o.absoluteURL||o.to}`})}}return t}function ak({routeContext:t,match:e,children:r}){let n=se.useContext(Dc);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),se.createElement(Ja.Provider,{value:t},r)}function ik(t,e=[],r=null,n=null,i=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let o=t,c=r?.errors;if(c!=null){let m=o.findIndex(v=>v.route.id&&c?.[v.route.id]!==void 0);ar(m>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),o=o.slice(0,Math.min(o.length,m+1))}let u=!1,h=-1;if(r)for(let m=0;m<o.length;m++){let v=o[m];if((v.route.HydrateFallback||v.route.hydrateFallbackElement)&&(h=m),v.route.id){let{loaderData:y,errors:E}=r,S=v.route.loader&&!y.hasOwnProperty(v.route.id)&&(!E||E[v.route.id]===void 0);if(v.route.lazy||S){u=!0,h>=0?o=o.slice(0,h+1):o=[o[0]];break}}}let d=r&&n?(m,v)=>{n(m,{location:r.location,params:r.matches?.[0]?.params??{},unstable_pattern:zR(r.matches),errorInfo:v})}:void 0;return o.reduceRight((m,v,y)=>{let E,S=!1,T=null,A=null;r&&(E=c&&v.route.id?c[v.route.id]:void 0,T=v.route.errorElement||rk,u&&(h<0&&y===0?(dS("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),S=!0,A=null):h===y&&(S=!0,A=v.route.hydrateFallbackElement||null)));let B=e.concat(o.slice(0,y+1)),I=()=>{let C;return E?C=T:S?C=A:v.route.Component?C=se.createElement(v.route.Component,null):v.route.element?C=v.route.element:C=m,se.createElement(ak,{match:v,routeContext:{outlet:m,matches:B,isDataRoute:r!=null},children:C})};return r&&(v.route.ErrorBoundary||v.route.errorElement||y===0)?se.createElement(hS,{location:r.location,revalidation:r.revalidation,component:T,error:E,children:I(),routeContext:{outlet:null,matches:B,isDataRoute:!0},onError:d}):I()},null)}function g1(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function sk(t){let e=se.useContext(Dc);return ar(e,g1(t)),e}function ok(t){let e=se.useContext(wd);return ar(e,g1(t)),e}function lk(t){let e=se.useContext(Ja);return ar(e,g1(t)),e}function x1(t){let e=lk(t),r=e.matches[e.matches.length-1];return ar(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function ck(){return x1("useRouteId")}function uk(){let t=se.useContext(m1),e=ok("useRouteError"),r=x1("useRouteError");return t!==void 0?t:e.errors?.[r]}function fk(){let{router:t}=sk("useNavigate"),e=x1("useNavigate"),r=se.useRef(!1);return uS(()=>{r.current=!0}),se.useCallback(async(i,o={})=>{na(r.current,cS),r.current&&(typeof i=="number"?await t.navigate(i):await t.navigate(i,{fromRouteId:e,...o}))},[t,e])}var x2={};function dS(t,e,r){!e&&!x2[t]&&(x2[t]=!0,na(!1,r))}se.memo(hk);function hk({routes:t,future:e,state:r,onError:n}){return fS(t,void 0,r,n,e)}function v2({to:t,replace:e,state:r,relative:n}){ar(Nc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=se.useContext(ia);na(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=se.useContext(Ja),{pathname:c}=ls(),u=sa(),h=p1(t,d1(o),c,n==="path"),d=JSON.stringify(h);return se.useEffect(()=>{u(JSON.parse(d),{replace:e,state:r,relative:n})},[u,d,n,e,r]),null}function Ua(t){ar(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function dk({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:i,static:o=!1,unstable_useTransitions:c}){ar(!Nc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=t.replace(/^\/*/,"/"),h=se.useMemo(()=>({basename:u,navigator:i,static:o,unstable_useTransitions:c,future:{}}),[u,i,o,c]);typeof r=="string"&&(r=ul(r));let{pathname:d="/",search:m="",hash:v="",state:y=null,key:E="default"}=r,S=se.useMemo(()=>{let T=ts(d,u);return T==null?null:{location:{pathname:T,search:m,hash:v,state:y,key:E},navigationType:n}},[u,d,m,v,y,E,n]);return na(S!=null,`<Router basename="${u}"> is not able to match the URL "${d}${m}${v}" because it does not start with the basename, so the <Router> won't render anything.`),S==null?null:se.createElement(ia.Provider,{value:h},se.createElement(Rf.Provider,{children:e,value:S}))}function pk({children:t,location:e}){return ek(bg(t),e)}function bg(t,e=[]){let r=[];return se.Children.forEach(t,(n,i)=>{if(!se.isValidElement(n))return;let o=[...e,i];if(n.type===se.Fragment){r.push.apply(r,bg(n.props.children,o));return}ar(n.type===Ua,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ar(!n.props.index||!n.props.children,"An index route cannot have child routes.");let c={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(c.children=bg(n.props.children,o)),r.push(c)}),r}var Nh="get",Oh="application/x-www-form-urlencoded";function Ad(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function mk(t){return Ad(t)&&t.tagName.toLowerCase()==="button"}function gk(t){return Ad(t)&&t.tagName.toLowerCase()==="form"}function xk(t){return Ad(t)&&t.tagName.toLowerCase()==="input"}function vk(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function yk(t,e){return t.button===0&&(!e||e==="_self")&&!vk(t)}var gh=null;function _k(){if(gh===null)try{new FormData(document.createElement("form"),0),gh=!1}catch{gh=!0}return gh}var Ek=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function tg(t){return t!=null&&!Ek.has(t)?(na(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Oh}"`),null):t}function Tk(t,e){let r,n,i,o,c;if(gk(t)){let u=t.getAttribute("action");n=u?ts(u,e):null,r=t.getAttribute("method")||Nh,i=tg(t.getAttribute("enctype"))||Oh,o=new FormData(t)}else if(mk(t)||xk(t)&&(t.type==="submit"||t.type==="image")){let u=t.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=t.getAttribute("formaction")||u.getAttribute("action");if(n=h?ts(h,e):null,r=t.getAttribute("formmethod")||u.getAttribute("method")||Nh,i=tg(t.getAttribute("formenctype"))||tg(u.getAttribute("enctype"))||Oh,o=new FormData(u,t),!_k()){let{name:d,type:m,value:v}=t;if(m==="image"){let y=d?`${d}.`:"";o.append(`${y}x`,"0"),o.append(`${y}y`,"0")}else d&&o.append(d,v)}}else{if(Ad(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Nh,n=null,i=Oh,c=t}return o&&i==="text/plain"&&(c=o,o=void 0),{action:n,method:r.toLowerCase(),encType:i,formData:o,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function v1(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Sk(t,e,r,n){let i=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r?i.pathname.endsWith("/")?i.pathname=`${i.pathname}_.${n}`:i.pathname=`${i.pathname}.${n}`:i.pathname==="/"?i.pathname=`_root.${n}`:e&&ts(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${n}`,i}async function wk(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Ak(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function bk(t,e,r){let n=await Promise.all(t.map(async i=>{let o=e.routes[i.route.id];if(o){let c=await wk(o,r);return c.links?c.links():[]}return[]}));return Ik(n.flat(1).filter(Ak).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function y2(t,e,r,n,i,o){let c=(h,d)=>r[d]?h.route.id!==r[d].route.id:!0,u=(h,d)=>r[d].pathname!==h.pathname||r[d].route.path?.endsWith("*")&&r[d].params["*"]!==h.params["*"];return o==="assets"?e.filter((h,d)=>c(h,d)||u(h,d)):o==="data"?e.filter((h,d)=>{let m=n.routes[h.route.id];if(!m||!m.hasLoader)return!1;if(c(h,d)||u(h,d))return!0;if(h.route.shouldRevalidate){let v=h.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function Ck(t,e,{includeHydrateFallback:r}={}){return Rk(t.map(n=>{let i=e.routes[n.route.id];if(!i)return[];let o=[i.module];return i.clientActionModule&&(o=o.concat(i.clientActionModule)),i.clientLoaderModule&&(o=o.concat(i.clientLoaderModule)),r&&i.hydrateFallbackModule&&(o=o.concat(i.hydrateFallbackModule)),i.imports&&(o=o.concat(i.imports)),o}).flat(1))}function Rk(t){return[...new Set(t)]}function kk(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function Ik(t,e){let r=new Set;return new Set(e),t.reduce((n,i)=>{let o=JSON.stringify(kk(i));return r.has(o)||(r.add(o),n.push({key:o,link:i})),n},[])}function pS(){let t=se.useContext(Dc);return v1(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function Dk(){let t=se.useContext(wd);return v1(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var y1=se.createContext(void 0);y1.displayName="FrameworkContext";function mS(){let t=se.useContext(y1);return v1(t,"You must render this element inside a <HydratedRouter> element"),t}function Nk(t,e){let r=se.useContext(y1),[n,i]=se.useState(!1),[o,c]=se.useState(!1),{onFocus:u,onBlur:h,onMouseEnter:d,onMouseLeave:m,onTouchStart:v}=e,y=se.useRef(null);se.useEffect(()=>{if(t==="render"&&c(!0),t==="viewport"){let T=B=>{B.forEach(I=>{c(I.isIntersecting)})},A=new IntersectionObserver(T,{threshold:.5});return y.current&&A.observe(y.current),()=>{A.disconnect()}}},[t]),se.useEffect(()=>{if(n){let T=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(T)}}},[n]);let E=()=>{i(!0)},S=()=>{i(!1),c(!1)};return r?t!=="intent"?[o,y,{}]:[o,y,{onFocus:ju(u,E),onBlur:ju(h,S),onMouseEnter:ju(d,E),onMouseLeave:ju(m,S),onTouchStart:ju(v,E)}]:[!1,y,{}]}function ju(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function Ok({page:t,...e}){let{router:r}=pS(),n=se.useMemo(()=>eS(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?se.createElement(Mk,{page:t,matches:n,...e}):null}function Fk(t){let{manifest:e,routeModules:r}=mS(),[n,i]=se.useState([]);return se.useEffect(()=>{let o=!1;return bk(t,e,r).then(c=>{o||i(c)}),()=>{o=!0}},[t,e,r]),n}function Mk({page:t,matches:e,...r}){let n=ls(),{future:i,manifest:o,routeModules:c}=mS(),{basename:u}=pS(),{loaderData:h,matches:d}=Dk(),m=se.useMemo(()=>y2(t,e,d,o,n,"data"),[t,e,d,o,n]),v=se.useMemo(()=>y2(t,e,d,o,n,"assets"),[t,e,d,o,n]),y=se.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let T=new Set,A=!1;if(e.forEach(I=>{let C=o.routes[I.route.id];!C||!C.hasLoader||(!m.some(G=>G.route.id===I.route.id)&&I.route.id in h&&c[I.route.id]?.shouldRevalidate||C.hasClientLoader?A=!0:T.add(I.route.id))}),T.size===0)return[];let B=Sk(t,u,i.unstable_trailingSlashAwareDataRequests,"data");return A&&T.size>0&&B.searchParams.set("_routes",e.filter(I=>T.has(I.route.id)).map(I=>I.route.id).join(",")),[B.pathname+B.search]},[u,i.unstable_trailingSlashAwareDataRequests,h,n,o,m,e,t,c]),E=se.useMemo(()=>Ck(v,o),[v,o]),S=Fk(v);return se.createElement(se.Fragment,null,y.map(T=>se.createElement("link",{key:T,rel:"prefetch",as:"fetch",href:T,...r})),E.map(T=>se.createElement("link",{key:T,rel:"modulepreload",href:T,...r})),S.map(({key:T,link:A})=>se.createElement("link",{key:T,nonce:r.nonce,...A})))}function Lk(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var Pk=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Pk&&(window.__reactRouterVersion="7.12.0")}catch{}function Bk({basename:t,children:e,unstable_useTransitions:r,window:n}){let i=se.useRef();i.current==null&&(i.current=xR({window:n,v5Compat:!0}));let o=i.current,[c,u]=se.useState({action:o.action,location:o.location}),h=se.useCallback(d=>{r===!1?u(d):se.startTransition(()=>u(d))},[r]);return se.useLayoutEffect(()=>o.listen(h),[o,h]),se.createElement(dk,{basename:t,children:e,location:c.location,navigationType:c.action,navigator:o,unstable_useTransitions:r})}var gS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,xS=se.forwardRef(function({onClick:e,discover:r="render",prefetch:n="none",relative:i,reloadDocument:o,replace:c,state:u,target:h,to:d,preventScrollReset:m,viewTransition:v,unstable_defaultShouldRevalidate:y,...E},S){let{basename:T,unstable_useTransitions:A}=se.useContext(ia),B=typeof d=="string"&&gS.test(d),I=iS(d,T);d=I.to;let C=QR(d,{relative:i}),[G,K,Y]=Nk(n,E),b=zk(d,{replace:c,state:u,target:h,preventScrollReset:m,relative:i,viewTransition:v,unstable_defaultShouldRevalidate:y,unstable_useTransitions:A});function N(U){e&&e(U),U.defaultPrevented||b(U)}let D=se.createElement("a",{...E,...Y,href:I.absoluteURL||C,onClick:I.isExternal||o?e:N,ref:Lk(S,K),target:h,"data-discover":!B&&r==="render"?"true":void 0});return G&&!B?se.createElement(se.Fragment,null,D,se.createElement(Ok,{page:C})):D});xS.displayName="Link";var Vk=se.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:n="",end:i=!1,style:o,to:c,viewTransition:u,children:h,...d},m){let v=kf(c,{relative:d.relative}),y=ls(),E=se.useContext(wd),{navigator:S,basename:T}=se.useContext(ia),A=E!=null&&Yk(v)&&u===!0,B=S.encodeLocation?S.encodeLocation(v).pathname:v.pathname,I=y.pathname,C=E&&E.navigation&&E.navigation.location?E.navigation.location.pathname:null;r||(I=I.toLowerCase(),C=C?C.toLowerCase():null,B=B.toLowerCase()),C&&T&&(C=ts(C,T)||C);const G=B!=="/"&&B.endsWith("/")?B.length-1:B.length;let K=I===B||!i&&I.startsWith(B)&&I.charAt(G)==="/",Y=C!=null&&(C===B||!i&&C.startsWith(B)&&C.charAt(B.length)==="/"),b={isActive:K,isPending:Y,isTransitioning:A},N=K?e:void 0,D;typeof n=="function"?D=n(b):D=[n,K?"active":null,Y?"pending":null,A?"transitioning":null].filter(Boolean).join(" ");let U=typeof o=="function"?o(b):o;return se.createElement(xS,{...d,"aria-current":N,className:D,ref:m,style:U,to:c,viewTransition:u},typeof h=="function"?h(b):h)});Vk.displayName="NavLink";var Uk=se.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:i,state:o,method:c=Nh,action:u,onSubmit:h,relative:d,preventScrollReset:m,viewTransition:v,unstable_defaultShouldRevalidate:y,...E},S)=>{let{unstable_useTransitions:T}=se.useContext(ia),A=qk(),B=Wk(u,{relative:d}),I=c.toLowerCase()==="get"?"get":"post",C=typeof u=="string"&&gS.test(u),G=K=>{if(h&&h(K),K.defaultPrevented)return;K.preventDefault();let Y=K.nativeEvent.submitter,b=Y?.getAttribute("formmethod")||c,N=()=>A(Y||K.currentTarget,{fetcherKey:e,method:b,navigate:r,replace:i,state:o,relative:d,preventScrollReset:m,viewTransition:v,unstable_defaultShouldRevalidate:y});T&&r!==!1?se.startTransition(()=>N()):N()};return se.createElement("form",{ref:S,method:I,action:B,onSubmit:n?h:G,...E,"data-discover":!C&&t==="render"?"true":void 0})});Uk.displayName="Form";function jk(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function vS(t){let e=se.useContext(Dc);return ar(e,jk(t)),e}function zk(t,{target:e,replace:r,state:n,preventScrollReset:i,relative:o,viewTransition:c,unstable_defaultShouldRevalidate:u,unstable_useTransitions:h}={}){let d=sa(),m=ls(),v=kf(t,{relative:o});return se.useCallback(y=>{if(yk(y,e)){y.preventDefault();let E=r!==void 0?r:hf(m)===hf(v),S=()=>d(t,{replace:E,state:n,preventScrollReset:i,relative:o,viewTransition:c,unstable_defaultShouldRevalidate:u});h?se.startTransition(()=>S()):S()}},[m,d,v,r,n,e,t,i,o,c,u,h])}var Hk=0,Gk=()=>`__${String(++Hk)}__`;function qk(){let{router:t}=vS("useSubmit"),{basename:e}=se.useContext(ia),r=ck(),n=t.fetch,i=t.navigate;return se.useCallback(async(o,c={})=>{let{action:u,method:h,encType:d,formData:m,body:v}=Tk(o,e);if(c.navigate===!1){let y=c.fetcherKey||Gk();await n(y,r,c.action||u,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:m,body:v,formMethod:c.method||h,formEncType:c.encType||d,flushSync:c.flushSync})}else await i(c.action||u,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:m,body:v,formMethod:c.method||h,formEncType:c.encType||d,replace:c.replace,state:c.state,fromRouteId:r,flushSync:c.flushSync,viewTransition:c.viewTransition})},[n,i,e,r])}function Wk(t,{relative:e}={}){let{basename:r}=se.useContext(ia),n=se.useContext(Ja);ar(n,"useFormAction must be used inside a RouteContext");let[i]=n.matches.slice(-1),o={...kf(t||".",{relative:e})},c=ls();if(t==null){o.search=c.search;let u=new URLSearchParams(o.search),h=u.getAll("index");if(h.some(m=>m==="")){u.delete("index"),h.filter(v=>v).forEach(v=>u.append("index",v));let m=u.toString();o.search=m?`?${m}`:""}}return(!t||t===".")&&i.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(o.pathname=o.pathname==="/"?r:$i([r,o.pathname])),hf(o)}function Yk(t,{relative:e}={}){let r=se.useContext(oS);ar(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=vS("useViewTransitionState"),i=kf(t,{relative:e});if(!r.isTransitioning)return!1;let o=ts(r.currentLocation.pathname,n)||r.currentLocation.pathname,c=ts(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Gh(i.pathname,c)!=null||Gh(i.pathname,o)!=null}const Xk=()=>{};var _2={};const yS=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},Kk=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[r++];e[n++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=t[r++],c=t[r++],u=t[r++],h=((i&7)<<18|(o&63)<<12|(c&63)<<6|u&63)-65536;e[n++]=String.fromCharCode(55296+(h>>10)),e[n++]=String.fromCharCode(56320+(h&1023))}else{const o=t[r++],c=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(o&63)<<6|c&63)}}return e.join("")},_S={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const o=t[i],c=i+1<t.length,u=c?t[i+1]:0,h=i+2<t.length,d=h?t[i+2]:0,m=o>>2,v=(o&3)<<4|u>>4;let y=(u&15)<<2|d>>6,E=d&63;h||(E=64,c||(y=64)),n.push(r[m],r[v],r[y],r[E])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(yS(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Kk(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const o=r[t.charAt(i++)],u=i<t.length?r[t.charAt(i)]:0;++i;const d=i<t.length?r[t.charAt(i)]:64;++i;const v=i<t.length?r[t.charAt(i)]:64;if(++i,o==null||u==null||d==null||v==null)throw new $k;const y=o<<2|u>>4;if(n.push(y),d!==64){const E=u<<4&240|d>>2;if(n.push(E),v!==64){const S=d<<6&192|v;n.push(S)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class $k extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Qk=function(t){const e=yS(t);return _S.encodeByteArray(e,!0)},qh=function(t){return Qk(t).replace(/\./g,"")},ES=function(t){try{return _S.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Jk(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Zk=()=>Jk().__FIREBASE_DEFAULTS__,e3=()=>{if(typeof process>"u"||typeof _2>"u")return;const t=_2.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},t3=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&ES(t[1]);return e&&JSON.parse(e)},bd=()=>{try{return Xk()||Zk()||e3()||t3()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},TS=t=>bd()?.emulatorHosts?.[t],r3=t=>{const e=TS(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},SS=()=>bd()?.config,wS=t=>bd()?.[`_${t}`];class n3{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}function Oc(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function AS(t){return(await fetch(t,{credentials:"include"})).ok}function a3(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...t};return[qh(JSON.stringify(r)),qh(JSON.stringify(c)),""].join(".")}const Ku={};function i3(){const t={prod:[],emulator:[]};for(const e of Object.keys(Ku))Ku[e]?t.emulator.push(e):t.prod.push(e);return t}function s3(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let E2=!1;function bS(t,e){if(typeof window>"u"||typeof document>"u"||!Oc(window.location.host)||Ku[t]===e||Ku[t]||E2)return;Ku[t]=e;function r(y){return`__firebase__banner__${y}`}const n="__firebase__banner",o=i3().prod.length>0;function c(){const y=document.getElementById(n);y&&y.remove()}function u(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function h(y,E){y.setAttribute("width","24"),y.setAttribute("id",E),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function d(){const y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{E2=!0,c()},y}function m(y,E){y.setAttribute("id",E),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function v(){const y=s3(n),E=r("text"),S=document.getElementById(E)||document.createElement("span"),T=r("learnmore"),A=document.getElementById(T)||document.createElement("a"),B=r("preprendIcon"),I=document.getElementById(B)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){const C=y.element;u(C),m(A,T);const G=d();h(I,B),C.append(I,S,A,G),document.body.appendChild(C)}o?(S.innerText="Preview backend disconnected.",I.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(I.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",E)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}function pn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function o3(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(pn())}function l3(){const t=bd()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function c3(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function u3(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function f3(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function h3(){const t=pn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function d3(){return!l3()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function p3(){try{return typeof indexedDB=="object"}catch{return!1}}function m3(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(r){e(r)}})}const g3="FirebaseError";class cs extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=g3,Object.setPrototypeOf(this,cs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,If.prototype.create)}}class If{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,o=this.errors[e],c=o?x3(o,n):"Error",u=`${this.serviceName}: ${c} (${i}).`;return new cs(i,u,n)}}function x3(t,e){return t.replace(v3,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const v3=/\{\$([^}]+)}/g;function y3(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function oo(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const o=t[i],c=e[i];if(T2(o)&&T2(c)){if(!oo(o,c))return!1}else if(o!==c)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function T2(t){return t!==null&&typeof t=="object"}function Df(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function _3(t,e){const r=new E3(t,e);return r.subscribe.bind(r)}class E3{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");T3(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=rg),i.error===void 0&&(i.error=rg),i.complete===void 0&&(i.complete=rg);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function T3(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function rg(){}function Mr(t){return t&&t._delegate?t._delegate:t}class rl{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Yo="[DEFAULT]";class S3{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new n3;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(A3(e))try{this.getOrInitializeService({instanceIdentifier:Yo})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const o=this.getOrInitializeService({instanceIdentifier:i});n.resolve(o)}catch{}}}}clearInstance(e=Yo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Yo){return this.instances.has(e)}getOptions(e=Yo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[o,c]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(o);n===u&&c.resolve(i)}return i}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const o=this.instances.get(n);return o&&e(o,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:w3(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Yo){return this.component?this.component.multipleInstances?e:Yo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function w3(t){return t===Yo?void 0:t}function A3(t){return t.instantiationMode==="EAGER"}class b3{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new S3(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}var pt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(pt||(pt={}));const C3={debug:pt.DEBUG,verbose:pt.VERBOSE,info:pt.INFO,warn:pt.WARN,error:pt.ERROR,silent:pt.SILENT},R3=pt.INFO,k3={[pt.DEBUG]:"log",[pt.VERBOSE]:"log",[pt.INFO]:"info",[pt.WARN]:"warn",[pt.ERROR]:"error"},I3=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=k3[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class _1{constructor(e){this.name=e,this._logLevel=R3,this._logHandler=I3,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in pt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?C3[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,pt.DEBUG,...e),this._logHandler(this,pt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,pt.VERBOSE,...e),this._logHandler(this,pt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,pt.INFO,...e),this._logHandler(this,pt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,pt.WARN,...e),this._logHandler(this,pt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,pt.ERROR,...e),this._logHandler(this,pt.ERROR,...e)}}const D3=(t,e)=>e.some(r=>t instanceof r);let S2,w2;function N3(){return S2||(S2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function O3(){return w2||(w2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const CS=new WeakMap,Cg=new WeakMap,RS=new WeakMap,ng=new WeakMap,E1=new WeakMap;function F3(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",c)},o=()=>{r(Zs(t.result)),i()},c=()=>{n(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",c)});return e.then(r=>{r instanceof IDBCursor&&CS.set(r,t)}).catch(()=>{}),E1.set(e,t),e}function M3(t){if(Cg.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",c),t.removeEventListener("abort",c)},o=()=>{r(),i()},c=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",c),t.addEventListener("abort",c)});Cg.set(t,e)}let Rg={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Cg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||RS.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Zs(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function L3(t){Rg=t(Rg)}function P3(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(ag(this),e,...r);return RS.set(n,e.sort?e.sort():[e]),Zs(n)}:O3().includes(t)?function(...e){return t.apply(ag(this),e),Zs(CS.get(this))}:function(...e){return Zs(t.apply(ag(this),e))}}function B3(t){return typeof t=="function"?P3(t):(t instanceof IDBTransaction&&M3(t),D3(t,N3())?new Proxy(t,Rg):t)}function Zs(t){if(t instanceof IDBRequest)return F3(t);if(ng.has(t))return ng.get(t);const e=B3(t);return e!==t&&(ng.set(t,e),E1.set(e,t)),e}const ag=t=>E1.get(t);function V3(t,e,{blocked:r,upgrade:n,blocking:i,terminated:o}={}){const c=indexedDB.open(t,e),u=Zs(c);return n&&c.addEventListener("upgradeneeded",h=>{n(Zs(c.result),h.oldVersion,h.newVersion,Zs(c.transaction),h)}),r&&c.addEventListener("blocked",h=>r(h.oldVersion,h.newVersion,h)),u.then(h=>{o&&h.addEventListener("close",()=>o()),i&&h.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}const U3=["get","getKey","getAll","getAllKeys","count"],j3=["put","add","delete","clear"],ig=new Map;function A2(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(ig.get(e))return ig.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=j3.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||U3.includes(r)))return;const o=async function(c,...u){const h=this.transaction(c,i?"readwrite":"readonly");let d=h.store;return n&&(d=d.index(u.shift())),(await Promise.all([d[r](...u),i&&h.done]))[0]};return ig.set(e,o),o}L3(t=>({...t,get:(e,r,n)=>A2(e,r)||t.get(e,r,n),has:(e,r)=>!!A2(e,r)||t.has(e,r)}));class z3{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(H3(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function H3(t){return t.getComponent()?.type==="VERSION"}const kg="@firebase/app",b2="0.14.6";const rs=new _1("@firebase/app"),G3="@firebase/app-compat",q3="@firebase/analytics-compat",W3="@firebase/analytics",Y3="@firebase/app-check-compat",X3="@firebase/app-check",K3="@firebase/auth",$3="@firebase/auth-compat",Q3="@firebase/database",J3="@firebase/data-connect",Z3="@firebase/database-compat",eI="@firebase/functions",tI="@firebase/functions-compat",rI="@firebase/installations",nI="@firebase/installations-compat",aI="@firebase/messaging",iI="@firebase/messaging-compat",sI="@firebase/performance",oI="@firebase/performance-compat",lI="@firebase/remote-config",cI="@firebase/remote-config-compat",uI="@firebase/storage",fI="@firebase/storage-compat",hI="@firebase/firestore",dI="@firebase/ai",pI="@firebase/firestore-compat",mI="firebase",gI="12.6.0";const Ig="[DEFAULT]",xI={[kg]:"fire-core",[G3]:"fire-core-compat",[W3]:"fire-analytics",[q3]:"fire-analytics-compat",[X3]:"fire-app-check",[Y3]:"fire-app-check-compat",[K3]:"fire-auth",[$3]:"fire-auth-compat",[Q3]:"fire-rtdb",[J3]:"fire-data-connect",[Z3]:"fire-rtdb-compat",[eI]:"fire-fn",[tI]:"fire-fn-compat",[rI]:"fire-iid",[nI]:"fire-iid-compat",[aI]:"fire-fcm",[iI]:"fire-fcm-compat",[sI]:"fire-perf",[oI]:"fire-perf-compat",[lI]:"fire-rc",[cI]:"fire-rc-compat",[uI]:"fire-gcs",[fI]:"fire-gcs-compat",[hI]:"fire-fst",[pI]:"fire-fst-compat",[dI]:"fire-vertex","fire-js":"fire-js",[mI]:"fire-js-all"};const Wh=new Map,vI=new Map,Dg=new Map;function C2(t,e){try{t.container.addComponent(e)}catch(r){rs.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function yc(t){const e=t.name;if(Dg.has(e))return rs.debug(`There were multiple attempts to register component ${e}.`),!1;Dg.set(e,t);for(const r of Wh.values())C2(r,t);for(const r of vI.values())C2(r,t);return!0}function T1(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function ja(t){return t==null?!1:t.settings!==void 0}const yI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},eo=new If("app","Firebase",yI);class _I{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new rl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw eo.create("app-deleted",{appName:this._name})}}const Fc=gI;function kS(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:Ig,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw eo.create("bad-app-name",{appName:String(i)});if(r||(r=SS()),!r)throw eo.create("no-options");const o=Wh.get(i);if(o){if(oo(r,o.options)&&oo(n,o.config))return o;throw eo.create("duplicate-app",{appName:i})}const c=new b3(i);for(const h of Dg.values())c.addComponent(h);const u=new _I(r,n,c);return Wh.set(i,u),u}function IS(t=Ig){const e=Wh.get(t);if(!e&&t===Ig&&SS())return kS();if(!e)throw eo.create("no-app",{appName:t});return e}function to(t,e,r){let n=xI[t]??t;r&&(n+=`-${r}`);const i=n.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const c=[`Unable to register library "${n}" with version "${e}":`];i&&c.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&o&&c.push("and"),o&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),rs.warn(c.join(" "));return}yc(new rl(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}const EI="firebase-heartbeat-database",TI=1,df="firebase-heartbeat-store";let sg=null;function DS(){return sg||(sg=V3(EI,TI,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(df)}catch(r){console.warn(r)}}}}).catch(t=>{throw eo.create("idb-open",{originalErrorMessage:t.message})})),sg}async function SI(t){try{const r=(await DS()).transaction(df),n=await r.objectStore(df).get(NS(t));return await r.done,n}catch(e){if(e instanceof cs)rs.warn(e.message);else{const r=eo.create("idb-get",{originalErrorMessage:e?.message});rs.warn(r.message)}}}async function R2(t,e){try{const n=(await DS()).transaction(df,"readwrite");await n.objectStore(df).put(e,NS(t)),await n.done}catch(r){if(r instanceof cs)rs.warn(r.message);else{const n=eo.create("idb-set",{originalErrorMessage:r?.message});rs.warn(n.message)}}}function NS(t){return`${t.name}!${t.options.appId}`}const wI=1024,AI=30;class bI{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new RI(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=k2();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>AI){const i=kI(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){rs.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=k2(),{heartbeatsToSend:r,unsentEntries:n}=CI(this._heartbeatsCache.heartbeats),i=qh(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return rs.warn(e),""}}}function k2(){return new Date().toISOString().substring(0,10)}function CI(t,e=wI){const r=[];let n=t.slice();for(const i of t){const o=r.find(c=>c.agent===i.agent);if(o){if(o.dates.push(i.date),I2(r)>e){o.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),I2(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class RI{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return p3()?m3().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await SI(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return R2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return R2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function I2(t){return qh(JSON.stringify({version:2,heartbeats:t})).length}function kI(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}function II(t){yc(new rl("platform-logger",e=>new z3(e),"PRIVATE")),yc(new rl("heartbeat",e=>new bI(e),"PRIVATE")),to(kg,b2,t),to(kg,b2,"esm2020"),to("fire-js","")}II("");var DI="firebase",NI="12.7.0";to(DI,NI,"app");var D2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ro,OS;(function(){var t;function e(b,N){function D(){}D.prototype=N.prototype,b.F=N.prototype,b.prototype=new D,b.prototype.constructor=b,b.D=function(U,P,F){for(var O=Array(arguments.length-2),we=2;we<arguments.length;we++)O[we-2]=arguments[we];return N.prototype[P].apply(U,O)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,r),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(b,N,D){D||(D=0);const U=Array(16);if(typeof N=="string")for(var P=0;P<16;++P)U[P]=N.charCodeAt(D++)|N.charCodeAt(D++)<<8|N.charCodeAt(D++)<<16|N.charCodeAt(D++)<<24;else for(P=0;P<16;++P)U[P]=N[D++]|N[D++]<<8|N[D++]<<16|N[D++]<<24;N=b.g[0],D=b.g[1],P=b.g[2];let F=b.g[3],O;O=N+(F^D&(P^F))+U[0]+3614090360&4294967295,N=D+(O<<7&4294967295|O>>>25),O=F+(P^N&(D^P))+U[1]+3905402710&4294967295,F=N+(O<<12&4294967295|O>>>20),O=P+(D^F&(N^D))+U[2]+606105819&4294967295,P=F+(O<<17&4294967295|O>>>15),O=D+(N^P&(F^N))+U[3]+3250441966&4294967295,D=P+(O<<22&4294967295|O>>>10),O=N+(F^D&(P^F))+U[4]+4118548399&4294967295,N=D+(O<<7&4294967295|O>>>25),O=F+(P^N&(D^P))+U[5]+1200080426&4294967295,F=N+(O<<12&4294967295|O>>>20),O=P+(D^F&(N^D))+U[6]+2821735955&4294967295,P=F+(O<<17&4294967295|O>>>15),O=D+(N^P&(F^N))+U[7]+4249261313&4294967295,D=P+(O<<22&4294967295|O>>>10),O=N+(F^D&(P^F))+U[8]+1770035416&4294967295,N=D+(O<<7&4294967295|O>>>25),O=F+(P^N&(D^P))+U[9]+2336552879&4294967295,F=N+(O<<12&4294967295|O>>>20),O=P+(D^F&(N^D))+U[10]+4294925233&4294967295,P=F+(O<<17&4294967295|O>>>15),O=D+(N^P&(F^N))+U[11]+2304563134&4294967295,D=P+(O<<22&4294967295|O>>>10),O=N+(F^D&(P^F))+U[12]+1804603682&4294967295,N=D+(O<<7&4294967295|O>>>25),O=F+(P^N&(D^P))+U[13]+4254626195&4294967295,F=N+(O<<12&4294967295|O>>>20),O=P+(D^F&(N^D))+U[14]+2792965006&4294967295,P=F+(O<<17&4294967295|O>>>15),O=D+(N^P&(F^N))+U[15]+1236535329&4294967295,D=P+(O<<22&4294967295|O>>>10),O=N+(P^F&(D^P))+U[1]+4129170786&4294967295,N=D+(O<<5&4294967295|O>>>27),O=F+(D^P&(N^D))+U[6]+3225465664&4294967295,F=N+(O<<9&4294967295|O>>>23),O=P+(N^D&(F^N))+U[11]+643717713&4294967295,P=F+(O<<14&4294967295|O>>>18),O=D+(F^N&(P^F))+U[0]+3921069994&4294967295,D=P+(O<<20&4294967295|O>>>12),O=N+(P^F&(D^P))+U[5]+3593408605&4294967295,N=D+(O<<5&4294967295|O>>>27),O=F+(D^P&(N^D))+U[10]+38016083&4294967295,F=N+(O<<9&4294967295|O>>>23),O=P+(N^D&(F^N))+U[15]+3634488961&4294967295,P=F+(O<<14&4294967295|O>>>18),O=D+(F^N&(P^F))+U[4]+3889429448&4294967295,D=P+(O<<20&4294967295|O>>>12),O=N+(P^F&(D^P))+U[9]+568446438&4294967295,N=D+(O<<5&4294967295|O>>>27),O=F+(D^P&(N^D))+U[14]+3275163606&4294967295,F=N+(O<<9&4294967295|O>>>23),O=P+(N^D&(F^N))+U[3]+4107603335&4294967295,P=F+(O<<14&4294967295|O>>>18),O=D+(F^N&(P^F))+U[8]+1163531501&4294967295,D=P+(O<<20&4294967295|O>>>12),O=N+(P^F&(D^P))+U[13]+2850285829&4294967295,N=D+(O<<5&4294967295|O>>>27),O=F+(D^P&(N^D))+U[2]+4243563512&4294967295,F=N+(O<<9&4294967295|O>>>23),O=P+(N^D&(F^N))+U[7]+1735328473&4294967295,P=F+(O<<14&4294967295|O>>>18),O=D+(F^N&(P^F))+U[12]+2368359562&4294967295,D=P+(O<<20&4294967295|O>>>12),O=N+(D^P^F)+U[5]+4294588738&4294967295,N=D+(O<<4&4294967295|O>>>28),O=F+(N^D^P)+U[8]+2272392833&4294967295,F=N+(O<<11&4294967295|O>>>21),O=P+(F^N^D)+U[11]+1839030562&4294967295,P=F+(O<<16&4294967295|O>>>16),O=D+(P^F^N)+U[14]+4259657740&4294967295,D=P+(O<<23&4294967295|O>>>9),O=N+(D^P^F)+U[1]+2763975236&4294967295,N=D+(O<<4&4294967295|O>>>28),O=F+(N^D^P)+U[4]+1272893353&4294967295,F=N+(O<<11&4294967295|O>>>21),O=P+(F^N^D)+U[7]+4139469664&4294967295,P=F+(O<<16&4294967295|O>>>16),O=D+(P^F^N)+U[10]+3200236656&4294967295,D=P+(O<<23&4294967295|O>>>9),O=N+(D^P^F)+U[13]+681279174&4294967295,N=D+(O<<4&4294967295|O>>>28),O=F+(N^D^P)+U[0]+3936430074&4294967295,F=N+(O<<11&4294967295|O>>>21),O=P+(F^N^D)+U[3]+3572445317&4294967295,P=F+(O<<16&4294967295|O>>>16),O=D+(P^F^N)+U[6]+76029189&4294967295,D=P+(O<<23&4294967295|O>>>9),O=N+(D^P^F)+U[9]+3654602809&4294967295,N=D+(O<<4&4294967295|O>>>28),O=F+(N^D^P)+U[12]+3873151461&4294967295,F=N+(O<<11&4294967295|O>>>21),O=P+(F^N^D)+U[15]+530742520&4294967295,P=F+(O<<16&4294967295|O>>>16),O=D+(P^F^N)+U[2]+3299628645&4294967295,D=P+(O<<23&4294967295|O>>>9),O=N+(P^(D|~F))+U[0]+4096336452&4294967295,N=D+(O<<6&4294967295|O>>>26),O=F+(D^(N|~P))+U[7]+1126891415&4294967295,F=N+(O<<10&4294967295|O>>>22),O=P+(N^(F|~D))+U[14]+2878612391&4294967295,P=F+(O<<15&4294967295|O>>>17),O=D+(F^(P|~N))+U[5]+4237533241&4294967295,D=P+(O<<21&4294967295|O>>>11),O=N+(P^(D|~F))+U[12]+1700485571&4294967295,N=D+(O<<6&4294967295|O>>>26),O=F+(D^(N|~P))+U[3]+2399980690&4294967295,F=N+(O<<10&4294967295|O>>>22),O=P+(N^(F|~D))+U[10]+4293915773&4294967295,P=F+(O<<15&4294967295|O>>>17),O=D+(F^(P|~N))+U[1]+2240044497&4294967295,D=P+(O<<21&4294967295|O>>>11),O=N+(P^(D|~F))+U[8]+1873313359&4294967295,N=D+(O<<6&4294967295|O>>>26),O=F+(D^(N|~P))+U[15]+4264355552&4294967295,F=N+(O<<10&4294967295|O>>>22),O=P+(N^(F|~D))+U[6]+2734768916&4294967295,P=F+(O<<15&4294967295|O>>>17),O=D+(F^(P|~N))+U[13]+1309151649&4294967295,D=P+(O<<21&4294967295|O>>>11),O=N+(P^(D|~F))+U[4]+4149444226&4294967295,N=D+(O<<6&4294967295|O>>>26),O=F+(D^(N|~P))+U[11]+3174756917&4294967295,F=N+(O<<10&4294967295|O>>>22),O=P+(N^(F|~D))+U[2]+718787259&4294967295,P=F+(O<<15&4294967295|O>>>17),O=D+(F^(P|~N))+U[9]+3951481745&4294967295,b.g[0]=b.g[0]+N&4294967295,b.g[1]=b.g[1]+(P+(O<<21&4294967295|O>>>11))&4294967295,b.g[2]=b.g[2]+P&4294967295,b.g[3]=b.g[3]+F&4294967295}n.prototype.v=function(b,N){N===void 0&&(N=b.length);const D=N-this.blockSize,U=this.C;let P=this.h,F=0;for(;F<N;){if(P==0)for(;F<=D;)i(this,b,F),F+=this.blockSize;if(typeof b=="string"){for(;F<N;)if(U[P++]=b.charCodeAt(F++),P==this.blockSize){i(this,U),P=0;break}}else for(;F<N;)if(U[P++]=b[F++],P==this.blockSize){i(this,U),P=0;break}}this.h=P,this.o+=N},n.prototype.A=function(){var b=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);b[0]=128;for(var N=1;N<b.length-8;++N)b[N]=0;N=this.o*8;for(var D=b.length-8;D<b.length;++D)b[D]=N&255,N/=256;for(this.v(b),b=Array(16),N=0,D=0;D<4;++D)for(let U=0;U<32;U+=8)b[N++]=this.g[D]>>>U&255;return b};function o(b,N){var D=u;return Object.prototype.hasOwnProperty.call(D,b)?D[b]:D[b]=N(b)}function c(b,N){this.h=N;const D=[];let U=!0;for(let P=b.length-1;P>=0;P--){const F=b[P]|0;U&&F==N||(D[P]=F,U=!1)}this.g=D}var u={};function h(b){return-128<=b&&b<128?o(b,function(N){return new c([N|0],N<0?-1:0)}):new c([b|0],b<0?-1:0)}function d(b){if(isNaN(b)||!isFinite(b))return v;if(b<0)return A(d(-b));const N=[];let D=1;for(let U=0;b>=D;U++)N[U]=b/D|0,D*=4294967296;return new c(N,0)}function m(b,N){if(b.length==0)throw Error("number format error: empty string");if(N=N||10,N<2||36<N)throw Error("radix out of range: "+N);if(b.charAt(0)=="-")return A(m(b.substring(1),N));if(b.indexOf("-")>=0)throw Error('number format error: interior "-" character');const D=d(Math.pow(N,8));let U=v;for(let F=0;F<b.length;F+=8){var P=Math.min(8,b.length-F);const O=parseInt(b.substring(F,F+P),N);P<8?(P=d(Math.pow(N,P)),U=U.j(P).add(d(O))):(U=U.j(D),U=U.add(d(O)))}return U}var v=h(0),y=h(1),E=h(16777216);t=c.prototype,t.m=function(){if(T(this))return-A(this).m();let b=0,N=1;for(let D=0;D<this.g.length;D++){const U=this.i(D);b+=(U>=0?U:4294967296+U)*N,N*=4294967296}return b},t.toString=function(b){if(b=b||10,b<2||36<b)throw Error("radix out of range: "+b);if(S(this))return"0";if(T(this))return"-"+A(this).toString(b);const N=d(Math.pow(b,6));var D=this;let U="";for(;;){const P=G(D,N).g;D=B(D,P.j(N));let F=((D.g.length>0?D.g[0]:D.h)>>>0).toString(b);if(D=P,S(D))return F+U;for(;F.length<6;)F="0"+F;U=F+U}},t.i=function(b){return b<0?0:b<this.g.length?this.g[b]:this.h};function S(b){if(b.h!=0)return!1;for(let N=0;N<b.g.length;N++)if(b.g[N]!=0)return!1;return!0}function T(b){return b.h==-1}t.l=function(b){return b=B(this,b),T(b)?-1:S(b)?0:1};function A(b){const N=b.g.length,D=[];for(let U=0;U<N;U++)D[U]=~b.g[U];return new c(D,~b.h).add(y)}t.abs=function(){return T(this)?A(this):this},t.add=function(b){const N=Math.max(this.g.length,b.g.length),D=[];let U=0;for(let P=0;P<=N;P++){let F=U+(this.i(P)&65535)+(b.i(P)&65535),O=(F>>>16)+(this.i(P)>>>16)+(b.i(P)>>>16);U=O>>>16,F&=65535,O&=65535,D[P]=O<<16|F}return new c(D,D[D.length-1]&-2147483648?-1:0)};function B(b,N){return b.add(A(N))}t.j=function(b){if(S(this)||S(b))return v;if(T(this))return T(b)?A(this).j(A(b)):A(A(this).j(b));if(T(b))return A(this.j(A(b)));if(this.l(E)<0&&b.l(E)<0)return d(this.m()*b.m());const N=this.g.length+b.g.length,D=[];for(var U=0;U<2*N;U++)D[U]=0;for(U=0;U<this.g.length;U++)for(let P=0;P<b.g.length;P++){const F=this.i(U)>>>16,O=this.i(U)&65535,we=b.i(P)>>>16,Ce=b.i(P)&65535;D[2*U+2*P]+=O*Ce,I(D,2*U+2*P),D[2*U+2*P+1]+=F*Ce,I(D,2*U+2*P+1),D[2*U+2*P+1]+=O*we,I(D,2*U+2*P+1),D[2*U+2*P+2]+=F*we,I(D,2*U+2*P+2)}for(b=0;b<N;b++)D[b]=D[2*b+1]<<16|D[2*b];for(b=N;b<2*N;b++)D[b]=0;return new c(D,0)};function I(b,N){for(;(b[N]&65535)!=b[N];)b[N+1]+=b[N]>>>16,b[N]&=65535,N++}function C(b,N){this.g=b,this.h=N}function G(b,N){if(S(N))throw Error("division by zero");if(S(b))return new C(v,v);if(T(b))return N=G(A(b),N),new C(A(N.g),A(N.h));if(T(N))return N=G(b,A(N)),new C(A(N.g),N.h);if(b.g.length>30){if(T(b)||T(N))throw Error("slowDivide_ only works with positive integers.");for(var D=y,U=N;U.l(b)<=0;)D=K(D),U=K(U);var P=Y(D,1),F=Y(U,1);for(U=Y(U,2),D=Y(D,2);!S(U);){var O=F.add(U);O.l(b)<=0&&(P=P.add(D),F=O),U=Y(U,1),D=Y(D,1)}return N=B(b,P.j(N)),new C(P,N)}for(P=v;b.l(N)>=0;){for(D=Math.max(1,Math.floor(b.m()/N.m())),U=Math.ceil(Math.log(D)/Math.LN2),U=U<=48?1:Math.pow(2,U-48),F=d(D),O=F.j(N);T(O)||O.l(b)>0;)D-=U,F=d(D),O=F.j(N);S(F)&&(F=y),P=P.add(F),b=B(b,O)}return new C(P,b)}t.B=function(b){return G(this,b).h},t.and=function(b){const N=Math.max(this.g.length,b.g.length),D=[];for(let U=0;U<N;U++)D[U]=this.i(U)&b.i(U);return new c(D,this.h&b.h)},t.or=function(b){const N=Math.max(this.g.length,b.g.length),D=[];for(let U=0;U<N;U++)D[U]=this.i(U)|b.i(U);return new c(D,this.h|b.h)},t.xor=function(b){const N=Math.max(this.g.length,b.g.length),D=[];for(let U=0;U<N;U++)D[U]=this.i(U)^b.i(U);return new c(D,this.h^b.h)};function K(b){const N=b.g.length+1,D=[];for(let U=0;U<N;U++)D[U]=b.i(U)<<1|b.i(U-1)>>>31;return new c(D,b.h)}function Y(b,N){const D=N>>5;N%=32;const U=b.g.length-D,P=[];for(let F=0;F<U;F++)P[F]=N>0?b.i(F+D)>>>N|b.i(F+D+1)<<32-N:b.i(F+D);return new c(P,b.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,OS=n,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.B,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=d,c.fromString=m,ro=c}).apply(typeof D2<"u"?D2:typeof self<"u"?self:typeof window<"u"?window:{});var xh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var FS,zu,MS,Fh,Ng,LS,PS,BS;(function(){var t,e=Object.defineProperty;function r(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof xh=="object"&&xh];for(var _=0;_<p.length;++_){var k=p[_];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var n=r(this);function i(p,_){if(_)e:{var k=n;p=p.split(".");for(var z=0;z<p.length-1;z++){var le=p[z];if(!(le in k))break e;k=k[le]}p=p[p.length-1],z=k[p],_=_(z),_!=z&&_!=null&&e(k,p,{configurable:!0,writable:!0,value:_})}}i("Symbol.dispose",function(p){return p||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(p){return p||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(p){return p||function(_){var k=[],z;for(z in _)Object.prototype.hasOwnProperty.call(_,z)&&k.push([z,_[z]]);return k}});var o=o||{},c=this||self;function u(p){var _=typeof p;return _=="object"&&p!=null||_=="function"}function h(p,_,k){return p.call.apply(p.bind,arguments)}function d(p,_,k){return d=h,d.apply(null,arguments)}function m(p,_){var k=Array.prototype.slice.call(arguments,1);return function(){var z=k.slice();return z.push.apply(z,arguments),p.apply(this,z)}}function v(p,_){function k(){}k.prototype=_.prototype,p.Z=_.prototype,p.prototype=new k,p.prototype.constructor=p,p.Ob=function(z,le,ve){for(var Pe=Array(arguments.length-2),it=2;it<arguments.length;it++)Pe[it-2]=arguments[it];return _.prototype[le].apply(z,Pe)}}var y=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?p=>p&&AsyncContext.Snapshot.wrap(p):p=>p;function E(p){const _=p.length;if(_>0){const k=Array(_);for(let z=0;z<_;z++)k[z]=p[z];return k}return[]}function S(p,_){for(let z=1;z<arguments.length;z++){const le=arguments[z];var k=typeof le;if(k=k!="object"?k:le?Array.isArray(le)?"array":k:"null",k=="array"||k=="object"&&typeof le.length=="number"){k=p.length||0;const ve=le.length||0;p.length=k+ve;for(let Pe=0;Pe<ve;Pe++)p[k+Pe]=le[Pe]}else p.push(le)}}class T{constructor(_,k){this.i=_,this.j=k,this.h=0,this.g=null}get(){let _;return this.h>0?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function A(p){c.setTimeout(()=>{throw p},0)}function B(){var p=b;let _=null;return p.g&&(_=p.g,p.g=p.g.next,p.g||(p.h=null),_.next=null),_}class I{constructor(){this.h=this.g=null}add(_,k){const z=C.get();z.set(_,k),this.h?this.h.next=z:this.g=z,this.h=z}}var C=new T(()=>new G,p=>p.reset());class G{constructor(){this.next=this.g=this.h=null}set(_,k){this.h=_,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let K,Y=!1,b=new I,N=()=>{const p=Promise.resolve(void 0);K=()=>{p.then(D)}};function D(){for(var p;p=B();){try{p.h.call(p.g)}catch(k){A(k)}var _=C;_.j(p),_.h<100&&(_.h++,p.next=_.g,_.g=p)}Y=!1}function U(){this.u=this.u,this.C=this.C}U.prototype.u=!1,U.prototype.dispose=function(){this.u||(this.u=!0,this.N())},U.prototype[Symbol.dispose]=function(){this.dispose()},U.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function P(p,_){this.type=p,this.g=this.target=_,this.defaultPrevented=!1}P.prototype.h=function(){this.defaultPrevented=!0};var F=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var p=!1,_=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const k=()=>{};c.addEventListener("test",k,_),c.removeEventListener("test",k,_)}catch{}return p})();function O(p){return/^[\s\xa0]*$/.test(p)}function we(p,_){P.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p&&this.init(p,_)}v(we,P),we.prototype.init=function(p,_){const k=this.type=p.type,z=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;this.target=p.target||p.srcElement,this.g=_,_=p.relatedTarget,_||(k=="mouseover"?_=p.fromElement:k=="mouseout"&&(_=p.toElement)),this.relatedTarget=_,z?(this.clientX=z.clientX!==void 0?z.clientX:z.pageX,this.clientY=z.clientY!==void 0?z.clientY:z.pageY,this.screenX=z.screenX||0,this.screenY=z.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=p.pointerType,this.state=p.state,this.i=p,p.defaultPrevented&&we.Z.h.call(this)},we.prototype.h=function(){we.Z.h.call(this);const p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var Ce="closure_listenable_"+(Math.random()*1e6|0),ne=0;function me(p,_,k,z,le){this.listener=p,this.proxy=null,this.src=_,this.type=k,this.capture=!!z,this.ha=le,this.key=++ne,this.da=this.fa=!1}function _e(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function ae(p,_,k){for(const z in p)_.call(k,p[z],z,p)}function Le(p,_){for(const k in p)_.call(void 0,p[k],k,p)}function Q(p){const _={};for(const k in p)_[k]=p[k];return _}const L="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function te(p,_){let k,z;for(let le=1;le<arguments.length;le++){z=arguments[le];for(k in z)p[k]=z[k];for(let ve=0;ve<L.length;ve++)k=L[ve],Object.prototype.hasOwnProperty.call(z,k)&&(p[k]=z[k])}}function J(p){this.src=p,this.g={},this.h=0}J.prototype.add=function(p,_,k,z,le){const ve=p.toString();p=this.g[ve],p||(p=this.g[ve]=[],this.h++);const Pe=xe(p,_,z,le);return Pe>-1?(_=p[Pe],k||(_.fa=!1)):(_=new me(_,this.src,ve,!!z,le),_.fa=k,p.push(_)),_};function ee(p,_){const k=_.type;if(k in p.g){var z=p.g[k],le=Array.prototype.indexOf.call(z,_,void 0),ve;(ve=le>=0)&&Array.prototype.splice.call(z,le,1),ve&&(_e(_),p.g[k].length==0&&(delete p.g[k],p.h--))}}function xe(p,_,k,z){for(let le=0;le<p.length;++le){const ve=p[le];if(!ve.da&&ve.listener==_&&ve.capture==!!k&&ve.ha==z)return le}return-1}var Re="closure_lm_"+(Math.random()*1e6|0),Me={};function Ie(p,_,k,z,le){if(Array.isArray(_)){for(let ve=0;ve<_.length;ve++)Ie(p,_[ve],k,z,le);return null}return k=Gt(k),p&&p[Ce]?p.J(_,k,u(z)?!!z.capture:!1,le):Oe(p,_,k,!1,z,le)}function Oe(p,_,k,z,le,ve){if(!_)throw Error("Invalid event type");const Pe=u(le)?!!le.capture:!!le;let it=Je(p);if(it||(p[Re]=it=new J(p)),k=it.add(_,k,z,Pe,ve),k.proxy)return k;if(z=ct(),k.proxy=z,z.src=p,z.listener=k,p.addEventListener)F||(le=Pe),le===void 0&&(le=!1),p.addEventListener(_.toString(),z,le);else if(p.attachEvent)p.attachEvent(nt(_.toString()),z);else if(p.addListener&&p.removeListener)p.addListener(z);else throw Error("addEventListener and attachEvent are unavailable.");return k}function ct(){function p(k){return _.call(p.src,p.listener,k)}const _=Tt;return p}function Z(p,_,k,z,le){if(Array.isArray(_))for(var ve=0;ve<_.length;ve++)Z(p,_[ve],k,z,le);else z=u(z)?!!z.capture:!!z,k=Gt(k),p&&p[Ce]?(p=p.i,ve=String(_).toString(),ve in p.g&&(_=p.g[ve],k=xe(_,k,z,le),k>-1&&(_e(_[k]),Array.prototype.splice.call(_,k,1),_.length==0&&(delete p.g[ve],p.h--)))):p&&(p=Je(p))&&(_=p.g[_.toString()],p=-1,_&&(p=xe(_,k,z,le)),(k=p>-1?_[p]:null)&&Vt(k))}function Vt(p){if(typeof p!="number"&&p&&!p.da){var _=p.src;if(_&&_[Ce])ee(_.i,p);else{var k=p.type,z=p.proxy;_.removeEventListener?_.removeEventListener(k,z,p.capture):_.detachEvent?_.detachEvent(nt(k),z):_.addListener&&_.removeListener&&_.removeListener(z),(k=Je(_))?(ee(k,p),k.h==0&&(k.src=null,_[Re]=null)):_e(p)}}}function nt(p){return p in Me?Me[p]:Me[p]="on"+p}function Tt(p,_){if(p.da)p=!0;else{_=new we(_,this);const k=p.listener,z=p.ha||p.src;p.fa&&Vt(p),p=k.call(z,_)}return p}function Je(p){return p=p[Re],p instanceof J?p:null}var Ve="__closure_events_fn_"+(Math.random()*1e9>>>0);function Gt(p){return typeof p=="function"?p:(p[Ve]||(p[Ve]=function(_){return p.handleEvent(_)}),p[Ve])}function St(){U.call(this),this.i=new J(this),this.M=this,this.G=null}v(St,U),St.prototype[Ce]=!0,St.prototype.removeEventListener=function(p,_,k,z){Z(this,p,_,k,z)};function Dt(p,_){var k,z=p.G;if(z)for(k=[];z;z=z.G)k.push(z);if(p=p.M,z=_.type||_,typeof _=="string")_=new P(_,p);else if(_ instanceof P)_.target=_.target||p;else{var le=_;_=new P(z,p),te(_,le)}le=!0;let ve,Pe;if(k)for(Pe=k.length-1;Pe>=0;Pe--)ve=_.g=k[Pe],le=Lr(ve,z,!0,_)&&le;if(ve=_.g=p,le=Lr(ve,z,!0,_)&&le,le=Lr(ve,z,!1,_)&&le,k)for(Pe=0;Pe<k.length;Pe++)ve=_.g=k[Pe],le=Lr(ve,z,!1,_)&&le}St.prototype.N=function(){if(St.Z.N.call(this),this.i){var p=this.i;for(const _ in p.g){const k=p.g[_];for(let z=0;z<k.length;z++)_e(k[z]);delete p.g[_],p.h--}}this.G=null},St.prototype.J=function(p,_,k,z){return this.i.add(String(p),_,!1,k,z)},St.prototype.K=function(p,_,k,z){return this.i.add(String(p),_,!0,k,z)};function Lr(p,_,k,z){if(_=p.i.g[String(_)],!_)return!0;_=_.concat();let le=!0;for(let ve=0;ve<_.length;++ve){const Pe=_[ve];if(Pe&&!Pe.da&&Pe.capture==k){const it=Pe.listener,dr=Pe.ha||Pe.src;Pe.fa&&ee(p.i,Pe),le=it.call(dr,z)!==!1&&le}}return le&&!z.defaultPrevented}function Ei(p,_){if(typeof p!="function")if(p&&typeof p.handleEvent=="function")p=d(p.handleEvent,p);else throw Error("Invalid listener argument");return Number(_)>2147483647?-1:c.setTimeout(p,_||0)}function Un(p){p.g=Ei(()=>{p.g=null,p.i&&(p.i=!1,Un(p))},p.l);const _=p.h;p.h=null,p.m.apply(null,_)}class Ot extends U{constructor(_,k){super(),this.m=_,this.l=k,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:Un(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Gr(p){U.call(this),this.h=p,this.g={}}v(Gr,U);var bn=[];function ba(p){ae(p.g,function(_,k){this.g.hasOwnProperty(k)&&Vt(_)},p),p.g={}}Gr.prototype.N=function(){Gr.Z.N.call(this),ba(this)},Gr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var er=c.JSON.stringify,Cn=c.JSON.parse,at=class{stringify(p){return c.JSON.stringify(p,void 0)}parse(p){return c.JSON.parse(p,void 0)}};function Yt(){}function qr(){}var Ct={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Qt(){P.call(this,"d")}v(Qt,P);function xn(){P.call(this,"c")}v(xn,P);var ir={},yl=null;function Ti(){return yl=yl||new St}ir.Ia="serverreachability";function Eo(p){P.call(this,ir.Ia,p)}v(Eo,P);function jn(p){const _=Ti();Dt(_,new Eo(_))}ir.STAT_EVENT="statevent";function Si(p,_){P.call(this,ir.STAT_EVENT,p),this.stat=_}v(Si,P);function lr(p){const _=Ti();Dt(_,new Si(_,p))}ir.Ja="timingevent";function vn(p,_){P.call(this,ir.Ja,p),this.size=_}v(vn,P);function oa(p,_){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){p()},_)}function zn(){this.g=!0}zn.prototype.ua=function(){this.g=!1};function qc(p,_,k,z,le,ve){p.info(function(){if(p.g)if(ve){var Pe="",it=ve.split("&");for(let Rt=0;Rt<it.length;Rt++){var dr=it[Rt].split("=");if(dr.length>1){const tr=dr[0];dr=dr[1];const fa=tr.split("_");Pe=fa.length>=2&&fa[1]=="type"?Pe+(tr+"="+dr+"&"):Pe+(tr+"=redacted&")}}}else Pe=null;else Pe=ve;return"XMLHTTP REQ ("+z+") [attempt "+le+"]: "+_+`
`+k+`
`+Pe})}function _l(p,_,k,z,le,ve,Pe){p.info(function(){return"XMLHTTP RESP ("+z+") [ attempt "+le+"]: "+_+`
`+k+`
`+ve+" "+Pe})}function la(p,_,k,z){p.info(function(){return"XMLHTTP TEXT ("+_+"): "+Wc(p,k)+(z?" "+z:"")})}function wi(p,_){p.info(function(){return"TIMEOUT: "+_})}zn.prototype.info=function(){};function Wc(p,_){if(!p.g)return _;if(!_)return null;try{const ve=JSON.parse(_);if(ve){for(p=0;p<ve.length;p++)if(Array.isArray(ve[p])){var k=ve[p];if(!(k.length<2)){var z=k[1];if(Array.isArray(z)&&!(z.length<1)){var le=z[0];if(le!="noop"&&le!="stop"&&le!="close")for(let Pe=1;Pe<z.length;Pe++)z[Pe]=""}}}}return er(ve)}catch{return _}}var Ai={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},bi={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},To;function Ci(){}v(Ci,Yt),Ci.prototype.g=function(){return new XMLHttpRequest},To=new Ci;function Ca(p){return encodeURIComponent(String(p))}function M(p){var _=1;p=p.split(":");const k=[];for(;_>0&&p.length;)k.push(p.shift()),_--;return p.length&&k.push(p.join(":")),k}function W(p,_,k,z){this.j=p,this.i=_,this.l=k,this.S=z||1,this.V=new Gr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new j}function j(){this.i=null,this.g="",this.h=!1}var H={},q={};function X(p,_,k){p.M=1,p.A=So(yr(_)),p.u=k,p.R=!0,ue(p,null)}function ue(p,_){p.F=Date.now(),de(p),p.B=yr(p.A);var k=p.B,z=p.S;Array.isArray(z)||(z=[String(z)]),Tl(k.i,"t",z),p.C=0,k=p.j.L,p.h=new j,p.g=c0(p.j,k?_:null,!p.u),p.P>0&&(p.O=new Ot(d(p.Y,p,p.g),p.P)),_=p.V,k=p.g,z=p.ba;var le="readystatechange";Array.isArray(le)||(le&&(bn[0]=le.toString()),le=bn);for(let ve=0;ve<le.length;ve++){const Pe=Ie(k,le[ve],z||_.handleEvent,!1,_.h||_);if(!Pe)break;_.g[Pe.key]=Pe}_=p.J?Q(p.J):{},p.u?(p.v||(p.v="POST"),_["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.B,p.v,p.u,_)):(p.v="GET",p.g.ea(p.B,p.v,null,_)),jn(),qc(p.i,p.v,p.B,p.l,p.S,p.u)}W.prototype.ba=function(p){p=p.target;const _=this.O;_&&Na(p)==3?_.j():this.Y(p)},W.prototype.Y=function(p){try{if(p==this.g)e:{const it=Na(this.g),dr=this.g.ya(),Rt=this.g.ca();if(!(it<3)&&(it!=3||this.g&&(this.h.h||this.g.la()||Wr(this.g)))){this.K||it!=4||dr==7||(dr==8||Rt<=0?jn(3):jn(2)),Fe(this);var _=this.g.ca();this.X=_;var k=Ee(this);if(this.o=_==200,_l(this.i,this.v,this.B,this.l,this.S,it,_),this.o){if(this.U&&!this.L){t:{if(this.g){var z,le=this.g;if((z=le.g?le.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(z)){var ve=z;break t}}ve=null}if(p=ve)la(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Be(this,p);else{this.o=!1,this.m=3,lr(12),De(this),Ue(this);break e}}if(this.R){p=!0;let tr;for(;!this.K&&this.C<k.length;)if(tr=pe(this,k),tr==q){it==4&&(this.m=4,lr(14),p=!1),la(this.i,this.l,null,"[Incomplete Response]");break}else if(tr==H){this.m=4,lr(15),la(this.i,this.l,k,"[Invalid Chunk]"),p=!1;break}else la(this.i,this.l,tr,null),Be(this,tr);if(fe(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),it!=4||k.length!=0||this.h.h||(this.m=1,lr(16),p=!1),this.o=this.o&&p,!p)la(this.i,this.l,k,"[Invalid Chunked Response]"),De(this),Ue(this);else if(k.length>0&&!this.W){this.W=!0;var Pe=this.j;Pe.g==this&&Pe.aa&&!Pe.P&&(Pe.j.info("Great, no buffering proxy detected. Bytes received: "+k.length),ru(Pe),Pe.P=!0,lr(11))}}else la(this.i,this.l,k,null),Be(this,k);it==4&&De(this),this.o&&!this.K&&(it==4?i0(this.j,this):(this.o=!1,de(this)))}else ki(this.g),_==400&&k.indexOf("Unknown SID")>0?(this.m=3,lr(12)):(this.m=0,lr(13)),De(this),Ue(this)}}}catch{}};function Ee(p){if(!fe(p))return p.g.la();const _=Wr(p.g);if(_==="")return"";let k="";const z=_.length,le=Na(p.g)==4;if(!p.h.i){if(typeof TextDecoder>"u")return De(p),Ue(p),"";p.h.i=new c.TextDecoder}for(let ve=0;ve<z;ve++)p.h.h=!0,k+=p.h.i.decode(_[ve],{stream:!(le&&ve==z-1)});return _.length=0,p.h.g+=k,p.C=0,p.h.g}function fe(p){return p.g?p.v=="GET"&&p.M!=2&&p.j.Aa:!1}function pe(p,_){var k=p.C,z=_.indexOf(`
`,k);return z==-1?q:(k=Number(_.substring(k,z)),isNaN(k)?H:(z+=1,z+k>_.length?q:(_=_.slice(z,z+k),p.C=z+k,_)))}W.prototype.cancel=function(){this.K=!0,De(this)};function de(p){p.T=Date.now()+p.H,Ne(p,p.H)}function Ne(p,_){if(p.D!=null)throw Error("WatchDog timer not null");p.D=oa(d(p.aa,p),_)}function Fe(p){p.D&&(c.clearTimeout(p.D),p.D=null)}W.prototype.aa=function(){this.D=null;const p=Date.now();p-this.T>=0?(wi(this.i,this.B),this.M!=2&&(jn(),lr(17)),De(this),this.m=2,Ue(this)):Ne(this,this.T-p)};function Ue(p){p.j.I==0||p.K||i0(p.j,p)}function De(p){Fe(p);var _=p.O;_&&typeof _.dispose=="function"&&_.dispose(),p.O=null,ba(p.V),p.g&&(_=p.g,p.g=null,_.abort(),_.dispose())}function Be(p,_){try{var k=p.j;if(k.I!=0&&(k.g==p||rn(k.h,p))){if(!p.L&&rn(k.h,p)&&k.I==3){try{var z=k.Ba.g.parse(_)}catch{z=null}if(Array.isArray(z)&&z.length==3){var le=z;if(le[0]==0){e:if(!k.v){if(k.g)if(k.g.F+3e3<p.F)Cl(k),ys(k);else break e;Io(k),lr(18)}}else k.xa=le[1],0<k.xa-k.K&&le[2]<37500&&k.F&&k.A==0&&!k.C&&(k.C=oa(d(k.Va,k),6e3));qt(k.h)<=1&&k.ta&&(k.ta=void 0)}else ai(k,11)}else if((p.L||k.g==p)&&Cl(k),!O(_))for(le=k.Ba.g.parse(_),_=0;_<le.length;_++){let Rt=le[_];const tr=Rt[0];if(!(tr<=k.K))if(k.K=tr,Rt=Rt[1],k.I==2)if(Rt[0]=="c"){k.M=Rt[1],k.ba=Rt[2];const fa=Rt[3];fa!=null&&(k.ka=fa,k.j.info("VER="+k.ka));const ii=Rt[4];ii!=null&&(k.za=ii,k.j.info("SVER="+k.za));const Oa=Rt[5];Oa!=null&&typeof Oa=="number"&&Oa>0&&(z=1.5*Oa,k.O=z,k.j.info("backChannelRequestTimeoutMs_="+z)),z=k;const Fa=p.g;if(Fa){const Do=Fa.g?Fa.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Do){var ve=z.h;ve.g||Do.indexOf("spdy")==-1&&Do.indexOf("quic")==-1&&Do.indexOf("h2")==-1||(ve.j=ve.l,ve.g=new Set,ve.h&&(Ra(ve,ve.h),ve.h=null))}if(z.G){const Rl=Fa.g?Fa.g.getResponseHeader("X-HTTP-Session-Id"):null;Rl&&(z.wa=Rl,Lt(z.J,z.G,Rl))}}k.I=3,k.l&&k.l.ra(),k.aa&&(k.T=Date.now()-p.F,k.j.info("Handshake RTT: "+k.T+"ms")),z=k;var Pe=p;if(z.na=l0(z,z.L?z.ba:null,z.W),Pe.L){ka(z.h,Pe);var it=Pe,dr=z.O;dr&&(it.H=dr),it.D&&(Fe(it),de(it)),z.g=Pe}else n0(z);k.i.length>0&&ni(k)}else Rt[0]!="stop"&&Rt[0]!="close"||ai(k,7);else k.I==3&&(Rt[0]=="stop"||Rt[0]=="close"?Rt[0]=="stop"?ai(k,7):eu(k):Rt[0]!="noop"&&k.l&&k.l.qa(Rt),k.A=0)}}jn(4)}catch{}}var Ge=class{constructor(p,_){this.g=p,this.map=_}};function Ft(p){this.l=p||10,c.PerformanceNavigationTiming?(p=c.performance.getEntriesByType("navigation"),p=p.length>0&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Mt(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function qt(p){return p.h?1:p.g?p.g.size:0}function rn(p,_){return p.h?p.h==_:p.g?p.g.has(_):!1}function Ra(p,_){p.g?p.g.add(_):p.h=_}function ka(p,_){p.h&&p.h==_?p.h=null:p.g&&p.g.has(_)&&p.g.delete(_)}Ft.prototype.cancel=function(){if(this.i=Hn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function Hn(p){if(p.h!=null)return p.i.concat(p.h.G);if(p.g!=null&&p.g.size!==0){let _=p.i;for(const k of p.g.values())_=_.concat(k.G);return _}return E(p.i)}var fs=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function nn(p,_){if(p){p=p.split("&");for(let k=0;k<p.length;k++){const z=p[k].indexOf("=");let le,ve=null;z>=0?(le=p[k].substring(0,z),ve=p[k].substring(z+1)):le=p[k],_(le,ve?decodeURIComponent(ve.replace(/\+/g," ")):"")}}}function Gn(p){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let _;p instanceof Gn?(this.l=p.l,Pr(this,p.j),this.o=p.o,this.g=p.g,hs(this,p.u),this.h=p.h,Yc(this,t0(p.i)),this.m=p.m):p&&(_=String(p).match(fs))?(this.l=!1,Pr(this,_[1]||"",!0),this.o=Za(_[2]||""),this.g=Za(_[3]||"",!0),hs(this,_[4]),this.h=Za(_[5]||"",!0),Yc(this,_[6]||"",!0),this.m=Za(_[7]||"")):(this.l=!1,this.i=new ps(null,this.l))}Gn.prototype.toString=function(){const p=[];var _=this.j;_&&p.push(wo(_,El,!0),":");var k=this.g;return(k||_=="file")&&(p.push("//"),(_=this.o)&&p.push(wo(_,El,!0),"@"),p.push(Ca(k).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.u,k!=null&&p.push(":",String(k))),(k=this.h)&&(this.g&&k.charAt(0)!="/"&&p.push("/"),p.push(wo(k,k.charAt(0)=="/"?Xc:Jf,!0))),(k=this.i.toString())&&p.push("?",k),(k=this.m)&&p.push("#",wo(k,Zf)),p.join("")},Gn.prototype.resolve=function(p){const _=yr(this);let k=!!p.j;k?Pr(_,p.j):k=!!p.o,k?_.o=p.o:k=!!p.g,k?_.g=p.g:k=p.u!=null;var z=p.h;if(k)hs(_,p.u);else if(k=!!p.h){if(z.charAt(0)!="/")if(this.g&&!this.h)z="/"+z;else{var le=_.h.lastIndexOf("/");le!=-1&&(z=_.h.slice(0,le+1)+z)}if(le=z,le==".."||le==".")z="";else if(le.indexOf("./")!=-1||le.indexOf("/.")!=-1){z=le.lastIndexOf("/",0)==0,le=le.split("/");const ve=[];for(let Pe=0;Pe<le.length;){const it=le[Pe++];it=="."?z&&Pe==le.length&&ve.push(""):it==".."?((ve.length>1||ve.length==1&&ve[0]!="")&&ve.pop(),z&&Pe==le.length&&ve.push("")):(ve.push(it),z=!0)}z=ve.join("/")}else z=le}return k?_.h=z:k=p.i.toString()!=="",k?Yc(_,t0(p.i)):k=!!p.m,k&&(_.m=p.m),_};function yr(p){return new Gn(p)}function Pr(p,_,k){p.j=k?Za(_,!0):_,p.j&&(p.j=p.j.replace(/:$/,""))}function hs(p,_){if(_){if(_=Number(_),isNaN(_)||_<0)throw Error("Bad port number "+_);p.u=_}else p.u=null}function Yc(p,_,k){_ instanceof ps?(p.i=_,Sl(p.i,p.l)):(k||(_=wo(_,ds)),p.i=new ps(_,p.l))}function Lt(p,_,k){p.i.set(_,k)}function So(p){return Lt(p,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),p}function Za(p,_){return p?_?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function wo(p,_,k){return typeof p=="string"?(p=encodeURI(p).replace(_,Rn),k&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function Rn(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var El=/[#\/\?@]/g,Jf=/[#\?:]/g,Xc=/[#\?]/g,ds=/[#\?@]/g,Zf=/#/g;function ps(p,_){this.h=this.g=null,this.i=p||null,this.j=!!_}function kn(p){p.g||(p.g=new Map,p.h=0,p.i&&nn(p.i,function(_,k){p.add(decodeURIComponent(_.replace(/\+/g," ")),k)}))}t=ps.prototype,t.add=function(p,_){kn(this),this.i=null,p=ms(this,p);let k=this.g.get(p);return k||this.g.set(p,k=[]),k.push(_),this.h+=1,this};function e0(p,_){kn(p),_=ms(p,_),p.g.has(_)&&(p.i=null,p.h-=p.g.get(_).length,p.g.delete(_))}function Kc(p,_){return kn(p),_=ms(p,_),p.g.has(_)}t.forEach=function(p,_){kn(this),this.g.forEach(function(k,z){k.forEach(function(le){p.call(_,le,z,this)},this)},this)};function $c(p,_){kn(p);let k=[];if(typeof _=="string")Kc(p,_)&&(k=k.concat(p.g.get(ms(p,_))));else for(p=Array.from(p.g.values()),_=0;_<p.length;_++)k=k.concat(p[_]);return k}t.set=function(p,_){return kn(this),this.i=null,p=ms(this,p),Kc(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[_]),this.h+=1,this},t.get=function(p,_){return p?(p=$c(this,p),p.length>0?String(p[0]):_):_};function Tl(p,_,k){e0(p,_),k.length>0&&(p.i=null,p.g.set(ms(p,_),E(k)),p.h+=k.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],_=Array.from(this.g.keys());for(let z=0;z<_.length;z++){var k=_[z];const le=Ca(k);k=$c(this,k);for(let ve=0;ve<k.length;ve++){let Pe=le;k[ve]!==""&&(Pe+="="+Ca(k[ve])),p.push(Pe)}}return this.i=p.join("&")};function t0(p){const _=new ps;return _.i=p.i,p.g&&(_.g=new Map(p.g),_.h=p.h),_}function ms(p,_){return _=String(_),p.j&&(_=_.toLowerCase()),_}function Sl(p,_){_&&!p.j&&(kn(p),p.i=null,p.g.forEach(function(k,z){const le=z.toLowerCase();z!=le&&(e0(this,z),Tl(this,le,k))},p)),p.j=_}function Ia(p,_){const k=new zn;if(c.Image){const z=new Image;z.onload=m(ca,k,"TestLoadImage: loaded",!0,_,z),z.onerror=m(ca,k,"TestLoadImage: error",!1,_,z),z.onabort=m(ca,k,"TestLoadImage: abort",!1,_,z),z.ontimeout=m(ca,k,"TestLoadImage: timeout",!1,_,z),c.setTimeout(function(){z.ontimeout&&z.ontimeout()},1e4),z.src=p}else _(!1)}function Qc(p,_){const k=new zn,z=new AbortController,le=setTimeout(()=>{z.abort(),ca(k,"TestPingServer: timeout",!1,_)},1e4);fetch(p,{signal:z.signal}).then(ve=>{clearTimeout(le),ve.ok?ca(k,"TestPingServer: ok",!0,_):ca(k,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(le),ca(k,"TestPingServer: error",!1,_)})}function ca(p,_,k,z,le){try{le&&(le.onload=null,le.onerror=null,le.onabort=null,le.ontimeout=null),z(k)}catch{}}function gs(){this.g=new at}function ei(p){this.i=p.Sb||null,this.h=p.ab||!1}v(ei,Yt),ei.prototype.g=function(){return new Ao(this.i,this.h)};function Ao(p,_){St.call(this),this.H=p,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v(Ao,St),t=Ao.prototype,t.open=function(p,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=p,this.D=_,this.readyState=1,Da(this)},t.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const _={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};p&&(_.body=p),(this.H||c).fetch(new Request(this.D,_)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,xs(this)),this.readyState=0},t.Pa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,Da(this)),this.g&&(this.readyState=3,Da(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;wl(this)}else p.text().then(this.Oa.bind(this),this.ga.bind(this))};function wl(p){p.j.read().then(p.Ma.bind(p)).catch(p.ga.bind(p))}t.Ma=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var _=p.value?p.value:new Uint8Array(0);(_=this.B.decode(_,{stream:!p.done}))&&(this.response=this.responseText+=_)}p.done?xs(this):Da(this),this.readyState==3&&wl(this)}},t.Oa=function(p){this.g&&(this.response=this.responseText=p,xs(this))},t.Na=function(p){this.g&&(this.response=p,xs(this))},t.ga=function(){this.g&&xs(this)};function xs(p){p.readyState=4,p.l=null,p.j=null,p.B=null,Da(p)}t.setRequestHeader=function(p,_){this.A.append(p,_)},t.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],_=this.h.entries();for(var k=_.next();!k.done;)k=k.value,p.push(k[0]+": "+k[1]),k=_.next();return p.join(`\r
`)};function Da(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(Ao.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function ua(p){let _="";return ae(p,function(k,z){_+=z,_+=":",_+=k,_+=`\r
`}),_}function bo(p,_,k){e:{for(z in k){var z=!1;break e}z=!0}z||(k=ua(k),typeof p=="string"?k!=null&&Ca(k):Lt(p,_,k))}function Ut(p){St.call(this),this.headers=new Map,this.L=p||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(Ut,St);var ti=/^https?$/i,Jc=["POST","PUT"];t=Ut.prototype,t.Fa=function(p){this.H=p},t.ea=function(p,_,k,z){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);_=_?_.toUpperCase():"GET",this.D=p,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():To.g(),this.g.onreadystatechange=y(d(this.Ca,this));try{this.B=!0,this.g.open(_,String(p),!0),this.B=!1}catch(ve){Co(this,ve);return}if(p=k||"",k=new Map(this.headers),z)if(Object.getPrototypeOf(z)===Object.prototype)for(var le in z)k.set(le,z[le]);else if(typeof z.keys=="function"&&typeof z.get=="function")for(const ve of z.keys())k.set(ve,z.get(ve));else throw Error("Unknown input type for opt_headers: "+String(z));z=Array.from(k.keys()).find(ve=>ve.toLowerCase()=="content-type"),le=c.FormData&&p instanceof c.FormData,!(Array.prototype.indexOf.call(Jc,_,void 0)>=0)||z||le||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ve,Pe]of k)this.g.setRequestHeader(ve,Pe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(p),this.v=!1}catch(ve){Co(this,ve)}};function Co(p,_){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=_,p.o=5,Zc(p),Ri(p)}function Zc(p){p.A||(p.A=!0,Dt(p,"complete"),Dt(p,"error"))}t.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=p||7,Dt(this,"complete"),Dt(this,"abort"),Ri(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ri(this,!0)),Ut.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Ro(this):this.Xa())},t.Xa=function(){Ro(this)};function Ro(p){if(p.h&&typeof o<"u"){if(p.v&&Na(p)==4)setTimeout(p.Ca.bind(p),0);else if(Dt(p,"readystatechange"),Na(p)==4){p.h=!1;try{const ve=p.ca();e:switch(ve){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var k;if(!(k=_)){var z;if(z=ve===0){let Pe=String(p.D).match(fs)[1]||null;!Pe&&c.self&&c.self.location&&(Pe=c.self.location.protocol.slice(0,-1)),z=!ti.test(Pe?Pe.toLowerCase():"")}k=z}if(k)Dt(p,"complete"),Dt(p,"success");else{p.o=6;try{var le=Na(p)>2?p.g.statusText:""}catch{le=""}p.l=le+" ["+p.ca()+"]",Zc(p)}}finally{Ri(p)}}}}function Ri(p,_){if(p.g){p.m&&(clearTimeout(p.m),p.m=null);const k=p.g;p.g=null,_||Dt(p,"ready");try{k.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Na(p){return p.g?p.g.readyState:0}t.ca=function(){try{return Na(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(p){if(this.g){var _=this.g.responseText;return p&&_.indexOf(p)==0&&(_=_.substring(p.length)),Cn(_)}};function Wr(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.F){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function ki(p){const _={};p=(p.g&&Na(p)>=2&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let z=0;z<p.length;z++){if(O(p[z]))continue;var k=M(p[z]);const le=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const ve=_[le]||[];_[le]=ve,ve.push(k)}Le(_,function(z){return z.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ri(p,_,k){return k&&k.internalChannelParams&&k.internalChannelParams[p]||_}function vs(p){this.za=0,this.i=[],this.j=new zn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ri("failFast",!1,p),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ri("baseRetryDelayMs",5e3,p),this.Za=ri("retryDelaySeedMs",1e4,p),this.Ta=ri("forwardChannelMaxRetries",2,p),this.va=ri("forwardChannelRequestTimeoutMs",2e4,p),this.ma=p&&p.xmlHttpFactory||void 0,this.Ua=p&&p.Rb||void 0,this.Aa=p&&p.useFetchStreams||!1,this.O=void 0,this.L=p&&p.supportsCrossDomainXhr||!1,this.M="",this.h=new Ft(p&&p.concurrentRequestLimit),this.Ba=new gs,this.S=p&&p.fastHandshake||!1,this.R=p&&p.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=p&&p.Pb||!1,p&&p.ua&&this.j.ua(),p&&p.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&p&&p.detectBufferingProxy||!1,this.ia=void 0,p&&p.longPollingTimeout&&p.longPollingTimeout>0&&(this.ia=p.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=vs.prototype,t.ka=8,t.I=1,t.connect=function(p,_,k,z){lr(0),this.W=p,this.H=_||{},k&&z!==void 0&&(this.H.OSID=k,this.H.OAID=z),this.F=this.X,this.J=l0(this,null,this.W),ni(this)};function eu(p){if(Al(p),p.I==3){var _=p.V++,k=yr(p.J);if(Lt(k,"SID",p.M),Lt(k,"RID",_),Lt(k,"TYPE","terminate"),ko(p,k),_=new W(p,p.j,_),_.M=2,_.A=So(yr(k)),k=!1,c.navigator&&c.navigator.sendBeacon)try{k=c.navigator.sendBeacon(_.A.toString(),"")}catch{}!k&&c.Image&&(new Image().src=_.A,k=!0),k||(_.g=c0(_.j,null),_.g.ea(_.A)),_.F=Date.now(),de(_)}o0(p)}function ys(p){p.g&&(ru(p),p.g.cancel(),p.g=null)}function Al(p){ys(p),p.v&&(c.clearTimeout(p.v),p.v=null),Cl(p),p.h.cancel(),p.m&&(typeof p.m=="number"&&c.clearTimeout(p.m),p.m=null)}function ni(p){if(!Mt(p.h)&&!p.m){p.m=!0;var _=p.Ea;K||N(),Y||(K(),Y=!0),b.add(_,p),p.D=0}}function bl(p,_){return qt(p.h)>=p.h.j-(p.m?1:0)?!1:p.m?(p.i=_.G.concat(p.i),!0):p.I==1||p.I==2||p.D>=(p.Sa?0:p.Ta)?!1:(p.m=oa(d(p.Ea,p,_),s0(p,p.D)),p.D++,!0)}t.Ea=function(p){if(this.m)if(this.m=null,this.I==1){if(!p){this.V=Math.floor(Math.random()*1e5),p=this.V++;const le=new W(this,this.j,p);let ve=this.o;if(this.U&&(ve?(ve=Q(ve),te(ve,this.U)):ve=this.U),this.u!==null||this.R||(le.J=ve,ve=null),this.S)e:{for(var _=0,k=0;k<this.i.length;k++){t:{var z=this.i[k];if("__data__"in z.map&&(z=z.map.__data__,typeof z=="string")){z=z.length;break t}z=void 0}if(z===void 0)break;if(_+=z,_>4096){_=k;break e}if(_===4096||k===this.i.length-1){_=k+1;break e}}_=1e3}else _=1e3;_=r0(this,le,_),k=yr(this.J),Lt(k,"RID",p),Lt(k,"CVER",22),this.G&&Lt(k,"X-HTTP-Session-Id",this.G),ko(this,k),ve&&(this.R?_="headers="+Ca(ua(ve))+"&"+_:this.u&&bo(k,this.u,ve)),Ra(this.h,le),this.Ra&&Lt(k,"TYPE","init"),this.S?(Lt(k,"$req",_),Lt(k,"SID","null"),le.U=!0,X(le,k,null)):X(le,k,_),this.I=2}}else this.I==3&&(p?tu(this,p):this.i.length==0||Mt(this.h)||tu(this))};function tu(p,_){var k;_?k=_.l:k=p.V++;const z=yr(p.J);Lt(z,"SID",p.M),Lt(z,"RID",k),Lt(z,"AID",p.K),ko(p,z),p.u&&p.o&&bo(z,p.u,p.o),k=new W(p,p.j,k,p.D+1),p.u===null&&(k.J=p.o),_&&(p.i=_.G.concat(p.i)),_=r0(p,k,1e3),k.H=Math.round(p.va*.5)+Math.round(p.va*.5*Math.random()),Ra(p.h,k),X(k,z,_)}function ko(p,_){p.H&&ae(p.H,function(k,z){Lt(_,z,k)}),p.l&&ae({},function(k,z){Lt(_,z,k)})}function r0(p,_,k){k=Math.min(p.i.length,k);const z=p.l?d(p.l.Ka,p.l,p):null;e:{var le=p.i;let it=-1;for(;;){const dr=["count="+k];it==-1?k>0?(it=le[0].g,dr.push("ofs="+it)):it=0:dr.push("ofs="+it);let Rt=!0;for(let tr=0;tr<k;tr++){var ve=le[tr].g;const fa=le[tr].map;if(ve-=it,ve<0)it=Math.max(0,le[tr].g-100),Rt=!1;else try{ve="req"+ve+"_"||"";try{var Pe=fa instanceof Map?fa:Object.entries(fa);for(const[ii,Oa]of Pe){let Fa=Oa;u(Oa)&&(Fa=er(Oa)),dr.push(ve+ii+"="+encodeURIComponent(Fa))}}catch(ii){throw dr.push(ve+"type="+encodeURIComponent("_badmap")),ii}}catch{z&&z(fa)}}if(Rt){Pe=dr.join("&");break e}}Pe=void 0}return p=p.i.splice(0,k),_.G=p,Pe}function n0(p){if(!p.g&&!p.v){p.Y=1;var _=p.Da;K||N(),Y||(K(),Y=!0),b.add(_,p),p.A=0}}function Io(p){return p.g||p.v||p.A>=3?!1:(p.Y++,p.v=oa(d(p.Da,p),s0(p,p.A)),p.A++,!0)}t.Da=function(){if(this.v=null,a0(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var p=4*this.T;this.j.info("BP detection timer enabled: "+p),this.B=oa(d(this.Wa,this),p)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,lr(10),ys(this),a0(this))};function ru(p){p.B!=null&&(c.clearTimeout(p.B),p.B=null)}function a0(p){p.g=new W(p,p.j,"rpc",p.Y),p.u===null&&(p.g.J=p.o),p.g.P=0;var _=yr(p.na);Lt(_,"RID","rpc"),Lt(_,"SID",p.M),Lt(_,"AID",p.K),Lt(_,"CI",p.F?"0":"1"),!p.F&&p.ia&&Lt(_,"TO",p.ia),Lt(_,"TYPE","xmlhttp"),ko(p,_),p.u&&p.o&&bo(_,p.u,p.o),p.O&&(p.g.H=p.O);var k=p.g;p=p.ba,k.M=1,k.A=So(yr(_)),k.u=null,k.R=!0,ue(k,p)}t.Va=function(){this.C!=null&&(this.C=null,ys(this),Io(this),lr(19))};function Cl(p){p.C!=null&&(c.clearTimeout(p.C),p.C=null)}function i0(p,_){var k=null;if(p.g==_){Cl(p),ru(p),p.g=null;var z=2}else if(rn(p.h,_))k=_.G,ka(p.h,_),z=1;else return;if(p.I!=0){if(_.o)if(z==1){k=_.u?_.u.length:0,_=Date.now()-_.F;var le=p.D;z=Ti(),Dt(z,new vn(z,k)),ni(p)}else n0(p);else if(le=_.m,le==3||le==0&&_.X>0||!(z==1&&bl(p,_)||z==2&&Io(p)))switch(k&&k.length>0&&(_=p.h,_.i=_.i.concat(k)),le){case 1:ai(p,5);break;case 4:ai(p,10);break;case 3:ai(p,6);break;default:ai(p,2)}}}function s0(p,_){let k=p.Qa+Math.floor(Math.random()*p.Za);return p.isActive()||(k*=2),k*_}function ai(p,_){if(p.j.info("Error code "+_),_==2){var k=d(p.bb,p),z=p.Ua;const le=!z;z=new Gn(z||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Pr(z,"https"),So(z),le?Ia(z.toString(),k):Qc(z.toString(),k)}else lr(2);p.I=0,p.l&&p.l.pa(_),o0(p),Al(p)}t.bb=function(p){p?(this.j.info("Successfully pinged google.com"),lr(2)):(this.j.info("Failed to ping google.com"),lr(1))};function o0(p){if(p.I=0,p.ja=[],p.l){const _=Hn(p.h);(_.length!=0||p.i.length!=0)&&(S(p.ja,_),S(p.ja,p.i),p.h.i.length=0,E(p.i),p.i.length=0),p.l.oa()}}function l0(p,_,k){var z=k instanceof Gn?yr(k):new Gn(k);if(z.g!="")_&&(z.g=_+"."+z.g),hs(z,z.u);else{var le=c.location;z=le.protocol,_=_?_+"."+le.hostname:le.hostname,le=+le.port;const ve=new Gn(null);z&&Pr(ve,z),_&&(ve.g=_),le&&hs(ve,le),k&&(ve.h=k),z=ve}return k=p.G,_=p.wa,k&&_&&Lt(z,k,_),Lt(z,"VER",p.ka),ko(p,z),z}function c0(p,_,k){if(_&&!p.L)throw Error("Can't create secondary domain capable XhrIo object.");return _=p.Aa&&!p.ma?new Ut(new ei({ab:k})):new Ut(p.ma),_.Fa(p.L),_}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function u0(){}t=u0.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function _s(){}_s.prototype.g=function(p,_){return new yn(p,_)};function yn(p,_){St.call(this),this.g=new vs(_),this.l=p,this.h=_&&_.messageUrlParams||null,p=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(p?p["X-WebChannel-Content-Type"]=_.messageContentType:p={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.sa&&(p?p["X-WebChannel-Client-Profile"]=_.sa:p={"X-WebChannel-Client-Profile":_.sa}),this.g.U=p,(p=_&&_.Qb)&&!O(p)&&(this.g.u=p),this.A=_&&_.supportsCrossDomainXhr||!1,this.v=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!O(_)&&(this.g.G=_,p=this.h,p!==null&&_ in p&&(p=this.h,_ in p&&delete p[_])),this.j=new Ii(this)}v(yn,St),yn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},yn.prototype.close=function(){eu(this.g)},yn.prototype.o=function(p){var _=this.g;if(typeof p=="string"){var k={};k.__data__=p,p=k}else this.v&&(k={},k.__data__=er(p),p=k);_.i.push(new Ge(_.Ya++,p)),_.I==3&&ni(_)},yn.prototype.N=function(){this.g.l=null,delete this.j,eu(this.g),delete this.g,yn.Z.N.call(this)};function f0(p){Qt.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var _=p.__sm__;if(_){e:{for(const k in _){p=k;break e}p=void 0}(this.i=p)&&(p=this.i,_=_!==null&&p in _?_[p]:void 0),this.data=_}else this.data=p}v(f0,Qt);function h0(){xn.call(this),this.status=1}v(h0,xn);function Ii(p){this.g=p}v(Ii,u0),Ii.prototype.ra=function(){Dt(this.g,"a")},Ii.prototype.qa=function(p){Dt(this.g,new f0(p))},Ii.prototype.pa=function(p){Dt(this.g,new h0)},Ii.prototype.oa=function(){Dt(this.g,"b")},_s.prototype.createWebChannel=_s.prototype.g,yn.prototype.send=yn.prototype.o,yn.prototype.open=yn.prototype.m,yn.prototype.close=yn.prototype.close,BS=function(){return new _s},PS=function(){return Ti()},LS=ir,Ng={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ai.NO_ERROR=0,Ai.TIMEOUT=8,Ai.HTTP_ERROR=6,Fh=Ai,bi.COMPLETE="complete",MS=bi,qr.EventType=Ct,Ct.OPEN="a",Ct.CLOSE="b",Ct.ERROR="c",Ct.MESSAGE="d",St.prototype.listen=St.prototype.J,zu=qr,Ut.prototype.listenOnce=Ut.prototype.K,Ut.prototype.getLastError=Ut.prototype.Ha,Ut.prototype.getLastErrorCode=Ut.prototype.ya,Ut.prototype.getStatus=Ut.prototype.ca,Ut.prototype.getResponseJson=Ut.prototype.La,Ut.prototype.getResponseText=Ut.prototype.la,Ut.prototype.send=Ut.prototype.ea,Ut.prototype.setWithCredentials=Ut.prototype.Fa,FS=Ut}).apply(typeof xh<"u"?xh:typeof self<"u"?self:typeof window<"u"?window:{});const N2="@firebase/firestore",O2="4.9.3";class ln{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ln.UNAUTHENTICATED=new ln(null),ln.GOOGLE_CREDENTIALS=new ln("google-credentials-uid"),ln.FIRST_PARTY=new ln("first-party-uid"),ln.MOCK_USER=new ln("mock-user");let Mc="12.7.0";const nl=new _1("@firebase/firestore");function ic(){return nl.logLevel}function ze(t,...e){if(nl.logLevel<=pt.DEBUG){const r=e.map(S1);nl.debug(`Firestore (${Mc}): ${t}`,...r)}}function ns(t,...e){if(nl.logLevel<=pt.ERROR){const r=e.map(S1);nl.error(`Firestore (${Mc}): ${t}`,...r)}}function al(t,...e){if(nl.logLevel<=pt.WARN){const r=e.map(S1);nl.warn(`Firestore (${Mc}): ${t}`,...r)}}function S1(t){if(typeof t=="string")return t;try{return(function(r){return JSON.stringify(r)})(t)}catch{return t}}function Ke(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,VS(t,n,r)}function VS(t,e,r){let n=`FIRESTORE (${Mc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw ns(n),new Error(n)}function Nt(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||VS(e,i,n)}function rt(t,e){return t}const be={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class je extends cs{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class no{constructor(){this.promise=new Promise(((e,r)=>{this.resolve=e,this.reject=r}))}}class US{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class jS{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable((()=>r(ln.UNAUTHENTICATED)))}shutdown(){}}class OI{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable((()=>r(this.token.user)))}shutdown(){this.changeListener=null}}class FI{constructor(e){this.t=e,this.currentUser=ln.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Nt(this.o===void 0,42304);let n=this.i;const i=h=>this.i!==n?(n=this.i,r(h)):Promise.resolve();let o=new no;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new no,e.enqueueRetryable((()=>i(this.currentUser)))};const c=()=>{const h=o;e.enqueueRetryable((async()=>{await h.promise,await i(this.currentUser)}))},u=h=>{ze("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((h=>u(h))),setTimeout((()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?u(h):(ze("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new no)}}),0),c()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then((n=>this.i!==e?(ze("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Nt(typeof n.accessToken=="string",31837,{l:n}),new US(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Nt(e===null||typeof e=="string",2055,{h:e}),new ln(e)}}class MI{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=ln.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class LI{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new MI(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable((()=>r(ln.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class F2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class PI{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ja(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Nt(this.o===void 0,3512);const n=o=>{o.error!=null&&ze("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const c=o.token!==this.m;return this.m=o.token,ze("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?r(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable((()=>n(o)))};const i=o=>{ze("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((o=>i(o))),setTimeout((()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):ze("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new F2(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((r=>r?(Nt(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new F2(r.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function BI(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}class Cd{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=BI(40);for(let o=0;o<i.length;++o)n.length<20&&i[o]<r&&(n+=e.charAt(i[o]%62))}return n}}function mt(t,e){return t<e?-1:t>e?1:0}function Og(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const i=t.charAt(n),o=e.charAt(n);if(i!==o)return og(i)===og(o)?mt(i,o):og(i)?1:-1}return mt(t.length,e.length)}const VI=55296,UI=57343;function og(t){const e=t.charCodeAt(0);return e>=VI&&e<=UI}function _c(t,e,r){return t.length===e.length&&t.every(((n,i)=>r(n,e[i])))}const M2="__name__";class hi{constructor(e,r,n){r===void 0?r=0:r>e.length&&Ke(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&Ke(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return hi.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof hi?e.forEach((n=>{r.push(n)})):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const o=hi.compareSegments(e.get(i),r.get(i));if(o!==0)return o}return mt(e.length,r.length)}static compareSegments(e,r){const n=hi.isNumericId(e),i=hi.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?hi.extractNumericId(e).compare(hi.extractNumericId(r)):Og(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ro.fromString(e.substring(4,e.length-2))}}class Xt extends hi{construct(e,r,n){return new Xt(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new je(be.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter((i=>i.length>0)))}return new Xt(r)}static emptyPath(){return new Xt([])}}const jI=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class jr extends hi{construct(e,r,n){return new jr(e,r,n)}static isValidIdentifier(e){return jI.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),jr.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===M2}static keyField(){return new jr([M2])}static fromServerFormat(e){const r=[];let n="",i=0;const o=()=>{if(n.length===0)throw new je(be.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let c=!1;for(;i<e.length;){const u=e[i];if(u==="\\"){if(i+1===e.length)throw new je(be.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new je(be.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=h,i+=2}else u==="`"?(c=!c,i++):u!=="."||c?(n+=u,i++):(o(),i++)}if(o(),c)throw new je(be.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new jr(r)}static emptyPath(){return new jr([])}}class We{constructor(e){this.path=e}static fromPath(e){return new We(Xt.fromString(e))}static fromName(e){return new We(Xt.fromString(e).popFirst(5))}static empty(){return new We(Xt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Xt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Xt.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new We(new Xt(e.slice()))}}function zS(t,e,r){if(!r)throw new je(be.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function HS(t,e,r,n){if(e===!0&&n===!0)throw new je(be.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function L2(t){if(!We.isDocumentKey(t))throw new je(be.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function P2(t){if(We.isDocumentKey(t))throw new je(be.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function GS(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Rd(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ke(12329,{type:typeof t})}function Sa(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new je(be.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Rd(t);throw new je(be.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}function kr(t,e){const r={typeString:t};return e&&(r.value=e),r}function Nf(t,e){if(!GS(t))throw new je(be.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,o="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const c=t[n];if(i&&typeof c!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(o!==void 0&&c!==o.value){r=`Expected '${n}' field to equal '${o.value}'`;break}}if(r)throw new je(be.INVALID_ARGUMENT,r);return!0}const B2=-62135596800,V2=1e6;class Kt{static now(){return Kt.fromMillis(Date.now())}static fromDate(e){return Kt.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*V2);return new Kt(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new je(be.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new je(be.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<B2)throw new je(be.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new je(be.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/V2}_compareTo(e){return this.seconds===e.seconds?mt(this.nanoseconds,e.nanoseconds):mt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Kt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Nf(e,Kt._jsonSchema))return new Kt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-B2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Kt._jsonSchemaVersion="firestore/timestamp/1.0",Kt._jsonSchema={type:kr("string",Kt._jsonSchemaVersion),seconds:kr("number"),nanoseconds:kr("number")};class Ze{static fromTimestamp(e){return new Ze(e)}static min(){return new Ze(new Kt(0,0))}static max(){return new Ze(new Kt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const pf=-1;function zI(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=Ze.fromTimestamp(n===1e9?new Kt(r+1,0):new Kt(r,n));return new lo(i,We.empty(),e)}function HI(t){return new lo(t.readTime,t.key,pf)}class lo{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new lo(Ze.min(),We.empty(),pf)}static max(){return new lo(Ze.max(),We.empty(),pf)}}function GI(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=We.comparator(t.documentKey,e.documentKey),r!==0?r:mt(t.largestBatchId,e.largestBatchId))}const qI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class WI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Lc(t){if(t.code!==be.FAILED_PRECONDITION||t.message!==qI)throw t;ze("LocalStore","Unexpectedly lost primary lease")}class ke{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)}),(r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)}))}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Ke(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new ke(((n,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,i)},this.catchCallback=o=>{this.wrapFailure(r,o).next(n,i)}}))}toPromise(){return new Promise(((e,r)=>{this.next(e,r)}))}wrapUserFunction(e){try{const r=e();return r instanceof ke?r:ke.resolve(r)}catch(r){return ke.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction((()=>e(r))):ke.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction((()=>e(r))):ke.reject(r)}static resolve(e){return new ke(((r,n)=>{r(e)}))}static reject(e){return new ke(((r,n)=>{n(e)}))}static waitFor(e){return new ke(((r,n)=>{let i=0,o=0,c=!1;e.forEach((u=>{++i,u.next((()=>{++o,c&&o===i&&r()}),(h=>n(h)))})),c=!0,o===i&&r()}))}static or(e){let r=ke.resolve(!1);for(const n of e)r=r.next((i=>i?ke.resolve(i):n()));return r}static forEach(e,r){const n=[];return e.forEach(((i,o)=>{n.push(r.call(this,i,o))})),this.waitFor(n)}static mapArray(e,r){return new ke(((n,i)=>{const o=e.length,c=new Array(o);let u=0;for(let h=0;h<o;h++){const d=h;r(e[d]).next((m=>{c[d]=m,++u,u===o&&n(c)}),(m=>i(m)))}}))}static doWhile(e,r){return new ke(((n,i)=>{const o=()=>{e()===!0?r().next((()=>{o()}),i):n()};o()}))}}function YI(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Pc(t){return t.name==="IndexedDbTransactionError"}class kd{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}kd.ce=-1;const w1=-1;function Id(t){return t==null}function Yh(t){return t===0&&1/t==-1/0}function XI(t){return typeof t=="number"&&Number.isInteger(t)&&!Yh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const qS="";function KI(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=U2(e)),e=$I(t.get(r),e);return U2(e)}function $I(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const o=t.charAt(i);switch(o){case"\0":r+="";break;case qS:r+="";break;default:r+=o}}return r}function U2(t){return t+qS+""}function j2(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function xo(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function WS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class or{constructor(e,r){this.comparator=e,this.root=r||Qr.EMPTY}insert(e,r){return new or(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Qr.BLACK,null,null))}remove(e){return new or(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Qr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((r,n)=>(e(r,n),!1)))}toString(){const e=[];return this.inorderTraversal(((r,n)=>(e.push(`${r}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new vh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new vh(this.root,e,this.comparator,!1)}getReverseIterator(){return new vh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new vh(this.root,e,this.comparator,!0)}}class vh{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=r?n(e.key,r):1,r&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Qr{constructor(e,r,n,i,o){this.key=e,this.value=r,this.color=n??Qr.RED,this.left=i??Qr.EMPTY,this.right=o??Qr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,o){return new Qr(e??this.key,r??this.value,n??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const o=n(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,r,n),null):o===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Qr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return Qr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Qr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Qr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ke(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ke(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ke(27949);return e+(this.isRed()?0:1)}}Qr.EMPTY=null,Qr.RED=!0,Qr.BLACK=!1;Qr.EMPTY=new class{constructor(){this.size=0}get key(){throw Ke(57766)}get value(){throw Ke(16141)}get color(){throw Ke(16727)}get left(){throw Ke(29726)}get right(){throw Ke(36894)}copy(e,r,n,i,o){return this}insert(e,r,n){return new Qr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Or{constructor(e){this.comparator=e,this.data=new or(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((r,n)=>(e(r),!1)))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new z2(this.data.getIterator())}getIteratorFrom(e){return new z2(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach((n=>{r=r.add(n)})),r}isEqual(e){if(!(e instanceof Or)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((r=>{e.push(r)})),e}toString(){const e=[];return this.forEach((r=>e.push(r))),"SortedSet("+e.toString()+")"}copy(e){const r=new Or(this.comparator);return r.data=e,r}}class z2{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class ta{constructor(e){this.fields=e,e.sort(jr.comparator)}static empty(){return new ta([])}unionWith(e){let r=new Or(jr.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new ta(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return _c(this.fields,e.fields,((r,n)=>r.isEqual(n)))}}class YS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Hr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=(function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new YS("Invalid base64 string: "+o):o}})(e);return new Hr(r)}static fromUint8Array(e){const r=(function(i){let o="";for(let c=0;c<i.length;++c)o+=String.fromCharCode(i[c]);return o})(e);return new Hr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(r){return btoa(r)})(this.binaryString)}toUint8Array(){return(function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return mt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Hr.EMPTY_BYTE_STRING=new Hr("");const QI=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function co(t){if(Nt(!!t,39018),typeof t=="string"){let e=0;const r=QI.exec(t);if(Nt(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:xr(t.seconds),nanos:xr(t.nanos)}}function xr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function uo(t){return typeof t=="string"?Hr.fromBase64String(t):Hr.fromUint8Array(t)}const XS="server_timestamp",KS="__type__",$S="__previous_value__",QS="__local_write_time__";function A1(t){return(t?.mapValue?.fields||{})[KS]?.stringValue===XS}function Dd(t){const e=t.mapValue.fields[$S];return A1(e)?Dd(e):e}function mf(t){const e=co(t.mapValue.fields[QS].timestampValue);return new Kt(e.seconds,e.nanos)}class JI{constructor(e,r,n,i,o,c,u,h,d,m){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=o,this.forceLongPolling=c,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=d,this.isUsingEmulator=m}}const Xh="(default)";class Ec{constructor(e,r){this.projectId=e,this.database=r||Xh}static empty(){return new Ec("","")}get isDefaultDatabase(){return this.database===Xh}isEqual(e){return e instanceof Ec&&e.projectId===this.projectId&&e.database===this.database}}const JS="__type__",ZI="__max__",yh={mapValue:{}},ZS="__vector__",Kh="value";function fo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?A1(t)?4:tD(t)?9007199254740991:eD(t)?10:11:Ke(28295,{value:t})}function gi(t,e){if(t===e)return!0;const r=fo(t);if(r!==fo(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return mf(t).isEqual(mf(e));case 3:return(function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const c=co(i.timestampValue),u=co(o.timestampValue);return c.seconds===u.seconds&&c.nanos===u.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(i,o){return uo(i.bytesValue).isEqual(uo(o.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(i,o){return xr(i.geoPointValue.latitude)===xr(o.geoPointValue.latitude)&&xr(i.geoPointValue.longitude)===xr(o.geoPointValue.longitude)})(t,e);case 2:return(function(i,o){if("integerValue"in i&&"integerValue"in o)return xr(i.integerValue)===xr(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const c=xr(i.doubleValue),u=xr(o.doubleValue);return c===u?Yh(c)===Yh(u):isNaN(c)&&isNaN(u)}return!1})(t,e);case 9:return _c(t.arrayValue.values||[],e.arrayValue.values||[],gi);case 10:case 11:return(function(i,o){const c=i.mapValue.fields||{},u=o.mapValue.fields||{};if(j2(c)!==j2(u))return!1;for(const h in c)if(c.hasOwnProperty(h)&&(u[h]===void 0||!gi(c[h],u[h])))return!1;return!0})(t,e);default:return Ke(52216,{left:t})}}function gf(t,e){return(t.values||[]).find((r=>gi(r,e)))!==void 0}function Tc(t,e){if(t===e)return 0;const r=fo(t),n=fo(e);if(r!==n)return mt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return mt(t.booleanValue,e.booleanValue);case 2:return(function(o,c){const u=xr(o.integerValue||o.doubleValue),h=xr(c.integerValue||c.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1})(t,e);case 3:return H2(t.timestampValue,e.timestampValue);case 4:return H2(mf(t),mf(e));case 5:return Og(t.stringValue,e.stringValue);case 6:return(function(o,c){const u=uo(o),h=uo(c);return u.compareTo(h)})(t.bytesValue,e.bytesValue);case 7:return(function(o,c){const u=o.split("/"),h=c.split("/");for(let d=0;d<u.length&&d<h.length;d++){const m=mt(u[d],h[d]);if(m!==0)return m}return mt(u.length,h.length)})(t.referenceValue,e.referenceValue);case 8:return(function(o,c){const u=mt(xr(o.latitude),xr(c.latitude));return u!==0?u:mt(xr(o.longitude),xr(c.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return G2(t.arrayValue,e.arrayValue);case 10:return(function(o,c){const u=o.fields||{},h=c.fields||{},d=u[Kh]?.arrayValue,m=h[Kh]?.arrayValue,v=mt(d?.values?.length||0,m?.values?.length||0);return v!==0?v:G2(d,m)})(t.mapValue,e.mapValue);case 11:return(function(o,c){if(o===yh.mapValue&&c===yh.mapValue)return 0;if(o===yh.mapValue)return 1;if(c===yh.mapValue)return-1;const u=o.fields||{},h=Object.keys(u),d=c.fields||{},m=Object.keys(d);h.sort(),m.sort();for(let v=0;v<h.length&&v<m.length;++v){const y=Og(h[v],m[v]);if(y!==0)return y;const E=Tc(u[h[v]],d[m[v]]);if(E!==0)return E}return mt(h.length,m.length)})(t.mapValue,e.mapValue);default:throw Ke(23264,{he:r})}}function H2(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return mt(t,e);const r=co(t),n=co(e),i=mt(r.seconds,n.seconds);return i!==0?i:mt(r.nanos,n.nanos)}function G2(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const o=Tc(r[i],n[i]);if(o)return o}return mt(r.length,n.length)}function Sc(t){return Fg(t)}function Fg(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(r){const n=co(r);return`time(${n.seconds},${n.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(r){return uo(r).toBase64()})(t.bytesValue):"referenceValue"in t?(function(r){return We.fromName(r).toString()})(t.referenceValue):"geoPointValue"in t?(function(r){return`geo(${r.latitude},${r.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(r){let n="[",i=!0;for(const o of r.values||[])i?i=!1:n+=",",n+=Fg(o);return n+"]"})(t.arrayValue):"mapValue"in t?(function(r){const n=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const c of n)o?o=!1:i+=",",i+=`${c}:${Fg(r.fields[c])}`;return i+"}"})(t.mapValue):Ke(61005,{value:t})}function Mh(t){switch(fo(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Dd(t);return e?16+Mh(e):16;case 5:return 2*t.stringValue.length;case 6:return uo(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((i,o)=>i+Mh(o)),0)})(t.arrayValue);case 10:case 11:return(function(n){let i=0;return xo(n.fields,((o,c)=>{i+=o.length+Mh(c)})),i})(t.mapValue);default:throw Ke(13486,{value:t})}}function q2(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Mg(t){return!!t&&"integerValue"in t}function b1(t){return!!t&&"arrayValue"in t}function W2(t){return!!t&&"nullValue"in t}function Y2(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Lh(t){return!!t&&"mapValue"in t}function eD(t){return(t?.mapValue?.fields||{})[JS]?.stringValue===ZS}function $u(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return xo(t.mapValue.fields,((r,n)=>e.mapValue.fields[r]=$u(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=$u(t.arrayValue.values[r]);return e}return{...t}}function tD(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===ZI}class Bn{constructor(e){this.value=e}static empty(){return new Bn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Lh(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=$u(r)}setAll(e){let r=jr.emptyPath(),n={},i=[];e.forEach(((c,u)=>{if(!r.isImmediateParentOf(u)){const h=this.getFieldsMap(r);this.applyChanges(h,n,i),n={},i=[],r=u.popLast()}c?n[u.lastSegment()]=$u(c):i.push(u.lastSegment())}));const o=this.getFieldsMap(r);this.applyChanges(o,n,i)}delete(e){const r=this.field(e.popLast());Lh(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return gi(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];Lh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){xo(r,((i,o)=>e[i]=o));for(const i of n)delete e[i]}clone(){return new Bn($u(this.value))}}function ew(t){const e=[];return xo(t.fields,((r,n)=>{const i=new jr([r]);if(Lh(n)){const o=ew(n.mapValue).fields;if(o.length===0)e.push(i);else for(const c of o)e.push(i.child(c))}else e.push(i)})),new ta(e)}class un{constructor(e,r,n,i,o,c,u){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=o,this.data=c,this.documentState=u}static newInvalidDocument(e){return new un(e,0,Ze.min(),Ze.min(),Ze.min(),Bn.empty(),0)}static newFoundDocument(e,r,n,i){return new un(e,1,r,Ze.min(),n,i,0)}static newNoDocument(e,r){return new un(e,2,r,Ze.min(),Ze.min(),Bn.empty(),0)}static newUnknownDocument(e,r){return new un(e,3,r,Ze.min(),Ze.min(),Bn.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Ze.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Bn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Bn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ze.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof un&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new un(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class $h{constructor(e,r){this.position=e,this.inclusive=r}}function X2(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const o=e[i],c=t.position[i];if(o.field.isKeyField()?n=We.comparator(We.fromName(c.referenceValue),r.key):n=Tc(c,r.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function K2(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!gi(t.position[r],e.position[r]))return!1;return!0}class Qh{constructor(e,r="asc"){this.field=e,this.dir=r}}function rD(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class tw{}class Rr extends tw{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new aD(e,r,n):r==="array-contains"?new oD(e,n):r==="in"?new lD(e,n):r==="not-in"?new cD(e,n):r==="array-contains-any"?new uD(e,n):new Rr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new iD(e,n):new sD(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(Tc(r,this.value)):r!==null&&fo(this.value)===fo(r)&&this.matchesComparison(Tc(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ke(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Qa extends tw{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new Qa(e,r)}matches(e){return rw(this)?this.filters.find((r=>!r.matches(e)))===void 0:this.filters.find((r=>r.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,r)=>e.concat(r.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function rw(t){return t.op==="and"}function nw(t){return nD(t)&&rw(t)}function nD(t){for(const e of t.filters)if(e instanceof Qa)return!1;return!0}function Lg(t){if(t instanceof Rr)return t.field.canonicalString()+t.op.toString()+Sc(t.value);if(nw(t))return t.filters.map((e=>Lg(e))).join(",");{const e=t.filters.map((r=>Lg(r))).join(",");return`${t.op}(${e})`}}function aw(t,e){return t instanceof Rr?(function(n,i){return i instanceof Rr&&n.op===i.op&&n.field.isEqual(i.field)&&gi(n.value,i.value)})(t,e):t instanceof Qa?(function(n,i){return i instanceof Qa&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce(((o,c,u)=>o&&aw(c,i.filters[u])),!0):!1})(t,e):void Ke(19439)}function iw(t){return t instanceof Rr?(function(r){return`${r.field.canonicalString()} ${r.op} ${Sc(r.value)}`})(t):t instanceof Qa?(function(r){return r.op.toString()+" {"+r.getFilters().map(iw).join(" ,")+"}"})(t):"Filter"}class aD extends Rr{constructor(e,r,n){super(e,r,n),this.key=We.fromName(n.referenceValue)}matches(e){const r=We.comparator(e.key,this.key);return this.matchesComparison(r)}}class iD extends Rr{constructor(e,r){super(e,"in",r),this.keys=sw("in",r)}matches(e){return this.keys.some((r=>r.isEqual(e.key)))}}class sD extends Rr{constructor(e,r){super(e,"not-in",r),this.keys=sw("not-in",r)}matches(e){return!this.keys.some((r=>r.isEqual(e.key)))}}function sw(t,e){return(e.arrayValue?.values||[]).map((r=>We.fromName(r.referenceValue)))}class oD extends Rr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return b1(r)&&gf(r.arrayValue,this.value)}}class lD extends Rr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&gf(this.value.arrayValue,r)}}class cD extends Rr{constructor(e,r){super(e,"not-in",r)}matches(e){if(gf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!gf(this.value.arrayValue,r)}}class uD extends Rr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!b1(r)||!r.arrayValue.values)&&r.arrayValue.values.some((n=>gf(this.value.arrayValue,n)))}}class fD{constructor(e,r=null,n=[],i=[],o=null,c=null,u=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=o,this.startAt=c,this.endAt=u,this.Te=null}}function $2(t,e=null,r=[],n=[],i=null,o=null,c=null){return new fD(t,e,r,n,i,o,c)}function C1(t){const e=rt(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map((n=>Lg(n))).join(","),r+="|ob:",r+=e.orderBy.map((n=>(function(o){return o.field.canonicalString()+o.dir})(n))).join(","),Id(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map((n=>Sc(n))).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map((n=>Sc(n))).join(",")),e.Te=r}return e.Te}function R1(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!rD(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!aw(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!K2(t.startAt,e.startAt)&&K2(t.endAt,e.endAt)}function Pg(t){return We.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class Of{constructor(e,r=null,n=[],i=[],o=null,c="F",u=null,h=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=o,this.limitType=c,this.startAt=u,this.endAt=h,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function hD(t,e,r,n,i,o,c,u){return new Of(t,e,r,n,i,o,c,u)}function k1(t){return new Of(t)}function Q2(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function ow(t){return t.collectionGroup!==null}function Qu(t){const e=rt(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),r.add(o.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let u=new Or(jr.comparator);return c.filters.forEach((h=>{h.getFlattenedFilters().forEach((d=>{d.isInequality()&&(u=u.add(d.field))}))})),u})(e).forEach((o=>{r.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new Qh(o,n))})),r.has(jr.keyField().canonicalString())||e.Ie.push(new Qh(jr.keyField(),n))}return e.Ie}function di(t){const e=rt(t);return e.Ee||(e.Ee=dD(e,Qu(t))),e.Ee}function dD(t,e){if(t.limitType==="F")return $2(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((i=>{const o=i.dir==="desc"?"asc":"desc";return new Qh(i.field,o)}));const r=t.endAt?new $h(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new $h(t.startAt.position,t.startAt.inclusive):null;return $2(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Bg(t,e){const r=t.filters.concat([e]);return new Of(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function Vg(t,e,r){return new Of(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Nd(t,e){return R1(di(t),di(e))&&t.limitType===e.limitType}function lw(t){return`${C1(di(t))}|lt:${t.limitType}`}function sc(t){return`Query(target=${(function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map((i=>iw(i))).join(", ")}]`),Id(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map((i=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(i))).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map((i=>Sc(i))).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map((i=>Sc(i))).join(",")),`Target(${n})`})(di(t))}; limitType=${t.limitType})`}function Od(t,e){return e.isFoundDocument()&&(function(n,i){const o=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):We.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)})(t,e)&&(function(n,i){for(const o of Qu(n))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0})(t,e)&&(function(n,i){for(const o of n.filters)if(!o.matches(i))return!1;return!0})(t,e)&&(function(n,i){return!(n.startAt&&!(function(c,u,h){const d=X2(c,u,h);return c.inclusive?d<=0:d<0})(n.startAt,Qu(n),i)||n.endAt&&!(function(c,u,h){const d=X2(c,u,h);return c.inclusive?d>=0:d>0})(n.endAt,Qu(n),i))})(t,e)}function pD(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function cw(t){return(e,r)=>{let n=!1;for(const i of Qu(t)){const o=mD(i,e,r);if(o!==0)return o;n=n||i.field.isKeyField()}return 0}}function mD(t,e,r){const n=t.field.isKeyField()?We.comparator(e.key,r.key):(function(o,c,u){const h=c.data.field(o),d=u.data.field(o);return h!==null&&d!==null?Tc(h,d):Ke(42886)})(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Ke(19790,{direction:t.dir})}}class fl{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,o]of n)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){xo(this.inner,((r,n)=>{for(const[i,o]of n)e(i,o)}))}isEmpty(){return WS(this.inner)}size(){return this.innerSize}}const gD=new or(We.comparator);function as(){return gD}const uw=new or(We.comparator);function Hu(...t){let e=uw;for(const r of t)e=e.insert(r.key,r);return e}function fw(t){let e=uw;return t.forEach(((r,n)=>e=e.insert(r,n.overlayedDocument))),e}function Ko(){return Ju()}function hw(){return Ju()}function Ju(){return new fl((t=>t.toString()),((t,e)=>t.isEqual(e)))}const xD=new or(We.comparator),vD=new Or(We.comparator);function gt(...t){let e=vD;for(const r of t)e=e.add(r);return e}const yD=new Or(mt);function _D(){return yD}function I1(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Yh(e)?"-0":e}}function dw(t){return{integerValue:""+t}}function ED(t,e){return XI(e)?dw(e):I1(t,e)}class Fd{constructor(){this._=void 0}}function TD(t,e,r){return t instanceof Jh?(function(i,o){const c={fields:{[KS]:{stringValue:XS},[QS]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&A1(o)&&(o=Dd(o)),o&&(c.fields[$S]=o),{mapValue:c}})(r,e):t instanceof wc?mw(t,e):t instanceof xf?gw(t,e):(function(i,o){const c=pw(i,o),u=J2(c)+J2(i.Ae);return Mg(c)&&Mg(i.Ae)?dw(u):I1(i.serializer,u)})(t,e)}function SD(t,e,r){return t instanceof wc?mw(t,e):t instanceof xf?gw(t,e):r}function pw(t,e){return t instanceof Zh?(function(n){return Mg(n)||(function(o){return!!o&&"doubleValue"in o})(n)})(e)?e:{integerValue:0}:null}class Jh extends Fd{}class wc extends Fd{constructor(e){super(),this.elements=e}}function mw(t,e){const r=xw(e);for(const n of t.elements)r.some((i=>gi(i,n)))||r.push(n);return{arrayValue:{values:r}}}class xf extends Fd{constructor(e){super(),this.elements=e}}function gw(t,e){let r=xw(e);for(const n of t.elements)r=r.filter((i=>!gi(i,n)));return{arrayValue:{values:r}}}class Zh extends Fd{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function J2(t){return xr(t.integerValue||t.doubleValue)}function xw(t){return b1(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class wD{constructor(e,r){this.field=e,this.transform=r}}function AD(t,e){return t.field.isEqual(e.field)&&(function(n,i){return n instanceof wc&&i instanceof wc||n instanceof xf&&i instanceof xf?_c(n.elements,i.elements,gi):n instanceof Zh&&i instanceof Zh?gi(n.Ae,i.Ae):n instanceof Jh&&i instanceof Jh})(t.transform,e.transform)}class bD{constructor(e,r){this.version=e,this.transformResults=r}}class Vn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Vn}static exists(e){return new Vn(void 0,e)}static updateTime(e){return new Vn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ph(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Md{}function vw(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ld(t.key,Vn.none()):new Ff(t.key,t.data,Vn.none());{const r=t.data,n=Bn.empty();let i=new Or(jr.comparator);for(let o of e.fields)if(!i.has(o)){let c=r.field(o);c===null&&o.length>1&&(o=o.popLast(),c=r.field(o)),c===null?n.delete(o):n.set(o,c),i=i.add(o)}return new vo(t.key,n,new ta(i.toArray()),Vn.none())}}function CD(t,e,r){t instanceof Ff?(function(i,o,c){const u=i.value.clone(),h=eE(i.fieldTransforms,o,c.transformResults);u.setAll(h),o.convertToFoundDocument(c.version,u).setHasCommittedMutations()})(t,e,r):t instanceof vo?(function(i,o,c){if(!Ph(i.precondition,o))return void o.convertToUnknownDocument(c.version);const u=eE(i.fieldTransforms,o,c.transformResults),h=o.data;h.setAll(yw(i)),h.setAll(u),o.convertToFoundDocument(c.version,h).setHasCommittedMutations()})(t,e,r):(function(i,o,c){o.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,r)}function Zu(t,e,r,n){return t instanceof Ff?(function(o,c,u,h){if(!Ph(o.precondition,c))return u;const d=o.value.clone(),m=tE(o.fieldTransforms,h,c);return d.setAll(m),c.convertToFoundDocument(c.version,d).setHasLocalMutations(),null})(t,e,r,n):t instanceof vo?(function(o,c,u,h){if(!Ph(o.precondition,c))return u;const d=tE(o.fieldTransforms,h,c),m=c.data;return m.setAll(yw(o)),m.setAll(d),c.convertToFoundDocument(c.version,m).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((v=>v.field)))})(t,e,r,n):(function(o,c,u){return Ph(o.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):u})(t,e,r)}function RD(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),o=pw(n.transform,i||null);o!=null&&(r===null&&(r=Bn.empty()),r.set(n.field,o))}return r||null}function Z2(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&_c(n,i,((o,c)=>AD(o,c)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ff extends Md{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class vo extends Md{constructor(e,r,n,i,o=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function yw(t){const e=new Map;return t.fieldMask.fields.forEach((r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}})),e}function eE(t,e,r){const n=new Map;Nt(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let i=0;i<r.length;i++){const o=t[i],c=o.transform,u=e.data.field(o.field);n.set(o.field,SD(c,u,r[i]))}return n}function tE(t,e,r){const n=new Map;for(const i of t){const o=i.transform,c=r.data.field(i.field);n.set(i.field,TD(o,c,e))}return n}class Ld extends Md{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class kD extends Md{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class ID{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&CD(o,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Zu(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Zu(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=hw();return this.mutations.forEach((i=>{const o=e.get(i.key),c=o.overlayedDocument;let u=this.applyToLocalView(c,o.mutatedFields);u=r.has(i.key)?null:u;const h=vw(c,u);h!==null&&n.set(i.key,h),c.isValidDocument()||c.convertToNoDocument(Ze.min())})),n}keys(){return this.mutations.reduce(((e,r)=>e.add(r.key)),gt())}isEqual(e){return this.batchId===e.batchId&&_c(this.mutations,e.mutations,((r,n)=>Z2(r,n)))&&_c(this.baseMutations,e.baseMutations,((r,n)=>Z2(r,n)))}}class D1{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){Nt(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=(function(){return xD})();const o=e.mutations;for(let c=0;c<o.length;c++)i=i.insert(o[c].key,n[c].version);return new D1(e,r,n,i)}}class DD{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class ND{constructor(e,r){this.count=e,this.unchangedNames=r}}var Ar,yt;function OD(t){switch(t){case be.OK:return Ke(64938);case be.CANCELLED:case be.UNKNOWN:case be.DEADLINE_EXCEEDED:case be.RESOURCE_EXHAUSTED:case be.INTERNAL:case be.UNAVAILABLE:case be.UNAUTHENTICATED:return!1;case be.INVALID_ARGUMENT:case be.NOT_FOUND:case be.ALREADY_EXISTS:case be.PERMISSION_DENIED:case be.FAILED_PRECONDITION:case be.ABORTED:case be.OUT_OF_RANGE:case be.UNIMPLEMENTED:case be.DATA_LOSS:return!0;default:return Ke(15467,{code:t})}}function _w(t){if(t===void 0)return ns("GRPC error has no .code"),be.UNKNOWN;switch(t){case Ar.OK:return be.OK;case Ar.CANCELLED:return be.CANCELLED;case Ar.UNKNOWN:return be.UNKNOWN;case Ar.DEADLINE_EXCEEDED:return be.DEADLINE_EXCEEDED;case Ar.RESOURCE_EXHAUSTED:return be.RESOURCE_EXHAUSTED;case Ar.INTERNAL:return be.INTERNAL;case Ar.UNAVAILABLE:return be.UNAVAILABLE;case Ar.UNAUTHENTICATED:return be.UNAUTHENTICATED;case Ar.INVALID_ARGUMENT:return be.INVALID_ARGUMENT;case Ar.NOT_FOUND:return be.NOT_FOUND;case Ar.ALREADY_EXISTS:return be.ALREADY_EXISTS;case Ar.PERMISSION_DENIED:return be.PERMISSION_DENIED;case Ar.FAILED_PRECONDITION:return be.FAILED_PRECONDITION;case Ar.ABORTED:return be.ABORTED;case Ar.OUT_OF_RANGE:return be.OUT_OF_RANGE;case Ar.UNIMPLEMENTED:return be.UNIMPLEMENTED;case Ar.DATA_LOSS:return be.DATA_LOSS;default:return Ke(39323,{code:t})}}(yt=Ar||(Ar={}))[yt.OK=0]="OK",yt[yt.CANCELLED=1]="CANCELLED",yt[yt.UNKNOWN=2]="UNKNOWN",yt[yt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",yt[yt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",yt[yt.NOT_FOUND=5]="NOT_FOUND",yt[yt.ALREADY_EXISTS=6]="ALREADY_EXISTS",yt[yt.PERMISSION_DENIED=7]="PERMISSION_DENIED",yt[yt.UNAUTHENTICATED=16]="UNAUTHENTICATED",yt[yt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",yt[yt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",yt[yt.ABORTED=10]="ABORTED",yt[yt.OUT_OF_RANGE=11]="OUT_OF_RANGE",yt[yt.UNIMPLEMENTED=12]="UNIMPLEMENTED",yt[yt.INTERNAL=13]="INTERNAL",yt[yt.UNAVAILABLE=14]="UNAVAILABLE",yt[yt.DATA_LOSS=15]="DATA_LOSS";function FD(){return new TextEncoder}const MD=new ro([4294967295,4294967295],0);function rE(t){const e=FD().encode(t),r=new OS;return r.update(e),new Uint8Array(r.digest())}function nE(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new ro([r,n],0),new ro([i,o],0)]}class N1{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Gu(`Invalid padding: ${r}`);if(n<0)throw new Gu(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Gu(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Gu(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=ro.fromNumber(this.ge)}ye(e,r,n){let i=e.add(r.multiply(ro.fromNumber(n)));return i.compare(MD)===1&&(i=new ro([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=rE(e),[n,i]=nE(r);for(let o=0;o<this.hashCount;o++){const c=this.ye(n,i,o);if(!this.we(c))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),c=new N1(o,i,r);return n.forEach((u=>c.insert(u))),c}insert(e){if(this.ge===0)return;const r=rE(e),[n,i]=nE(r);for(let o=0;o<this.hashCount;o++){const c=this.ye(n,i,o);this.Se(c)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Gu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Pd{constructor(e,r,n,i,o){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,Mf.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Pd(Ze.min(),i,new or(mt),as(),gt())}}class Mf{constructor(e,r,n,i,o){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Mf(n,r,gt(),gt(),gt())}}class Bh{constructor(e,r,n,i){this.be=e,this.removedTargetIds=r,this.key=n,this.De=i}}class Ew{constructor(e,r){this.targetId=e,this.Ce=r}}class Tw{constructor(e,r,n=Hr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class aE{constructor(){this.ve=0,this.Fe=iE(),this.Me=Hr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=gt(),r=gt(),n=gt();return this.Fe.forEach(((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:Ke(38017,{changeType:o})}})),new Mf(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=iE()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Nt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class LD{constructor(e){this.Ge=e,this.ze=new Map,this.je=as(),this.Je=_h(),this.He=_h(),this.Ye=new or(mt)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,(r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:Ke(56790,{state:e.state})}}))}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach(((n,i)=>{this.rt(i)&&r(i)}))}st(e){const r=e.targetId,n=e.Ce.count,i=this.ot(r);if(i){const o=i.target;if(Pg(o))if(n===0){const c=new We(o.path);this.et(r,c,un.newNoDocument(c,Ze.min()))}else Nt(n===1,20013,{expectedCount:n});else{const c=this._t(r);if(c!==n){const u=this.ut(e),h=u?this.ct(u,e,c):1;if(h!==0){this.it(r);const d=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,d)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:o=0}=r;let c,u;try{c=uo(n).toUint8Array()}catch(h){if(h instanceof YS)return al("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new N1(c,i,o)}catch(h){return al(h instanceof Gu?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.ge===0?null:u}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let i=0;return n.forEach((o=>{const c=this.Ge.ht(),u=`projects/${c.projectId}/databases/${c.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.et(r,o,null),i++)})),i}Tt(e){const r=new Map;this.ze.forEach(((o,c)=>{const u=this.ot(c);if(u){if(o.current&&Pg(u.target)){const h=new We(u.target.path);this.It(h).has(c)||this.Et(c,h)||this.et(c,h,un.newNoDocument(h,e))}o.Be&&(r.set(c,o.ke()),o.qe())}}));let n=gt();this.He.forEach(((o,c)=>{let u=!0;c.forEachWhile((h=>{const d=this.ot(h);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)})),u&&(n=n.add(o))})),this.je.forEach(((o,c)=>c.setReadTime(e)));const i=new Pd(e,r,this.Ye,this.je,n);return this.je=as(),this.Je=_h(),this.He=_h(),this.Ye=new or(mt),i}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,r)?i.Qe(r,1):i.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new aE,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new Or(mt),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new Or(mt),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||ze("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new aE),this.Ge.getRemoteKeysForTarget(e).forEach((r=>{this.et(e,r,null)}))}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function _h(){return new or(We.comparator)}function iE(){return new or(We.comparator)}const PD={asc:"ASCENDING",desc:"DESCENDING"},BD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},VD={and:"AND",or:"OR"};class UD{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Ug(t,e){return t.useProto3Json||Id(e)?e:{value:e}}function ed(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Sw(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function jD(t,e){return ed(t,e.toTimestamp())}function pi(t){return Nt(!!t,49232),Ze.fromTimestamp((function(r){const n=co(r);return new Kt(n.seconds,n.nanos)})(t))}function O1(t,e){return jg(t,e).canonicalString()}function jg(t,e){const r=(function(i){return new Xt(["projects",i.projectId,"databases",i.database])})(t).child("documents");return e===void 0?r:r.child(e)}function ww(t){const e=Xt.fromString(t);return Nt(kw(e),10190,{key:e.toString()}),e}function zg(t,e){return O1(t.databaseId,e.path)}function lg(t,e){const r=ww(e);if(r.get(1)!==t.databaseId.projectId)throw new je(be.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new je(be.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new We(bw(r))}function Aw(t,e){return O1(t.databaseId,e)}function zD(t){const e=ww(t);return e.length===4?Xt.emptyPath():bw(e)}function Hg(t){return new Xt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function bw(t){return Nt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function sE(t,e,r){return{name:zg(t,e),fields:r.value.mapValue.fields}}function HD(t,e){let r;if("targetChange"in e){e.targetChange;const n=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Ke(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=(function(d,m){return d.useProto3Json?(Nt(m===void 0||typeof m=="string",58123),Hr.fromBase64String(m||"")):(Nt(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),Hr.fromUint8Array(m||new Uint8Array))})(t,e.targetChange.resumeToken),c=e.targetChange.cause,u=c&&(function(d){const m=d.code===void 0?be.UNKNOWN:_w(d.code);return new je(m,d.message||"")})(c);r=new Tw(n,i,o,u||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=lg(t,n.document.name),o=pi(n.document.updateTime),c=n.document.createTime?pi(n.document.createTime):Ze.min(),u=new Bn({mapValue:{fields:n.document.fields}}),h=un.newFoundDocument(i,o,c,u),d=n.targetIds||[],m=n.removedTargetIds||[];r=new Bh(d,m,h.key,h)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=lg(t,n.document),o=n.readTime?pi(n.readTime):Ze.min(),c=un.newNoDocument(i,o),u=n.removedTargetIds||[];r=new Bh([],u,c.key,c)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=lg(t,n.document),o=n.removedTargetIds||[];r=new Bh([],o,i,null)}else{if(!("filter"in e))return Ke(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:o}=n,c=new ND(i,o),u=n.targetId;r=new Ew(u,c)}}return r}function GD(t,e){let r;if(e instanceof Ff)r={update:sE(t,e.key,e.value)};else if(e instanceof Ld)r={delete:zg(t,e.key)};else if(e instanceof vo)r={update:sE(t,e.key,e.data),updateMask:ZD(e.fieldMask)};else{if(!(e instanceof kD))return Ke(16599,{Vt:e.type});r={verify:zg(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map((n=>(function(o,c){const u=c.transform;if(u instanceof Jh)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof wc)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof xf)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Zh)return{fieldPath:c.field.canonicalString(),increment:u.Ae};throw Ke(20930,{transform:c.transform})})(0,n)))),e.precondition.isNone||(r.currentDocument=(function(i,o){return o.updateTime!==void 0?{updateTime:jD(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Ke(27497)})(t,e.precondition)),r}function qD(t,e){return t&&t.length>0?(Nt(e!==void 0,14353),t.map((r=>(function(i,o){let c=i.updateTime?pi(i.updateTime):pi(o);return c.isEqual(Ze.min())&&(c=pi(o)),new bD(c,i.transformResults||[])})(r,e)))):[]}function WD(t,e){return{documents:[Aw(t,e.path)]}}function YD(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=Aw(t,i);const o=(function(d){if(d.length!==0)return Rw(Qa.create(d,"and"))})(e.filters);o&&(r.structuredQuery.where=o);const c=(function(d){if(d.length!==0)return d.map((m=>(function(y){return{field:oc(y.field),direction:$D(y.dir)}})(m)))})(e.orderBy);c&&(r.structuredQuery.orderBy=c);const u=Ug(t,e.limit);return u!==null&&(r.structuredQuery.limit=u),e.startAt&&(r.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(r.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:r,parent:i}}function XD(t){let e=zD(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Nt(n===1,65062);const m=r.from[0];m.allDescendants?i=m.collectionId:e=e.child(m.collectionId)}let o=[];r.where&&(o=(function(v){const y=Cw(v);return y instanceof Qa&&nw(y)?y.getFilters():[y]})(r.where));let c=[];r.orderBy&&(c=(function(v){return v.map((y=>(function(S){return new Qh(lc(S.field),(function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(y)))})(r.orderBy));let u=null;r.limit&&(u=(function(v){let y;return y=typeof v=="object"?v.value:v,Id(y)?null:y})(r.limit));let h=null;r.startAt&&(h=(function(v){const y=!!v.before,E=v.values||[];return new $h(E,y)})(r.startAt));let d=null;return r.endAt&&(d=(function(v){const y=!v.before,E=v.values||[];return new $h(E,y)})(r.endAt)),hD(e,i,c,o,u,"F",h,d)}function KD(t,e){const r=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ke(28987,{purpose:i})}})(e.purpose);return r==null?null:{"goog-listen-tags":r}}function Cw(t){return t.unaryFilter!==void 0?(function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=lc(r.unaryFilter.field);return Rr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=lc(r.unaryFilter.field);return Rr.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=lc(r.unaryFilter.field);return Rr.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=lc(r.unaryFilter.field);return Rr.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ke(61313);default:return Ke(60726)}})(t):t.fieldFilter!==void 0?(function(r){return Rr.create(lc(r.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ke(58110);default:return Ke(50506)}})(r.fieldFilter.op),r.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(r){return Qa.create(r.compositeFilter.filters.map((n=>Cw(n))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ke(1026)}})(r.compositeFilter.op))})(t):Ke(30097,{filter:t})}function $D(t){return PD[t]}function QD(t){return BD[t]}function JD(t){return VD[t]}function oc(t){return{fieldPath:t.canonicalString()}}function lc(t){return jr.fromServerFormat(t.fieldPath)}function Rw(t){return t instanceof Rr?(function(r){if(r.op==="=="){if(Y2(r.value))return{unaryFilter:{field:oc(r.field),op:"IS_NAN"}};if(W2(r.value))return{unaryFilter:{field:oc(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(Y2(r.value))return{unaryFilter:{field:oc(r.field),op:"IS_NOT_NAN"}};if(W2(r.value))return{unaryFilter:{field:oc(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:oc(r.field),op:QD(r.op),value:r.value}}})(t):t instanceof Qa?(function(r){const n=r.getFilters().map((i=>Rw(i)));return n.length===1?n[0]:{compositeFilter:{op:JD(r.op),filters:n}}})(t):Ke(54877,{filter:t})}function ZD(t){const e=[];return t.fields.forEach((r=>e.push(r.canonicalString()))),{fieldPaths:e}}function kw(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class $s{constructor(e,r,n,i,o=Ze.min(),c=Ze.min(),u=Hr.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new $s(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new $s(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new $s(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new $s(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class e5{constructor(e){this.yt=e}}function t5(t){const e=XD({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Vg(e,e.limit,"L"):e}class r5{constructor(){this.Cn=new n5}addToCollectionParentIndex(e,r){return this.Cn.add(r),ke.resolve()}getCollectionParents(e,r){return ke.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return ke.resolve()}deleteFieldIndex(e,r){return ke.resolve()}deleteAllFieldIndexes(e){return ke.resolve()}createTargetIndexes(e,r){return ke.resolve()}getDocumentsMatchingTarget(e,r){return ke.resolve(null)}getIndexType(e,r){return ke.resolve(0)}getFieldIndexes(e,r){return ke.resolve([])}getNextCollectionGroupToUpdate(e){return ke.resolve(null)}getMinOffset(e,r){return ke.resolve(lo.min())}getMinOffsetFromCollectionGroup(e,r){return ke.resolve(lo.min())}updateCollectionGroup(e,r,n){return ke.resolve()}updateIndexEntries(e,r){return ke.resolve()}}class n5{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new Or(Xt.comparator),o=!i.has(n);return this.index[r]=i.add(n),o}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Or(Xt.comparator)).toArray()}}const oE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Iw=41943040;class Ln{static withCacheSize(e){return new Ln(e,Ln.DEFAULT_COLLECTION_PERCENTILE,Ln.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}Ln.DEFAULT_COLLECTION_PERCENTILE=10,Ln.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ln.DEFAULT=new Ln(Iw,Ln.DEFAULT_COLLECTION_PERCENTILE,Ln.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ln.DISABLED=new Ln(-1,0,0);class Ac{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ac(0)}static cr(){return new Ac(-1)}}const lE="LruGarbageCollector",a5=1048576;function cE([t,e],[r,n]){const i=mt(t,r);return i===0?mt(e,n):i}class i5{constructor(e){this.Ir=e,this.buffer=new Or(cE),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();cE(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class s5{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ze(lE,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Pc(r)?ze(lE,"Ignoring IndexedDB error during garbage collection: ",r):await Lc(r)}await this.Vr(3e5)}))}}class o5{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next((n=>Math.floor(r/100*n)))}nthSequenceNumber(e,r){if(r===0)return ke.resolve(kd.ce);const n=new i5(r);return this.mr.forEachTarget(e,(i=>n.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>n.Ar(i))))).next((()=>n.maxValue))}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(ze("LruGarbageCollector","Garbage collection skipped; disabled"),ke.resolve(oE)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(ze("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),oE):this.yr(e,r)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,i,o,c,u,h,d;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(ze("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),i=this.params.maximumSequenceNumbersToCollect):i=v,c=Date.now(),this.nthSequenceNumber(e,i)))).next((v=>(n=v,u=Date.now(),this.removeTargets(e,n,r)))).next((v=>(o=v,h=Date.now(),this.removeOrphanedDocuments(e,n)))).next((v=>(d=Date.now(),ic()<=pt.DEBUG&&ze("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-m}ms
	Determined least recently used ${i} in `+(u-c)+`ms
	Removed ${o} targets in `+(h-u)+`ms
	Removed ${v} documents in `+(d-h)+`ms
Total Duration: ${d-m}ms`),ke.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:v}))))}}function l5(t,e){return new o5(t,e)}class c5{constructor(){this.changes=new fl((e=>e.toString()),((e,r)=>e.isEqual(r))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,un.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?ke.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class u5{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}class f5{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next((i=>(n=i,this.remoteDocumentCache.getEntry(e,r)))).next((i=>(n!==null&&Zu(n.mutation,i,ta.empty(),Kt.now()),i)))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.getLocalViewOfDocuments(e,n,gt()).next((()=>n))))}getLocalViewOfDocuments(e,r,n=gt()){const i=Ko();return this.populateOverlays(e,i,r).next((()=>this.computeViews(e,r,i,n).next((o=>{let c=Hu();return o.forEach(((u,h)=>{c=c.insert(u,h.overlayedDocument)})),c}))))}getOverlayedDocuments(e,r){const n=Ko();return this.populateOverlays(e,n,r).next((()=>this.computeViews(e,r,n,gt())))}populateOverlays(e,r,n){const i=[];return n.forEach((o=>{r.has(o)||i.push(o)})),this.documentOverlayCache.getOverlays(e,i).next((o=>{o.forEach(((c,u)=>{r.set(c,u)}))}))}computeViews(e,r,n,i){let o=as();const c=Ju(),u=(function(){return Ju()})();return r.forEach(((h,d)=>{const m=n.get(d.key);i.has(d.key)&&(m===void 0||m.mutation instanceof vo)?o=o.insert(d.key,d):m!==void 0?(c.set(d.key,m.mutation.getFieldMask()),Zu(m.mutation,d,m.mutation.getFieldMask(),Kt.now())):c.set(d.key,ta.empty())})),this.recalculateAndSaveOverlays(e,o).next((h=>(h.forEach(((d,m)=>c.set(d,m))),r.forEach(((d,m)=>u.set(d,new u5(m,c.get(d)??null)))),u)))}recalculateAndSaveOverlays(e,r){const n=Ju();let i=new or(((c,u)=>c-u)),o=gt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next((c=>{for(const u of c)u.keys().forEach((h=>{const d=r.get(h);if(d===null)return;let m=n.get(h)||ta.empty();m=u.applyToLocalView(d,m),n.set(h,m);const v=(i.get(u.batchId)||gt()).add(h);i=i.insert(u.batchId,v)}))})).next((()=>{const c=[],u=i.getReverseIterator();for(;u.hasNext();){const h=u.getNext(),d=h.key,m=h.value,v=hw();m.forEach((y=>{if(!o.has(y)){const E=vw(r.get(y),n.get(y));E!==null&&v.set(y,E),o=o.add(y)}})),c.push(this.documentOverlayCache.saveOverlays(e,d,v))}return ke.waitFor(c)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,r,n,i){return(function(c){return We.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0})(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):ow(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next((o=>{const c=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-o.size):ke.resolve(Ko());let u=pf,h=o;return c.next((d=>ke.forEach(d,((m,v)=>(u<v.largestBatchId&&(u=v.largestBatchId),o.get(m)?ke.resolve():this.remoteDocumentCache.getEntry(e,m).next((y=>{h=h.insert(m,y)}))))).next((()=>this.populateOverlays(e,d,o))).next((()=>this.computeViews(e,h,d,gt()))).next((m=>({batchId:u,changes:fw(m)})))))}))}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new We(r)).next((n=>{let i=Hu();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i}))}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const o=r.collectionGroup;let c=Hu();return this.indexManager.getCollectionParents(e,o).next((u=>ke.forEach(u,(h=>{const d=(function(v,y){return new Of(y,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(r,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,n,i).next((m=>{m.forEach(((v,y)=>{c=c.insert(v,y)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,r,n,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next((c=>(o=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,o,i)))).next((c=>{o.forEach(((h,d)=>{const m=d.getKey();c.get(m)===null&&(c=c.insert(m,un.newInvalidDocument(m)))}));let u=Hu();return c.forEach(((h,d)=>{const m=o.get(h);m!==void 0&&Zu(m.mutation,d,ta.empty(),Kt.now()),Od(r,d)&&(u=u.insert(h,d))})),u}))}}class h5{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return ke.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,(function(i){return{id:i.id,version:i.version,createTime:pi(i.createTime)}})(r)),ke.resolve()}getNamedQuery(e,r){return ke.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,(function(i){return{name:i.name,query:t5(i.bundledQuery),readTime:pi(i.readTime)}})(r)),ke.resolve()}}class d5{constructor(){this.overlays=new or(We.comparator),this.qr=new Map}getOverlay(e,r){return ke.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Ko();return ke.forEach(r,(i=>this.getOverlay(e,i).next((o=>{o!==null&&n.set(i,o)})))).next((()=>n))}saveOverlays(e,r,n){return n.forEach(((i,o)=>{this.St(e,r,o)})),ke.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach((o=>this.overlays=this.overlays.remove(o))),this.qr.delete(n)),ke.resolve()}getOverlaysForCollection(e,r,n){const i=Ko(),o=r.length+1,c=new We(r.child("")),u=this.overlays.getIteratorFrom(c);for(;u.hasNext();){const h=u.getNext().value,d=h.getKey();if(!r.isPrefixOf(d.path))break;d.path.length===o&&h.largestBatchId>n&&i.set(h.getKey(),h)}return ke.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let o=new or(((d,m)=>d-m));const c=this.overlays.getIterator();for(;c.hasNext();){const d=c.getNext().value;if(d.getKey().getCollectionGroup()===r&&d.largestBatchId>n){let m=o.get(d.largestBatchId);m===null&&(m=Ko(),o=o.insert(d.largestBatchId,m)),m.set(d.getKey(),d)}}const u=Ko(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach(((d,m)=>u.set(d,m))),!(u.size()>=i)););return ke.resolve(u)}St(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const c=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,c)}this.overlays=this.overlays.insert(n.key,new DD(r,n));let o=this.qr.get(r);o===void 0&&(o=gt(),this.qr.set(r,o)),this.qr.set(r,o.add(n.key))}}class p5{constructor(){this.sessionToken=Hr.EMPTY_BYTE_STRING}getSessionToken(e){return ke.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,ke.resolve()}}class F1{constructor(){this.Qr=new Or(Vr.$r),this.Ur=new Or(Vr.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new Vr(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach((n=>this.addReference(n,r)))}removeReference(e,r){this.Gr(new Vr(e,r))}zr(e,r){e.forEach((n=>this.removeReference(n,r)))}jr(e){const r=new We(new Xt([])),n=new Vr(r,e),i=new Vr(r,e+1),o=[];return this.Ur.forEachInRange([n,i],(c=>{this.Gr(c),o.push(c.key)})),o}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new We(new Xt([])),n=new Vr(r,e),i=new Vr(r,e+1);let o=gt();return this.Ur.forEachInRange([n,i],(c=>{o=o.add(c.key)})),o}containsKey(e){const r=new Vr(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Vr{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return We.comparator(e.key,r.key)||mt(e.Yr,r.Yr)}static Kr(e,r){return mt(e.Yr,r.Yr)||We.comparator(e.key,r.key)}}class m5{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new Or(Vr.$r)}checkEmpty(e){return ke.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new ID(o,r,n,i);this.mutationQueue.push(c);for(const u of i)this.Zr=this.Zr.add(new Vr(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return ke.resolve(c)}lookupMutationBatch(e,r){return ke.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.ei(n),o=i<0?0:i;return ke.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return ke.resolve(this.mutationQueue.length===0?w1:this.tr-1)}getAllMutationBatches(e){return ke.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Vr(r,0),i=new Vr(r,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([n,i],(c=>{const u=this.Xr(c.Yr);o.push(u)})),ke.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Or(mt);return r.forEach((i=>{const o=new Vr(i,0),c=new Vr(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,c],(u=>{n=n.add(u.Yr)}))})),ke.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let o=n;We.isDocumentKey(o)||(o=o.child(""));const c=new Vr(new We(o),0);let u=new Or(mt);return this.Zr.forEachWhile((h=>{const d=h.key.path;return!!n.isPrefixOf(d)&&(d.length===i&&(u=u.add(h.Yr)),!0)}),c),ke.resolve(this.ti(u))}ti(e){const r=[];return e.forEach((n=>{const i=this.Xr(n);i!==null&&r.push(i)})),r}removeMutationBatch(e,r){Nt(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return ke.forEach(r.mutations,(i=>{const o=new Vr(i.key,r.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=n}))}ir(e){}containsKey(e,r){const n=new Vr(r,0),i=this.Zr.firstAfterOrEqual(n);return ke.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ke.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}class g5{constructor(e){this.ri=e,this.docs=(function(){return new or(We.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),o=i?i.size:0,c=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:c}),this.size+=c-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return ke.resolve(n?n.document.mutableCopy():un.newInvalidDocument(r))}getEntries(e,r){let n=as();return r.forEach((i=>{const o=this.docs.get(i);n=n.insert(i,o?o.document.mutableCopy():un.newInvalidDocument(i))})),ke.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let o=as();const c=r.path,u=new We(c.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){const{key:d,value:{document:m}}=h.getNext();if(!c.isPrefixOf(d.path))break;d.path.length>c.length+1||GI(HI(m),n)<=0||(i.has(m.key)||Od(r,m))&&(o=o.insert(m.key,m.mutableCopy()))}return ke.resolve(o)}getAllFromCollectionGroup(e,r,n,i){Ke(9500)}ii(e,r){return ke.forEach(this.docs,(n=>r(n)))}newChangeBuffer(e){return new x5(this)}getSize(e){return ke.resolve(this.size)}}class x5 extends c5{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?r.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(n)})),ke.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}class v5{constructor(e){this.persistence=e,this.si=new fl((r=>C1(r)),R1),this.lastRemoteSnapshotVersion=Ze.min(),this.highestTargetId=0,this.oi=0,this._i=new F1,this.targetCount=0,this.ai=Ac.ur()}forEachTarget(e,r){return this.si.forEach(((n,i)=>r(i))),ke.resolve()}getLastRemoteSnapshotVersion(e){return ke.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ke.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ke.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),ke.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new Ac(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,ke.resolve()}updateTargetData(e,r){return this.Pr(r),ke.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,ke.resolve()}removeTargets(e,r,n){let i=0;const o=[];return this.si.forEach(((c,u)=>{u.sequenceNumber<=r&&n.get(u.targetId)===null&&(this.si.delete(c),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)})),ke.waitFor(o).next((()=>i))}getTargetCount(e){return ke.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return ke.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),ke.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const i=this.persistence.referenceDelegate,o=[];return i&&r.forEach((c=>{o.push(i.markPotentiallyOrphaned(e,c))})),ke.waitFor(o)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),ke.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return ke.resolve(n)}containsKey(e,r){return ke.resolve(this._i.containsKey(r))}}class Dw{constructor(e,r){this.ui={},this.overlays={},this.ci=new kd(0),this.li=!1,this.li=!0,this.hi=new p5,this.referenceDelegate=e(this),this.Pi=new v5(this),this.indexManager=new r5,this.remoteDocumentCache=(function(i){return new g5(i)})((n=>this.referenceDelegate.Ti(n))),this.serializer=new e5(r),this.Ii=new h5(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new d5,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new m5(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){ze("MemoryPersistence","Starting transaction:",e);const i=new y5(this.ci.next());return this.referenceDelegate.Ei(),n(i).next((o=>this.referenceDelegate.di(i).next((()=>o)))).toPromise().then((o=>(i.raiseOnCommittedEvent(),o)))}Ai(e,r){return ke.or(Object.values(this.ui).map((n=>()=>n.containsKey(e,r))))}}class y5 extends WI{constructor(e){super(),this.currentSequenceNumber=e}}class M1{constructor(e){this.persistence=e,this.Ri=new F1,this.Vi=null}static mi(e){return new M1(e)}get fi(){if(this.Vi)return this.Vi;throw Ke(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),ke.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),ke.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),ke.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach((i=>this.fi.add(i.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next((i=>{i.forEach((o=>this.fi.add(o.toString())))})).next((()=>n.removeTargetData(e,r)))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ke.forEach(this.fi,(n=>{const i=We.fromPath(n);return this.gi(e,i).next((o=>{o||r.removeEntry(i,Ze.min())}))})).next((()=>(this.Vi=null,r.apply(e))))}updateLimboDocument(e,r){return this.gi(e,r).next((n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())}))}Ti(e){return 0}gi(e,r){return ke.or([()=>ke.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class td{constructor(e,r){this.persistence=e,this.pi=new fl((n=>KI(n.path)),((n,i)=>n.isEqual(i))),this.garbageCollector=l5(this,r)}static mi(e,r){return new td(e,r)}Ei(){}di(e){return ke.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>r.next((i=>n+i))))}wr(e){let r=0;return this.pr(e,(n=>{r++})).next((()=>r))}pr(e,r){return ke.forEach(this.pi,((n,i)=>this.br(e,n,i).next((o=>o?ke.resolve():r(i)))))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ii(e,(c=>this.br(e,c,r).next((u=>{u||(n++,o.removeEntry(c,Ze.min()))})))).next((()=>o.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),ke.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),ke.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),ke.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),ke.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=Mh(e.data.value)),r}br(e,r,n){return ke.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.pi.get(r);return ke.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class L1{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=i}static As(e,r){let n=gt(),i=gt();for(const o of r.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new L1(e,r.fromCache,n,i)}}class _5{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class E5{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return d3()?8:YI(pn())>0?6:4})()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,i){const o={result:null};return this.ys(e,r).next((c=>{o.result=c})).next((()=>{if(!o.result)return this.ws(e,r,i,n).next((c=>{o.result=c}))})).next((()=>{if(o.result)return;const c=new _5;return this.Ss(e,r,c).next((u=>{if(o.result=u,this.Vs)return this.bs(e,r,c,u.size)}))})).next((()=>o.result))}bs(e,r,n,i){return n.documentReadCount<this.fs?(ic()<=pt.DEBUG&&ze("QueryEngine","SDK will not create cache indexes for query:",sc(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ke.resolve()):(ic()<=pt.DEBUG&&ze("QueryEngine","Query:",sc(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(ic()<=pt.DEBUG&&ze("QueryEngine","The SDK decides to create cache indexes for query:",sc(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,di(r))):ke.resolve())}ys(e,r){if(Q2(r))return ke.resolve(null);let n=di(r);return this.indexManager.getIndexType(e,n).next((i=>i===0?null:(r.limit!==null&&i===1&&(r=Vg(r,null,"F"),n=di(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next((o=>{const c=gt(...o);return this.ps.getDocuments(e,c).next((u=>this.indexManager.getMinOffset(e,n).next((h=>{const d=this.Ds(r,u);return this.Cs(r,d,c,h.readTime)?this.ys(e,Vg(r,null,"F")):this.vs(e,d,r,h)}))))})))))}ws(e,r,n,i){return Q2(r)||i.isEqual(Ze.min())?ke.resolve(null):this.ps.getDocuments(e,n).next((o=>{const c=this.Ds(r,o);return this.Cs(r,c,n,i)?ke.resolve(null):(ic()<=pt.DEBUG&&ze("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),sc(r)),this.vs(e,c,r,zI(i,pf)).next((u=>u)))}))}Ds(e,r){let n=new Or(cw(e));return r.forEach(((i,o)=>{Od(e,o)&&(n=n.add(o))})),n}Cs(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const o=e.limitType==="F"?r.last():r.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Ss(e,r,n){return ic()<=pt.DEBUG&&ze("QueryEngine","Using full collection scan to execute query:",sc(r)),this.ps.getDocumentsMatchingQuery(e,r,lo.min(),n)}vs(e,r,n,i){return this.ps.getDocumentsMatchingQuery(e,n,i).next((o=>(r.forEach((c=>{o=o.insert(c.key,c)})),o)))}}const P1="LocalStore",T5=3e8;class S5{constructor(e,r,n,i){this.persistence=e,this.Fs=r,this.serializer=i,this.Ms=new or(mt),this.xs=new fl((o=>C1(o)),R1),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new f5(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(r=>e.collect(r,this.Ms)))}}function w5(t,e,r,n){return new S5(t,e,r,n)}async function Nw(t,e){const r=rt(t);return await r.persistence.runTransaction("Handle user change","readonly",(n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next((o=>(i=o,r.Bs(e),r.mutationQueue.getAllMutationBatches(n)))).next((o=>{const c=[],u=[];let h=gt();for(const d of i){c.push(d.batchId);for(const m of d.mutations)h=h.add(m.key)}for(const d of o){u.push(d.batchId);for(const m of d.mutations)h=h.add(m.key)}return r.localDocuments.getDocuments(n,h).next((d=>({Ls:d,removedBatchIds:c,addedBatchIds:u})))}))}))}function A5(t,e){const r=rt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const i=e.batch.keys(),o=r.Ns.newChangeBuffer({trackRemovals:!0});return(function(u,h,d,m){const v=d.batch,y=v.keys();let E=ke.resolve();return y.forEach((S=>{E=E.next((()=>m.getEntry(h,S))).next((T=>{const A=d.docVersions.get(S);Nt(A!==null,48541),T.version.compareTo(A)<0&&(v.applyToRemoteDocument(T,d),T.isValidDocument()&&(T.setReadTime(d.commitVersion),m.addEntry(T)))}))})),E.next((()=>u.mutationQueue.removeMutationBatch(h,v)))})(r,n,e,o).next((()=>o.apply(n))).next((()=>r.mutationQueue.performConsistencyCheck(n))).next((()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId))).next((()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(u){let h=gt();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(h=h.add(u.batch.mutations[d].key));return h})(e)))).next((()=>r.localDocuments.getDocuments(n,i)))}))}function Ow(t){const e=rt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(r=>e.Pi.getLastRemoteSnapshotVersion(r)))}function b5(t,e){const r=rt(t),n=e.snapshotVersion;let i=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const c=r.Ns.newChangeBuffer({trackRemovals:!0});i=r.Ms;const u=[];e.targetChanges.forEach(((m,v)=>{const y=i.get(v);if(!y)return;u.push(r.Pi.removeMatchingKeys(o,m.removedDocuments,v).next((()=>r.Pi.addMatchingKeys(o,m.addedDocuments,v))));let E=y.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(v)!==null?E=E.withResumeToken(Hr.EMPTY_BYTE_STRING,Ze.min()).withLastLimboFreeSnapshotVersion(Ze.min()):m.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(m.resumeToken,n)),i=i.insert(v,E),(function(T,A,B){return T.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=T5?!0:B.addedDocuments.size+B.modifiedDocuments.size+B.removedDocuments.size>0})(y,E,m)&&u.push(r.Pi.updateTargetData(o,E))}));let h=as(),d=gt();if(e.documentUpdates.forEach((m=>{e.resolvedLimboDocuments.has(m)&&u.push(r.persistence.referenceDelegate.updateLimboDocument(o,m))})),u.push(C5(o,c,e.documentUpdates).next((m=>{h=m.ks,d=m.qs}))),!n.isEqual(Ze.min())){const m=r.Pi.getLastRemoteSnapshotVersion(o).next((v=>r.Pi.setTargetsMetadata(o,o.currentSequenceNumber,n)));u.push(m)}return ke.waitFor(u).next((()=>c.apply(o))).next((()=>r.localDocuments.getLocalViewOfDocuments(o,h,d))).next((()=>h))})).then((o=>(r.Ms=i,o)))}function C5(t,e,r){let n=gt(),i=gt();return r.forEach((o=>n=n.add(o))),e.getEntries(t,n).next((o=>{let c=as();return r.forEach(((u,h)=>{const d=o.get(u);h.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(u)),h.isNoDocument()&&h.version.isEqual(Ze.min())?(e.removeEntry(u,h.readTime),c=c.insert(u,h)):!d.isValidDocument()||h.version.compareTo(d.version)>0||h.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(h),c=c.insert(u,h)):ze(P1,"Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",h.version)})),{ks:c,qs:i}}))}function R5(t,e){const r=rt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=w1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}function k5(t,e){const r=rt(t);return r.persistence.runTransaction("Allocate target","readwrite",(n=>{let i;return r.Pi.getTargetData(n,e).next((o=>o?(i=o,ke.resolve(i)):r.Pi.allocateTargetId(n).next((c=>(i=new $s(e,c,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,i).next((()=>i)))))))})).then((n=>{const i=r.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n}))}async function Gg(t,e,r){const n=rt(t),i=n.Ms.get(e),o=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",o,(c=>n.persistence.referenceDelegate.removeTarget(c,i)))}catch(c){if(!Pc(c))throw c;ze(P1,`Failed to update sequence numbers for target ${e}: ${c}`)}n.Ms=n.Ms.remove(e),n.xs.delete(i.target)}function uE(t,e,r){const n=rt(t);let i=Ze.min(),o=gt();return n.persistence.runTransaction("Execute query","readwrite",(c=>(function(h,d,m){const v=rt(h),y=v.xs.get(m);return y!==void 0?ke.resolve(v.Ms.get(y)):v.Pi.getTargetData(d,m)})(n,c,di(e)).next((u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(c,u.targetId).next((h=>{o=h}))})).next((()=>n.Fs.getDocumentsMatchingQuery(c,e,r?i:Ze.min(),r?o:gt()))).next((u=>(I5(n,pD(e),u),{documents:u,Qs:o})))))}function I5(t,e,r){let n=t.Os.get(e)||Ze.min();r.forEach(((i,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)})),t.Os.set(e,n)}class fE{constructor(){this.activeTargetIds=_D()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class D5{constructor(){this.Mo=new fE,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new fE,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class N5{Oo(e){}shutdown(){}}const hE="ConnectivityMonitor";class dE{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ze(hE,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ze(hE,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Eh=null;function qg(){return Eh===null?Eh=(function(){return 268435456+Math.round(2147483648*Math.random())})():Eh++,"0x"+Eh.toString(16)}const cg="RestConnection",O5={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class F5{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===Xh?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(e,r,n,i,o){const c=qg(),u=this.zo(e,r.toUriEncodedString());ze(cg,`Sending RPC '${e}' ${c}:`,u,n);const h={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(h,i,o);const{host:d}=new URL(u),m=Oc(d);return this.Jo(e,u,h,n,m).then((v=>(ze(cg,`Received RPC '${e}' ${c}: `,v),v)),(v=>{throw al(cg,`RPC '${e}' ${c} failed with error: `,v,"url: ",u,"request:",n),v}))}Ho(e,r,n,i,o,c){return this.Go(e,r,n,i,o)}jo(e,r,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Mc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach(((i,o)=>e[o]=i)),n&&n.headers.forEach(((i,o)=>e[o]=i))}zo(e,r){const n=O5[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}class M5{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const sn="WebChannelConnection";class L5 extends F5{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,i,o){const c=qg();return new Promise(((u,h)=>{const d=new FS;d.setWithCredentials(!0),d.listenOnce(MS.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case Fh.NO_ERROR:const v=d.getResponseJson();ze(sn,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(v)),u(v);break;case Fh.TIMEOUT:ze(sn,`RPC '${e}' ${c} timed out`),h(new je(be.DEADLINE_EXCEEDED,"Request time out"));break;case Fh.HTTP_ERROR:const y=d.getStatus();if(ze(sn,`RPC '${e}' ${c} failed with status:`,y,"response text:",d.getResponseText()),y>0){let E=d.getResponseJson();Array.isArray(E)&&(E=E[0]);const S=E?.error;if(S&&S.status&&S.message){const T=(function(B){const I=B.toLowerCase().replace(/_/g,"-");return Object.values(be).indexOf(I)>=0?I:be.UNKNOWN})(S.status);h(new je(T,S.message))}else h(new je(be.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new je(be.UNAVAILABLE,"Connection failed."));break;default:Ke(9055,{l_:e,streamId:c,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{ze(sn,`RPC '${e}' ${c} completed.`)}}));const m=JSON.stringify(i);ze(sn,`RPC '${e}' ${c} sending request:`,i),d.send(r,"POST",m,n,15)}))}T_(e,r,n){const i=qg(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=BS(),u=PS(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(h.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(h.useFetchStreams=!0),this.jo(h.initMessageHeaders,r,n),h.encodeInitMessageHeaders=!0;const m=o.join("");ze(sn,`Creating RPC '${e}' stream ${i}: ${m}`,h);const v=c.createWebChannel(m,h);this.I_(v);let y=!1,E=!1;const S=new M5({Yo:A=>{E?ze(sn,`Not sending because RPC '${e}' stream ${i} is closed:`,A):(y||(ze(sn,`Opening RPC '${e}' stream ${i} transport.`),v.open(),y=!0),ze(sn,`RPC '${e}' stream ${i} sending:`,A),v.send(A))},Zo:()=>v.close()}),T=(A,B,I)=>{A.listen(B,(C=>{try{I(C)}catch(G){setTimeout((()=>{throw G}),0)}}))};return T(v,zu.EventType.OPEN,(()=>{E||(ze(sn,`RPC '${e}' stream ${i} transport opened.`),S.o_())})),T(v,zu.EventType.CLOSE,(()=>{E||(E=!0,ze(sn,`RPC '${e}' stream ${i} transport closed`),S.a_(),this.E_(v))})),T(v,zu.EventType.ERROR,(A=>{E||(E=!0,al(sn,`RPC '${e}' stream ${i} transport errored. Name:`,A.name,"Message:",A.message),S.a_(new je(be.UNAVAILABLE,"The operation could not be completed")))})),T(v,zu.EventType.MESSAGE,(A=>{if(!E){const B=A.data[0];Nt(!!B,16349);const I=B,C=I?.error||I[0]?.error;if(C){ze(sn,`RPC '${e}' stream ${i} received error:`,C);const G=C.status;let K=(function(N){const D=Ar[N];if(D!==void 0)return _w(D)})(G),Y=C.message;K===void 0&&(K=be.INTERNAL,Y="Unknown error status: "+G+" with message "+C.message),E=!0,S.a_(new je(K,Y)),v.close()}else ze(sn,`RPC '${e}' stream ${i} received:`,B),S.u_(B)}})),T(u,LS.STAT_EVENT,(A=>{A.stat===Ng.PROXY?ze(sn,`RPC '${e}' stream ${i} detected buffering proxy`):A.stat===Ng.NOPROXY&&ze(sn,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{S.__()}),0),S}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((r=>r===e))}}function ug(){return typeof document<"u"?document:null}function Bd(t){return new UD(t,!0)}class Fw{constructor(e,r,n=1e3,i=1.5,o=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=i,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,r-n);i>0&&ze("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const pE="PersistentStream";class Mw{constructor(e,r,n,i,o,c,u,h){this.Mi=e,this.S_=n,this.b_=i,this.connection=o,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Fw(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===be.RESOURCE_EXHAUSTED?(ns(r.toString()),ns("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===be.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,i])=>{this.D_===r&&this.G_(n,i)}),(n=>{e((()=>{const i=new je(be.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)}))}))}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{n((()=>this.z_(i)))})),this.stream.onMessage((i=>{n((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ze(pE,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget((()=>this.D_===e?r():(ze(pE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class P5 extends Mw{constructor(e,r,n,i,o,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,c),this.serializer=o}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=HD(this.serializer,e),n=(function(o){if(!("targetChange"in o))return Ze.min();const c=o.targetChange;return c.targetIds&&c.targetIds.length?Ze.min():c.readTime?pi(c.readTime):Ze.min()})(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=Hg(this.serializer),r.addTarget=(function(o,c){let u;const h=c.target;if(u=Pg(h)?{documents:WD(o,h)}:{query:YD(o,h).ft},u.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){u.resumeToken=Sw(o,c.resumeToken);const d=Ug(o,c.expectedCount);d!==null&&(u.expectedCount=d)}else if(c.snapshotVersion.compareTo(Ze.min())>0){u.readTime=ed(o,c.snapshotVersion.toTimestamp());const d=Ug(o,c.expectedCount);d!==null&&(u.expectedCount=d)}return u})(this.serializer,e);const n=KD(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=Hg(this.serializer),r.removeTarget=e,this.q_(r)}}class B5 extends Mw{constructor(e,r,n,i,o,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,c),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Nt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Nt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Nt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=qD(e.writeResults,e.commitTime),n=pi(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=Hg(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map((n=>GD(this.serializer,n)))};this.q_(r)}}class V5{}class U5 extends V5{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new je(be.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.Go(e,jg(r,n),i,o,c))).catch((o=>{throw o.name==="FirebaseError"?(o.code===be.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new je(be.UNKNOWN,o.toString())}))}Ho(e,r,n,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,u])=>this.connection.Ho(e,jg(r,n),i,c,u,o))).catch((c=>{throw c.name==="FirebaseError"?(c.code===be.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new je(be.UNKNOWN,c.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class j5{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ns(r),this.aa=!1):ze("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const il="RemoteStore";class z5{constructor(e,r,n,i,o){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo((c=>{n.enqueueAndForget((async()=>{hl(this)&&(ze(il,"Restarting streams for network reachability change."),await(async function(h){const d=rt(h);d.Ea.add(4),await Lf(d),d.Ra.set("Unknown"),d.Ea.delete(4),await Vd(d)})(this))}))})),this.Ra=new j5(n,i)}}async function Vd(t){if(hl(t))for(const e of t.da)await e(!0)}async function Lf(t){for(const e of t.da)await e(!1)}function Lw(t,e){const r=rt(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),j1(r)?U1(r):Bc(r).O_()&&V1(r,e))}function B1(t,e){const r=rt(t),n=Bc(r);r.Ia.delete(e),n.O_()&&Pw(r,e),r.Ia.size===0&&(n.O_()?n.L_():hl(r)&&r.Ra.set("Unknown"))}function V1(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ze.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Bc(t).Y_(e)}function Pw(t,e){t.Va.Ue(e),Bc(t).Z_(e)}function U1(t){t.Va=new LD({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Bc(t).start(),t.Ra.ua()}function j1(t){return hl(t)&&!Bc(t).x_()&&t.Ia.size>0}function hl(t){return rt(t).Ea.size===0}function Bw(t){t.Va=void 0}async function H5(t){t.Ra.set("Online")}async function G5(t){t.Ia.forEach(((e,r)=>{V1(t,e)}))}async function q5(t,e){Bw(t),j1(t)?(t.Ra.ha(e),U1(t)):t.Ra.set("Unknown")}async function W5(t,e,r){if(t.Ra.set("Online"),e instanceof Tw&&e.state===2&&e.cause)try{await(async function(i,o){const c=o.cause;for(const u of o.targetIds)i.Ia.has(u)&&(await i.remoteSyncer.rejectListen(u,c),i.Ia.delete(u),i.Va.removeTarget(u))})(t,e)}catch(n){ze(il,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await rd(t,n)}else if(e instanceof Bh?t.Va.Ze(e):e instanceof Ew?t.Va.st(e):t.Va.tt(e),!r.isEqual(Ze.min()))try{const n=await Ow(t.localStore);r.compareTo(n)>=0&&await(function(o,c){const u=o.Va.Tt(c);return u.targetChanges.forEach(((h,d)=>{if(h.resumeToken.approximateByteSize()>0){const m=o.Ia.get(d);m&&o.Ia.set(d,m.withResumeToken(h.resumeToken,c))}})),u.targetMismatches.forEach(((h,d)=>{const m=o.Ia.get(h);if(!m)return;o.Ia.set(h,m.withResumeToken(Hr.EMPTY_BYTE_STRING,m.snapshotVersion)),Pw(o,h);const v=new $s(m.target,h,d,m.sequenceNumber);V1(o,v)})),o.remoteSyncer.applyRemoteEvent(u)})(t,r)}catch(n){ze(il,"Failed to raise snapshot:",n),await rd(t,n)}}async function rd(t,e,r){if(!Pc(e))throw e;t.Ea.add(1),await Lf(t),t.Ra.set("Offline"),r||(r=()=>Ow(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{ze(il,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await Vd(t)}))}function Vw(t,e){return e().catch((r=>rd(t,r,e)))}async function Ud(t){const e=rt(t),r=ho(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:w1;for(;Y5(e);)try{const i=await R5(e.localStore,n);if(i===null){e.Ta.length===0&&r.L_();break}n=i.batchId,X5(e,i)}catch(i){await rd(e,i)}Uw(e)&&jw(e)}function Y5(t){return hl(t)&&t.Ta.length<10}function X5(t,e){t.Ta.push(e);const r=ho(t);r.O_()&&r.X_&&r.ea(e.mutations)}function Uw(t){return hl(t)&&!ho(t).x_()&&t.Ta.length>0}function jw(t){ho(t).start()}async function K5(t){ho(t).ra()}async function $5(t){const e=ho(t);for(const r of t.Ta)e.ea(r.mutations)}async function Q5(t,e,r){const n=t.Ta.shift(),i=D1.from(n,e,r);await Vw(t,(()=>t.remoteSyncer.applySuccessfulWrite(i))),await Ud(t)}async function J5(t,e){e&&ho(t).X_&&await(async function(n,i){if((function(c){return OD(c)&&c!==be.ABORTED})(i.code)){const o=n.Ta.shift();ho(n).B_(),await Vw(n,(()=>n.remoteSyncer.rejectFailedWrite(o.batchId,i))),await Ud(n)}})(t,e),Uw(t)&&jw(t)}async function mE(t,e){const r=rt(t);r.asyncQueue.verifyOperationInProgress(),ze(il,"RemoteStore received new credentials");const n=hl(r);r.Ea.add(3),await Lf(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await Vd(r)}async function Z5(t,e){const r=rt(t);e?(r.Ea.delete(2),await Vd(r)):e||(r.Ea.add(2),await Lf(r),r.Ra.set("Unknown"))}function Bc(t){return t.ma||(t.ma=(function(r,n,i){const o=rt(r);return o.sa(),new P5(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(t.datastore,t.asyncQueue,{Xo:H5.bind(null,t),t_:G5.bind(null,t),r_:q5.bind(null,t),H_:W5.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),j1(t)?U1(t):t.Ra.set("Unknown")):(await t.ma.stop(),Bw(t))}))),t.ma}function ho(t){return t.fa||(t.fa=(function(r,n,i){const o=rt(r);return o.sa(),new B5(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:K5.bind(null,t),r_:J5.bind(null,t),ta:$5.bind(null,t),na:Q5.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await Ud(t)):(await t.fa.stop(),t.Ta.length>0&&(ze(il,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class z1{constructor(e,r,n,i,o){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=o,this.deferred=new no,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,o){const c=Date.now()+n,u=new z1(e,r,c,i,o);return u.start(n),u}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new je(be.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function H1(t,e){if(ns("AsyncQueue",`${e}: ${t}`),Pc(t))return new je(be.UNAVAILABLE,`${e}: ${t}`);throw t}class hc{static emptySet(e){return new hc(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||We.comparator(r.key,n.key):(r,n)=>We.comparator(r.key,n.key),this.keyedMap=Hu(),this.sortedSet=new or(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((r,n)=>(e(r),!1)))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof hc)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach((r=>{e.push(r.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new hc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}class gE{constructor(){this.ga=new or(We.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):Ke(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal(((r,n)=>{e.push(n)})),e}}class bc{constructor(e,r,n,i,o,c,u,h,d){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=o,this.fromCache=c,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=d}static fromInitialDocuments(e,r,n,i,o){const c=[];return r.forEach((u=>{c.push({type:0,doc:u})})),new bc(e,r,hc.emptySet(r),c,n,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Nd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}class e6{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class t6{constructor(){this.queries=xE(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const i=rt(r),o=i.queries;i.queries=xE(),o.forEach(((c,u)=>{for(const h of u.Sa)h.onError(n)}))})(this,new je(be.ABORTED,"Firestore shutting down"))}}function xE(){return new fl((t=>lw(t)),Nd)}async function zw(t,e){const r=rt(t);let n=3;const i=e.query;let o=r.queries.get(i);o?!o.ba()&&e.Da()&&(n=2):(o=new e6,n=e.Da()?0:1);try{switch(n){case 0:o.wa=await r.onListen(i,!0);break;case 1:o.wa=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(c){const u=H1(c,`Initialization of query '${sc(e.query)}' failed`);return void e.onError(u)}r.queries.set(i,o),o.Sa.push(e),e.va(r.onlineState),o.wa&&e.Fa(o.wa)&&G1(r)}async function Hw(t,e){const r=rt(t),n=e.query;let i=3;const o=r.queries.get(n);if(o){const c=o.Sa.indexOf(e);c>=0&&(o.Sa.splice(c,1),o.Sa.length===0?i=e.Da()?0:1:!o.ba()&&e.Da()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function r6(t,e){const r=rt(t);let n=!1;for(const i of e){const o=i.query,c=r.queries.get(o);if(c){for(const u of c.Sa)u.Fa(i)&&(n=!0);c.wa=i}}n&&G1(r)}function n6(t,e,r){const n=rt(t),i=n.queries.get(e);if(i)for(const o of i.Sa)o.onError(r);n.queries.delete(e)}function G1(t){t.Ca.forEach((e=>{e.next()}))}var Wg,vE;(vE=Wg||(Wg={})).Ma="default",vE.Cache="cache";class Gw{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new bc(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=bc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Wg.Cache}}class qw{constructor(e){this.key=e}}class Ww{constructor(e){this.key=e}}class a6{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=gt(),this.mutatedKeys=gt(),this.eu=cw(e),this.tu=new hc(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new gE,i=r?r.tu:this.tu;let o=r?r.mutatedKeys:this.mutatedKeys,c=i,u=!1;const h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((m,v)=>{const y=i.get(m),E=Od(this.query,v)?v:null,S=!!y&&this.mutatedKeys.has(y.key),T=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let A=!1;y&&E?y.data.isEqual(E.data)?S!==T&&(n.track({type:3,doc:E}),A=!0):this.su(y,E)||(n.track({type:2,doc:E}),A=!0,(h&&this.eu(E,h)>0||d&&this.eu(E,d)<0)&&(u=!0)):!y&&E?(n.track({type:0,doc:E}),A=!0):y&&!E&&(n.track({type:1,doc:y}),A=!0,(h||d)&&(u=!0)),A&&(E?(c=c.add(E),o=T?o.add(m):o.delete(m)):(c=c.delete(m),o=o.delete(m)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const m=this.query.limitType==="F"?c.last():c.first();c=c.delete(m.key),o=o.delete(m.key),n.track({type:1,doc:m})}return{tu:c,iu:n,Cs:u,mutatedKeys:o}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const c=e.iu.ya();c.sort(((m,v)=>(function(E,S){const T=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ke(20277,{Rt:A})}};return T(E)-T(S)})(m.type,v.type)||this.eu(m.doc,v.doc))),this.ou(n),i=i??!1;const u=r&&!i?this._u():[],h=this.Xa.size===0&&this.current&&!i?1:0,d=h!==this.Za;return this.Za=h,c.length!==0||d?{snapshot:new bc(this.query,e.tu,o,c,e.mutatedKeys,h===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new gE,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((r=>this.Ya=this.Ya.add(r))),e.modifiedDocuments.forEach((r=>{})),e.removedDocuments.forEach((r=>this.Ya=this.Ya.delete(r))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=gt(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))}));const r=[];return e.forEach((n=>{this.Xa.has(n)||r.push(new Ww(n))})),this.Xa.forEach((n=>{e.has(n)||r.push(new qw(n))})),r}cu(e){this.Ya=e.Qs,this.Xa=gt();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return bc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const q1="SyncEngine";class i6{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class s6{constructor(e){this.key=e,this.hu=!1}}class o6{constructor(e,r,n,i,o,c){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=c,this.Pu={},this.Tu=new fl((u=>lw(u)),Nd),this.Iu=new Map,this.Eu=new Set,this.du=new or(We.comparator),this.Au=new Map,this.Ru=new F1,this.Vu={},this.mu=new Map,this.fu=Ac.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function l6(t,e,r=!0){const n=Jw(t);let i;const o=n.Tu.get(e);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await Yw(n,e,r,!0),i}async function c6(t,e){const r=Jw(t);await Yw(r,e,!0,!1)}async function Yw(t,e,r,n){const i=await k5(t.localStore,di(e)),o=i.targetId,c=t.sharedClientState.addLocalQueryTarget(o,r);let u;return n&&(u=await u6(t,e,o,c==="current",i.resumeToken)),t.isPrimaryClient&&r&&Lw(t.remoteStore,i),u}async function u6(t,e,r,n,i){t.pu=(v,y,E)=>(async function(T,A,B,I){let C=A.view.ru(B);C.Cs&&(C=await uE(T.localStore,A.query,!1).then((({documents:b})=>A.view.ru(b,C))));const G=I&&I.targetChanges.get(A.targetId),K=I&&I.targetMismatches.get(A.targetId)!=null,Y=A.view.applyChanges(C,T.isPrimaryClient,G,K);return _E(T,A.targetId,Y.au),Y.snapshot})(t,v,y,E);const o=await uE(t.localStore,e,!0),c=new a6(e,o.Qs),u=c.ru(o.documents),h=Mf.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),d=c.applyChanges(u,t.isPrimaryClient,h);_E(t,r,d.au);const m=new i6(e,r,c);return t.Tu.set(e,m),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),d.snapshot}async function f6(t,e,r){const n=rt(t),i=n.Tu.get(e),o=n.Iu.get(i.targetId);if(o.length>1)return n.Iu.set(i.targetId,o.filter((c=>!Nd(c,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Gg(n.localStore,i.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(i.targetId),r&&B1(n.remoteStore,i.targetId),Yg(n,i.targetId)})).catch(Lc)):(Yg(n,i.targetId),await Gg(n.localStore,i.targetId,!0))}async function h6(t,e){const r=rt(t),n=r.Tu.get(e),i=r.Iu.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),B1(r.remoteStore,n.targetId))}async function d6(t,e,r){const n=_6(t);try{const i=await(function(c,u){const h=rt(c),d=Kt.now(),m=u.reduce(((E,S)=>E.add(S.key)),gt());let v,y;return h.persistence.runTransaction("Locally write mutations","readwrite",(E=>{let S=as(),T=gt();return h.Ns.getEntries(E,m).next((A=>{S=A,S.forEach(((B,I)=>{I.isValidDocument()||(T=T.add(B))}))})).next((()=>h.localDocuments.getOverlayedDocuments(E,S))).next((A=>{v=A;const B=[];for(const I of u){const C=RD(I,v.get(I.key).overlayedDocument);C!=null&&B.push(new vo(I.key,C,ew(C.value.mapValue),Vn.exists(!0)))}return h.mutationQueue.addMutationBatch(E,d,B,u)})).next((A=>{y=A;const B=A.applyToLocalDocumentSet(v,T);return h.documentOverlayCache.saveOverlays(E,A.batchId,B)}))})).then((()=>({batchId:y.batchId,changes:fw(v)})))})(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),(function(c,u,h){let d=c.Vu[c.currentUser.toKey()];d||(d=new or(mt)),d=d.insert(u,h),c.Vu[c.currentUser.toKey()]=d})(n,i.batchId,r),await Pf(n,i.changes),await Ud(n.remoteStore)}catch(i){const o=H1(i,"Failed to persist write");r.reject(o)}}async function Xw(t,e){const r=rt(t);try{const n=await b5(r.localStore,e);e.targetChanges.forEach(((i,o)=>{const c=r.Au.get(o);c&&(Nt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?c.hu=!0:i.modifiedDocuments.size>0?Nt(c.hu,14607):i.removedDocuments.size>0&&(Nt(c.hu,42227),c.hu=!1))})),await Pf(r,n,e)}catch(n){await Lc(n)}}function yE(t,e,r){const n=rt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Tu.forEach(((o,c)=>{const u=c.view.va(e);u.snapshot&&i.push(u.snapshot)})),(function(c,u){const h=rt(c);h.onlineState=u;let d=!1;h.queries.forEach(((m,v)=>{for(const y of v.Sa)y.va(u)&&(d=!0)})),d&&G1(h)})(n.eventManager,e),i.length&&n.Pu.H_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function p6(t,e,r){const n=rt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Au.get(e),o=i&&i.key;if(o){let c=new or(We.comparator);c=c.insert(o,un.newNoDocument(o,Ze.min()));const u=gt().add(o),h=new Pd(Ze.min(),new Map,new or(mt),c,u);await Xw(n,h),n.du=n.du.remove(o),n.Au.delete(e),W1(n)}else await Gg(n.localStore,e,!1).then((()=>Yg(n,e,r))).catch(Lc)}async function m6(t,e){const r=rt(t),n=e.batch.batchId;try{const i=await A5(r.localStore,e);$w(r,n,null),Kw(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Pf(r,i)}catch(i){await Lc(i)}}async function g6(t,e,r){const n=rt(t);try{const i=await(function(c,u){const h=rt(c);return h.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let m;return h.mutationQueue.lookupMutationBatch(d,u).next((v=>(Nt(v!==null,37113),m=v.keys(),h.mutationQueue.removeMutationBatch(d,v)))).next((()=>h.mutationQueue.performConsistencyCheck(d))).next((()=>h.documentOverlayCache.removeOverlaysForBatchId(d,m,u))).next((()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,m))).next((()=>h.localDocuments.getDocuments(d,m)))}))})(n.localStore,e);$w(n,e,r),Kw(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Pf(n,i)}catch(i){await Lc(i)}}function Kw(t,e){(t.mu.get(e)||[]).forEach((r=>{r.resolve()})),t.mu.delete(e)}function $w(t,e,r){const n=rt(t);let i=n.Vu[n.currentUser.toKey()];if(i){const o=i.get(e);o&&(r?o.reject(r):o.resolve(),i=i.remove(e)),n.Vu[n.currentUser.toKey()]=i}}function Yg(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((n=>{t.Ru.containsKey(n)||Qw(t,n)}))}function Qw(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(B1(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),W1(t))}function _E(t,e,r){for(const n of r)n instanceof qw?(t.Ru.addReference(n.key,e),x6(t,n)):n instanceof Ww?(ze(q1,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||Qw(t,n.key)):Ke(19791,{wu:n})}function x6(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(ze(q1,"New document in limbo: "+r),t.Eu.add(n),W1(t))}function W1(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new We(Xt.fromString(e)),n=t.fu.next();t.Au.set(n,new s6(r)),t.du=t.du.insert(r,n),Lw(t.remoteStore,new $s(di(k1(r.path)),n,"TargetPurposeLimboResolution",kd.ce))}}async function Pf(t,e,r){const n=rt(t),i=[],o=[],c=[];n.Tu.isEmpty()||(n.Tu.forEach(((u,h)=>{c.push(n.pu(h,e,r).then((d=>{if((d||r)&&n.isPrimaryClient){const m=d?!d.fromCache:r?.targetChanges.get(h.targetId)?.current;n.sharedClientState.updateQueryState(h.targetId,m?"current":"not-current")}if(d){i.push(d);const m=L1.As(h.targetId,d);o.push(m)}})))})),await Promise.all(c),n.Pu.H_(i),await(async function(h,d){const m=rt(h);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>ke.forEach(d,(y=>ke.forEach(y.Es,(E=>m.persistence.referenceDelegate.addReference(v,y.targetId,E))).next((()=>ke.forEach(y.ds,(E=>m.persistence.referenceDelegate.removeReference(v,y.targetId,E)))))))))}catch(v){if(!Pc(v))throw v;ze(P1,"Failed to update sequence numbers: "+v)}for(const v of d){const y=v.targetId;if(!v.fromCache){const E=m.Ms.get(y),S=E.snapshotVersion,T=E.withLastLimboFreeSnapshotVersion(S);m.Ms=m.Ms.insert(y,T)}}})(n.localStore,o))}async function v6(t,e){const r=rt(t);if(!r.currentUser.isEqual(e)){ze(q1,"User change. New user:",e.toKey());const n=await Nw(r.localStore,e);r.currentUser=e,(function(o,c){o.mu.forEach((u=>{u.forEach((h=>{h.reject(new je(be.CANCELLED,c))}))})),o.mu.clear()})(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Pf(r,n.Ls)}}function y6(t,e){const r=rt(t),n=r.Au.get(e);if(n&&n.hu)return gt().add(n.key);{let i=gt();const o=r.Iu.get(e);if(!o)return i;for(const c of o){const u=r.Tu.get(c);i=i.unionWith(u.view.nu)}return i}}function Jw(t){const e=rt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Xw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=y6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=p6.bind(null,e),e.Pu.H_=r6.bind(null,e.eventManager),e.Pu.yu=n6.bind(null,e.eventManager),e}function _6(t){const e=rt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=m6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=g6.bind(null,e),e}class nd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Bd(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return w5(this.persistence,new E5,e.initialUser,this.serializer)}Cu(e){return new Dw(M1.mi,this.serializer)}Du(e){return new D5}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}nd.provider={build:()=>new nd};class E6 extends nd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Nt(this.persistence.referenceDelegate instanceof td,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new s5(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?Ln.withCacheSize(this.cacheSizeBytes):Ln.DEFAULT;return new Dw((n=>td.mi(n,r)),this.serializer)}}class Xg{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>yE(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=v6.bind(null,this.syncEngine),await Z5(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new t6})()}createDatastore(e){const r=Bd(e.databaseInfo.databaseId),n=(function(o){return new L5(o)})(e.databaseInfo);return(function(o,c,u,h){return new U5(o,c,u,h)})(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return(function(n,i,o,c,u){return new z5(n,i,o,c,u)})(this.localStore,this.datastore,e.asyncQueue,(r=>yE(this.syncEngine,r,0)),(function(){return dE.v()?new dE:new N5})())}createSyncEngine(e,r){return(function(i,o,c,u,h,d,m){const v=new o6(i,o,c,u,h,d);return m&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await(async function(r){const n=rt(r);ze(il,"RemoteStore shutting down."),n.Ea.add(5),await Lf(n),n.Aa.shutdown(),n.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Xg.provider={build:()=>new Xg};class Zw{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ns("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout((()=>{this.muted||e(r)}),0)}}const po="FirestoreClient";class T6{constructor(e,r,n,i,o){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=ln.UNAUTHENTICATED,this.clientId=Cd.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,(async c=>{ze(po,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(n,(c=>(ze(po,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new no;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=H1(r,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function fg(t,e){t.asyncQueue.verifyOperationInProgress(),ze(po,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener((async i=>{n.isEqual(i)||(await Nw(e.localStore,i),n=i)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function EE(t,e){t.asyncQueue.verifyOperationInProgress();const r=await S6(t);ze(po,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener((n=>mE(e.remoteStore,n))),t.setAppCheckTokenChangeListener(((n,i)=>mE(e.remoteStore,i))),t._onlineComponents=e}async function S6(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ze(po,"Using user provided OfflineComponentProvider");try{await fg(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!(function(i){return i.name==="FirebaseError"?i.code===be.FAILED_PRECONDITION||i.code===be.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(r))throw r;al("Error using user provided cache. Falling back to memory cache: "+r),await fg(t,new nd)}}else ze(po,"Using default OfflineComponentProvider"),await fg(t,new E6(void 0));return t._offlineComponents}async function eA(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ze(po,"Using user provided OnlineComponentProvider"),await EE(t,t._uninitializedComponentsProvider._online)):(ze(po,"Using default OnlineComponentProvider"),await EE(t,new Xg))),t._onlineComponents}function w6(t){return eA(t).then((e=>e.syncEngine))}async function Kg(t){const e=await eA(t),r=e.eventManager;return r.onListen=l6.bind(null,e.syncEngine),r.onUnlisten=f6.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=c6.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=h6.bind(null,e.syncEngine),r}function A6(t,e,r={}){const n=new no;return t.asyncQueue.enqueueAndForget((async()=>(function(o,c,u,h,d){const m=new Zw({next:y=>{m.Nu(),c.enqueueAndForget((()=>Hw(o,v))),y.fromCache&&h.source==="server"?d.reject(new je(be.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(y)},error:y=>d.reject(y)}),v=new Gw(u,m,{includeMetadataChanges:!0,qa:!0});return zw(o,v)})(await Kg(t),t.asyncQueue,e,r,n))),n.promise}function tA(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const TE=new Map;const rA="firestore.googleapis.com",SE=!0;class wE{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new je(be.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=rA,this.ssl=SE}else this.host=e.host,this.ssl=e.ssl??SE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Iw;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<a5)throw new je(be.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}HS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=tA(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new je(be.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new je(be.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new je(be.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,i){return n.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class jd{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new wE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new je(be.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new je(be.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new wE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new jS;switch(n.type){case"firstParty":return new LI(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new je(be.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(r){const n=TE.get(r);n&&(ze("ComponentProvider","Removing Datastore"),TE.delete(r),n.terminate())})(this),Promise.resolve()}}function nA(t,e,r,n={}){t=Sa(t,jd);const i=Oc(e),o=t._getSettings(),c={...o,emulatorOptions:t._getEmulatorOptions()},u=`${e}:${r}`;i&&(AS(`https://${u}`),bS("Firestore",!0)),o.host!==rA&&o.host!==u&&al("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h={...o,host:u,ssl:i,emulatorOptions:n};if(!oo(h,c)&&(t._setSettings(h),n.mockUserToken)){let d,m;if(typeof n.mockUserToken=="string")d=n.mockUserToken,m=ln.MOCK_USER;else{d=a3(n.mockUserToken,t._app?.options.projectId);const v=n.mockUserToken.sub||n.mockUserToken.user_id;if(!v)throw new je(be.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new ln(v)}t._authCredentials=new OI(new US(d,m))}}class yo{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new yo(this.firestore,e,this._query)}}class vr{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Qi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new vr(this.firestore,e,this._key)}toJSON(){return{type:vr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(Nf(r,vr._jsonSchema))return new vr(e,n||null,new We(Xt.fromString(r.referencePath)))}}vr._jsonSchemaVersion="firestore/documentReference/1.0",vr._jsonSchema={type:kr("string",vr._jsonSchemaVersion),referencePath:kr("string")};class Qi extends yo{constructor(e,r,n){super(e,r,k1(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new vr(this.firestore,null,new We(e))}withConverter(e){return new Qi(this.firestore,e,this._path)}}function Zr(t,e,...r){if(t=Mr(t),zS("collection","path",e),t instanceof jd){const n=Xt.fromString(e,...r);return P2(n),new Qi(t,null,n)}{if(!(t instanceof vr||t instanceof Qi))throw new je(be.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Xt.fromString(e,...r));return P2(n),new Qi(t.firestore,null,n)}}function ra(t,e,...r){if(t=Mr(t),arguments.length===1&&(e=Cd.newId()),zS("doc","path",e),t instanceof jd){const n=Xt.fromString(e,...r);return L2(n),new vr(t,null,new We(n))}{if(!(t instanceof vr||t instanceof Qi))throw new je(be.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Xt.fromString(e,...r));return L2(n),new vr(t.firestore,t instanceof Qi?t.converter:null,new We(n))}}const AE="AsyncQueue";class bE{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Fw(this,"async_queue_retry"),this._c=()=>{const n=ug();n&&ze(AE,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=ug();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=ug();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const r=new no;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise))).then((()=>r.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Pc(e))throw e;ze(AE,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const r=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,ns("INTERNAL UNHANDLED ERROR: ",CE(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const i=z1.createAndSchedule(this,e,r,n,(o=>this.hc(o)));return this.tc.push(i),i}uc(){this.nc&&Ke(47125,{Pc:CE(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((r,n)=>r.targetTimeMs-n.targetTimeMs));for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function CE(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}function RE(t){return(function(r,n){if(typeof r!="object"||r===null)return!1;const i=r;for(const o of n)if(o in i&&typeof i[o]=="function")return!0;return!1})(t,["next","error","complete"])}class is extends jd{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new bE,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new bE(e),this._firestoreClient=void 0,await e}}}function aA(t,e){const r=typeof t=="object"?t:IS(),n=typeof t=="string"?t:Xh,i=T1(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const o=r3("firestore");o&&nA(i,...o)}return i}function Bf(t){if(t._terminated)throw new je(be.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||b6(t),t._firestoreClient}function b6(t){const e=t._freezeSettings(),r=(function(i,o,c,u){return new JI(i,o,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,tA(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new T6(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&(function(i){const o=i?._online.build();return{_offline:i?._offline.build(o),_online:o}})(t._componentsProvider))}class Zn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Zn(Hr.fromBase64String(e))}catch(r){throw new je(be.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Zn(Hr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Zn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Nf(e,Zn._jsonSchema))return Zn.fromBase64String(e.bytes)}}Zn._jsonSchemaVersion="firestore/bytes/1.0",Zn._jsonSchema={type:kr("string",Zn._jsonSchemaVersion),bytes:kr("string")};class Vc{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new je(be.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new jr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Vf{constructor(e){this._methodName=e}}class Wa{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new je(be.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new je(be.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return mt(this._lat,e._lat)||mt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Wa._jsonSchemaVersion}}static fromJSON(e){if(Nf(e,Wa._jsonSchema))return new Wa(e.latitude,e.longitude)}}Wa._jsonSchemaVersion="firestore/geoPoint/1.0",Wa._jsonSchema={type:kr("string",Wa._jsonSchemaVersion),latitude:kr("number"),longitude:kr("number")};class Ya{constructor(e){this._values=(e||[]).map((r=>r))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,i){if(n.length!==i.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==i[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Ya._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Nf(e,Ya._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((r=>typeof r=="number")))return new Ya(e.vectorValues);throw new je(be.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ya._jsonSchemaVersion="firestore/vectorValue/1.0",Ya._jsonSchema={type:kr("string",Ya._jsonSchemaVersion),vectorValues:kr("object")};const C6=/^__.*__$/;class R6{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new vo(e,this.data,this.fieldMask,r,this.fieldTransforms):new Ff(e,this.data,r,this.fieldTransforms)}}class iA{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new vo(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function sA(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ke(40011,{Ac:t})}}class zd{constructor(e,r,n,i,o,c){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new zd({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return ad(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((r=>e.isPrefixOf(r)))!==void 0||this.fieldTransforms.find((r=>e.isPrefixOf(r.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(sA(this.Ac)&&C6.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class k6{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Bd(e)}Cc(e,r,n,i=!1){return new zd({Ac:e,methodName:r,Dc:n,path:jr.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Hd(t){const e=t._freezeSettings(),r=Bd(t._databaseId);return new k6(t._databaseId,!!e.ignoreUndefinedProperties,r)}function oA(t,e,r,n,i,o={}){const c=t.Cc(o.merge||o.mergeFields?2:0,e,r,i);X1("Data must be an object, but it was:",c,n);const u=uA(n,c);let h,d;if(o.merge)h=new ta(c.fieldMask),d=c.fieldTransforms;else if(o.mergeFields){const m=[];for(const v of o.mergeFields){const y=$g(e,v,r);if(!c.contains(y))throw new je(be.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);hA(m,y)||m.push(y)}h=new ta(m),d=c.fieldTransforms.filter((v=>h.covers(v.field)))}else h=null,d=c.fieldTransforms;return new R6(new Bn(u),h,d)}class Gd extends Vf{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Gd}}function I6(t,e,r){return new zd({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:r},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Y1 extends Vf{constructor(e,r){super(e),this.vc=r}_toFieldTransform(e){const r=I6(this,e,!0),n=this.vc.map((o=>Uc(o,r))),i=new wc(n);return new wD(e.path,i)}isEqual(e){return e instanceof Y1&&oo(this.vc,e.vc)}}function lA(t,e,r,n){const i=t.Cc(1,e,r);X1("Data must be an object, but it was:",i,n);const o=[],c=Bn.empty();xo(n,((h,d)=>{const m=K1(e,h,r);d=Mr(d);const v=i.yc(m);if(d instanceof Gd)o.push(m);else{const y=Uc(d,v);y!=null&&(o.push(m),c.set(m,y))}}));const u=new ta(o);return new iA(c,u,i.fieldTransforms)}function cA(t,e,r,n,i,o){const c=t.Cc(1,e,r),u=[$g(e,n,r)],h=[i];if(o.length%2!=0)throw new je(be.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let y=0;y<o.length;y+=2)u.push($g(e,o[y])),h.push(o[y+1]);const d=[],m=Bn.empty();for(let y=u.length-1;y>=0;--y)if(!hA(d,u[y])){const E=u[y];let S=h[y];S=Mr(S);const T=c.yc(E);if(S instanceof Gd)d.push(E);else{const A=Uc(S,T);A!=null&&(d.push(E),m.set(E,A))}}const v=new ta(d);return new iA(m,v,c.fieldTransforms)}function D6(t,e,r,n=!1){return Uc(r,t.Cc(n?4:3,e))}function Uc(t,e){if(fA(t=Mr(t)))return X1("Unsupported field value:",e,t),uA(t,e);if(t instanceof Vf)return(function(n,i){if(!sA(i.Ac))throw i.Sc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(i);o&&i.fieldTransforms.push(o)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(n,i){const o=[];let c=0;for(const u of n){let h=Uc(u,i.wc(c));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),c++}return{arrayValue:{values:o}}})(t,e)}return(function(n,i){if((n=Mr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return ED(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=Kt.fromDate(n);return{timestampValue:ed(i.serializer,o)}}if(n instanceof Kt){const o=new Kt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:ed(i.serializer,o)}}if(n instanceof Wa)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Zn)return{bytesValue:Sw(i.serializer,n._byteString)};if(n instanceof vr){const o=i.databaseId,c=n.firestore._databaseId;if(!c.isEqual(o))throw i.Sc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:O1(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof Ya)return(function(c,u){return{mapValue:{fields:{[JS]:{stringValue:ZS},[Kh]:{arrayValue:{values:c.toArray().map((d=>{if(typeof d!="number")throw u.Sc("VectorValues must only contain numeric values.");return I1(u.serializer,d)}))}}}}}})(n,i);throw i.Sc(`Unsupported field value: ${Rd(n)}`)})(t,e)}function uA(t,e){const r={};return WS(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):xo(t,((n,i)=>{const o=Uc(i,e.mc(n));o!=null&&(r[n]=o)})),{mapValue:{fields:r}}}function fA(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Kt||t instanceof Wa||t instanceof Zn||t instanceof vr||t instanceof Vf||t instanceof Ya)}function X1(t,e,r){if(!fA(r)||!GS(r)){const n=Rd(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function $g(t,e,r){if((e=Mr(e))instanceof Vc)return e._internalPath;if(typeof e=="string")return K1(t,e);throw ad("Field path arguments must be of type string or ",t,!1,void 0,r)}const N6=new RegExp("[~\\*/\\[\\]]");function K1(t,e,r){if(e.search(N6)>=0)throw ad(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Vc(...e.split("."))._internalPath}catch{throw ad(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function ad(t,e,r,n,i){const o=n&&!n.isEmpty(),c=i!==void 0;let u=`Function ${e}() called with invalid data`;r&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(o||c)&&(h+=" (found",o&&(h+=` in field ${n}`),c&&(h+=` in document ${i}`),h+=")"),new je(be.INVALID_ARGUMENT,u+t+h)}function hA(t,e){return t.some((r=>r.isEqual(e)))}class dA{constructor(e,r,n,i,o){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new vr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new O6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field($1("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class O6 extends dA{data(){return super.data()}}function $1(t,e){return typeof e=="string"?K1(t,e):e instanceof Vc?e._internalPath:e._delegate._internalPath}function pA(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new je(be.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Q1{}class mA extends Q1{}function Xa(t,e,...r){let n=[];e instanceof Q1&&n.push(e),n=n.concat(r),(function(o){const c=o.filter((h=>h instanceof qd)).length,u=o.filter((h=>h instanceof Uf)).length;if(c>1||c>0&&u>0)throw new je(be.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(n);for(const i of n)t=i._apply(t);return t}class Uf extends mA{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Uf(e,r,n)}_apply(e){const r=this._parse(e);return gA(e._query,r),new yo(e.firestore,e.converter,Bg(e._query,r))}_parse(e){const r=Hd(e.firestore);return(function(o,c,u,h,d,m,v){let y;if(d.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new je(be.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){IE(v,m);const S=[];for(const T of v)S.push(kE(h,o,T));y={arrayValue:{values:S}}}else y=kE(h,o,v)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||IE(v,m),y=D6(u,c,v,m==="in"||m==="not-in");return Rr.create(d,m,y)})(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function Pn(t,e,r){const n=e,i=$1("where",t);return Uf._create(i,n,r)}class qd extends Q1{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new qd(e,r)}_parse(e){const r=this._queryConstraints.map((n=>n._parse(e))).filter((n=>n.getFilters().length>0));return r.length===1?r[0]:Qa.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:((function(i,o){let c=i;const u=o.getFlattenedFilters();for(const h of u)gA(c,h),c=Bg(c,h)})(e._query,r),new yo(e.firestore,e.converter,Bg(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function kE(t,e,r){if(typeof(r=Mr(r))=="string"){if(r==="")throw new je(be.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ow(e)&&r.indexOf("/")!==-1)throw new je(be.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(Xt.fromString(r));if(!We.isDocumentKey(n))throw new je(be.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return q2(t,new We(n))}if(r instanceof vr)return q2(t,r._key);throw new je(be.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Rd(r)}.`)}function IE(t,e){if(!Array.isArray(t)||t.length===0)throw new je(be.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function gA(t,e){const r=(function(i,o){for(const c of i)for(const u of c.getFlattenedFilters())if(o.indexOf(u.op)>=0)return u.op;return null})(t.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(r!==null)throw r===e.op?new je(be.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new je(be.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class xA{convertValue(e,r="none"){switch(fo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return xr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(uo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Ke(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return xo(e,((i,o)=>{n[i]=this.convertValue(o,r)})),n}convertVectorValue(e){const r=e.fields?.[Kh].arrayValue?.values?.map((n=>xr(n.doubleValue)));return new Ya(r)}convertGeoPoint(e){return new Wa(xr(e.latitude),xr(e.longitude))}convertArray(e,r){return(e.values||[]).map((n=>this.convertValue(n,r)))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Dd(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(mf(e));default:return null}}convertTimestamp(e){const r=co(e);return new Kt(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Xt.fromString(e);Nt(kw(n),9688,{name:e});const i=new Ec(n.get(1),n.get(3)),o=new We(n.popFirst(5));return i.isEqual(r)||ns(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),o}}function vA(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class uc{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ao extends dA{constructor(e,r,n,i,o,c){super(e,r,n,i,c),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new ef(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field($1("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new je(be.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=ao._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}ao._jsonSchemaVersion="firestore/documentSnapshot/1.0",ao._jsonSchema={type:kr("string",ao._jsonSchemaVersion),bundleSource:kr("string","DocumentSnapshot"),bundleName:kr("string"),bundle:kr("string")};class ef extends ao{data(e={}){return super.data(e)}}class io{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new uc(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach((r=>e.push(r))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach((n=>{e.call(r,new ef(this._firestore,this._userDataWriter,n.key,n,new uc(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new je(be.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=(function(i,o){if(i._snapshot.oldDocs.isEmpty()){let c=0;return i._snapshot.docChanges.map((u=>{const h=new ef(i._firestore,i._userDataWriter,u.doc.key,u.doc,new uc(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:c++}}))}{let c=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((u=>o||u.type!==3)).map((u=>{const h=new ef(i._firestore,i._userDataWriter,u.doc.key,u.doc,new uc(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,m=-1;return u.type!==0&&(d=c.indexOf(u.doc.key),c=c.delete(u.doc.key)),u.type!==1&&(c=c.add(u.doc),m=c.indexOf(u.doc.key)),{type:F6(u.type),doc:h,oldIndex:d,newIndex:m}}))}})(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new je(be.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=io._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Cd.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach((o=>{o._document!==null&&(r.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function F6(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ke(61501,{type:t})}}io._jsonSchemaVersion="firestore/querySnapshot/1.0",io._jsonSchema={type:kr("string",io._jsonSchemaVersion),bundleSource:kr("string","QuerySnapshot"),bundleName:kr("string"),bundle:kr("string")};class J1 extends xA{constructor(e){super(),this.firestore=e}convertBytes(e){return new Zn(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new vr(this.firestore,null,r)}}function Qg(t){t=Sa(t,yo);const e=Sa(t.firestore,is),r=Bf(e),n=new J1(e);return pA(t._query),A6(r,t._query).then((i=>new io(e,n,t,i)))}function Jo(t,e,r,...n){t=Sa(t,vr);const i=Sa(t.firestore,is),o=Hd(i);let c;return c=typeof(e=Mr(e))=="string"||e instanceof Vc?cA(o,"updateDoc",t._key,e,r,n):lA(o,"updateDoc",t._key,e),jf(i,[c.toMutation(t._key,Vn.exists(!0))])}function Z1(t){return jf(Sa(t.firestore,is),[new Ld(t._key,Vn.none())])}function Wd(t,e){const r=Sa(t.firestore,is),n=ra(t),i=vA(t.converter,e);return jf(r,[oA(Hd(t.firestore),"addDoc",n._key,i,t.converter!==null,{}).toMutation(n._key,Vn.exists(!1))]).then((()=>n))}function Ji(t,...e){t=Mr(t);let r={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||RE(e[n])||(r=e[n++]);const i={includeMetadataChanges:r.includeMetadataChanges,source:r.source};if(RE(e[n])){const h=e[n];e[n]=h.next?.bind(h),e[n+1]=h.error?.bind(h),e[n+2]=h.complete?.bind(h)}let o,c,u;if(t instanceof vr)c=Sa(t.firestore,is),u=k1(t._key.path),o={next:h=>{e[n]&&e[n](M6(c,t,h))},error:e[n+1],complete:e[n+2]};else{const h=Sa(t,yo);c=Sa(h.firestore,is),u=h._query;const d=new J1(c);o={next:m=>{e[n]&&e[n](new io(c,d,h,m))},error:e[n+1],complete:e[n+2]},pA(t._query)}return(function(d,m,v,y){const E=new Zw(y),S=new Gw(m,E,v);return d.asyncQueue.enqueueAndForget((async()=>zw(await Kg(d),S))),()=>{E.Nu(),d.asyncQueue.enqueueAndForget((async()=>Hw(await Kg(d),S)))}})(Bf(c),u,i,o)}function jf(t,e){return(function(n,i){const o=new no;return n.asyncQueue.enqueueAndForget((async()=>d6(await w6(n),i,o))),o.promise})(Bf(t),e)}function M6(t,e,r){const n=r.docs.get(e._key),i=new J1(t);return new ao(t,i,e._key,n,new uc(r.hasPendingWrites,r.fromCache),e.converter)}class yA{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=Hd(e)}set(e,r,n){this._verifyNotCommitted();const i=hg(e,this._firestore),o=vA(i.converter,r,n),c=oA(this._dataReader,"WriteBatch.set",i._key,o,i.converter!==null,n);return this._mutations.push(c.toMutation(i._key,Vn.none())),this}update(e,r,n,...i){this._verifyNotCommitted();const o=hg(e,this._firestore);let c;return c=typeof(r=Mr(r))=="string"||r instanceof Vc?cA(this._dataReader,"WriteBatch.update",o._key,r,n,i):lA(this._dataReader,"WriteBatch.update",o._key,r),this._mutations.push(c.toMutation(o._key,Vn.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=hg(e,this._firestore);return this._mutations=this._mutations.concat(new Ld(r._key,Vn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new je(be.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function hg(t,e){if((t=Mr(t)).firestore!==e)throw new je(be.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function _A(...t){return new Y1("arrayUnion",t)}function Cc(t){return Bf(t=Sa(t,is)),new yA(t,(e=>jf(t,e)))}(function(e,r=!0){(function(i){Mc=i})(Fc),yc(new rl("firestore",((n,{instanceIdentifier:i,options:o})=>{const c=n.getProvider("app").getImmediate(),u=new is(new FI(n.getProvider("auth-internal")),new PI(c,n.getProvider("app-check-internal")),(function(d,m){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new je(be.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ec(d.options.projectId,m)})(c,i),c);return o={useFetchStreams:r,...o},u._setSettings(o),u}),"PUBLIC").setMultipleInstances(!0)),to(N2,O2,e),to(N2,O2,"esm2020")})();const L6=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:xA,Bytes:Zn,CollectionReference:Qi,DocumentReference:vr,DocumentSnapshot:ao,FieldPath:Vc,FieldValue:Vf,Firestore:is,FirestoreError:je,GeoPoint:Wa,Query:yo,QueryCompositeFilterConstraint:qd,QueryConstraint:mA,QueryDocumentSnapshot:ef,QueryFieldFilterConstraint:Uf,QuerySnapshot:io,SnapshotMetadata:uc,Timestamp:Kt,VectorValue:Ya,WriteBatch:yA,_AutoId:Cd,_ByteString:Hr,_DatabaseId:Ec,_DocumentKey:We,_EmptyAuthCredentialsProvider:jS,_FieldPath:jr,_cast:Sa,_logWarn:al,_validateIsNotUsedTogether:HS,addDoc:Wd,arrayUnion:_A,collection:Zr,connectFirestoreEmulator:nA,deleteDoc:Z1,doc:ra,ensureFirestoreConfigured:Bf,executeWrite:jf,getDocs:Qg,getFirestore:aA,onSnapshot:Ji,query:Xa,updateDoc:Jo,where:Pn,writeBatch:Cc},Symbol.toStringTag,{value:"Module"}));function EA(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const P6=EA,TA=new If("auth","Firebase",EA());const id=new _1("@firebase/auth");function B6(t,...e){id.logLevel<=pt.WARN&&id.warn(`Auth (${Fc}): ${t}`,...e)}function Vh(t,...e){id.logLevel<=pt.ERROR&&id.error(`Auth (${Fc}): ${t}`,...e)}function xi(t,...e){throw tx(t,...e)}function Ka(t,...e){return tx(t,...e)}function ex(t,e,r){const n={...P6(),[e]:r};return new If("auth","Firebase",n).create(e,{appName:t.name})}function Zo(t){return ex(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function V6(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&xi(t,"argument-error"),ex(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function tx(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return TA.create(t,...e)}function Qe(t,e,...r){if(!t)throw tx(e,...r)}function Yi(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Vh(e),new Error(e)}function ss(t,e){t||Yi(e)}function Jg(){return typeof self<"u"&&self.location?.href||""}function U6(){return DE()==="http:"||DE()==="https:"}function DE(){return typeof self<"u"&&self.location?.protocol||null}function j6(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(U6()||u3()||"connection"in navigator)?navigator.onLine:!0}function z6(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class zf{constructor(e,r){this.shortDelay=e,this.longDelay=r,ss(r>e,"Short delay should be less than long delay!"),this.isMobile=o3()||f3()}get(){return j6()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function rx(t,e){ss(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}class SA{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Yi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Yi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Yi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const H6={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const G6=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],q6=new zf(3e4,6e4);function nx(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function jc(t,e,r,n,i={}){return wA(t,i,async()=>{let o={},c={};n&&(e==="GET"?c=n:o={body:JSON.stringify(n)});const u=Df({key:t.config.apiKey,...c}).slice(1),h=await t._getAdditionalHeaders();h["Content-Type"]="application/json",t.languageCode&&(h["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:h,...o};return c3()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Oc(t.emulatorConfig.host)&&(d.credentials="include"),SA.fetch()(await AA(t,t.config.apiHost,r,u),d)})}async function wA(t,e,r){t._canInitEmulator=!1;const n={...H6,...e};try{const i=new Y6(t),o=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const c=await o.json();if("needConfirmation"in c)throw Th(t,"account-exists-with-different-credential",c);if(o.ok&&!("errorMessage"in c))return c;{const u=o.ok?c.errorMessage:c.error.message,[h,d]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw Th(t,"credential-already-in-use",c);if(h==="EMAIL_EXISTS")throw Th(t,"email-already-in-use",c);if(h==="USER_DISABLED")throw Th(t,"user-disabled",c);const m=n[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw ex(t,m,d);xi(t,m)}}catch(i){if(i instanceof cs)throw i;xi(t,"network-request-failed",{message:String(i)})}}async function W6(t,e,r,n,i={}){const o=await jc(t,e,r,n,i);return"mfaPendingCredential"in o&&xi(t,"multi-factor-auth-required",{_serverResponse:o}),o}async function AA(t,e,r,n){const i=`${e}${r}?${n}`,o=t,c=o.config.emulator?rx(t.config,i):`${t.config.apiScheme}://${i}`;return G6.includes(r)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(c).toString():c}class Y6{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Ka(this.auth,"network-request-failed")),q6.get())})}}function Th(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Ka(t,e,n);return i.customData._tokenResponse=r,i}async function X6(t,e){return jc(t,"POST","/v1/accounts:delete",e)}async function sd(t,e){return jc(t,"POST","/v1/accounts:lookup",e)}function tf(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function K6(t,e=!1){const r=Mr(t),n=await r.getIdToken(e),i=ax(n);Qe(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,c=o?.sign_in_provider;return{claims:i,token:n,authTime:tf(dg(i.auth_time)),issuedAtTime:tf(dg(i.iat)),expirationTime:tf(dg(i.exp)),signInProvider:c||null,signInSecondFactor:o?.sign_in_second_factor||null}}function dg(t){return Number(t)*1e3}function ax(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Vh("JWT malformed, contained fewer than 3 sections"),null;try{const i=ES(r);return i?JSON.parse(i):(Vh("Failed to decode base64 JWT payload"),null)}catch(i){return Vh("Caught error parsing JWT payload as JSON",i?.toString()),null}}function NE(t){const e=ax(t);return Qe(e,"internal-error"),Qe(typeof e.exp<"u","internal-error"),Qe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function vf(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof cs&&$6(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function $6({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class Q6{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Zg{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=tf(this.lastLoginAt),this.creationTime=tf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function od(t){const e=t.auth,r=await t.getIdToken(),n=await vf(t,sd(e,{idToken:r}));Qe(n?.users.length,e,"internal-error");const i=n.users[0];t._notifyReloadListener(i);const o=i.providerUserInfo?.length?bA(i.providerUserInfo):[],c=Z6(t.providerData,o),u=t.isAnonymous,h=!(t.email&&i.passwordHash)&&!c?.length,d=u?h:!1,m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:c,metadata:new Zg(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,m)}async function J6(t){const e=Mr(t);await od(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Z6(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function bA(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}async function eN(t,e){const r=await wA(t,{},async()=>{const n=Df({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=t.config,c=await AA(t,i,"/v1/token",`key=${o}`),u=await t._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:u,body:n};return t.emulatorConfig&&Oc(t.emulatorConfig.host)&&(h.credentials="include"),SA.fetch()(c,h)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function tN(t,e){return jc(t,"POST","/v2/accounts:revokeToken",nx(t,e))}class dc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Qe(e.idToken,"internal-error"),Qe(typeof e.idToken<"u","internal-error"),Qe(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):NE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Qe(e.length!==0,"internal-error");const r=NE(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Qe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:o}=await eN(e,r);this.updateTokensAndExpiration(n,i,Number(o))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:o}=r,c=new dc;return n&&(Qe(typeof n=="string","internal-error",{appName:e}),c.refreshToken=n),i&&(Qe(typeof i=="string","internal-error",{appName:e}),c.accessToken=i),o&&(Qe(typeof o=="number","internal-error",{appName:e}),c.expirationTime=o),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new dc,this.toJSON())}_performRefresh(){return Yi("not implemented")}}function Hs(t,e){Qe(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ha{constructor({uid:e,auth:r,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new Q6(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Zg(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await vf(this,this.stsTokenManager.getToken(this.auth,e));return Qe(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return K6(this,e)}reload(){return J6(this)}_assign(e){this!==e&&(Qe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Ha({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){Qe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await od(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ja(this.auth.app))return Promise.reject(Zo(this.auth));const e=await this.getIdToken();return await vf(this,X6(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,i=r.email??void 0,o=r.phoneNumber??void 0,c=r.photoURL??void 0,u=r.tenantId??void 0,h=r._redirectEventId??void 0,d=r.createdAt??void 0,m=r.lastLoginAt??void 0,{uid:v,emailVerified:y,isAnonymous:E,providerData:S,stsTokenManager:T}=r;Qe(v&&T,e,"internal-error");const A=dc.fromJSON(this.name,T);Qe(typeof v=="string",e,"internal-error"),Hs(n,e.name),Hs(i,e.name),Qe(typeof y=="boolean",e,"internal-error"),Qe(typeof E=="boolean",e,"internal-error"),Hs(o,e.name),Hs(c,e.name),Hs(u,e.name),Hs(h,e.name),Hs(d,e.name),Hs(m,e.name);const B=new Ha({uid:v,auth:e,email:i,emailVerified:y,displayName:n,isAnonymous:E,photoURL:c,phoneNumber:o,tenantId:u,stsTokenManager:A,createdAt:d,lastLoginAt:m});return S&&Array.isArray(S)&&(B.providerData=S.map(I=>({...I}))),h&&(B._redirectEventId=h),B}static async _fromIdTokenResponse(e,r,n=!1){const i=new dc;i.updateFromServerResponse(r);const o=new Ha({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await od(o),o}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];Qe(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?bA(i.providerUserInfo):[],c=!(i.email&&i.passwordHash)&&!o?.length,u=new dc;u.updateFromIdToken(n);const h=new Ha({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:c}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Zg(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(h,d),h}}const OE=new Map;function Xi(t){ss(t instanceof Function,"Expected a class definition");let e=OE.get(t);return e?(ss(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,OE.set(t,e),e)}class CA{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}CA.type="NONE";const FE=CA;function Uh(t,e,r){return`firebase:${t}:${e}:${r}`}class pc{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:o}=this.auth;this.fullUserKey=Uh(this.userKey,i.apiKey,o),this.fullPersistenceKey=Uh("persistence",i.apiKey,o),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await sd(this.auth,{idToken:e}).catch(()=>{});return r?Ha._fromGetAccountInfoResponse(this.auth,r,e):null}return Ha._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new pc(Xi(FE),e,n);const i=(await Promise.all(r.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let o=i[0]||Xi(FE);const c=Uh(n,e.config.apiKey,e.name);let u=null;for(const d of r)try{const m=await d._get(c);if(m){let v;if(typeof m=="string"){const y=await sd(e,{idToken:m}).catch(()=>{});if(!y)break;v=await Ha._fromGetAccountInfoResponse(e,y,m)}else v=Ha._fromJSON(e,m);d!==o&&(u=v),o=d;break}}catch{}const h=i.filter(d=>d._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new pc(o,e,n):(o=h[0],u&&await o._set(c,u.toJSON()),await Promise.all(r.map(async d=>{if(d!==o)try{await d._remove(c)}catch{}})),new pc(o,e,n))}}function ME(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(DA(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(RA(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(OA(e))return"Blackberry";if(FA(e))return"Webos";if(kA(e))return"Safari";if((e.includes("chrome/")||IA(e))&&!e.includes("edge/"))return"Chrome";if(NA(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function RA(t=pn()){return/firefox\//i.test(t)}function kA(t=pn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function IA(t=pn()){return/crios\//i.test(t)}function DA(t=pn()){return/iemobile/i.test(t)}function NA(t=pn()){return/android/i.test(t)}function OA(t=pn()){return/blackberry/i.test(t)}function FA(t=pn()){return/webos/i.test(t)}function ix(t=pn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function rN(t=pn()){return ix(t)&&!!window.navigator?.standalone}function nN(){return h3()&&document.documentMode===10}function MA(t=pn()){return ix(t)||NA(t)||FA(t)||OA(t)||/windows phone/i.test(t)||DA(t)}function LA(t,e=[]){let r;switch(t){case"Browser":r=ME(pn());break;case"Worker":r=`${ME(pn())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Fc}/${n}`}class aN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=o=>new Promise((c,u)=>{try{const h=e(o);c(h)}catch(h){u(h)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}async function iN(t,e={}){return jc(t,"GET","/v2/passwordPolicy",nx(t,e))}const sN=6;class oN{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??sN,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}class lN{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new LE(this),this.idTokenSubscription=new LE(this),this.beforeStateQueue=new aN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=TA,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Xi(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await pc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await sd(this,{idToken:e}),n=await Ha._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(ja(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(c,c))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=this.redirectUser?._redirectEventId,c=n?._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===c)&&u?.user&&(n=u.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Qe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await od(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=z6()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ja(this.app))return Promise.reject(Zo(this));const r=e?Mr(e):null;return r&&Qe(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Qe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ja(this.app)?Promise.reject(Zo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ja(this.app)?Promise.reject(Zo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Xi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await iN(this),r=new oN(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new If("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await tN(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Xi(e)||this._popupRedirectResolver;Qe(r,this,"argument-error"),this.redirectPersistenceManager=await pc.create(this,[Xi(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const o=typeof r=="function"?r:r.next.bind(r);let c=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(Qe(u,this,"internal-error"),u.then(()=>{c||o(this.currentUser)}),typeof r=="function"){const h=e.addObserver(r,n,i);return()=>{c=!0,h()}}else{const h=e.addObserver(r);return()=>{c=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Qe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=LA(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(ja(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&B6(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Yd(t){return Mr(t)}class LE{constructor(e){this.auth=e,this.observer=null,this.addObserver=_3(r=>this.observer=r)}get next(){return Qe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let sx={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function cN(t){sx=t}function uN(t){return sx.loadJS(t)}function fN(){return sx.gapiScript}function hN(t){return`__${t}${Math.floor(Math.random()*1e6)}`}function dN(t,e){const r=T1(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),o=r.getOptions();if(oo(o,e??{}))return i;xi(i,"already-initialized")}return r.initialize({options:e})}function pN(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(Xi);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function mN(t,e,r){const n=Yd(t);Qe(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,o=PA(e),{host:c,port:u}=gN(e),h=u===null?"":`:${u}`,d={url:`${o}//${c}${h}/`},m=Object.freeze({host:c,port:u,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){Qe(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),Qe(oo(d,n.config.emulator)&&oo(m,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=d,n.emulatorConfig=m,n.settings.appVerificationDisabledForTesting=!0,Oc(c)?(AS(`${o}//${c}${h}`),bS("Auth",!0)):xN()}function PA(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function gN(t){const e=PA(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const o=i[1];return{host:o,port:PE(n.substr(o.length+1))}}else{const[o,c]=n.split(":");return{host:o,port:PE(c)}}}function PE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function xN(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class BA{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Yi("not implemented")}_getIdTokenResponse(e){return Yi("not implemented")}_linkToIdToken(e,r){return Yi("not implemented")}_getReauthenticationResolver(e){return Yi("not implemented")}}async function mc(t,e){return W6(t,"POST","/v1/accounts:signInWithIdp",nx(t,e))}const vN="http://localhost";class sl extends BA{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new sl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):xi("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...o}=r;if(!n||!i)return null;const c=new sl(n,i);return c.idToken=o.idToken||void 0,c.accessToken=o.accessToken||void 0,c.secret=o.secret,c.nonce=o.nonce,c.pendingToken=o.pendingToken||null,c}_getIdTokenResponse(e){const r=this.buildRequest();return mc(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,mc(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,mc(e,r)}buildRequest(){const e={requestUri:vN,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Df(r)}return e}}class ox{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Hf extends ox{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ws extends Hf{constructor(){super("facebook.com")}static credential(e){return sl._fromParams({providerId:Ws.PROVIDER_ID,signInMethod:Ws.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ws.credentialFromTaggedObject(e)}static credentialFromError(e){return Ws.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ws.credential(e.oauthAccessToken)}catch{return null}}}Ws.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ws.PROVIDER_ID="facebook.com";class Wi extends Hf{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return sl._fromParams({providerId:Wi.PROVIDER_ID,signInMethod:Wi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Wi.credentialFromTaggedObject(e)}static credentialFromError(e){return Wi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Wi.credential(r,n)}catch{return null}}}Wi.GOOGLE_SIGN_IN_METHOD="google.com";Wi.PROVIDER_ID="google.com";class Ys extends Hf{constructor(){super("github.com")}static credential(e){return sl._fromParams({providerId:Ys.PROVIDER_ID,signInMethod:Ys.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ys.credentialFromTaggedObject(e)}static credentialFromError(e){return Ys.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ys.credential(e.oauthAccessToken)}catch{return null}}}Ys.GITHUB_SIGN_IN_METHOD="github.com";Ys.PROVIDER_ID="github.com";class Xs extends Hf{constructor(){super("twitter.com")}static credential(e,r){return sl._fromParams({providerId:Xs.PROVIDER_ID,signInMethod:Xs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Xs.credentialFromTaggedObject(e)}static credentialFromError(e){return Xs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Xs.credential(r,n)}catch{return null}}}Xs.TWITTER_SIGN_IN_METHOD="twitter.com";Xs.PROVIDER_ID="twitter.com";class Rc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const o=await Ha._fromIdTokenResponse(e,n,i),c=BE(n);return new Rc({user:o,providerId:c,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=BE(n);return new Rc({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function BE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class ld extends cs{constructor(e,r,n,i){super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,ld.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new ld(e,r,n,i)}}function VA(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?ld._fromErrorAndOperation(t,o,e,n):o})}async function yN(t,e,r=!1){const n=await vf(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Rc._forOperation(t,"link",n)}async function _N(t,e,r=!1){const{auth:n}=t;if(ja(n.app))return Promise.reject(Zo(n));const i="reauthenticate";try{const o=await vf(t,VA(n,i,e,t),r);Qe(o.idToken,n,"internal-error");const c=ax(o.idToken);Qe(c,n,"internal-error");const{sub:u}=c;return Qe(t.uid===u,n,"user-mismatch"),Rc._forOperation(t,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&xi(n,"user-mismatch"),o}}async function EN(t,e,r=!1){if(ja(t.app))return Promise.reject(Zo(t));const n="signIn",i=await VA(t,n,e),o=await Rc._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(o.user),o}function TN(t,e,r,n){return Mr(t).onIdTokenChanged(e,r,n)}function SN(t,e,r){return Mr(t).beforeAuthStateChanged(e,r)}function wN(t,e,r,n){return Mr(t).onAuthStateChanged(e,r,n)}const cd="__sak";class UA{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(cd,"1"),this.storage.removeItem(cd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const AN=1e3,bN=10;class jA extends UA{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=MA(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((c,u,h)=>{this.notifyListeners(c,h)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const c=this.storage.getItem(n);!r&&this.localCache[n]===c||this.notifyListeners(n,c)},o=this.storage.getItem(n);nN()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,bN):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},AN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}jA.type="LOCAL";const CN=jA;class zA extends UA{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}zA.type="SESSION";const HA=zA;function RN(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}class Xd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new Xd(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:o}=r.data,c=this.handlersMap[i];if(!c?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const u=Array.from(c).map(async d=>d(r.origin,o)),h=await RN(u);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:h})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Xd.receivers=[];function lx(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}class kN{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,c;return new Promise((u,h)=>{const d=lx("",20);i.port1.start();const m=setTimeout(()=>{h(new Error("unsupported_event"))},n);c={messageChannel:i,onMessage(v){const y=v;if(y.data.eventId===d)switch(y.data.status){case"ack":clearTimeout(m),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(y.data.response);break;default:clearTimeout(m),clearTimeout(o),h(new Error("invalid_response"));break}}},this.handlers.add(c),i.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:d,data:r},[i.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}function mi(){return window}function IN(t){mi().location.href=t}function GA(){return typeof mi().WorkerGlobalScope<"u"&&typeof mi().importScripts=="function"}async function DN(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function NN(){return navigator?.serviceWorker?.controller||null}function ON(){return GA()?self:null}const qA="firebaseLocalStorageDb",FN=1,ud="firebaseLocalStorage",WA="fbase_key";class Gf{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Kd(t,e){return t.transaction([ud],e?"readwrite":"readonly").objectStore(ud)}function MN(){const t=indexedDB.deleteDatabase(qA);return new Gf(t).toPromise()}function e1(){const t=indexedDB.open(qA,FN);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(ud,{keyPath:WA})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(ud)?e(n):(n.close(),await MN(),e(await e1()))})})}async function VE(t,e,r){const n=Kd(t,!0).put({[WA]:e,value:r});return new Gf(n).toPromise()}async function LN(t,e){const r=Kd(t,!1).get(e),n=await new Gf(r).toPromise();return n===void 0?null:n.value}function UE(t,e){const r=Kd(t,!0).delete(e);return new Gf(r).toPromise()}const PN=800,BN=3;class YA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await e1(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>BN)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return GA()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Xd._getInstance(ON()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await DN(),!this.activeServiceWorker)return;this.sender=new kN(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||NN()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await e1();return await VE(e,cd,"1"),await UE(e,cd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>VE(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>LN(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>UE(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=Kd(i,!1).getAll();return new Gf(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),PN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}YA.type="LOCAL";const VN=YA;new zf(3e4,6e4);function XA(t,e){return e?Xi(e):(Qe(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class cx extends BA{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return mc(e,this._buildIdpRequest())}_linkToIdToken(e,r){return mc(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return mc(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function UN(t){return EN(t.auth,new cx(t),t.bypassAuthState)}function jN(t){const{auth:e,user:r}=t;return Qe(r,e,"internal-error"),_N(r,new cx(t),t.bypassAuthState)}async function zN(t){const{auth:e,user:r}=t;return Qe(r,e,"internal-error"),yN(r,new cx(t),t.bypassAuthState)}class KA{constructor(e,r,n,i,o=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:o,error:c,type:u}=e;if(c){this.reject(c);return}const h={auth:this.auth,requestUri:r,sessionId:n,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(h))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return UN;case"linkViaPopup":case"linkViaRedirect":return zN;case"reauthViaPopup":case"reauthViaRedirect":return jN;default:xi(this.auth,"internal-error")}}resolve(e){ss(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ss(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const HN=new zf(2e3,1e4);async function GN(t,e,r){if(ja(t.app))return Promise.reject(Ka(t,"operation-not-supported-in-this-environment"));const n=Yd(t);V6(t,e,ox);const i=XA(n,r);return new $o(n,"signInViaPopup",e,i).executeNotNull()}class $o extends KA{constructor(e,r,n,i,o){super(e,r,i,o),this.provider=n,this.authWindow=null,this.pollId=null,$o.currentPopupAction&&$o.currentPopupAction.cancel(),$o.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Qe(e,this.auth,"internal-error"),e}async onExecution(){ss(this.filter.length===1,"Popup operations only handle one event");const e=lx();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Ka(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ka(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,$o.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ka(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,HN.get())};e()}}$o.currentPopupAction=null;const qN="pendingRedirect",jh=new Map;class WN extends KA{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=jh.get(this.auth._key());if(!e){try{const n=await YN(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}jh.set(this.auth._key(),e)}return this.bypassAuthState||jh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function YN(t,e){const r=$N(e),n=KN(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function XN(t,e){jh.set(t._key(),e)}function KN(t){return Xi(t._redirectPersistence)}function $N(t){return Uh(qN,t.config.apiKey,t.name)}async function QN(t,e,r=!1){if(ja(t.app))return Promise.reject(Zo(t));const n=Yd(t),i=XA(n,e),c=await new WN(n,i,r).execute();return c&&!r&&(delete c.user._redirectEventId,await n._persistUserIfCurrent(c.user),await n._setRedirectUser(null,e)),c}const JN=600*1e3;class ZN{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!eO(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!$A(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(Ka(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=JN&&this.cachedEventUids.clear(),this.cachedEventUids.has(jE(e))}saveEventToCache(e){this.cachedEventUids.add(jE(e)),this.lastProcessedEventTime=Date.now()}}function jE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function $A({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function eO(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return $A(t);default:return!1}}async function tO(t,e={}){return jc(t,"GET","/v1/projects",e)}const rO=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,nO=/^https?/;async function aO(t){if(t.config.emulator)return;const{authorizedDomains:e}=await tO(t);for(const r of e)try{if(iO(r))return}catch{}xi(t,"unauthorized-domain")}function iO(t){const e=Jg(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const c=new URL(t);return c.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&c.hostname===n}if(!nO.test(r))return!1;if(rO.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}const sO=new zf(3e4,6e4);function zE(){const t=mi().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function oO(t){return new Promise((e,r)=>{function n(){zE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{zE(),r(Ka(t,"network-request-failed"))},timeout:sO.get()})}if(mi().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(mi().gapi?.load)n();else{const i=hN("iframefcb");return mi()[i]=()=>{gapi.load?n():r(Ka(t,"network-request-failed"))},uN(`${fN()}?onload=${i}`).catch(o=>r(o))}}).catch(e=>{throw zh=null,e})}let zh=null;function lO(t){return zh=zh||oO(t),zh}const cO=new zf(5e3,15e3),uO="__/auth/iframe",fO="emulator/auth/iframe",hO={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},dO=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function pO(t){const e=t.config;Qe(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?rx(e,fO):`https://${t.config.authDomain}/${uO}`,n={apiKey:e.apiKey,appName:t.name,v:Fc},i=dO.get(t.config.apiHost);i&&(n.eid=i);const o=t._getFrameworks();return o.length&&(n.fw=o.join(",")),`${r}?${Df(n).slice(1)}`}async function mO(t){const e=await lO(t),r=mi().gapi;return Qe(r,t,"internal-error"),e.open({where:document.body,url:pO(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:hO,dontclear:!0},n=>new Promise(async(i,o)=>{await n.restyle({setHideOnLeave:!1});const c=Ka(t,"network-request-failed"),u=mi().setTimeout(()=>{o(c)},cO.get());function h(){mi().clearTimeout(u),i(n)}n.ping(h).then(h,()=>{o(c)})}))}const gO={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},xO=500,vO=600,yO="_blank",_O="http://localhost";class HE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function EO(t,e,r,n=xO,i=vO){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),c=Math.max((window.screen.availWidth-n)/2,0).toString();let u="";const h={...gO,width:n.toString(),height:i.toString(),top:o,left:c},d=pn().toLowerCase();r&&(u=IA(d)?yO:r),RA(d)&&(e=e||_O,h.scrollbars="yes");const m=Object.entries(h).reduce((y,[E,S])=>`${y}${E}=${S},`,"");if(rN(d)&&u!=="_self")return TO(e||"",u),new HE(null);const v=window.open(e||"",u,m);Qe(v,t,"popup-blocked");try{v.focus()}catch{}return new HE(v)}function TO(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}const SO="__/auth/handler",wO="emulator/auth/handler",AO=encodeURIComponent("fac");async function GE(t,e,r,n,i,o){Qe(t.config.authDomain,t,"auth-domain-config-required"),Qe(t.config.apiKey,t,"invalid-api-key");const c={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Fc,eventId:i};if(e instanceof ox){e.setDefaultLanguage(t.languageCode),c.providerId=e.providerId||"",y3(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,v]of Object.entries({}))c[m]=v}if(e instanceof Hf){const m=e.getScopes().filter(v=>v!=="");m.length>0&&(c.scopes=m.join(","))}t.tenantId&&(c.tid=t.tenantId);const u=c;for(const m of Object.keys(u))u[m]===void 0&&delete u[m];const h=await t._getAppCheckToken(),d=h?`#${AO}=${encodeURIComponent(h)}`:"";return`${bO(t)}?${Df(u).slice(1)}${d}`}function bO({config:t}){return t.emulator?rx(t,wO):`https://${t.authDomain}/${SO}`}const pg="webStorageSupport";class CO{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=HA,this._completeRedirectFn=QN,this._overrideRedirectResult=XN}async _openPopup(e,r,n,i){ss(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const o=await GE(e,r,n,Jg(),i);return EO(e,o,lx())}async _openRedirect(e,r,n,i){await this._originValidation(e);const o=await GE(e,r,n,Jg(),i);return IN(o),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:o}=this.eventManagers[r];return i?Promise.resolve(i):(ss(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await mO(e),n=new ZN(e);return r.register("authEvent",i=>(Qe(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(pg,{type:pg},i=>{const o=i?.[0]?.[pg];o!==void 0&&r(!!o),xi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=aO(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return MA()||kA()||ix()}}const RO=CO;var qE="@firebase/auth",WE="1.12.0";class kO{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Qe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function IO(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function DO(t){yc(new rl("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:c,authDomain:u}=n.options;Qe(c&&!c.includes(":"),"invalid-api-key",{appName:n.name});const h={apiKey:c,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:LA(t)},d=new lN(n,i,o,h);return pN(d,r),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),yc(new rl("auth-internal",e=>{const r=Yd(e.getProvider("auth").getImmediate());return(n=>new kO(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),to(qE,WE,IO(t)),to(qE,WE,"esm2020")}const NO=300,OO=wS("authIdTokenMaxAge")||NO;let YE=null;const FO=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>OO)return;const i=r?.token;YE!==i&&(YE=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function MO(t=IS()){const e=T1(t,"auth");if(e.isInitialized())return e.getImmediate();const r=dN(t,{popupRedirectResolver:RO,persistence:[VN,CN,HA]}),n=wS("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(n,location.origin);if(location.origin===o.origin){const c=FO(o.toString());SN(r,c,()=>c(r.currentUser)),TN(r,u=>c(u))}}const i=TS("auth");return i&&mN(r,`http://${i}`),r}function LO(){return document.getElementsByTagName("head")?.[0]??document}cN({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const o=Ka("internal-error");o.customData=i,r(o)},n.type="text/javascript",n.charset="UTF-8",LO().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});DO("Browser");const PO=()=>{const t=localStorage.getItem("firebaseConfig");return t?JSON.parse(t):null};let Hh,It,sr,fd;const XE=PO();if(XE)try{Hh=kS(XE),It=aA(Hh),sr=MO(Hh),fd=new Wi}catch(t){console.error("Firebase Initialization Error:",t)}const hd=()=>!!Hh,BO=Object.freeze(Object.defineProperty({__proto__:null,get auth(){return sr},get db(){return It},get googleProvider(){return fd},isConfigured:hd},Symbol.toStringTag,{value:"Module"}));function VO(){const[t,e]=se.useState(""),[r,n]=se.useState(!1),i=sa();se.useEffect(()=>{hd()||i("/settings")},[i]);const o=async()=>{if(!(!sr||!fd)){n(!0),e("");try{const c=await GN(sr,fd);c.user&&localStorage.setItem("user",c.user.displayName||c.user.email),i("/dashboard")}catch(c){console.error(c),e("Google sign-in failed.")}finally{n(!1)}}};return R.jsx("div",{className:"container fade-in",style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:R.jsxs("div",{className:"glass-card",style:{width:"100%",maxWidth:"400px",textAlign:"center"},children:[R.jsx("div",{style:{width:"64px",height:"64px",background:"linear-gradient(135deg, var(--primary), #1e40af)",borderRadius:"16px",margin:"0 auto 24px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"32px"},children:""}),R.jsx("h1",{style:{fontSize:"24px",marginBottom:"8px"},children:"EMI Tracker"}),R.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"14px",marginBottom:"32px"},children:"Manage your finances with ease"}),hd()?R.jsxs("div",{children:[t&&R.jsx("div",{style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",color:"var(--danger)",padding:"12px",borderRadius:"10px",marginBottom:"20px",fontSize:"14px"},children:t}),R.jsxs("button",{type:"button",onClick:o,className:"btn-primary",disabled:r,style:{width:"100%"},children:[R.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",children:[R.jsx("path",{d:"M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844c-.209 1.125-.843 2.078-1.796 2.717v2.258h2.908c1.702-1.567 2.684-3.874 2.684-6.615z",fill:"#4285F4"}),R.jsx("path",{d:"M9.003 18c2.43 0 4.467-.806 5.956-2.18L12.05 13.56c-.806.54-1.836.86-3.047.86-2.344 0-4.328-1.584-5.036-3.711H.96v2.332C2.44 15.983 5.485 18 9.003 18z",fill:"#34A853"}),R.jsx("path",{d:"M3.964 10.712c-.18-.54-.282-1.117-.282-1.71 0-.593.102-1.17.282-1.71V4.96H.957C.347 6.175 0 7.55 0 9.002c0 1.452.348 2.827.957 4.042l3.007-2.332z",fill:"#FBBC05"}),R.jsx("path",{d:"M9.003 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.464.891 11.426 0 9.003 0 5.485 0 2.44 2.017.96 4.958L3.967 7.29c.708-2.127 2.692-3.71 5.036-3.71z",fill:"#EA4335"})]}),r?"Signing in...":"Continue with Google"]})]}):R.jsxs("div",{children:[R.jsx("p",{style:{color:"var(--text-secondary)",marginBottom:"20px",fontSize:"14px"},children:"Firebase not configured yet"}),R.jsx("button",{onClick:()=>i("/settings"),className:"btn-primary",style:{width:"100%"},children:"Configure Now"})]}),R.jsx("div",{style:{marginTop:"24px",paddingTop:"24px",borderTop:"1px solid var(--border)"},children:R.jsx("button",{onClick:()=>i("/settings"),className:"btn-secondary",style:{width:"100%",fontSize:"13px"},children:" Settings"})})]})})}function qf(){const t=sa(),e=ls(),[r,n]=se.useState(!1),i=[{path:"/tracker",icon:"",label:"Tracker"},{path:"/income",icon:"",label:"Income"},{path:"/borrowers",icon:"",label:"Lending"}],o=[{path:"/investments",icon:"",label:"Investments"},{path:"/upload",icon:"",label:"Import"},{path:"/add-schedule",icon:"",label:"Schedule"},{path:"/settings",icon:"",label:"Settings"}],c=u=>e.pathname===u;return R.jsxs(R.Fragment,{children:[R.jsxs("div",{style:{position:"fixed",bottom:0,left:0,right:0,background:"var(--surface)",borderTop:"1px solid var(--border)",display:"grid",gridTemplateColumns:"repeat(5, 1fr)",padding:"10px 4px",zIndex:1e3,backdropFilter:"blur(10px)",boxShadow:"0 -4px 20px rgba(0,0,0,0.1)"},children:[R.jsxs("button",{onClick:()=>t("/dashboard"),className:"btn-secondary",style:{border:"none",background:"transparent",flexDirection:"column",gap:"4px",padding:"6px 2px",borderRadius:0,color:c("/dashboard")?"var(--primary)":"var(--text-primary)"},children:[R.jsx("span",{style:{fontSize:"20px"},children:""}),R.jsx("span",{style:{fontSize:"10px",fontWeight:"600"},children:"Home"})]}),i.map(u=>R.jsxs("button",{onClick:()=>t(u.path),className:"btn-secondary",style:{border:"none",background:"transparent",flexDirection:"column",gap:"4px",padding:"6px 2px",borderRadius:0,color:c(u.path)?"var(--primary)":"var(--text-primary)"},children:[R.jsx("span",{style:{fontSize:"20px"},children:u.icon}),R.jsx("span",{style:{fontSize:"10px",fontWeight:"600"},children:u.label})]},u.path)),R.jsxs("button",{onClick:()=>n(!0),className:"btn-secondary",style:{border:"none",background:"transparent",flexDirection:"column",gap:"4px",padding:"6px 2px",borderRadius:0},children:[R.jsx("span",{style:{fontSize:"20px"},children:""}),R.jsx("span",{style:{fontSize:"10px",fontWeight:"600"},children:"More"})]})]}),r&&R.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",zIndex:2e3,animation:"fadeIn 0.2s ease-out"},onClick:()=>n(!1),children:R.jsxs("div",{style:{position:"absolute",bottom:0,left:0,right:0,background:"var(--surface)",padding:"24px",borderTopLeftRadius:"20px",borderTopRightRadius:"20px",animation:"slideUp 0.3s ease-out"},onClick:u=>u.stopPropagation(),children:[R.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[R.jsx("h2",{style:{fontSize:"18px",margin:0},children:"More Options"}),R.jsx("button",{onClick:()=>n(!1),className:"btn-secondary",style:{padding:"8px",width:"36px",height:"36px"},children:""})]}),R.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px",marginBottom:"16px"},children:o.map(u=>R.jsxs("button",{onClick:()=>{n(!1),t(u.path)},className:"btn-secondary",style:{justifyContent:"flex-start",padding:"14px 16px",width:"100%",background:c(u.path)?"rgba(59, 130, 246, 0.1)":"var(--surface)",borderColor:c(u.path)?"var(--primary)":"var(--border)"},children:[R.jsx("span",{style:{fontSize:"20px"},children:u.icon}),R.jsx("span",{style:{flex:1,textAlign:"left",color:c(u.path)?"var(--primary)":"inherit"},children:u.label})]},u.path))}),R.jsx("button",{onClick:()=>{sr.signOut(),localStorage.removeItem("user"),t("/")},className:"btn-secondary",style:{width:"100%",color:"var(--danger)",marginTop:"8px"},children:" Sign Out"})]})})]})}function UO(){const t=sa(),e=new Date,[r,n]=se.useState(localStorage.getItem("user")||"User"),[i,o]=se.useState(e.getMonth()),[c,u]=se.useState(e.getFullYear()),[h,d]=se.useState([]),[m,v]=se.useState([]),[y,E]=se.useState([]),[S,T]=se.useState({total:0,paid:0,percentage:0,monthlyIncome:0,monthlyExpenses:0,totalInvested:0});se.useEffect(()=>{let C,G,K;const Y=sr.onAuthStateChanged(b=>{C&&C(),G&&G(),K&&K(),b&&(C=Ji(Xa(Zr(It,"emis"),Pn("uid","==",b.uid)),N=>d(N.docs.map(D=>D.data())),N=>console.error("EMI Listener Error:",N)),G=Ji(Xa(Zr(It,"income"),Pn("uid","==",b.uid)),N=>v(N.docs.map(D=>D.data())),N=>console.error("Income Listener Error:",N)),K=Ji(Xa(Zr(It,"borrowers"),Pn("uid","==",b.uid)),N=>E(N.docs.map(D=>D.data())),N=>console.error("Borrower Listener Error:",N)))});return()=>{Y(),C&&C(),G&&G(),K&&K()}},[]),se.useEffect(()=>{const C=h.filter(F=>(F.category||"debt")==="debt"),G={};C.forEach(F=>{G[F.bank]||(G[F.bank]=[]),G[F.bank].push(F)});let K=0;Object.keys(G).forEach(F=>{const O=G[F];O.sort((Ce,ne)=>new Date(Ce.date)-new Date(ne.date));const we=O.find(Ce=>{const ne=new Date(Ce.date);return ne.getMonth()===e.getMonth()&&ne.getFullYear()===e.getFullYear()});if(we)K+=parseFloat(we.balance)||0;else{const Ce=O.filter(ne=>new Date(ne.date)<e);Ce.length>0?K+=parseFloat(Ce[Ce.length-1].balance)||0:O.length>0&&(K+=parseFloat(O[0].balance)||0)}});const Y=C.some(F=>F.balance!==void 0),b=C.reduce((F,O)=>F+(parseFloat(O.amount)||0),0),N=Y&&K>0?K:b,D=C.filter(F=>F.status==="paid"||F.status===void 0&&new Date(F.date)<=e).reduce((F,O)=>F+(parseFloat(O.amount)||0),0),U=h.filter(F=>{const O=new Date(F.date);return O.getMonth()===i&&O.getFullYear()===c}).reduce((F,O)=>F+(parseFloat(O.amount)||0),0),P=m.filter(F=>{const O=new Date(F.date||F.createdAt);return O.getMonth()===i&&O.getFullYear()===c}).reduce((F,O)=>F+(parseFloat(O.amount)||0),0);T({total:N,paid:D,percentage:N>0?D/N*100:0,monthlyIncome:P,monthlyExpenses:U,totalInvested:h.filter(F=>(F.category||"debt")==="investment").reduce((F,O)=>F+(parseFloat(O.amount)||0),0)})},[h,m,i,c]);const A=S.monthlyIncome-S.monthlyExpenses,B=["January","February","March","April","May","June","July","August","September","October","November","December"],I=Array.from({length:5},(C,G)=>e.getFullYear()-1+G);return R.jsxs(R.Fragment,{children:[R.jsxs("div",{className:"container fade-in",style:{paddingBottom:"100px"},children:[R.jsxs("div",{style:{marginBottom:"24px"},children:[R.jsx("div",{className:"label",style:{marginBottom:"4px"},children:"Dashboard"}),R.jsxs("h1",{style:{fontSize:"24px",marginTop:"0"},children:["Hi, ",r.split(" ")[0]," "]})]}),R.jsxs("div",{style:{display:"flex",gap:"12px",marginBottom:"24px"},children:[R.jsx("select",{value:i,onChange:C=>o(parseInt(C.target.value)),style:{flex:1,marginBottom:0},children:B.map((C,G)=>R.jsx("option",{value:G,children:C},C))}),R.jsx("select",{value:c,onChange:C=>u(parseInt(C.target.value)),style:{width:"100px",marginBottom:0},children:I.map(C=>R.jsx("option",{value:C,children:C},C))})]}),R.jsxs("div",{className:"glass-card",onClick:()=>t("/tracker"),style:{background:"linear-gradient(135deg, var(--primary) 0%, #1e40af 100%)",border:"none",marginBottom:"16px",cursor:"pointer"},children:[R.jsx("div",{className:"label",style:{color:"rgba(255,255,255,0.8)"},children:"Budget Forecast"}),R.jsxs("div",{className:"stat-value",style:{color:"white",marginTop:"4px",marginBottom:"20px",fontSize:"36px"},children:["",(A||0).toLocaleString("en-IN")]}),R.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[R.jsxs("div",{style:{background:"rgba(255,255,255,0.15)",padding:"14px",borderRadius:"12px"},children:[R.jsx("div",{style:{fontSize:"11px",color:"rgba(255,255,255,0.8)",marginBottom:"4px",fontWeight:"600"},children:"Monthly Income"}),R.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"white"},children:["",(S.monthlyIncome||0).toLocaleString("en-IN")]})]}),R.jsxs("div",{style:{background:"rgba(255,255,255,0.15)",padding:"14px",borderRadius:"12px"},children:[R.jsx("div",{style:{fontSize:"11px",color:"rgba(255,255,255,0.8)",marginBottom:"4px",fontWeight:"600"},children:"Monthly Expenses"}),R.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"white"},children:["",(S.monthlyExpenses||0).toLocaleString("en-IN")]})]})]})]}),R.jsxs("div",{className:"glass-card",onClick:()=>t("/tracker"),style:{cursor:"pointer",marginBottom:"16px"},children:[R.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[R.jsx("div",{className:"label",style:{marginBottom:0},children:"Loan Progress"}),R.jsxs("div",{style:{fontSize:"24px",fontWeight:"800",color:"var(--primary)"},children:[Math.round(S.percentage||0),"%"]})]}),R.jsx("div",{style:{width:"100%",height:"8px",background:"var(--border)",borderRadius:"10px",overflow:"hidden",marginBottom:"12px"},children:R.jsx("div",{style:{width:`${S.percentage}%`,height:"100%",background:"var(--primary)",transition:"width 1s ease-out"}})}),R.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"14px",color:"var(--text-secondary)"},children:[R.jsxs("span",{children:["",(S.paid||0).toLocaleString("en-IN")," cleared"]}),R.jsxs("span",{children:["",(S.total||0).toLocaleString("en-IN")," outstanding"]})]})]}),R.jsxs("div",{className:"glass-card",onClick:()=>t("/investments"),style:{cursor:"pointer",marginBottom:"16px",borderLeft:"8px solid var(--success)"},children:[R.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[R.jsx("div",{className:"label",style:{marginBottom:0},children:"Investments Tracker"}),R.jsx("div",{style:{fontSize:"24px"},children:""})]}),R.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[R.jsxs("div",{children:[R.jsx("div",{style:{fontSize:"13px",color:"var(--text-secondary)",marginBottom:"4px"},children:"Total Invested"}),R.jsxs("div",{style:{fontSize:"22px",fontWeight:"700",color:"var(--success)"},children:["",(S.totalInvested||0).toLocaleString("en-IN")]})]}),R.jsxs("div",{style:{textAlign:"right"},children:[R.jsx("div",{style:{fontSize:"13px",color:"var(--text-secondary)",marginBottom:"4px"},children:"Expected Yield"}),R.jsxs("div",{style:{fontSize:"22px",fontWeight:"700"},children:["",h.filter(C=>(C.category||"debt")==="investment").length," Plans"]})]})]})]}),R.jsxs("div",{className:"glass-card",onClick:()=>t("/borrowers"),style:{cursor:"pointer",marginBottom:"16px"},children:[R.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[R.jsx("div",{className:"label",style:{marginBottom:0},children:"Lending Overall"}),R.jsxs("div",{style:{fontSize:"12px",fontWeight:"600",color:"var(--warning)",background:"rgba(245, 158, 11, 0.1)",padding:"4px 12px",borderRadius:"20px"},children:[y.filter(C=>C.status==="active").length," Active Borrowers"]})]}),R.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[R.jsxs("div",{children:[R.jsx("div",{style:{fontSize:"13px",color:"var(--text-secondary)",marginBottom:"4px"},children:"Principal Lent"}),R.jsxs("div",{style:{fontSize:"22px",fontWeight:"700"},children:["",y.reduce((C,G)=>C+(parseFloat(G.amount)||0),0).toLocaleString("en-IN")]})]}),R.jsxs("div",{style:{textAlign:"right"},children:[R.jsx("div",{style:{fontSize:"13px",color:"var(--text-secondary)",marginBottom:"4px"},children:"Outstanding"}),R.jsxs("div",{style:{fontSize:"22px",fontWeight:"700",color:"var(--danger)"},children:["",(y.reduce((C,G)=>C+(parseFloat(G.amount)||0),0)-y.reduce((C,G)=>C+(G.settlements?.reduce((K,Y)=>K+(parseFloat(Y.amount)||0),0)||0),0)).toLocaleString("en-IN")]})]})]})]})]}),R.jsx(qf,{})]})}var QA=1252,jO=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],ux={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},fx=function(t){jO.indexOf(t)!=-1&&(QA=ux[0]=t)};function zO(){fx(1252)}var Ga=function(t){fx(t)};function JA(){Ga(1200),zO()}function KE(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function HO(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function ZA(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var qu=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?HO(t.slice(2)):e==254&&r==255?ZA(t.slice(2)):e==65279?t.slice(1):t},Sh=function(e){return String.fromCharCode(e)},$E=function(e){return String.fromCharCode(e)},yf,Qs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function QE(t){for(var e="",r=0,n=0,i=0,o=0,c=0,u=0,h=0,d=0;d<t.length;)r=t.charCodeAt(d++),o=r>>2,n=t.charCodeAt(d++),c=(r&3)<<4|n>>4,i=t.charCodeAt(d++),u=(n&15)<<2|i>>6,h=i&63,isNaN(n)?u=h=64:isNaN(i)&&(h=64),e+=Qs.charAt(o)+Qs.charAt(c)+Qs.charAt(u)+Qs.charAt(h);return e}function aa(t){var e="",r=0,n=0,i=0,o=0,c=0,u=0,h=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)o=Qs.indexOf(t.charAt(d++)),c=Qs.indexOf(t.charAt(d++)),r=o<<2|c>>4,e+=String.fromCharCode(r),u=Qs.indexOf(t.charAt(d++)),n=(c&15)<<4|u>>2,u!==64&&(e+=String.fromCharCode(n)),h=Qs.indexOf(t.charAt(d++)),i=(u&3)<<6|h,h!==64&&(e+=String.fromCharCode(i));return e}var vt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),dl=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function mo(t){return vt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function JE(t){return vt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var za=function(e){return vt?dl(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function pl(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function hx(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return hx(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Ks=vt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:dl(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function GO(t){for(var e=[],r=0,n=t.length+250,i=mo(t.length+255),o=0;o<t.length;++o){var c=t.charCodeAt(o);if(c<128)i[r++]=c;else if(c<2048)i[r++]=192|c>>6&31,i[r++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var u=t.charCodeAt(++o)&1023;i[r++]=240|c>>8&7,i[r++]=128|c>>2&63,i[r++]=128|u>>6&15|(c&3)<<4,i[r++]=128|u&63}else i[r++]=224|c>>12&15,i[r++]=128|c>>6&63,i[r++]=128|c&63;r>n&&(e.push(i.slice(0,r)),r=0,i=mo(65535),n=65530)}return e.push(i.slice(0,r)),Ks(e)}var wn=/\u0000/g,Wu=/[\u0001-\u0006]/g;function gc(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function qa(t,e){var r=""+t;return r.length>=e?r:fr("0",e-r.length)+r}function dx(t,e){var r=""+t;return r.length>=e?r:fr(" ",e-r.length)+r}function dd(t,e){var r=""+t;return r.length>=e?r:r+fr(" ",e-r.length)}function qO(t,e){var r=""+Math.round(t);return r.length>=e?r:fr("0",e-r.length)+r}function WO(t,e){var r=""+t;return r.length>=e?r:fr("0",e-r.length)+r}var ZE=Math.pow(2,32);function ac(t,e){if(t>ZE||t<-ZE)return qO(t,e);var r=Math.round(t);return WO(r,e)}function pd(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var eT=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],mg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function YO(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var ot={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},tT={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},XO={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function md(t,e,r){for(var n=t<0?-1:1,i=t*n,o=0,c=1,u=0,h=1,d=0,m=0,v=Math.floor(i);d<e&&(v=Math.floor(i),u=v*c+o,m=v*d+h,!(i-v<5e-8));)i=1/(i-v),o=c,c=u,h=d,d=m;if(m>e&&(d>e?(m=h,u=o):(m=d,u=c)),!r)return[0,n*u,m];var y=Math.floor(n*u/m);return[y,n*u-y*m,m]}function Qo(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),o=0,c=[],u={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),e&&e.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++i==86400&&(u.T=i=0,++n,++u.D)),n===60)c=r?[1317,10,29]:[1900,2,29],o=3;else if(n===0)c=r?[1317,8,29]:[1900,1,0],o=6;else{n>60&&--n;var h=new Date(1900,0,1);h.setDate(h.getDate()+n-1),c=[h.getFullYear(),h.getMonth()+1,h.getDate()],o=h.getDay(),n<60&&(o=(o+6)%7),r&&(o=e8(h,c))}return u.y=c[0],u.m=c[1],u.d=c[2],u.S=i%60,i=Math.floor(i/60),u.M=i%60,i=Math.floor(i/60),u.H=i,u.q=o,u}var e4=new Date(1899,11,31,0,0,0),KO=e4.getTime(),$O=new Date(1900,2,1,0,0,0);function t4(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=$O&&(r+=1440*60*1e3),(r-(KO+(t.getTimezoneOffset()-e4.getTimezoneOffset())*6e4))/(1440*60*1e3)}function px(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function QO(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function JO(t){var e=t<0?12:11,r=px(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function ZO(t){var e=px(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function _f(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=JO(t):e===10?r=t.toFixed(10).substr(0,12):r=ZO(t),px(QO(r.toUpperCase()))}function ol(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):_f(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return wa(14,t4(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function e8(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function t8(t,e,r,n){var i="",o=0,c=0,u=r.y,h,d=0;switch(t){case 98:u=r.y+543;case 121:switch(e.length){case 1:case 2:h=u%100,d=2;break;default:h=u%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:h=r.m,d=e.length;break;case 3:return mg[r.m-1][1];case 5:return mg[r.m-1][0];default:return mg[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:h=r.d,d=e.length;break;case 3:return eT[r.q][0];default:return eT[r.q][1]}break;case 104:switch(e.length){case 1:case 2:h=1+(r.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:h=r.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:h=r.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?qa(r.S,e.length):(n>=2?c=n===3?1e3:100:c=n===1?10:1,o=Math.round(c*(r.S+r.u)),o>=60*c&&(o=0),e==="s"?o===0?"0":""+o/c:(i=qa(o,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":h=r.D*24+r.H;break;case"[m]":case"[mm]":h=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":h=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:h=u,d=1;break}var m=d>0?qa(h,d):"";return m}function Js(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var r4=/%/g;function r8(t,e,r){var n=e.replace(r4,""),i=e.length-n.length;return Zi(t,n,r*Math.pow(10,2*i))+fr("%",i)}function n8(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Zi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function n4(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+n4(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%i;if(o<0&&(o+=i),r=(e/Math.pow(10,o)).toPrecision(n+1+(i+o)%i),r.indexOf("e")===-1){var c=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(c-r.length+o):r+="E+"+(c-o);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,m){return h+d+m.substr(0,(i+o)%i)+"."+m.substr(o)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var a4=/# (\?+)( ?)\/( ?)(\d+)/;function a8(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),o=Math.floor(i/n),c=i-o*n,u=n;return r+(o===0?"":""+o)+" "+(c===0?fr(" ",t[1].length+1+t[4].length):dx(c,t[1].length)+t[2]+"/"+t[3]+qa(u,t[4].length))}function i8(t,e,r){return r+(e===0?"":""+e)+fr(" ",t[1].length+2+t[4].length)}var i4=/^#*0*\.([0#]+)/,s4=/\).*[0#]/,o4=/\(###\) ###\\?-####/;function En(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function rT(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function nT(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function s8(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function o8(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Ea(t,e,r){if(t.charCodeAt(0)===40&&!e.match(s4)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ea("n",n,r):"("+Ea("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return n8(t,e,r);if(e.indexOf("%")!==-1)return r8(t,e,r);if(e.indexOf("E")!==-1)return n4(e,r);if(e.charCodeAt(0)===36)return"$"+Ea(t,e.substr(e.charAt(1)==" "?2:1),r);var i,o,c,u,h=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+ac(h,e.length);if(e.match(/^[#?]+$/))return i=ac(r,0),i==="0"&&(i=""),i.length>e.length?i:En(e.substr(0,e.length-i.length))+i;if(o=e.match(a4))return a8(o,h,d);if(e.match(/^#+0+$/))return d+ac(h,e.length-e.indexOf("0"));if(o=e.match(i4))return i=rT(r,o[1].length).replace(/^([^\.]+)$/,"$1."+En(o[1])).replace(/\.$/,"."+En(o[1])).replace(/\.(\d*)$/,function(S,T){return"."+T+fr("0",En(o[1]).length-T.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return d+rT(h,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return d+Js(ac(h,0));if(o=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ea(t,e,-r):Js(""+(Math.floor(r)+s8(r,o[1].length)))+"."+qa(nT(r,o[1].length),o[1].length);if(o=e.match(/^#,#*,#0/))return Ea(t,e.replace(/^#,#*,/,""),r);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=gc(Ea(t,e.replace(/[\\-]/g,""),r)),c=0,gc(gc(e.replace(/\\/g,"")).replace(/[0#]/g,function(S){return c<i.length?i.charAt(c++):S==="0"?"0":""}));if(e.match(o4))return i=Ea(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var m="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(o[4].length,7),u=md(h,Math.pow(10,c)-1,!1),i=""+d,m=Zi("n",o[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),i+=m+o[2]+"/"+o[3],m=dd(u[2],c),m.length<o[4].length&&(m=En(o[4].substr(o[4].length-m.length))+m),i+=m,i;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(o[1].length,o[4].length),7),u=md(h,Math.pow(10,c)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?dx(u[1],c)+o[2]+"/"+o[3]+dd(u[2],c):fr(" ",2*c+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return i=ac(r,0),e.length<=i.length?i:En(e.substr(0,e.length-i.length))+i;if(o=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),c=i.indexOf(".");var v=e.indexOf(".")-c,y=e.length-i.length-v;return En(e.substr(0,v)+i+e.substr(e.length-y))}if(o=e.match(/^00,000\.([#0]*0)$/))return c=nT(r,o[1].length),r<0?"-"+Ea(t,e,-r):Js(o8(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?qa(0,3-S.length):"")+S})+"."+qa(c,o[1].length);switch(e){case"###,##0.00":return Ea(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var E=Js(ac(h,0));return E!=="0"?d+E:"";case"###,###.00":return Ea(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ea(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function l8(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Zi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function c8(t,e,r){var n=e.replace(r4,""),i=e.length-n.length;return Zi(t,n,r*Math.pow(10,2*i))+fr("%",i)}function l4(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+l4(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%i;if(o<0&&(o+=i),r=(e/Math.pow(10,o)).toPrecision(n+1+(i+o)%i),!r.match(/[Ee]/)){var c=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(c-r.length+o):r+="E+"+(c-o),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,m){return h+d+m.substr(0,(i+o)%i)+"."+m.substr(o)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function fi(t,e,r){if(t.charCodeAt(0)===40&&!e.match(s4)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?fi("n",n,r):"("+fi("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return l8(t,e,r);if(e.indexOf("%")!==-1)return c8(t,e,r);if(e.indexOf("E")!==-1)return l4(e,r);if(e.charCodeAt(0)===36)return"$"+fi(t,e.substr(e.charAt(1)==" "?2:1),r);var i,o,c,u,h=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+qa(h,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:En(e.substr(0,e.length-i.length))+i;if(o=e.match(a4))return i8(o,h,d);if(e.match(/^#+0+$/))return d+qa(h,e.length-e.indexOf("0"));if(o=e.match(i4))return i=(""+r).replace(/^([^\.]+)$/,"$1."+En(o[1])).replace(/\.$/,"."+En(o[1])),i=i.replace(/\.(\d*)$/,function(S,T){return"."+T+fr("0",En(o[1]).length-T.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return d+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return d+Js(""+h);if(o=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+fi(t,e,-r):Js(""+r)+"."+fr("0",o[1].length);if(o=e.match(/^#,#*,#0/))return fi(t,e.replace(/^#,#*,/,""),r);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=gc(fi(t,e.replace(/[\\-]/g,""),r)),c=0,gc(gc(e.replace(/\\/g,"")).replace(/[0#]/g,function(S){return c<i.length?i.charAt(c++):S==="0"?"0":""}));if(e.match(o4))return i=fi(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var m="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(o[4].length,7),u=md(h,Math.pow(10,c)-1,!1),i=""+d,m=Zi("n",o[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),i+=m+o[2]+"/"+o[3],m=dd(u[2],c),m.length<o[4].length&&(m=En(o[4].substr(o[4].length-m.length))+m),i+=m,i;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(o[1].length,o[4].length),7),u=md(h,Math.pow(10,c)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?dx(u[1],c)+o[2]+"/"+o[3]+dd(u[2],c):fr(" ",2*c+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:En(e.substr(0,e.length-i.length))+i;if(o=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),c=i.indexOf(".");var v=e.indexOf(".")-c,y=e.length-i.length-v;return En(e.substr(0,v)+i+e.substr(e.length-y))}if(o=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+fi(t,e,-r):Js(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?qa(0,3-S.length):"")+S})+"."+qa(0,o[1].length);switch(e){case"###,###":case"##,###":case"#,###":var E=Js(""+h);return E!=="0"?d+E:"";default:if(e.match(/\.[0#?]*$/))return fi(t,e.slice(0,e.lastIndexOf(".")),r)+En(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Zi(t,e,r){return(r|0)===r?fi(t,e,r):Ea(t,e,r)}function u8(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var c4=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function zc(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":pd(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(c4))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function f8(t,e,r,n){for(var i=[],o="",c=0,u="",h="t",d,m,v,y="H";c<t.length;)switch(u=t.charAt(c)){case"G":if(!pd(t,c))throw new Error("unrecognized character "+u+" in "+t);i[i.length]={t:"G",v:"General"},c+=7;break;case'"':for(o="";(v=t.charCodeAt(++c))!==34&&c<t.length;)o+=String.fromCharCode(v);i[i.length]={t:"t",v:o},++c;break;case"\\":var E=t.charAt(++c),S=E==="("||E===")"?E:"t";i[i.length]={t:S,v:E},++c;break;case"_":i[i.length]={t:"t",v:" "},c+=2;break;case"@":i[i.length]={t:"T",v:e},++c;break;case"B":case"b":if(t.charAt(c+1)==="1"||t.charAt(c+1)==="2"){if(d==null&&(d=Qo(e,r,t.charAt(c+1)==="2"),d==null))return"";i[i.length]={t:"X",v:t.substr(c,2)},h=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=Qo(e,r),d==null))return"";for(o=u;++c<t.length&&t.charAt(c).toLowerCase()===u;)o+=u;u==="m"&&h.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=y),i[i.length]={t:u,v:o},h=u;break;case"A":case"a":case"":var T={t:u,v:u};if(d==null&&(d=Qo(e,r)),t.substr(c,3).toUpperCase()==="A/P"?(d!=null&&(T.v=d.H>=12?"P":"A"),T.t="T",y="h",c+=3):t.substr(c,5).toUpperCase()==="AM/PM"?(d!=null&&(T.v=d.H>=12?"PM":"AM"),T.t="T",c+=5,y="h"):t.substr(c,5).toUpperCase()==="/"?(d!=null&&(T.v=d.H>=12?"":""),T.t="T",c+=5,y="h"):(T.t="t",++c),d==null&&T.t==="T")return"";i[i.length]=T,h=u;break;case"[":for(o=u;t.charAt(c++)!=="]"&&c<t.length;)o+=t.charAt(c);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(c4)){if(d==null&&(d=Qo(e,r),d==null))return"";i[i.length]={t:"Z",v:o.toLowerCase()},h=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",zc(t)||(i[i.length]={t:"t",v:o}));break;case".":if(d!=null){for(o=u;++c<t.length&&(u=t.charAt(c))==="0";)o+=u;i[i.length]={t:"s",v:o};break}case"0":case"#":for(o=u;++c<t.length&&"0#?.,E+-%".indexOf(u=t.charAt(c))>-1;)o+=u;i[i.length]={t:"n",v:o};break;case"?":for(o=u;t.charAt(++c)===u;)o+=u;i[i.length]={t:u,v:o},h=u;break;case"*":++c,(t.charAt(c)==" "||t.charAt(c)=="*")&&++c;break;case"(":case")":i[i.length]={t:n===1?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=u;c<t.length&&"0123456789".indexOf(t.charAt(++c))>-1;)o+=t.charAt(c);i[i.length]={t:"D",v:o};break;case" ":i[i.length]={t:u,v:u},++c;break;case"$":i[i.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+t);i[i.length]={t:"t",v:u},++c;break}var A=0,B=0,I;for(c=i.length-1,h="t";c>=0;--c)switch(i[c].t){case"h":case"H":i[c].t=y,h="h",A<1&&(A=1);break;case"s":(I=i[c].v.match(/\.0+$/))&&(B=Math.max(B,I[0].length-1)),A<3&&(A=3);case"d":case"y":case"M":case"e":h=i[c].t;break;case"m":h==="s"&&(i[c].t="M",A<2&&(A=2));break;case"X":break;case"Z":A<1&&i[c].v.match(/[Hh]/)&&(A=1),A<2&&i[c].v.match(/[Mm]/)&&(A=2),A<3&&i[c].v.match(/[Ss]/)&&(A=3)}switch(A){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var C="",G;for(c=0;c<i.length;++c)switch(i[c].t){case"t":case"T":case" ":case"D":break;case"X":i[c].v="",i[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[c].v=t8(i[c].t.charCodeAt(0),i[c].v,d,B),i[c].t="t";break;case"n":case"?":for(G=c+1;i[G]!=null&&((u=i[G].t)==="?"||u==="D"||(u===" "||u==="t")&&i[G+1]!=null&&(i[G+1].t==="?"||i[G+1].t==="t"&&i[G+1].v==="/")||i[c].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(i[G].v==="/"||i[G].v===" "&&i[G+1]!=null&&i[G+1].t=="?"));)i[c].v+=i[G].v,i[G]={v:"",t:";"},++G;C+=i[c].v,c=G-1;break;case"G":i[c].t="t",i[c].v=ol(e,r);break}var K="",Y,b;if(C.length>0){C.charCodeAt(0)==40?(Y=e<0&&C.charCodeAt(0)===45?-e:e,b=Zi("n",C,Y)):(Y=e<0&&n>1?-e:e,b=Zi("n",C,Y),Y<0&&i[0]&&i[0].t=="t"&&(b=b.substr(1),i[0].v="-"+i[0].v)),G=b.length-1;var N=i.length;for(c=0;c<i.length;++c)if(i[c]!=null&&i[c].t!="t"&&i[c].v.indexOf(".")>-1){N=c;break}var D=i.length;if(N===i.length&&b.indexOf("E")===-1){for(c=i.length-1;c>=0;--c)i[c]==null||"n?".indexOf(i[c].t)===-1||(G>=i[c].v.length-1?(G-=i[c].v.length,i[c].v=b.substr(G+1,i[c].v.length)):G<0?i[c].v="":(i[c].v=b.substr(0,G+1),G=-1),i[c].t="t",D=c);G>=0&&D<i.length&&(i[D].v=b.substr(0,G+1)+i[D].v)}else if(N!==i.length&&b.indexOf("E")===-1){for(G=b.indexOf(".")-1,c=N;c>=0;--c)if(!(i[c]==null||"n?".indexOf(i[c].t)===-1)){for(m=i[c].v.indexOf(".")>-1&&c===N?i[c].v.indexOf(".")-1:i[c].v.length-1,K=i[c].v.substr(m+1);m>=0;--m)G>=0&&(i[c].v.charAt(m)==="0"||i[c].v.charAt(m)==="#")&&(K=b.charAt(G--)+K);i[c].v=K,i[c].t="t",D=c}for(G>=0&&D<i.length&&(i[D].v=b.substr(0,G+1)+i[D].v),G=b.indexOf(".")+1,c=N;c<i.length;++c)if(!(i[c]==null||"n?(".indexOf(i[c].t)===-1&&c!==N)){for(m=i[c].v.indexOf(".")>-1&&c===N?i[c].v.indexOf(".")+1:0,K=i[c].v.substr(0,m);m<i[c].v.length;++m)G<b.length&&(K+=b.charAt(G++));i[c].v=K,i[c].t="t",D=c}}}for(c=0;c<i.length;++c)i[c]!=null&&"n?".indexOf(i[c].t)>-1&&(Y=n>1&&e<0&&c>0&&i[c-1].v==="-"?-e:e,i[c].v=Zi(i[c].t,i[c].v,Y),i[c].t="t");var U="";for(c=0;c!==i.length;++c)i[c]!=null&&(U+=i[c].v);return U}var aT=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function iT(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function h8(t,e){var r=u8(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var o=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,o];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var c=r[0].match(aT),u=r[1].match(aT);return iT(e,c)?[n,r[0]]:iT(e,u)?[n,r[1]]:[n,r[c!=null&&u!=null?2:1]]}return[n,o]}function wa(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ot)[t],n==null&&(n=r.table&&r.table[tT[t]]||ot[tT[t]]),n==null&&(n=XO[t]||"General");break}if(pd(n,0))return ol(e,r);e instanceof Date&&(e=t4(e,r.date1904));var i=h8(n,e);if(pd(i[1]))return ol(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return f8(i[1],e,r,i[0])}function el(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(ot[r]==null){e<0&&(e=r);continue}if(ot[r]==t){e=r;break}}e<0&&(e=391)}return ot[e]=t,e}function u4(){ot=YO()}var d8={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},f4=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function p8(t){var e=typeof t=="number"?ot[t]:t;return e=e.replace(f4,"(\\d+)"),new RegExp("^"+e+"$")}function m8(t,e,r){var n=-1,i=-1,o=-1,c=-1,u=-1,h=-1;(e.match(f4)||[]).forEach(function(v,y){var E=parseInt(r[y+1],10);switch(v.toLowerCase().charAt(0)){case"y":n=E;break;case"d":o=E;break;case"h":c=E;break;case"s":h=E;break;case"m":c>=0?u=E:i=E;break}}),h>=0&&u==-1&&i>=0&&(u=i,i=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var m=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return c==-1&&u==-1&&h==-1?d:n==-1&&i==-1&&o==-1?m:d+"T"+m}var g8=(function(){var t={};t.version="1.2.0";function e(){for(var b=0,N=new Array(256),D=0;D!=256;++D)b=D,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,N[D]=b;return typeof Int32Array<"u"?new Int32Array(N):N}var r=e();function n(b){var N=0,D=0,U=0,P=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(U=0;U!=256;++U)P[U]=b[U];for(U=0;U!=256;++U)for(D=b[U],N=256+U;N<4096;N+=256)D=P[N]=D>>>8^b[D&255];var F=[];for(U=1;U!=16;++U)F[U-1]=typeof Int32Array<"u"?P.subarray(U*256,U*256+256):P.slice(U*256,U*256+256);return F}var i=n(r),o=i[0],c=i[1],u=i[2],h=i[3],d=i[4],m=i[5],v=i[6],y=i[7],E=i[8],S=i[9],T=i[10],A=i[11],B=i[12],I=i[13],C=i[14];function G(b,N){for(var D=N^-1,U=0,P=b.length;U<P;)D=D>>>8^r[(D^b.charCodeAt(U++))&255];return~D}function K(b,N){for(var D=N^-1,U=b.length-15,P=0;P<U;)D=C[b[P++]^D&255]^I[b[P++]^D>>8&255]^B[b[P++]^D>>16&255]^A[b[P++]^D>>>24]^T[b[P++]]^S[b[P++]]^E[b[P++]]^y[b[P++]]^v[b[P++]]^m[b[P++]]^d[b[P++]]^h[b[P++]]^u[b[P++]]^c[b[P++]]^o[b[P++]]^r[b[P++]];for(U+=15;P<U;)D=D>>>8^r[(D^b[P++])&255];return~D}function Y(b,N){for(var D=N^-1,U=0,P=b.length,F=0,O=0;U<P;)F=b.charCodeAt(U++),F<128?D=D>>>8^r[(D^F)&255]:F<2048?(D=D>>>8^r[(D^(192|F>>6&31))&255],D=D>>>8^r[(D^(128|F&63))&255]):F>=55296&&F<57344?(F=(F&1023)+64,O=b.charCodeAt(U++)&1023,D=D>>>8^r[(D^(240|F>>8&7))&255],D=D>>>8^r[(D^(128|F>>2&63))&255],D=D>>>8^r[(D^(128|O>>6&15|(F&3)<<4))&255],D=D>>>8^r[(D^(128|O&63))&255]):(D=D>>>8^r[(D^(224|F>>12&15))&255],D=D>>>8^r[(D^(128|F>>6&63))&255],D=D>>>8^r[(D^(128|F&63))&255]);return~D}return t.table=r,t.bstr=G,t.buf=K,t.str=Y,t})(),_t=(function(){var e={};e.version="1.2.1";function r(M,W){for(var j=M.split("/"),H=W.split("/"),q=0,X=0,ue=Math.min(j.length,H.length);q<ue;++q){if(X=j[q].length-H[q].length)return X;if(j[q]!=H[q])return j[q]<H[q]?-1:1}return j.length-H.length}function n(M){if(M.charAt(M.length-1)=="/")return M.slice(0,-1).indexOf("/")===-1?M:n(M.slice(0,-1));var W=M.lastIndexOf("/");return W===-1?M:M.slice(0,W+1)}function i(M){if(M.charAt(M.length-1)=="/")return i(M.slice(0,-1));var W=M.lastIndexOf("/");return W===-1?M:M.slice(W+1)}function o(M,W){typeof W=="string"&&(W=new Date(W));var j=W.getHours();j=j<<6|W.getMinutes(),j=j<<5|W.getSeconds()>>>1,M.write_shift(2,j);var H=W.getFullYear()-1980;H=H<<4|W.getMonth()+1,H=H<<5|W.getDate(),M.write_shift(2,H)}function c(M){var W=M.read_shift(2)&65535,j=M.read_shift(2)&65535,H=new Date,q=j&31;j>>>=5;var X=j&15;j>>>=4,H.setMilliseconds(0),H.setFullYear(j+1980),H.setMonth(X-1),H.setDate(q);var ue=W&31;W>>>=5;var Ee=W&63;return W>>>=6,H.setHours(W),H.setMinutes(Ee),H.setSeconds(ue<<1),H}function u(M){Jr(M,0);for(var W={},j=0;M.l<=M.length-4;){var H=M.read_shift(2),q=M.read_shift(2),X=M.l+q,ue={};H===21589&&(j=M.read_shift(1),j&1&&(ue.mtime=M.read_shift(4)),q>5&&(j&2&&(ue.atime=M.read_shift(4)),j&4&&(ue.ctime=M.read_shift(4))),ue.mtime&&(ue.mt=new Date(ue.mtime*1e3))),M.l=X,W[H]=ue}return W}var h;function d(){return h||(h={})}function m(M,W){if(M[0]==80&&M[1]==75)return jn(M,W);if((M[0]|32)==109&&(M[1]|32)==105)return wi(M,W);if(M.length<512)throw new Error("CFB file size "+M.length+" < 512");var j=3,H=512,q=0,X=0,ue=0,Ee=0,fe=0,pe=[],de=M.slice(0,512);Jr(de,0);var Ne=v(de);switch(j=Ne[0],j){case 3:H=512;break;case 4:H=4096;break;case 0:if(Ne[1]==0)return jn(M,W);default:throw new Error("Major Version: Expected 3 or 4 saw "+j)}H!==512&&(de=M.slice(0,H),Jr(de,28));var Fe=M.slice(0,H);y(de,j);var Ue=de.read_shift(4,"i");if(j===3&&Ue!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ue);de.l+=4,ue=de.read_shift(4,"i"),de.l+=4,de.chk("00100000","Mini Stream Cutoff Size: "),Ee=de.read_shift(4,"i"),q=de.read_shift(4,"i"),fe=de.read_shift(4,"i"),X=de.read_shift(4,"i");for(var De=-1,Be=0;Be<109&&(De=de.read_shift(4,"i"),!(De<0));++Be)pe[Be]=De;var Ge=E(M,H);A(fe,X,Ge,H,pe);var Ft=I(Ge,ue,pe,H);Ft[ue].name="!Directory",q>0&&Ee!==O&&(Ft[Ee].name="!MiniFAT"),Ft[pe[0]].name="!FAT",Ft.fat_addrs=pe,Ft.ssz=H;var Mt={},qt=[],rn=[],Ra=[];C(ue,Ft,Ge,qt,q,Mt,rn,Ee),S(rn,Ra,qt),qt.shift();var ka={FileIndex:rn,FullPaths:Ra};return W&&W.raw&&(ka.raw={header:Fe,sectors:Ge}),ka}function v(M){if(M[M.l]==80&&M[M.l+1]==75)return[0,0];M.chk(we,"Header Signature: "),M.l+=16;var W=M.read_shift(2,"u");return[M.read_shift(2,"u"),W]}function y(M,W){var j=9;switch(M.l+=2,j=M.read_shift(2)){case 9:if(W!=3)throw new Error("Sector Shift: Expected 9 saw "+j);break;case 12:if(W!=4)throw new Error("Sector Shift: Expected 12 saw "+j);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+j)}M.chk("0600","Mini Sector Shift: "),M.chk("000000000000","Reserved: ")}function E(M,W){for(var j=Math.ceil(M.length/W)-1,H=[],q=1;q<j;++q)H[q-1]=M.slice(q*W,(q+1)*W);return H[j-1]=M.slice(j*W),H}function S(M,W,j){for(var H=0,q=0,X=0,ue=0,Ee=0,fe=j.length,pe=[],de=[];H<fe;++H)pe[H]=de[H]=H,W[H]=j[H];for(;Ee<de.length;++Ee)H=de[Ee],q=M[H].L,X=M[H].R,ue=M[H].C,pe[H]===H&&(q!==-1&&pe[q]!==q&&(pe[H]=pe[q]),X!==-1&&pe[X]!==X&&(pe[H]=pe[X])),ue!==-1&&(pe[ue]=H),q!==-1&&H!=pe[H]&&(pe[q]=pe[H],de.lastIndexOf(q)<Ee&&de.push(q)),X!==-1&&H!=pe[H]&&(pe[X]=pe[H],de.lastIndexOf(X)<Ee&&de.push(X));for(H=1;H<fe;++H)pe[H]===H&&(X!==-1&&pe[X]!==X?pe[H]=pe[X]:q!==-1&&pe[q]!==q&&(pe[H]=pe[q]));for(H=1;H<fe;++H)if(M[H].type!==0){if(Ee=H,Ee!=pe[Ee])do Ee=pe[Ee],W[H]=W[Ee]+"/"+W[H];while(Ee!==0&&pe[Ee]!==-1&&Ee!=pe[Ee]);pe[H]=-1}for(W[0]+="/",H=1;H<fe;++H)M[H].type!==2&&(W[H]+="/")}function T(M,W,j){for(var H=M.start,q=M.size,X=[],ue=H;j&&q>0&&ue>=0;)X.push(W.slice(ue*F,ue*F+F)),q-=F,ue=Xo(j,ue*4);return X.length===0?Dr(0):Ks(X).slice(0,M.size)}function A(M,W,j,H,q){var X=O;if(M===O){if(W!==0)throw new Error("DIFAT chain shorter than expected")}else if(M!==-1){var ue=j[M],Ee=(H>>>2)-1;if(!ue)return;for(var fe=0;fe<Ee&&(X=Xo(ue,fe*4))!==O;++fe)q.push(X);A(Xo(ue,H-4),W-1,j,H,q)}}function B(M,W,j,H,q){var X=[],ue=[];q||(q=[]);var Ee=H-1,fe=0,pe=0;for(fe=W;fe>=0;){q[fe]=!0,X[X.length]=fe,ue.push(M[fe]);var de=j[Math.floor(fe*4/H)];if(pe=fe*4&Ee,H<4+pe)throw new Error("FAT boundary crossed: "+fe+" 4 "+H);if(!M[de])break;fe=Xo(M[de],pe)}return{nodes:X,data:mT([ue])}}function I(M,W,j,H){var q=M.length,X=[],ue=[],Ee=[],fe=[],pe=H-1,de=0,Ne=0,Fe=0,Ue=0;for(de=0;de<q;++de)if(Ee=[],Fe=de+W,Fe>=q&&(Fe-=q),!ue[Fe]){fe=[];var De=[];for(Ne=Fe;Ne>=0;){De[Ne]=!0,ue[Ne]=!0,Ee[Ee.length]=Ne,fe.push(M[Ne]);var Be=j[Math.floor(Ne*4/H)];if(Ue=Ne*4&pe,H<4+Ue)throw new Error("FAT boundary crossed: "+Ne+" 4 "+H);if(!M[Be]||(Ne=Xo(M[Be],Ue),De[Ne]))break}X[Fe]={nodes:Ee,data:mT([fe])}}return X}function C(M,W,j,H,q,X,ue,Ee){for(var fe=0,pe=H.length?2:0,de=W[M].data,Ne=0,Fe=0,Ue;Ne<de.length;Ne+=128){var De=de.slice(Ne,Ne+128);Jr(De,64),Fe=De.read_shift(2),Ue=yx(De,0,Fe-pe),H.push(Ue);var Be={name:Ue,type:De.read_shift(1),color:De.read_shift(1),L:De.read_shift(4,"i"),R:De.read_shift(4,"i"),C:De.read_shift(4,"i"),clsid:De.read_shift(16),state:De.read_shift(4,"i"),start:0,size:0},Ge=De.read_shift(2)+De.read_shift(2)+De.read_shift(2)+De.read_shift(2);Ge!==0&&(Be.ct=G(De,De.l-8));var Ft=De.read_shift(2)+De.read_shift(2)+De.read_shift(2)+De.read_shift(2);Ft!==0&&(Be.mt=G(De,De.l-8)),Be.start=De.read_shift(4,"i"),Be.size=De.read_shift(4,"i"),Be.size<0&&Be.start<0&&(Be.size=Be.type=0,Be.start=O,Be.name=""),Be.type===5?(fe=Be.start,q>0&&fe!==O&&(W[fe].name="!StreamData")):Be.size>=4096?(Be.storage="fat",W[Be.start]===void 0&&(W[Be.start]=B(j,Be.start,W.fat_addrs,W.ssz)),W[Be.start].name=Be.name,Be.content=W[Be.start].data.slice(0,Be.size)):(Be.storage="minifat",Be.size<0?Be.size=0:fe!==O&&Be.start!==O&&W[fe]&&(Be.content=T(Be,W[fe].data,(W[Ee]||{}).data))),Be.content&&Jr(Be.content,0),X[Ue]=Be,ue.push(Be)}}function G(M,W){return new Date((Jn(M,W+4)/1e7*Math.pow(2,32)+Jn(M,W)/1e7-11644473600)*1e3)}function K(M,W){return d(),m(h.readFileSync(M),W)}function Y(M,W){var j=W&&W.type;switch(j||vt&&Buffer.isBuffer(M)&&(j="buffer"),j||"base64"){case"file":return K(M,W);case"base64":return m(za(aa(M)),W);case"binary":return m(za(M),W)}return m(M,W)}function b(M,W){var j=W||{},H=j.root||"Root Entry";if(M.FullPaths||(M.FullPaths=[]),M.FileIndex||(M.FileIndex=[]),M.FullPaths.length!==M.FileIndex.length)throw new Error("inconsistent CFB structure");M.FullPaths.length===0&&(M.FullPaths[0]=H+"/",M.FileIndex[0]={name:H,type:5}),j.CLSID&&(M.FileIndex[0].clsid=j.CLSID),N(M)}function N(M){var W="Sh33tJ5";if(!_t.find(M,"/"+W)){var j=Dr(4);j[0]=55,j[1]=j[3]=50,j[2]=54,M.FileIndex.push({name:W,type:2,content:j,size:4,L:69,R:69,C:69}),M.FullPaths.push(M.FullPaths[0]+W),D(M)}}function D(M,W){b(M);for(var j=!1,H=!1,q=M.FullPaths.length-1;q>=0;--q){var X=M.FileIndex[q];switch(X.type){case 0:H?j=!0:(M.FileIndex.pop(),M.FullPaths.pop());break;case 1:case 2:case 5:H=!0,isNaN(X.R*X.L*X.C)&&(j=!0),X.R>-1&&X.L>-1&&X.R==X.L&&(j=!0);break;default:j=!0;break}}if(!(!j&&!W)){var ue=new Date(1987,1,19),Ee=0,fe=Object.create?Object.create(null):{},pe=[];for(q=0;q<M.FullPaths.length;++q)fe[M.FullPaths[q]]=!0,M.FileIndex[q].type!==0&&pe.push([M.FullPaths[q],M.FileIndex[q]]);for(q=0;q<pe.length;++q){var de=n(pe[q][0]);H=fe[de],H||(pe.push([de,{name:i(de).replace("/",""),type:1,clsid:ne,ct:ue,mt:ue,content:null}]),fe[de]=!0)}for(pe.sort(function(Ue,De){return r(Ue[0],De[0])}),M.FullPaths=[],M.FileIndex=[],q=0;q<pe.length;++q)M.FullPaths[q]=pe[q][0],M.FileIndex[q]=pe[q][1];for(q=0;q<pe.length;++q){var Ne=M.FileIndex[q],Fe=M.FullPaths[q];if(Ne.name=i(Fe).replace("/",""),Ne.L=Ne.R=Ne.C=-(Ne.color=1),Ne.size=Ne.content?Ne.content.length:0,Ne.start=0,Ne.clsid=Ne.clsid||ne,q===0)Ne.C=pe.length>1?1:-1,Ne.size=0,Ne.type=5;else if(Fe.slice(-1)=="/"){for(Ee=q+1;Ee<pe.length&&n(M.FullPaths[Ee])!=Fe;++Ee);for(Ne.C=Ee>=pe.length?-1:Ee,Ee=q+1;Ee<pe.length&&n(M.FullPaths[Ee])!=n(Fe);++Ee);Ne.R=Ee>=pe.length?-1:Ee,Ne.type=1}else n(M.FullPaths[q+1]||"")==n(Fe)&&(Ne.R=q+1),Ne.type=2}}}function U(M,W){var j=W||{};if(j.fileType=="mad")return Wc(M,j);if(D(M),j.fileType==="zip")return lr(M,j);var H=(function(Ue){for(var De=0,Be=0,Ge=0;Ge<Ue.FileIndex.length;++Ge){var Ft=Ue.FileIndex[Ge];if(Ft.content){var Mt=Ft.content.length;Mt>0&&(Mt<4096?De+=Mt+63>>6:Be+=Mt+511>>9)}}for(var qt=Ue.FullPaths.length+3>>2,rn=De+7>>3,Ra=De+127>>7,ka=rn+Be+qt+Ra,Hn=ka+127>>7,fs=Hn<=109?0:Math.ceil((Hn-109)/127);ka+Hn+fs+127>>7>Hn;)fs=++Hn<=109?0:Math.ceil((Hn-109)/127);var nn=[1,fs,Hn,Ra,qt,Be,De,0];return Ue.FileIndex[0].size=De<<6,nn[7]=(Ue.FileIndex[0].start=nn[0]+nn[1]+nn[2]+nn[3]+nn[4]+nn[5])+(nn[6]+7>>3),nn})(M),q=Dr(H[7]<<9),X=0,ue=0;{for(X=0;X<8;++X)q.write_shift(1,Ce[X]);for(X=0;X<8;++X)q.write_shift(2,0);for(q.write_shift(2,62),q.write_shift(2,3),q.write_shift(2,65534),q.write_shift(2,9),q.write_shift(2,6),X=0;X<3;++X)q.write_shift(2,0);for(q.write_shift(4,0),q.write_shift(4,H[2]),q.write_shift(4,H[0]+H[1]+H[2]+H[3]-1),q.write_shift(4,0),q.write_shift(4,4096),q.write_shift(4,H[3]?H[0]+H[1]+H[2]-1:O),q.write_shift(4,H[3]),q.write_shift(-4,H[1]?H[0]-1:O),q.write_shift(4,H[1]),X=0;X<109;++X)q.write_shift(-4,X<H[2]?H[1]+X:-1)}if(H[1])for(ue=0;ue<H[1];++ue){for(;X<236+ue*127;++X)q.write_shift(-4,X<H[2]?H[1]+X:-1);q.write_shift(-4,ue===H[1]-1?O:ue+1)}var Ee=function(Ue){for(ue+=Ue;X<ue-1;++X)q.write_shift(-4,X+1);Ue&&(++X,q.write_shift(-4,O))};for(ue=X=0,ue+=H[1];X<ue;++X)q.write_shift(-4,me.DIFSECT);for(ue+=H[2];X<ue;++X)q.write_shift(-4,me.FATSECT);Ee(H[3]),Ee(H[4]);for(var fe=0,pe=0,de=M.FileIndex[0];fe<M.FileIndex.length;++fe)de=M.FileIndex[fe],de.content&&(pe=de.content.length,!(pe<4096)&&(de.start=ue,Ee(pe+511>>9)));for(Ee(H[6]+7>>3);q.l&511;)q.write_shift(-4,me.ENDOFCHAIN);for(ue=X=0,fe=0;fe<M.FileIndex.length;++fe)de=M.FileIndex[fe],de.content&&(pe=de.content.length,!(!pe||pe>=4096)&&(de.start=ue,Ee(pe+63>>6)));for(;q.l&511;)q.write_shift(-4,me.ENDOFCHAIN);for(X=0;X<H[4]<<2;++X){var Ne=M.FullPaths[X];if(!Ne||Ne.length===0){for(fe=0;fe<17;++fe)q.write_shift(4,0);for(fe=0;fe<3;++fe)q.write_shift(4,-1);for(fe=0;fe<12;++fe)q.write_shift(4,0);continue}de=M.FileIndex[X],X===0&&(de.start=de.size?de.start-1:O);var Fe=X===0&&j.root||de.name;if(pe=2*(Fe.length+1),q.write_shift(64,Fe,"utf16le"),q.write_shift(2,pe),q.write_shift(1,de.type),q.write_shift(1,de.color),q.write_shift(-4,de.L),q.write_shift(-4,de.R),q.write_shift(-4,de.C),de.clsid)q.write_shift(16,de.clsid,"hex");else for(fe=0;fe<4;++fe)q.write_shift(4,0);q.write_shift(4,de.state||0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,de.start),q.write_shift(4,de.size),q.write_shift(4,0)}for(X=1;X<M.FileIndex.length;++X)if(de=M.FileIndex[X],de.size>=4096)if(q.l=de.start+1<<9,vt&&Buffer.isBuffer(de.content))de.content.copy(q,q.l,0,de.size),q.l+=de.size+511&-512;else{for(fe=0;fe<de.size;++fe)q.write_shift(1,de.content[fe]);for(;fe&511;++fe)q.write_shift(1,0)}for(X=1;X<M.FileIndex.length;++X)if(de=M.FileIndex[X],de.size>0&&de.size<4096)if(vt&&Buffer.isBuffer(de.content))de.content.copy(q,q.l,0,de.size),q.l+=de.size+63&-64;else{for(fe=0;fe<de.size;++fe)q.write_shift(1,de.content[fe]);for(;fe&63;++fe)q.write_shift(1,0)}if(vt)q.l=q.length;else for(;q.l<q.length;)q.write_shift(1,0);return q}function P(M,W){var j=M.FullPaths.map(function(fe){return fe.toUpperCase()}),H=j.map(function(fe){var pe=fe.split("/");return pe[pe.length-(fe.slice(-1)=="/"?2:1)]}),q=!1;W.charCodeAt(0)===47?(q=!0,W=j[0].slice(0,-1)+W):q=W.indexOf("/")!==-1;var X=W.toUpperCase(),ue=q===!0?j.indexOf(X):H.indexOf(X);if(ue!==-1)return M.FileIndex[ue];var Ee=!X.match(Wu);for(X=X.replace(wn,""),Ee&&(X=X.replace(Wu,"!")),ue=0;ue<j.length;++ue)if((Ee?j[ue].replace(Wu,"!"):j[ue]).replace(wn,"")==X||(Ee?H[ue].replace(Wu,"!"):H[ue]).replace(wn,"")==X)return M.FileIndex[ue];return null}var F=64,O=-2,we="d0cf11e0a1b11ae1",Ce=[208,207,17,224,161,177,26,225],ne="00000000000000000000000000000000",me={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:O,FREESECT:-1,HEADER_SIGNATURE:we,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ne,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function _e(M,W,j){d();var H=U(M,j);h.writeFileSync(W,H)}function ae(M){for(var W=new Array(M.length),j=0;j<M.length;++j)W[j]=String.fromCharCode(M[j]);return W.join("")}function Le(M,W){var j=U(M,W);switch(W&&W.type||"buffer"){case"file":return d(),h.writeFileSync(W.filename,j),j;case"binary":return typeof j=="string"?j:ae(j);case"base64":return QE(typeof j=="string"?j:ae(j));case"buffer":if(vt)return Buffer.isBuffer(j)?j:dl(j);case"array":return typeof j=="string"?za(j):j}return j}var Q;function L(M){try{var W=M.InflateRaw,j=new W;if(j._processChunk(new Uint8Array([3,0]),j._finishFlushFlag),j.bytesRead)Q=M;else throw new Error("zlib does not expose bytesRead")}catch(H){console.error("cannot use native zlib: "+(H.message||H))}}function te(M,W){if(!Q)return Ti(M,W);var j=Q.InflateRaw,H=new j,q=H._processChunk(M.slice(M.l),H._finishFlushFlag);return M.l+=H.bytesRead,q}function J(M){return Q?Q.deflateRawSync(M):at(M)}var ee=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],xe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Re=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Me(M){var W=(M<<1|M<<11)&139536|(M<<5|M<<15)&558144;return(W>>16|W>>8|W)&255}for(var Ie=typeof Uint8Array<"u",Oe=Ie?new Uint8Array(256):[],ct=0;ct<256;++ct)Oe[ct]=Me(ct);function Z(M,W){var j=Oe[M&255];return W<=8?j>>>8-W:(j=j<<8|Oe[M>>8&255],W<=16?j>>>16-W:(j=j<<8|Oe[M>>16&255],j>>>24-W))}function Vt(M,W){var j=W&7,H=W>>>3;return(M[H]|(j<=6?0:M[H+1]<<8))>>>j&3}function nt(M,W){var j=W&7,H=W>>>3;return(M[H]|(j<=5?0:M[H+1]<<8))>>>j&7}function Tt(M,W){var j=W&7,H=W>>>3;return(M[H]|(j<=4?0:M[H+1]<<8))>>>j&15}function Je(M,W){var j=W&7,H=W>>>3;return(M[H]|(j<=3?0:M[H+1]<<8))>>>j&31}function Ve(M,W){var j=W&7,H=W>>>3;return(M[H]|(j<=1?0:M[H+1]<<8))>>>j&127}function Gt(M,W,j){var H=W&7,q=W>>>3,X=(1<<j)-1,ue=M[q]>>>H;return j<8-H||(ue|=M[q+1]<<8-H,j<16-H)||(ue|=M[q+2]<<16-H,j<24-H)||(ue|=M[q+3]<<24-H),ue&X}function St(M,W,j){var H=W&7,q=W>>>3;return H<=5?M[q]|=(j&7)<<H:(M[q]|=j<<H&255,M[q+1]=(j&7)>>8-H),W+3}function Dt(M,W,j){var H=W&7,q=W>>>3;return j=(j&1)<<H,M[q]|=j,W+1}function Lr(M,W,j){var H=W&7,q=W>>>3;return j<<=H,M[q]|=j&255,j>>>=8,M[q+1]=j,W+8}function Ei(M,W,j){var H=W&7,q=W>>>3;return j<<=H,M[q]|=j&255,j>>>=8,M[q+1]=j&255,M[q+2]=j>>>8,W+16}function Un(M,W){var j=M.length,H=2*j>W?2*j:W+5,q=0;if(j>=W)return M;if(vt){var X=JE(H);if(M.copy)M.copy(X);else for(;q<M.length;++q)X[q]=M[q];return X}else if(Ie){var ue=new Uint8Array(H);if(ue.set)ue.set(M);else for(;q<j;++q)ue[q]=M[q];return ue}return M.length=H,M}function Ot(M){for(var W=new Array(M),j=0;j<M;++j)W[j]=0;return W}function Gr(M,W,j){var H=1,q=0,X=0,ue=0,Ee=0,fe=M.length,pe=Ie?new Uint16Array(32):Ot(32);for(X=0;X<32;++X)pe[X]=0;for(X=fe;X<j;++X)M[X]=0;fe=M.length;var de=Ie?new Uint16Array(fe):Ot(fe);for(X=0;X<fe;++X)pe[q=M[X]]++,H<q&&(H=q),de[X]=0;for(pe[0]=0,X=1;X<=H;++X)pe[X+16]=Ee=Ee+pe[X-1]<<1;for(X=0;X<fe;++X)Ee=M[X],Ee!=0&&(de[X]=pe[Ee+16]++);var Ne=0;for(X=0;X<fe;++X)if(Ne=M[X],Ne!=0)for(Ee=Z(de[X],H)>>H-Ne,ue=(1<<H+4-Ne)-1;ue>=0;--ue)W[Ee|ue<<Ne]=Ne&15|X<<4;return H}var bn=Ie?new Uint16Array(512):Ot(512),ba=Ie?new Uint16Array(32):Ot(32);if(!Ie){for(var er=0;er<512;++er)bn[er]=0;for(er=0;er<32;++er)ba[er]=0}(function(){for(var M=[],W=0;W<32;W++)M.push(5);Gr(M,ba,32);var j=[];for(W=0;W<=143;W++)j.push(8);for(;W<=255;W++)j.push(9);for(;W<=279;W++)j.push(7);for(;W<=287;W++)j.push(8);Gr(j,bn,288)})();var Cn=(function(){for(var W=Ie?new Uint8Array(32768):[],j=0,H=0;j<Re.length-1;++j)for(;H<Re[j+1];++H)W[H]=j;for(;H<32768;++H)W[H]=29;var q=Ie?new Uint8Array(259):[];for(j=0,H=0;j<xe.length-1;++j)for(;H<xe[j+1];++H)q[H]=j;function X(Ee,fe){for(var pe=0;pe<Ee.length;){var de=Math.min(65535,Ee.length-pe),Ne=pe+de==Ee.length;for(fe.write_shift(1,+Ne),fe.write_shift(2,de),fe.write_shift(2,~de&65535);de-- >0;)fe[fe.l++]=Ee[pe++]}return fe.l}function ue(Ee,fe){for(var pe=0,de=0,Ne=Ie?new Uint16Array(32768):[];de<Ee.length;){var Fe=Math.min(65535,Ee.length-de);if(Fe<10){for(pe=St(fe,pe,+(de+Fe==Ee.length)),pe&7&&(pe+=8-(pe&7)),fe.l=pe/8|0,fe.write_shift(2,Fe),fe.write_shift(2,~Fe&65535);Fe-- >0;)fe[fe.l++]=Ee[de++];pe=fe.l*8;continue}pe=St(fe,pe,+(de+Fe==Ee.length)+2);for(var Ue=0;Fe-- >0;){var De=Ee[de];Ue=(Ue<<5^De)&32767;var Be=-1,Ge=0;if((Be=Ne[Ue])&&(Be|=de&-32768,Be>de&&(Be-=32768),Be<de))for(;Ee[Be+Ge]==Ee[de+Ge]&&Ge<250;)++Ge;if(Ge>2){De=q[Ge],De<=22?pe=Lr(fe,pe,Oe[De+1]>>1)-1:(Lr(fe,pe,3),pe+=5,Lr(fe,pe,Oe[De-23]>>5),pe+=3);var Ft=De<8?0:De-4>>2;Ft>0&&(Ei(fe,pe,Ge-xe[De]),pe+=Ft),De=W[de-Be],pe=Lr(fe,pe,Oe[De]>>3),pe-=3;var Mt=De<4?0:De-2>>1;Mt>0&&(Ei(fe,pe,de-Be-Re[De]),pe+=Mt);for(var qt=0;qt<Ge;++qt)Ne[Ue]=de&32767,Ue=(Ue<<5^Ee[de])&32767,++de;Fe-=Ge-1}else De<=143?De=De+48:pe=Dt(fe,pe,1),pe=Lr(fe,pe,Oe[De]),Ne[Ue]=de&32767,++de}pe=Lr(fe,pe,0)-1}return fe.l=(pe+7)/8|0,fe.l}return function(fe,pe){return fe.length<8?X(fe,pe):ue(fe,pe)}})();function at(M){var W=Dr(50+Math.floor(M.length*1.1)),j=Cn(M,W);return W.slice(0,j)}var Yt=Ie?new Uint16Array(32768):Ot(32768),qr=Ie?new Uint16Array(32768):Ot(32768),Ct=Ie?new Uint16Array(128):Ot(128),Qt=1,xn=1;function ir(M,W){var j=Je(M,W)+257;W+=5;var H=Je(M,W)+1;W+=5;var q=Tt(M,W)+4;W+=4;for(var X=0,ue=Ie?new Uint8Array(19):Ot(19),Ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],fe=1,pe=Ie?new Uint8Array(8):Ot(8),de=Ie?new Uint8Array(8):Ot(8),Ne=ue.length,Fe=0;Fe<q;++Fe)ue[ee[Fe]]=X=nt(M,W),fe<X&&(fe=X),pe[X]++,W+=3;var Ue=0;for(pe[0]=0,Fe=1;Fe<=fe;++Fe)de[Fe]=Ue=Ue+pe[Fe-1]<<1;for(Fe=0;Fe<Ne;++Fe)(Ue=ue[Fe])!=0&&(Ee[Fe]=de[Ue]++);var De=0;for(Fe=0;Fe<Ne;++Fe)if(De=ue[Fe],De!=0){Ue=Oe[Ee[Fe]]>>8-De;for(var Be=(1<<7-De)-1;Be>=0;--Be)Ct[Ue|Be<<De]=De&7|Fe<<3}var Ge=[];for(fe=1;Ge.length<j+H;)switch(Ue=Ct[Ve(M,W)],W+=Ue&7,Ue>>>=3){case 16:for(X=3+Vt(M,W),W+=2,Ue=Ge[Ge.length-1];X-- >0;)Ge.push(Ue);break;case 17:for(X=3+nt(M,W),W+=3;X-- >0;)Ge.push(0);break;case 18:for(X=11+Ve(M,W),W+=7;X-- >0;)Ge.push(0);break;default:Ge.push(Ue),fe<Ue&&(fe=Ue);break}var Ft=Ge.slice(0,j),Mt=Ge.slice(j);for(Fe=j;Fe<286;++Fe)Ft[Fe]=0;for(Fe=H;Fe<30;++Fe)Mt[Fe]=0;return Qt=Gr(Ft,Yt,286),xn=Gr(Mt,qr,30),W}function yl(M,W){if(M[0]==3&&!(M[1]&3))return[mo(W),2];for(var j=0,H=0,q=JE(W||1<<18),X=0,ue=q.length>>>0,Ee=0,fe=0;(H&1)==0;){if(H=nt(M,j),j+=3,H>>>1)H>>1==1?(Ee=9,fe=5):(j=ir(M,j),Ee=Qt,fe=xn);else{j&7&&(j+=8-(j&7));var pe=M[j>>>3]|M[(j>>>3)+1]<<8;if(j+=32,pe>0)for(!W&&ue<X+pe&&(q=Un(q,X+pe),ue=q.length);pe-- >0;)q[X++]=M[j>>>3],j+=8;continue}for(;;){!W&&ue<X+32767&&(q=Un(q,X+32767),ue=q.length);var de=Gt(M,j,Ee),Ne=H>>>1==1?bn[de]:Yt[de];if(j+=Ne&15,Ne>>>=4,(Ne>>>8&255)===0)q[X++]=Ne;else{if(Ne==256)break;Ne-=257;var Fe=Ne<8?0:Ne-4>>2;Fe>5&&(Fe=0);var Ue=X+xe[Ne];Fe>0&&(Ue+=Gt(M,j,Fe),j+=Fe),de=Gt(M,j,fe),Ne=H>>>1==1?ba[de]:qr[de],j+=Ne&15,Ne>>>=4;var De=Ne<4?0:Ne-2>>1,Be=Re[Ne];for(De>0&&(Be+=Gt(M,j,De),j+=De),!W&&ue<Ue&&(q=Un(q,Ue+100),ue=q.length);X<Ue;)q[X]=q[X-Be],++X}}}return W?[q,j+7>>>3]:[q.slice(0,X),j+7>>>3]}function Ti(M,W){var j=M.slice(M.l||0),H=yl(j,W);return M.l+=H[1],H[0]}function Eo(M,W){if(M)typeof console<"u"&&console.error(W);else throw new Error(W)}function jn(M,W){var j=M;Jr(j,0);var H=[],q=[],X={FileIndex:H,FullPaths:q};b(X,{root:W.root});for(var ue=j.length-4;(j[ue]!=80||j[ue+1]!=75||j[ue+2]!=5||j[ue+3]!=6)&&ue>=0;)--ue;j.l=ue+4,j.l+=4;var Ee=j.read_shift(2);j.l+=6;var fe=j.read_shift(4);for(j.l=fe,ue=0;ue<Ee;++ue){j.l+=20;var pe=j.read_shift(4),de=j.read_shift(4),Ne=j.read_shift(2),Fe=j.read_shift(2),Ue=j.read_shift(2);j.l+=8;var De=j.read_shift(4),Be=u(j.slice(j.l+Ne,j.l+Ne+Fe));j.l+=Ne+Fe+Ue;var Ge=j.l;j.l=De+4,Si(j,pe,de,X,Be),j.l=Ge}return X}function Si(M,W,j,H,q){M.l+=2;var X=M.read_shift(2),ue=M.read_shift(2),Ee=c(M);if(X&8257)throw new Error("Unsupported ZIP encryption");for(var fe=M.read_shift(4),pe=M.read_shift(4),de=M.read_shift(4),Ne=M.read_shift(2),Fe=M.read_shift(2),Ue="",De=0;De<Ne;++De)Ue+=String.fromCharCode(M[M.l++]);if(Fe){var Be=u(M.slice(M.l,M.l+Fe));(Be[21589]||{}).mt&&(Ee=Be[21589].mt),((q||{})[21589]||{}).mt&&(Ee=q[21589].mt)}M.l+=Fe;var Ge=M.slice(M.l,M.l+pe);switch(ue){case 8:Ge=te(M,de);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ue)}var Ft=!1;X&8&&(fe=M.read_shift(4),fe==134695760&&(fe=M.read_shift(4),Ft=!0),pe=M.read_shift(4),de=M.read_shift(4)),pe!=W&&Eo(Ft,"Bad compressed size: "+W+" != "+pe),de!=j&&Eo(Ft,"Bad uncompressed size: "+j+" != "+de),bi(H,Ue,Ge,{unsafe:!0,mt:Ee})}function lr(M,W){var j=W||{},H=[],q=[],X=Dr(1),ue=j.compression?8:0,Ee=0,fe=0,pe=0,de=0,Ne=0,Fe=M.FullPaths[0],Ue=Fe,De=M.FileIndex[0],Be=[],Ge=0;for(fe=1;fe<M.FullPaths.length;++fe)if(Ue=M.FullPaths[fe].slice(Fe.length),De=M.FileIndex[fe],!(!De.size||!De.content||Ue=="Sh33tJ5")){var Ft=de,Mt=Dr(Ue.length);for(pe=0;pe<Ue.length;++pe)Mt.write_shift(1,Ue.charCodeAt(pe)&127);Mt=Mt.slice(0,Mt.l),Be[Ne]=g8.buf(De.content,0);var qt=De.content;ue==8&&(qt=J(qt)),X=Dr(30),X.write_shift(4,67324752),X.write_shift(2,20),X.write_shift(2,Ee),X.write_shift(2,ue),De.mt?o(X,De.mt):X.write_shift(4,0),X.write_shift(-4,Be[Ne]),X.write_shift(4,qt.length),X.write_shift(4,De.content.length),X.write_shift(2,Mt.length),X.write_shift(2,0),de+=X.length,H.push(X),de+=Mt.length,H.push(Mt),de+=qt.length,H.push(qt),X=Dr(46),X.write_shift(4,33639248),X.write_shift(2,0),X.write_shift(2,20),X.write_shift(2,Ee),X.write_shift(2,ue),X.write_shift(4,0),X.write_shift(-4,Be[Ne]),X.write_shift(4,qt.length),X.write_shift(4,De.content.length),X.write_shift(2,Mt.length),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(4,0),X.write_shift(4,Ft),Ge+=X.l,q.push(X),Ge+=Mt.length,q.push(Mt),++Ne}return X=Dr(22),X.write_shift(4,101010256),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,Ne),X.write_shift(2,Ne),X.write_shift(4,Ge),X.write_shift(4,de),X.write_shift(2,0),Ks([Ks(H),Ks(q),X])}var vn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function oa(M,W){if(M.ctype)return M.ctype;var j=M.name||"",H=j.match(/\.([^\.]+)$/);return H&&vn[H[1]]||W&&(H=(j=W).match(/[\.\\]([^\.\\])+$/),H&&vn[H[1]])?vn[H[1]]:"application/octet-stream"}function zn(M){for(var W=QE(M),j=[],H=0;H<W.length;H+=76)j.push(W.slice(H,H+76));return j.join(`\r
`)+`\r
`}function qc(M){var W=M.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(pe){var de=pe.charCodeAt(0).toString(16).toUpperCase();return"="+(de.length==1?"0"+de:de)});W=W.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),W.charAt(0)==`
`&&(W="=0D"+W.slice(1)),W=W.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var j=[],H=W.split(`\r
`),q=0;q<H.length;++q){var X=H[q];if(X.length==0){j.push("");continue}for(var ue=0;ue<X.length;){var Ee=76,fe=X.slice(ue,ue+Ee);fe.charAt(Ee-1)=="="?Ee--:fe.charAt(Ee-2)=="="?Ee-=2:fe.charAt(Ee-3)=="="&&(Ee-=3),fe=X.slice(ue,ue+Ee),ue+=Ee,ue<X.length&&(fe+="="),j.push(fe)}}return j.join(`\r
`)}function _l(M){for(var W=[],j=0;j<M.length;++j){for(var H=M[j];j<=M.length&&H.charAt(H.length-1)=="=";)H=H.slice(0,H.length-1)+M[++j];W.push(H)}for(var q=0;q<W.length;++q)W[q]=W[q].replace(/[=][0-9A-Fa-f]{2}/g,function(X){return String.fromCharCode(parseInt(X.slice(1),16))});return za(W.join(`\r
`))}function la(M,W,j){for(var H="",q="",X="",ue,Ee=0;Ee<10;++Ee){var fe=W[Ee];if(!fe||fe.match(/^\s*$/))break;var pe=fe.match(/^(.*?):\s*([^\s].*)$/);if(pe)switch(pe[1].toLowerCase()){case"content-location":H=pe[2].trim();break;case"content-type":X=pe[2].trim();break;case"content-transfer-encoding":q=pe[2].trim();break}}switch(++Ee,q.toLowerCase()){case"base64":ue=za(aa(W.slice(Ee).join("")));break;case"quoted-printable":ue=_l(W.slice(Ee));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+q)}var de=bi(M,H.slice(j.length),ue,{unsafe:!0});X&&(de.ctype=X)}function wi(M,W){if(ae(M.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var j=W&&W.root||"",H=(vt&&Buffer.isBuffer(M)?M.toString("binary"):ae(M)).split(`\r
`),q=0,X="";for(q=0;q<H.length;++q)if(X=H[q],!!/^Content-Location:/i.test(X)&&(X=X.slice(X.indexOf("file")),j||(j=X.slice(0,X.lastIndexOf("/")+1)),X.slice(0,j.length)!=j))for(;j.length>0&&(j=j.slice(0,j.length-1),j=j.slice(0,j.lastIndexOf("/")+1),X.slice(0,j.length)!=j););var ue=(H[1]||"").match(/boundary="(.*?)"/);if(!ue)throw new Error("MAD cannot find boundary");var Ee="--"+(ue[1]||""),fe=[],pe=[],de={FileIndex:fe,FullPaths:pe};b(de);var Ne,Fe=0;for(q=0;q<H.length;++q){var Ue=H[q];Ue!==Ee&&Ue!==Ee+"--"||(Fe++&&la(de,H.slice(Ne,q),j),Ne=q)}return de}function Wc(M,W){var j=W||{},H=j.boundary||"SheetJS";H="------="+H;for(var q=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+H.slice(2)+'"',"","",""],X=M.FullPaths[0],ue=X,Ee=M.FileIndex[0],fe=1;fe<M.FullPaths.length;++fe)if(ue=M.FullPaths[fe].slice(X.length),Ee=M.FileIndex[fe],!(!Ee.size||!Ee.content||ue=="Sh33tJ5")){ue=ue.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ge){return"_x"+Ge.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ge){return"_u"+Ge.charCodeAt(0).toString(16)+"_"});for(var pe=Ee.content,de=vt&&Buffer.isBuffer(pe)?pe.toString("binary"):ae(pe),Ne=0,Fe=Math.min(1024,de.length),Ue=0,De=0;De<=Fe;++De)(Ue=de.charCodeAt(De))>=32&&Ue<128&&++Ne;var Be=Ne>=Fe*4/5;q.push(H),q.push("Content-Location: "+(j.root||"file:///C:/SheetJS/")+ue),q.push("Content-Transfer-Encoding: "+(Be?"quoted-printable":"base64")),q.push("Content-Type: "+oa(Ee,ue)),q.push(""),q.push(Be?qc(de):zn(de))}return q.push(H+`--\r
`),q.join(`\r
`)}function Ai(M){var W={};return b(W,M),W}function bi(M,W,j,H){var q=H&&H.unsafe;q||b(M);var X=!q&&_t.find(M,W);if(!X){var ue=M.FullPaths[0];W.slice(0,ue.length)==ue?ue=W:(ue.slice(-1)!="/"&&(ue+="/"),ue=(ue+W).replace("//","/")),X={name:i(W),type:2},M.FileIndex.push(X),M.FullPaths.push(ue),q||_t.utils.cfb_gc(M)}return X.content=j,X.size=j?j.length:0,H&&(H.CLSID&&(X.clsid=H.CLSID),H.mt&&(X.mt=H.mt),H.ct&&(X.ct=H.ct)),X}function To(M,W){b(M);var j=_t.find(M,W);if(j){for(var H=0;H<M.FileIndex.length;++H)if(M.FileIndex[H]==j)return M.FileIndex.splice(H,1),M.FullPaths.splice(H,1),!0}return!1}function Ci(M,W,j){b(M);var H=_t.find(M,W);if(H){for(var q=0;q<M.FileIndex.length;++q)if(M.FileIndex[q]==H)return M.FileIndex[q].name=i(j),M.FullPaths[q]=j,!0}return!1}function Ca(M){D(M,!0)}return e.find=P,e.read=Y,e.parse=m,e.write=Le,e.writeFile=_e,e.utils={cfb_new:Ai,cfb_add:bi,cfb_del:To,cfb_mov:Ci,cfb_gc:Ca,ReadShift:rf,CheckField:O4,prep_blob:Jr,bconcat:Ks,use_zlib:L,_deflateRaw:at,_inflateRaw:Ti,consts:me},e})();function x8(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function vi(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function mx(t){for(var e=[],r=vi(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}var gd=new Date(1899,11,30,0,0,0);function An(t,e){var r=t.getTime(),n=gd.getTime()+(t.getTimezoneOffset()-gd.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var h4=new Date,v8=gd.getTime()+(h4.getTimezoneOffset()-gd.getTimezoneOffset())*6e4,sT=h4.getTimezoneOffset();function $d(t){var e=new Date;return e.setTime(t*24*60*60*1e3+v8),e.getTimezoneOffset()!==sT&&e.setTime(e.getTime()+(e.getTimezoneOffset()-sT)*6e4),e}function y8(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var o=1;o!=i.length;++o)if(i[o]){switch(r=1,o>3&&(n=!0),i[o].slice(i[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[o].slice(i[o].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[o],10)}return e}var oT=new Date("2017-02-19T19:06:09.000Z"),d4=isNaN(oT.getFullYear())?new Date("2/19/17"):oT,_8=d4.getFullYear()==2017;function zr(t,e){var r=new Date(t);if(_8)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(d4.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function ll(t,e){if(vt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Xu(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Xu(ZA(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Xu(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Xu(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(o){return r[o]||o})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function en(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=en(t[r]));return e}function fr(t,e){for(var r="";r.length<e;)r+=t;return r}function $a(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,o){return r=-r,o}),!isNaN(e=Number(n)))?e/r:e}var E8=["january","february","march","april","may","june","july","august","september","october","november","december"];function kc(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),o=e.getDate();if(isNaN(o))return r;var c=t.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&E8.indexOf(c)==-1)return r}else if(c.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||o>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var T8=(function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var o=r.split(n),c=[o[0]],u=1;u<o.length;++u)c.push(i),c.push(o[u]);return c}})();function p4(t){return t?t.content&&t.type?ll(t.content,!0):t.data?qu(t.data):t.asNodeBuffer&&vt?qu(t.asNodeBuffer().toString("binary")):t.asBinary?qu(t.asBinary()):t._data&&t._data.getContent?qu(ll(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function m4(t){if(!t)return null;if(t.data)return KE(t.data);if(t.asNodeBuffer&&vt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?KE(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function S8(t){return t&&t.name.slice(-4)===".bin"?m4(t):p4(t)}function Ta(t,e){for(var r=t.FullPaths||vi(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),o=0;o<r.length;++o){var c=r[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==c||i==c)return t.files?t.files[r[o]]:t.FileIndex[o]}return null}function gx(t,e){var r=Ta(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function br(t,e,r){if(!r)return S8(gx(t,e));if(!e)return null;try{return br(t,e)}catch{return null}}function ea(t,e,r){if(!r)return p4(gx(t,e));if(!e)return null;try{return ea(t,e)}catch{return null}}function w8(t,e,r){return m4(gx(t,e))}function lT(t){for(var e=t.FullPaths||vi(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function A8(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return vt?n=dl(r):n=GO(r),_t.utils.cfb_add(t,e,n)}_t.utils.cfb_add(t,e,r)}else t.file(e,r)}function g4(t,e){switch(e.type){case"base64":return _t.read(t,{type:"base64"});case"binary":return _t.read(t,{type:"binary"});case"buffer":case"array":return _t.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Yu(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var x4=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,b8=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,cT=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,C8=/<[^>]*>/g,gn=x4.match(cT)?cT:C8,R8=/<\w*:/,k8=/<(\/?)\w+:/;function $e(t,e,r){for(var n={},i=0,o=0;i!==t.length&&!((o=t.charCodeAt(i))===32||o===10||o===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var c=t.match(b8),u=0,h="",d=0,m="",v="",y=1;if(c)for(d=0;d!=c.length;++d){for(v=c[d],o=0;o!=v.length&&v.charCodeAt(o)!==61;++o);for(m=v.slice(0,o).trim();v.charCodeAt(o+1)==32;)++o;for(y=(i=v.charCodeAt(o+1))==34||i==39?1:0,h=v.slice(o+1+y,v.length-y),u=0;u!=m.length&&m.charCodeAt(u)!==58;++u);if(u===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),n[m]=h,n[m.toLowerCase()]=h;else{var E=(u===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(u+1);if(n[E]&&m.slice(u-3,u)=="ext")continue;n[E]=h,n[E.toLowerCase()]=h}}return n}function yi(t){return t.replace(k8,"<$1")}var v4={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},I8=mx(v4),wt=(function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",o=i.indexOf("<![CDATA[");if(o==-1)return i.replace(t,function(u,h){return v4[u]||String.fromCharCode(parseInt(h,u.indexOf("x")>-1?16:10))||u}).replace(e,function(u,h){return String.fromCharCode(parseInt(h,16))});var c=i.indexOf("]]>");return r(i.slice(0,o))+i.slice(o+9,c)+r(i.slice(c+3))}})(),D8=/[&<>'"]/g,N8=/[\u0000-\u001f]/g;function xx(t){var e=t+"";return e.replace(D8,function(r){return I8[r]}).replace(/\n/g,"<br/>").replace(N8,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var uT=(function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}})();function nr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function gg(t){for(var e="",r=0,n=0,i=0,o=0,c=0,u=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){c=(n&31)<<6,c|=i&63,e+=String.fromCharCode(c);continue}if(o=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|o&63);continue}c=t.charCodeAt(r++),u=((n&7)<<18|(i&63)<<12|(o&63)<<6|c&63)-65536,e+=String.fromCharCode(55296+(u>>>10&1023)),e+=String.fromCharCode(56320+(u&1023))}return e}function fT(t){var e=mo(2*t.length),r,n,i=1,o=0,c=0,u;for(n=0;n<t.length;n+=i)i=1,(u=t.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(t.charCodeAt(n+1)&63),i=2):u<240?(r=(u&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(u&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,c=55296+(r>>>10&1023),r=56320+(r&1023)),c!==0&&(e[o++]=c&255,e[o++]=c>>>8,c=0),e[o++]=r%256,e[o++]=r>>>8;return e.slice(0,o).toString("ucs2")}function hT(t){return dl(t,"binary").toString("utf8")}var wh="foo bar baz",$t=vt&&(hT(wh)==gg(wh)&&hT||fT(wh)==gg(wh)&&fT)||gg,Xu=vt?function(t){return dl(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Ef=(function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),y4=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}})(),O8=(function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),F8=/<\/?(?:vt:)?variant>/g,M8=/<(?:vt:)([^>]*)>([\s\S]*)</;function dT(t,e){var r=$e(t),n=t.match(O8(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(o){var c=o.replace(F8,"").match(M8);c&&i.push({v:$t(c[2]),t:c[1]})}),i}var L8=/(^\s|\s$|\n)/;function P8(t){return vi(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function B8(t,e,r){return"<"+t+(r!=null?P8(r):"")+(e!=null?(e.match(L8)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function vx(t){if(vt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return $t(pl(hx(t)));throw new Error("Bad input format: expected Buffer or string")}var Tf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,V8={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},U8=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function j8(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,o=5;o>=0;--o)i=i*256+t[e+o];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function z8(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,o=0,c=n?-e:e;isFinite(c)?c==0?i=o=0:(i=Math.floor(Math.log(c)/Math.LN2),o=c*Math.pow(2,52-i),i<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?i=-1022:(o-=Math.pow(2,52),i+=1023)):(i=2047,o=isNaN(e)?26985:0);for(var u=0;u<=5;++u,o/=256)t[r+u]=o&255;t[r+6]=(i&15)<<4|o&15,t[r+7]=i>>4|n}var pT=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,o=t[0][n].length;i<o;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},mT=vt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:dl(e)})):pT(t)}:pT,gT=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Ki(t,i)));return n.join("").replace(wn,"")},yx=vt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(wn,""):gT(t,e,r)}:gT,xT=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},_4=vt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):xT(t,e,r)}:xT,vT=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(cc(t,i)));return n.join("")},Wf=vt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):vT(e,r,n)}:vT,E4=function(t,e){var r=Jn(t,e);return r>0?Wf(t,e+4,e+4+r-1):""},T4=E4,S4=function(t,e){var r=Jn(t,e);return r>0?Wf(t,e+4,e+4+r-1):""},w4=S4,A4=function(t,e){var r=2*Jn(t,e);return r>0?Wf(t,e+4,e+4+r-1):""},b4=A4,C4=function(e,r){var n=Jn(e,r);return n>0?yx(e,r+4,r+4+n):""},R4=C4,k4=function(t,e){var r=Jn(t,e);return r>0?Wf(t,e+4,e+4+r):""},I4=k4,D4=function(t,e){return j8(t,e)},xd=D4,N4=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};vt&&(T4=function(e,r){if(!Buffer.isBuffer(e))return E4(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},w4=function(e,r){if(!Buffer.isBuffer(e))return S4(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},b4=function(e,r){if(!Buffer.isBuffer(e))return A4(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},R4=function(e,r){if(!Buffer.isBuffer(e))return C4(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},I4=function(e,r){if(!Buffer.isBuffer(e))return k4(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},xd=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):D4(e,r)},N4=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var cc=function(t,e){return t[e]},Ki=function(t,e){return t[e+1]*256+t[e]},H8=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Jn=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Xo=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},G8=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function rf(t,e){var r="",n,i,o=[],c,u,h,d;switch(e){case"dbcs":if(d=this.l,vt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(h=0;h<t;++h)r+=String.fromCharCode(Ki(this,d)),d+=2;t*=2;break;case"utf8":r=Wf(this,this.l,this.l+t);break;case"utf16le":t*=2,r=yx(this,this.l,this.l+t);break;case"wstr":return rf.call(this,t,"dbcs");case"lpstr-ansi":r=T4(this,this.l),t=4+Jn(this,this.l);break;case"lpstr-cp":r=w4(this,this.l),t=4+Jn(this,this.l);break;case"lpwstr":r=b4(this,this.l),t=4+2*Jn(this,this.l);break;case"lpp4":t=4+Jn(this,this.l),r=R4(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Jn(this,this.l),r=I4(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(c=cc(this,this.l+t++))!==0;)o.push(Sh(c));r=o.join("");break;case"_wstr":for(t=0,r="";(c=Ki(this,this.l+t))!==0;)o.push(Sh(c)),t+=2;t+=2,r=o.join("");break;case"dbcs-cont":for(r="",d=this.l,h=0;h<t;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return c=cc(this,d),this.l=d+1,u=rf.call(this,t-h,c?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(Sh(Ki(this,d))),d+=2}r=o.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,h=0;h!=t;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return c=cc(this,d),this.l=d+1,u=rf.call(this,t-h,c?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(Sh(cc(this,d))),d+=1}r=o.join("");break;default:switch(t){case 1:return n=cc(this,this.l),this.l++,n;case 2:return n=(e==="i"?H8:Ki)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?Xo:G8)(this,this.l),this.l+=4,n):(i=Jn(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=xd(this,this.l):i=xd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=_4(this,this.l,t);break}}return this.l+=t,r}var q8=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},W8=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},Y8=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function X8(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)Y8(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var o=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var c=e.charCodeAt(i);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,q8(this,e,this.l);break;case 8:if(n=8,r==="f"){z8(this,e,this.l);break}case 16:break;case-4:n=4,W8(this,e,this.l);break}return this.l+=n,this}function O4(t,e){var r=_4(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Jr(t,e){t.l=e,t.read_shift=rf,t.chk=O4,t.write_shift=X8}function mn(t,e){t.l+=e}function Dr(t){var e=mo(t);return Jr(e,0),e}function us(t,e,r){if(t){var n,i,o;Jr(t,t.l||0);for(var c=t.length,u=0,h=0;t.l<c;){u=t.read_shift(1),u&128&&(u=(u&127)+((t.read_shift(1)&127)<<7));var d=Sd[u]||Sd[65535];for(n=t.read_shift(1),o=n&127,i=1;i<4&&n&128;++i)o+=((n=t.read_shift(1))&127)<<7*i;h=t.l+o;var m=d.f&&d.f(t,o,r);if(t.l=h,e(m,d,u))return}}}function t1(){var t=[],e=vt?256:2048,r=function(d){var m=Dr(d);return Jr(m,0),m},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},o=function(d){return n&&d<n.length-n.l?n:(i(),n=r(Math.max(d+1,e)))},c=function(){return i(),Ks(t)},u=function(d){i(),n=d,n.l==null&&(n.l=n.length),o(e)};return{next:o,push:u,end:c,_bufs:t}}function nf(t,e,r){var n=en(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function yT(t,e,r){var n=en(t);return n.s=nf(n.s,e.s,r),n.e=nf(n.e,e.s,r),n}function af(t,e){if(t.cRel&&t.c<0)for(t=en(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=en(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=tt(t);return!t.cRel&&t.cRel!=null&&(r=Q8(r)),!t.rRel&&t.rRel!=null&&(r=K8(r)),r}function xg(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Nr(t.s.c)+":"+(t.e.cRel?"":"$")+Nr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+tn(t.s.r)+":"+(t.e.rRel?"":"$")+tn(t.e.r):af(t.s,e.biff)+":"+af(t.e,e.biff)}function _x(t){return parseInt($8(t),10)-1}function tn(t){return""+(t+1)}function K8(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function $8(t){return t.replace(/\$(\d+)$/,"$1")}function Ex(t){for(var e=J8(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Nr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function Q8(t){return t.replace(/^([A-Z])/,"$$$1")}function J8(t){return t.replace(/^\$([A-Z])/,"$1")}function Z8(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Sn(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function tt(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Hc(t){var e=t.indexOf(":");return e==-1?{s:Sn(t),e:Sn(t)}:{s:Sn(t.slice(0,e)),e:Sn(t.slice(e+1))}}function Et(t,e){return typeof e>"u"||typeof e=="number"?Et(t.s,t.e):(typeof t!="string"&&(t=tt(t)),typeof e!="string"&&(e=tt(e)),t==e?t:t+":"+e)}function hr(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,o=t.length;for(r=0;n<o&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<o&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===o||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=o&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=o&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function _T(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=wa(t.z,r?An(e):e)}catch{}try{return t.w=wa((t.XF||{}).numFmtId||(r?14:0),r?An(e):e)}catch{return""+e}}function os(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?xl[t.v]||t.v:e==null?_T(t,t.v):_T(t,e))}function _o(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function F4(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,o=t||(i?[]:{}),c=0,u=0;if(o&&n.origin!=null){if(typeof n.origin=="number")c=n.origin;else{var h=typeof n.origin=="string"?Sn(n.origin):n.origin;c=h.r,u=h.c}o["!ref"]||(o["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var m=hr(o["!ref"]);d.s.c=m.s.c,d.s.r=m.s.r,d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),c==-1&&(d.e.r=c=m.e.r+1)}for(var v=0;v!=e.length;++v)if(e[v]){if(!Array.isArray(e[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=e[v].length;++y)if(!(typeof e[v][y]>"u")){var E={v:e[v][y]},S=c+v,T=u+y;if(d.s.r>S&&(d.s.r=S),d.s.c>T&&(d.s.c=T),d.e.r<S&&(d.e.r=S),d.e.c<T&&(d.e.c=T),e[v][y]&&typeof e[v][y]=="object"&&!Array.isArray(e[v][y])&&!(e[v][y]instanceof Date))E=e[v][y];else if(Array.isArray(E.v)&&(E.f=e[v][y][1],E.v=E.v[0]),E.v===null)if(E.f)E.t="n";else if(n.nullError)E.t="e",E.v=0;else if(n.sheetStubs)E.t="z";else continue;else typeof E.v=="number"?E.t="n":typeof E.v=="boolean"?E.t="b":E.v instanceof Date?(E.z=n.dateNF||ot[14],n.cellDates?(E.t="d",E.w=wa(E.z,An(E.v))):(E.t="n",E.v=An(E.v),E.w=wa(E.z,E.v))):E.t="s";if(i)o[S]||(o[S]=[]),o[S][T]&&o[S][T].z&&(E.z=o[S][T].z),o[S][T]=E;else{var A=tt({c:T,r:S});o[A]&&o[A].z&&(E.z=o[A].z),o[A]=E}}}return d.s.c<1e7&&(o["!ref"]=Et(d)),o}function Gc(t,e){return F4(null,t,e)}function eF(t){return t.read_shift(4,"i")}function dn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function tF(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Tx(t,e){var r=t.l,n=t.read_shift(1),i=dn(t),o=[],c={t:i,h:i};if((n&1)!==0){for(var u=t.read_shift(4),h=0;h!=u;++h)o.push(tF(t));c.r=o}else c.r=[{ich:0,ifnt:0}];return t.l=r+e,c}var rF=Tx;function Aa(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function ml(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var nF=dn;function Sx(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var aF=dn,r1=Sx;function wx(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?xd([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Xo(e,0)>>2;return r?i/100:i}function M4(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var gl=M4;function fn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function iF(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),o=t.read_shift(2,"i"),c=t.read_shift(1),u=t.read_shift(1),h=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var d=tl[i];d&&(e.rgb=wf(d));break;case 2:e.rgb=wf([c,u,h]);break;case 3:e.theme=i;break}return o!=0&&(e.tint=o>0?o/32767:o/32768),e}function sF(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function L4(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function oF(t){return L4(t,1)}function lF(t){return L4(t,2)}var Ax=2,Mn=3,Ah=11,ET=12,vd=19,bh=64,cF=65,uF=71,fF=4108,hF=4126,Ur=80,P4=81,dF=[Ur,P4],pF={1:{n:"CodePage",t:Ax},2:{n:"Category",t:Ur},3:{n:"PresentationFormat",t:Ur},4:{n:"ByteCount",t:Mn},5:{n:"LineCount",t:Mn},6:{n:"ParagraphCount",t:Mn},7:{n:"SlideCount",t:Mn},8:{n:"NoteCount",t:Mn},9:{n:"HiddenCount",t:Mn},10:{n:"MultimediaClipCount",t:Mn},11:{n:"ScaleCrop",t:Ah},12:{n:"HeadingPairs",t:fF},13:{n:"TitlesOfParts",t:hF},14:{n:"Manager",t:Ur},15:{n:"Company",t:Ur},16:{n:"LinksUpToDate",t:Ah},17:{n:"CharacterCount",t:Mn},19:{n:"SharedDoc",t:Ah},22:{n:"HyperlinksChanged",t:Ah},23:{n:"AppVersion",t:Mn,p:"version"},24:{n:"DigSig",t:cF},26:{n:"ContentType",t:Ur},27:{n:"ContentStatus",t:Ur},28:{n:"Language",t:Ur},29:{n:"Version",t:Ur},255:{},2147483648:{n:"Locale",t:vd},2147483651:{n:"Behavior",t:vd},1919054434:{}},mF={1:{n:"CodePage",t:Ax},2:{n:"Title",t:Ur},3:{n:"Subject",t:Ur},4:{n:"Author",t:Ur},5:{n:"Keywords",t:Ur},6:{n:"Comments",t:Ur},7:{n:"Template",t:Ur},8:{n:"LastAuthor",t:Ur},9:{n:"RevNumber",t:Ur},10:{n:"EditTime",t:bh},11:{n:"LastPrinted",t:bh},12:{n:"CreatedDate",t:bh},13:{n:"ModifiedDate",t:bh},14:{n:"PageCount",t:Mn},15:{n:"WordCount",t:Mn},16:{n:"CharCount",t:Mn},17:{n:"Thumbnail",t:uF},18:{n:"Application",t:Ur},19:{n:"DocSecurity",t:Mn},255:{},2147483648:{n:"Locale",t:vd},2147483651:{n:"Behavior",t:vd},1919054434:{}},TT={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},gF=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function xF(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var vF=xF([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),tl=en(vF),xl={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},B4={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ST={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function yF(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function _F(t){var e=yF();if(!t||!t.match)return e;var r={};if((t.match(gn)||[]).forEach(function(n){var i=$e(n);switch(i[0].replace(R8,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[ST[i.ContentType]]!==void 0&&e[ST[i.ContentType]].push(i.PartName);break}}),e.xmlns!==V8.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}var fc={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function n1(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function sf(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(gn)||[]).forEach(function(i){var o=$e(i);if(o[0]==="<Relationship"){var c={};c.Type=o.Type,c.Target=o.Target,c.Id=o.Id,o.TargetMode&&(c.TargetMode=o.TargetMode);var u=o.TargetMode==="External"?o.Target:Yu(o.Target,e);r[u]=c,n[o.Id]=c}}),r["!id"]=n,r}var EF="application/vnd.oasis.opendocument.spreadsheet";function TF(t,e){for(var r=vx(t),n,i;n=Tf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=$e(n[0],!1),i.path=="/"&&i.type!==EF)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var of=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],SF=(function(){for(var t=new Array(of.length),e=0;e<of.length;++e){var r=of[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t})();function V4(t){var e={};t=$t(t);for(var r=0;r<of.length;++r){var n=of[r],i=t.match(SF[r]);i!=null&&i.length>0&&(e[n[1]]=wt(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=zr(e[n[1]]))}return e}var wF=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function U4(t,e,r,n){var i=[];if(typeof t=="string")i=dT(t,n);else for(var o=0;o<t.length;++o)i=i.concat(t[o].map(function(m){return{v:m}}));var c=typeof e=="string"?dT(e,n).map(function(m){return m.v}):e,u=0,h=0;if(c.length>0)for(var d=0;d!==i.length;d+=2){switch(h=+i[d+1].v,i[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=h,r.SheetNames=c.slice(u,u+h);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=h,r.DefinedNames=c.slice(u,u+h);break;case"Charts":case"Diagramme":r.Chartsheets=h,r.ChartNames=c.slice(u,u+h);break}u+=h}}function AF(t,e,r){var n={};return e||(e={}),t=$t(t),wF.forEach(function(i){var o=(t.match(Ef(i[0]))||[])[1];switch(i[2]){case"string":o&&(e[i[1]]=wt(o));break;case"bool":e[i[1]]=o==="true";break;case"raw":var c=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));c&&c.length>0&&(n[i[1]]=c[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&U4(n.HeadingPairs,n.TitlesOfParts,e,r),e}var bF=/<[^>]+>[^<]*/g;function CF(t,e){var r={},n="",i=t.match(bF);if(i)for(var o=0;o!=i.length;++o){var c=i[o],u=$e(c);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=wt(u.name);break;case"</property>":n=null;break;default:if(c.indexOf("<vt:")===0){var h=c.split(">"),d=h[0].slice(4),m=h[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=wt(m);break;case"bool":r[n]=nr(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(m,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(m);break;case"filetime":case"date":r[n]=zr(m);break;case"cy":case"error":r[n]=wt(m);break;default:if(d.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",c,d,h)}}else if(c.slice(0,2)!=="</"){if(e.WTF)throw new Error(c)}}}return r}var RF={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},vg;function kF(t,e,r){vg||(vg=mx(RF)),e=vg[e]||e,t[e]=r}function bx(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function j4(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function z4(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function H4(t,e,r){return e===31?z4(t):j4(t,e,r)}function a1(t,e,r){return H4(t,e,r===!1?0:4)}function IF(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return H4(t,e,0)}function DF(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(wn,""),t.l-i&2&&(t.l+=2)}return r}function NF(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(wn,"");return r}function OF(t){var e=t.l,r=yd(t,P4);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=yd(t,Mn);return[r,n]}function FF(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(OF(t));return r}function wT(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var o=t.read_shift(4),c=t.read_shift(4);n[o]=t.read_shift(c,e===1200?"utf16le":"utf8").replace(wn,"").replace(Wu,"!"),e===1200&&c%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function G4(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function MF(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function yd(t,e,r){var n=t.read_shift(2),i,o=r||{};if(t.l+=2,e!==ET&&n!==e&&dF.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===ET?n:e){case 2:return i=t.read_shift(2,"i"),o.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return j4(t,n,4).replace(wn,"");case 31:return z4(t);case 64:return bx(t);case 65:return G4(t);case 71:return MF(t);case 80:return a1(t,n,!o.raw).replace(wn,"");case 81:return IF(t,n).replace(wn,"");case 4108:return FF(t);case 4126:case 4127:return n==4127?DF(t):NF(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function AT(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),o=[],c=0,u=0,h=-1,d={};for(c=0;c!=i;++c){var m=t.read_shift(4),v=t.read_shift(4);o[c]=[m,v+r]}o.sort(function(I,C){return I[1]-C[1]});var y={};for(c=0;c!=i;++c){if(t.l!==o[c][1]){var E=!0;if(c>0&&e)switch(e[o[c-1][0]].t){case 2:t.l+2===o[c][1]&&(t.l+=2,E=!1);break;case 80:t.l<=o[c][1]&&(t.l=o[c][1],E=!1);break;case 4108:t.l<=o[c][1]&&(t.l=o[c][1],E=!1);break}if((!e||c==0)&&t.l<=o[c][1]&&(E=!1,t.l=o[c][1]),E)throw new Error("Read Error: Expected address "+o[c][1]+" at "+t.l+" :"+c)}if(e){var S=e[o[c][0]];if(y[S.n]=yd(t,S.t,{raw:!0}),S.p==="version"&&(y[S.n]=String(y[S.n]>>16)+"."+("0000"+String(y[S.n]&65535)).slice(-4)),S.n=="CodePage")switch(y[S.n]){case 0:y[S.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ga(u=y[S.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+y[S.n])}}else if(o[c][0]===1){if(u=y.CodePage=yd(t,Ax),Ga(u),h!==-1){var T=t.l;t.l=o[h][1],d=wT(t,u),t.l=T}}else if(o[c][0]===0){if(u===0){h=c,t.l=o[c+1][1];continue}d=wT(t,u)}else{var A=d[o[c][0]],B;switch(t[t.l]){case 65:t.l+=4,B=G4(t);break;case 30:t.l+=4,B=a1(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,B=a1(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,B=t.read_shift(4,"i");break;case 19:t.l+=4,B=t.read_shift(4);break;case 5:t.l+=4,B=t.read_shift(8,"f");break;case 11:t.l+=4,B=gr(t,4);break;case 64:t.l+=4,B=zr(bx(t));break;default:throw new Error("unparsed value: "+t[t.l])}y[A]=B}}return t.l=r+n,y}function bT(t,e,r){var n=t.content;if(!n)return{};Jr(n,0);var i,o,c,u,h=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),m=n.read_shift(16);if(m!==_t.utils.consts.HEADER_CLSID&&m!==r)throw new Error("Bad PropertySet CLSID "+m);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(o=n.read_shift(16),u=n.read_shift(4),i===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);i===2&&(c=n.read_shift(16),h=n.read_shift(4));var v=AT(n,e),y={SystemIdentifier:d};for(var E in v)y[E]=v[E];if(y.FMTID=o,i===1)return y;if(h-n.l==2&&(n.l+=2),n.l!==h)throw new Error("Length mismatch 2: "+n.l+" !== "+h);var S;try{S=AT(n,null)}catch{}for(E in S)y[E]=S[E];return y.FMTID=[o,c],y}function Gs(t,e){return t.read_shift(e),null}function LF(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function gr(t,e){return t.read_shift(e)===1}function Cr(t){return t.read_shift(2,"u")}function q4(t,e){return LF(t,e,Cr)}function PF(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function Yf(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var o=t.read_shift(1);o&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var c=n?t.read_shift(n,i):"";return c}function BF(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,o=1+(r&1),c=0,u,h={};i&&(c=t.read_shift(2)),n&&(u=t.read_shift(4));var d=o==2?"dbcs-cont":"sbcs-cont",m=e===0?"":t.read_shift(e,d);return i&&(t.l+=4*c),n&&(t.l+=u),h.t=m,i||(h.raw="<t>"+h.t+"</t>",h.r=h.t),h}function cl(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Xf(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):cl(t,n,r)}function vl(t,e,r){if(r.biff>5)return Xf(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function VF(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function UF(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(wn,"");return n&&(t.l+=24),i}function jF(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var o=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var c=t.read_shift(o>>1,"utf16le").replace(wn,"");return r+c}function zF(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return UF(t);case"0303000000000000c000000000000046":return jF(t);default:throw new Error("Unsupported Moniker "+r)}}function Ch(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(wn,""):"";return r}function HF(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var o,c,u,h,d="",m,v;i&16&&(o=Ch(t,r-t.l)),i&128&&(c=Ch(t,r-t.l)),(i&257)===257&&(u=Ch(t,r-t.l)),(i&257)===1&&(h=zF(t,r-t.l)),i&8&&(d=Ch(t,r-t.l)),i&32&&(m=t.read_shift(16)),i&64&&(v=bx(t)),t.l=r;var y=c||u||h||"";y&&d&&(y+="#"+d),y||(y="#"+d),i&2&&y.charAt(0)=="/"&&y.charAt(1)!="/"&&(y="file://"+y);var E={Target:y};return m&&(E.guid=m),v&&(E.time=v),o&&(E.Tooltip=o),E}function W4(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function Y4(t,e){var r=W4(t);return r[3]=0,r}function _i(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function GF(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function qF(t,e,r){return e===0?"":vl(t,e,r)}function WF(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),o=t.read_shift(n,"i"),c=t.read_shift(n,"i");return[i,o,c]}function X4(t){var e=t.read_shift(2),r=wx(t);return[e,r]}function YF(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=Yf(t,e,r),o=t.read_shift(2);if(n-=t.l,o!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+o);return t.l+=o,i}function Qd(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function K4(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var XF=K4;function $4(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function KF(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function $F(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function on(t){t.l+=2,t.l+=t.read_shift(2)}var QF={0:on,4:on,5:on,6:on,7:$F,8:on,9:on,10:on,11:on,12:on,13:KF,14:on,15:on,16:on,17:on,18:on,19:on,20:on,21:$4};function JF(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(QF[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Rh(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function ZF(t,e){return e===0||t.read_shift(2),1200}function eM(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=vl(t,0,r);return t.read_shift(e+n-t.l),i}function tM(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function rM(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,o=t.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var c=Yf(t,0,r);return c.length===0&&(c="Sheet1"),{pos:n,hs:i,dt:o,name:c}}function nM(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),o=[],c=0;c!=i&&t.l<r;++c)o.push(BF(t));return o.Count=n,o.Unique=i,o}function aM(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function iM(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function sM(t){var e=GF(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function oM(t){return t.read_shift(2),t.read_shift(4)}function CT(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var o={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[o,i]}function lM(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),c=t.read_shift(2),u=t.read_shift(2),h=t.read_shift(2),d=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:o,CurTab:c,FirstTab:u,Selected:h,TabRatio:d}}function cM(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function uM(){}function fM(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Yf(t,0,r),n}function hM(t){var e=_i(t);return e.isst=t.read_shift(4),e}function dM(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=_i(t);r.biff==2&&t.l++;var o=Xf(t,n-t.l,r);return i.val=o,i}function pM(t,e,r){var n=t.read_shift(2),i=vl(t,0,r);return[n,i]}var mM=vl;function RT(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,o=t.read_shift(i),c=t.read_shift(i),u=t.read_shift(2),h=t.read_shift(2);return t.l=n,{s:{r:o,c:u},e:{r:c,c:h}}}function gM(t){var e=t.read_shift(2),r=t.read_shift(2),n=X4(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function xM(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),o=[];t.l<r;)o.push(X4(t));if(t.l!==r)throw new Error("MulRK read error");var c=t.read_shift(2);if(o.length!=c-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:c,rkrec:o}}function vM(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),o=[];t.l<r;)o.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var c=t.read_shift(2);if(o.length!=c-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:c,ixfe:o}}function yM(t,e,r,n){var i={},o=t.read_shift(4),c=t.read_shift(4),u=t.read_shift(4),h=t.read_shift(2);return i.patternType=gF[u>>26],n.cellStyles&&(i.alc=o&7,i.fWrap=o>>3&1,i.alcV=o>>4&7,i.fJustLast=o>>7&1,i.trot=o>>8&255,i.cIndent=o>>16&15,i.fShrinkToFit=o>>20&1,i.iReadOrder=o>>22&2,i.fAtrNum=o>>26&1,i.fAtrFnt=o>>27&1,i.fAtrAlc=o>>28&1,i.fAtrBdr=o>>29&1,i.fAtrPat=o>>30&1,i.fAtrProt=o>>31&1,i.dgLeft=c&15,i.dgRight=c>>4&15,i.dgTop=c>>8&15,i.dgBottom=c>>12&15,i.icvLeft=c>>16&127,i.icvRight=c>>23&127,i.grbitDiag=c>>30&3,i.icvTop=u&127,i.icvBottom=u>>7&127,i.icvDiag=u>>14&127,i.dgDiag=u>>21&15,i.icvFore=h&127,i.icvBack=h>>7&127,i.fsxButton=h>>14&1),i}function _M(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=yM(t,e,n.fStyle,r),n}function EM(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function kT(t,e,r){var n=_i(t);(r.biff==2||e==9)&&++t.l;var i=PF(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function TM(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=_i(t),i=fn(t);return n.val=i,n}var IT=qF;function SM(t,e,r){var n=t.l+e,i=t.read_shift(2),o=t.read_shift(2);if(r.sbcch=o,o==1025||o==14849)return[o,i];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var c=cl(t,o),u=[];n>t.l;)u.push(Xf(t));return[o,i,c,u]}function DT(t,e,r){var n=t.read_shift(2),i,o={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=YF(t,e-2,r)),o.body=i||t.read_shift(e-2),typeof i=="string"&&(o.Name=i),o}var wM=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function NT(t,e,r){var n=t.l+e,i=t.read_shift(2),o=t.read_shift(1),c=t.read_shift(1),u=t.read_shift(r&&r.biff==2?1:2),h=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),h=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var d=cl(t,c,r);i&32&&(d=wM[d.charCodeAt(0)]);var m=n-t.l;r&&r.biff==2&&--m;var v=n==t.l||u===0||!(m>0)?[]:i7(t,m,r,u);return{chKey:o,Name:d,itab:h,rgce:v}}function Q4(t,e,r){if(r.biff<8)return AM(t,e,r);for(var n=[],i=t.l+e,o=t.read_shift(r.biff>8?4:2);o--!==0;)n.push(WF(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function AM(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Yf(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function bM(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),o=cl(t,n,r),c=cl(t,i,r);return[o,c]}function CM(t,e,r){var n=K4(t);t.l++;var i=t.read_shift(1);return e-=8,[s7(t,e,r),i,n]}function OT(t,e,r){var n=XF(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,n7(t,e,r)]}function RM(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function kM(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),c=t.read_shift(2),u=vl(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},u,c,o]}}function IM(t,e,r){return kM(t,e,r)}function DM(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Qd(t));return r}function NM(t,e,r){if(r&&r.biff<8)return FM(t,e,r);var n=$4(t),i=JF(t,e-22,n[1]);return{cmo:n,ft:i}}var OM={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function FM(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var c=[];return c.push((OM[n]||mn)(t,e,r)),{cmo:[i,n,o],ft:c}}function MM(t,e,r){var n=t.l,i="";try{t.l+=4;var o=(r.lastobj||{cmo:[0,0]}).cmo[1],c;[0,5,7,11,12,14].indexOf(o)==-1?t.l+=6:c=VF(t,6,r);var u=t.read_shift(2);t.read_shift(2),Cr(t,2);var h=t.read_shift(2);t.l+=h;for(var d=1;d<t.lens.length-1;++d){if(t.l-n!=t.lens[d])throw new Error("TxO: bad continue record");var m=t[t.l],v=cl(t,t.lens[d+1]-t.lens[d]-1);if(i+=v,i.length>=(m?u:2*u))break}if(i.length!==u&&i.length!==u*2)throw new Error("cchText: "+u+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function LM(t,e){var r=Qd(t);t.l+=16;var n=HF(t,e-24);return[r,n]}function PM(t,e){t.read_shift(2);var r=Qd(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(wn,""),[r,n]}function BM(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=TT[r]||r,r=t.read_shift(2),e[1]=TT[r]||r,e}function VM(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(Y4(t));return r}function UM(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(Y4(t));return r}function jM(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function J4(t,e,r){if(!r.cellStyles)return mn(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),o=t.read_shift(n),c=t.read_shift(n),u=t.read_shift(n),h=t.read_shift(2);n==2&&(t.l+=2);var d={s:i,e:o,w:c,ixfe:u,flags:h};return(r.biff>=5||!r.biff)&&(d.level=h>>8&7),d}function zM(t,e){var r={};return e<32||(t.l+=16,r.header=fn(t),r.footer=fn(t),t.l+=2),r}function HM(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}var GM=_i,qM=q4,WM=Xf;function YM(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function XM(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=_i(t);++t.l;var i=vl(t,e-7,r);return n.t="str",n.val=i,n}function KM(t){var e=_i(t);++t.l;var r=fn(t);return e.t="n",e.val=r,e}function $M(t){var e=_i(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function QM(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function JM(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function ZM(t,e,r){var n=t.l+e,i=_i(t),o=t.read_shift(2),c=cl(t,o,r);return t.l=n,i.t="str",i.val=c,i}var eL=[2,3,48,49,131,139,140,245],FT=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=mx({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,h){var d=[],m=mo(1);switch(h.type){case"base64":m=za(aa(u));break;case"binary":m=za(u);break;case"buffer":case"array":m=u;break}Jr(m,0);var v=m.read_shift(1),y=!!(v&136),E=!1,S=!1;switch(v){case 2:break;case 3:break;case 48:E=!0,y=!0;break;case 49:E=!0,y=!0;break;case 131:break;case 139:break;case 140:S=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var T=0,A=521;v==2&&(T=m.read_shift(2)),m.l+=3,v!=2&&(T=m.read_shift(4)),T>1048576&&(T=1e6),v!=2&&(A=m.read_shift(2));var B=m.read_shift(2),I=h.codepage||1252;v!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(I=t[m[m.l]]),m.l+=1,m.l+=2),S&&(m.l+=36);for(var C=[],G={},K=Math.min(m.length,v==2?521:A-10-(E?264:0)),Y=S?32:11;m.l<K&&m[m.l]!=13;)switch(G={},G.name=yf.utils.decode(I,m.slice(m.l,m.l+Y)).replace(/[\u0000\r\n].*$/g,""),m.l+=Y,G.type=String.fromCharCode(m.read_shift(1)),v!=2&&!S&&(G.offset=m.read_shift(4)),G.len=m.read_shift(1),v==2&&(G.offset=m.read_shift(2)),G.dec=m.read_shift(1),G.name.length&&C.push(G),v!=2&&(m.l+=S?13:14),G.type){case"B":(!E||G.len!=8)&&h.WTF&&console.log("Skipping "+G.name+":"+G.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+G.name+":"+G.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+G.type)}if(m[m.l]!==13&&(m.l=A-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=A;var b=0,N=0;for(d[0]=[],N=0;N!=C.length;++N)d[0][N]=C[N].name;for(;T-- >0;){if(m[m.l]===42){m.l+=B;continue}for(++m.l,d[++b]=[],N=0,N=0;N!=C.length;++N){var D=m.slice(m.l,m.l+C[N].len);m.l+=C[N].len,Jr(D,0);var U=yf.utils.decode(I,D);switch(C[N].type){case"C":U.trim().length&&(d[b][N]=U.replace(/\s+$/,""));break;case"D":U.length===8?d[b][N]=new Date(+U.slice(0,4),+U.slice(4,6)-1,+U.slice(6,8)):d[b][N]=U;break;case"F":d[b][N]=parseFloat(U.trim());break;case"+":case"I":d[b][N]=S?D.read_shift(-4,"i")^2147483648:D.read_shift(4,"i");break;case"L":switch(U.trim().toUpperCase()){case"Y":case"T":d[b][N]=!0;break;case"N":case"F":d[b][N]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+U+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));d[b][N]="##MEMO##"+(S?parseInt(U.trim(),10):D.read_shift(4));break;case"N":U=U.replace(/\u0000/g,"").trim(),U&&U!="."&&(d[b][N]=+U||0);break;case"@":d[b][N]=new Date(D.read_shift(-8,"f")-621356832e5);break;case"T":d[b][N]=new Date((D.read_shift(4)-2440588)*864e5+D.read_shift(4));break;case"Y":d[b][N]=D.read_shift(4,"i")/1e4+D.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[b][N]=-D.read_shift(-8,"f");break;case"B":if(E&&C[N].len==8){d[b][N]=D.read_shift(8,"f");break}case"G":case"P":D.l+=C[N].len;break;case"0":if(C[N].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[N].type)}}}if(v!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return h&&h.sheetRows&&(d=d.slice(0,h.sheetRows)),h.DBF=C,d}function n(u,h){var d=h||{};d.dateNF||(d.dateNF="yyyymmdd");var m=Gc(r(u,d),d);return m["!cols"]=d.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete d.DBF,m}function i(u,h){try{return _o(n(u,h),h)}catch(d){if(h&&h.WTF)throw d}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function c(u,h){var d=h||{};if(+d.codepage>=0&&Ga(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var m=t1(),v=f1(u,{header:1,raw:!0,cellDates:!0}),y=v[0],E=v.slice(1),S=u["!cols"]||[],T=0,A=0,B=0,I=1;for(T=0;T<y.length;++T){if(((S[T]||{}).DBF||{}).name){y[T]=S[T].DBF.name,++B;continue}if(y[T]!=null){if(++B,typeof y[T]=="number"&&(y[T]=y[T].toString(10)),typeof y[T]!="string")throw new Error("DBF Invalid column name "+y[T]+" |"+typeof y[T]+"|");if(y.indexOf(y[T])!==T){for(A=0;A<1024;++A)if(y.indexOf(y[T]+"_"+A)==-1){y[T]+="_"+A;break}}}}var C=hr(u["!ref"]),G=[],K=[],Y=[];for(T=0;T<=C.e.c-C.s.c;++T){var b="",N="",D=0,U=[];for(A=0;A<E.length;++A)E[A][T]!=null&&U.push(E[A][T]);if(U.length==0||y[T]==null){G[T]="?";continue}for(A=0;A<U.length;++A){switch(typeof U[A]){case"number":N="B";break;case"string":N="C";break;case"boolean":N="L";break;case"object":N=U[A]instanceof Date?"D":"C";break;default:N="C"}D=Math.max(D,String(U[A]).length),b=b&&b!=N?"C":N}D>250&&(D=250),N=((S[T]||{}).DBF||{}).type,N=="C"&&S[T].DBF.len>D&&(D=S[T].DBF.len),b=="B"&&N=="N"&&(b="N",Y[T]=S[T].DBF.dec,D=S[T].DBF.len),K[T]=b=="C"||N=="N"?D:o[b]||0,I+=K[T],G[T]=b}var P=m.next(32);for(P.write_shift(4,318902576),P.write_shift(4,E.length),P.write_shift(2,296+32*B),P.write_shift(2,I),T=0;T<4;++T)P.write_shift(4,0);for(P.write_shift(4,0|(+e[QA]||3)<<8),T=0,A=0;T<y.length;++T)if(y[T]!=null){var F=m.next(32),O=(y[T].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);F.write_shift(1,O,"sbcs"),F.write_shift(1,G[T]=="?"?"C":G[T],"sbcs"),F.write_shift(4,A),F.write_shift(1,K[T]||o[G[T]]||0),F.write_shift(1,Y[T]||0),F.write_shift(1,2),F.write_shift(4,0),F.write_shift(1,0),F.write_shift(4,0),F.write_shift(4,0),A+=K[T]||o[G[T]]||0}var we=m.next(264);for(we.write_shift(4,13),T=0;T<65;++T)we.write_shift(4,0);for(T=0;T<E.length;++T){var Ce=m.next(I);for(Ce.write_shift(1,0),A=0;A<y.length;++A)if(y[A]!=null)switch(G[A]){case"L":Ce.write_shift(1,E[T][A]==null?63:E[T][A]?84:70);break;case"B":Ce.write_shift(8,E[T][A]||0,"f");break;case"N":var ne="0";for(typeof E[T][A]=="number"&&(ne=E[T][A].toFixed(Y[A]||0)),B=0;B<K[A]-ne.length;++B)Ce.write_shift(1,32);Ce.write_shift(1,ne,"sbcs");break;case"D":E[T][A]?(Ce.write_shift(4,("0000"+E[T][A].getFullYear()).slice(-4),"sbcs"),Ce.write_shift(2,("00"+(E[T][A].getMonth()+1)).slice(-2),"sbcs"),Ce.write_shift(2,("00"+E[T][A].getDate()).slice(-2),"sbcs")):Ce.write_shift(8,"00000000","sbcs");break;case"C":var me=String(E[T][A]!=null?E[T][A]:"").slice(0,K[A]);for(Ce.write_shift(1,me,"sbcs"),B=0;B<K[A]-me.length;++B)Ce.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:i,to_sheet:n,from_sheet:c}})(),tL=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+vi(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(y,E){var S=t[E];return typeof S=="number"?$E(S):S},n=function(y,E,S){var T=E.charCodeAt(0)-32<<4|S.charCodeAt(0)-48;return T==59?y:$E(T)};t["|"]=254;function i(y,E){switch(E.type){case"base64":return o(aa(y),E);case"binary":return o(y,E);case"buffer":return o(vt&&Buffer.isBuffer(y)?y.toString("binary"):pl(y),E);case"array":return o(ll(y),E)}throw new Error("Unrecognized type "+E.type)}function o(y,E){var S=y.split(/[\n\r]+/),T=-1,A=-1,B=0,I=0,C=[],G=[],K=null,Y={},b=[],N=[],D=[],U=0,P;for(+E.codepage>=0&&Ga(+E.codepage);B!==S.length;++B){U=0;var F=S[B].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),O=F.replace(/;;/g,"\0").split(";").map(function(ee){return ee.replace(/\u0000/g,";")}),we=O[0],Ce;if(F.length>0)switch(we){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":O[1].charAt(0)=="P"&&G.push(F.slice(3).replace(/;;/g,";"));break;case"C":var ne=!1,me=!1,_e=!1,ae=!1,Le=-1,Q=-1;for(I=1;I<O.length;++I)switch(O[I].charAt(0)){case"A":break;case"X":A=parseInt(O[I].slice(1))-1,me=!0;break;case"Y":for(T=parseInt(O[I].slice(1))-1,me||(A=0),P=C.length;P<=T;++P)C[P]=[];break;case"K":Ce=O[I].slice(1),Ce.charAt(0)==='"'?Ce=Ce.slice(1,Ce.length-1):Ce==="TRUE"?Ce=!0:Ce==="FALSE"?Ce=!1:isNaN($a(Ce))?isNaN(kc(Ce).getDate())||(Ce=zr(Ce)):(Ce=$a(Ce),K!==null&&zc(K)&&(Ce=$d(Ce))),ne=!0;break;case"E":ae=!0;var L=xc(O[I].slice(1),{r:T,c:A});C[T][A]=[C[T][A],L];break;case"S":_e=!0,C[T][A]=[C[T][A],"S5S"];break;case"G":break;case"R":Le=parseInt(O[I].slice(1))-1;break;case"C":Q=parseInt(O[I].slice(1))-1;break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+F)}if(ne&&(C[T][A]&&C[T][A].length==2?C[T][A][0]=Ce:C[T][A]=Ce,K=null),_e){if(ae)throw new Error("SYLK shared formula cannot have own formula");var te=Le>-1&&C[Le][Q];if(!te||!te[1])throw new Error("SYLK shared formula cannot find base");C[T][A][1]=lb(te[1],{r:T-Le,c:A-Q})}break;case"F":var J=0;for(I=1;I<O.length;++I)switch(O[I].charAt(0)){case"X":A=parseInt(O[I].slice(1))-1,++J;break;case"Y":for(T=parseInt(O[I].slice(1))-1,P=C.length;P<=T;++P)C[P]=[];break;case"M":U=parseInt(O[I].slice(1))/20;break;case"F":break;case"G":break;case"P":K=G[parseInt(O[I].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(D=O[I].slice(1).split(" "),P=parseInt(D[0],10);P<=parseInt(D[1],10);++P)U=parseInt(D[2],10),N[P-1]=U===0?{hidden:!0}:{wch:U},Ic(N[P-1]);break;case"C":A=parseInt(O[I].slice(1))-1,N[A]||(N[A]={});break;case"R":T=parseInt(O[I].slice(1))-1,b[T]||(b[T]={}),U>0?(b[T].hpt=U,b[T].hpx=Af(U)):U===0&&(b[T].hidden=!0);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+F)}J<1&&(K=null);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+F)}}return b.length>0&&(Y["!rows"]=b),N.length>0&&(Y["!cols"]=N),E&&E.sheetRows&&(C=C.slice(0,E.sheetRows)),[C,Y]}function c(y,E){var S=i(y,E),T=S[0],A=S[1],B=Gc(T,E);return vi(A).forEach(function(I){B[I]=A[I]}),B}function u(y,E){return _o(c(y,E),E)}function h(y,E,S,T){var A="C;Y"+(S+1)+";X"+(T+1)+";K";switch(y.t){case"n":A+=y.v||0,y.f&&!y.F&&(A+=";E"+j9(y.f,{r:S,c:T}));break;case"b":A+=y.v?"TRUE":"FALSE";break;case"e":A+=y.w||y.v;break;case"d":A+='"'+(y.w||y.v)+'"';break;case"s":A+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return A}function d(y,E){E.forEach(function(S,T){var A="F;W"+(T+1)+" "+(T+1)+" ";S.hidden?A+="0":(typeof S.width=="number"&&!S.wpx&&(S.wpx=Ed(S.width)),typeof S.wpx=="number"&&!S.wch&&(S.wch=Td(S.wpx)),typeof S.wch=="number"&&(A+=Math.round(S.wch))),A.charAt(A.length-1)!=" "&&y.push(A)})}function m(y,E){E.forEach(function(S,T){var A="F;";S.hidden?A+="M0;":S.hpt?A+="M"+20*S.hpt+";":S.hpx&&(A+="M"+20*ib(S.hpx)+";"),A.length>2&&y.push(A+"R"+(T+1))})}function v(y,E){var S=["ID;PWXL;N;E"],T=[],A=hr(y["!ref"]),B,I=Array.isArray(y),C=`\r
`;S.push("P;PGeneral"),S.push("F;P0;DG0G8;M255"),y["!cols"]&&d(S,y["!cols"]),y["!rows"]&&m(S,y["!rows"]),S.push("B;Y"+(A.e.r-A.s.r+1)+";X"+(A.e.c-A.s.c+1)+";D"+[A.s.c,A.s.r,A.e.c,A.e.r].join(" "));for(var G=A.s.r;G<=A.e.r;++G)for(var K=A.s.c;K<=A.e.c;++K){var Y=tt({r:G,c:K});B=I?(y[G]||[])[K]:y[Y],!(!B||B.v==null&&(!B.f||B.F))&&T.push(h(B,y,G,K))}return S.join(C)+C+T.join(C)+C+"E"+C}return{to_workbook:u,to_sheet:c,from_sheet:v}})(),rL=(function(){function t(o,c){switch(c.type){case"base64":return e(aa(o),c);case"binary":return e(o,c);case"buffer":return e(vt&&Buffer.isBuffer(o)?o.toString("binary"):pl(o),c);case"array":return e(ll(o),c)}throw new Error("Unrecognized type "+c.type)}function e(o,c){for(var u=o.split(`
`),h=-1,d=-1,m=0,v=[];m!==u.length;++m){if(u[m].trim()==="BOT"){v[++h]=[],d=0;continue}if(!(h<0)){var y=u[m].trim().split(","),E=y[0],S=y[1];++m;for(var T=u[m]||"";(T.match(/["]/g)||[]).length&1&&m<u.length-1;)T+=`
`+u[++m];switch(T=T.trim(),+E){case-1:if(T==="BOT"){v[++h]=[],d=0;continue}else if(T!=="EOD")throw new Error("Unrecognized DIF special command "+T);break;case 0:T==="TRUE"?v[h][d]=!0:T==="FALSE"?v[h][d]=!1:isNaN($a(S))?isNaN(kc(S).getDate())?v[h][d]=S:v[h][d]=zr(S):v[h][d]=$a(S),++d;break;case 1:T=T.slice(1,T.length-1),T=T.replace(/""/g,'"'),T&&T.match(/^=".*"$/)&&(T=T.slice(2,-1)),v[h][d++]=T!==""?T:null;break}if(T==="EOD")break}}return c&&c.sheetRows&&(v=v.slice(0,c.sheetRows)),v}function r(o,c){return Gc(t(o,c),c)}function n(o,c){return _o(r(o,c),c)}var i=(function(){var o=function(h,d,m,v,y){h.push(d),h.push(m+","+v),h.push('"'+y.replace(/"/g,'""')+'"')},c=function(h,d,m,v){h.push(d+","+m),h.push(d==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(h){var d=[],m=hr(h["!ref"]),v,y=Array.isArray(h);o(d,"TABLE",0,1,"sheetjs"),o(d,"VECTORS",0,m.e.r-m.s.r+1,""),o(d,"TUPLES",0,m.e.c-m.s.c+1,""),o(d,"DATA",0,0,"");for(var E=m.s.r;E<=m.e.r;++E){c(d,-1,0,"BOT");for(var S=m.s.c;S<=m.e.c;++S){var T=tt({r:E,c:S});if(v=y?(h[E]||[])[S]:h[T],!v){c(d,1,0,"");continue}switch(v.t){case"n":var A=v.w;!A&&v.v!=null&&(A=v.v),A==null?v.f&&!v.F?c(d,1,0,"="+v.f):c(d,1,0,""):c(d,0,A,"V");break;case"b":c(d,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":c(d,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=wa(v.z||ot[14],An(zr(v.v)))),c(d,0,v.w,"V");break;default:c(d,1,0,"")}}}c(d,-1,0,"EOD");var B=`\r
`,I=d.join(B);return I}})();return{to_workbook:n,to_sheet:r,from_sheet:i}})(),nL=(function(){function t(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(v,y){for(var E=v.split(`
`),S=-1,T=-1,A=0,B=[];A!==E.length;++A){var I=E[A].trim().split(":");if(I[0]==="cell"){var C=Sn(I[1]);if(B.length<=C.r)for(S=B.length;S<=C.r;++S)B[S]||(B[S]=[]);switch(S=C.r,T=C.c,I[2]){case"t":B[S][T]=t(I[3]);break;case"v":B[S][T]=+I[3];break;case"vtf":var G=I[I.length-1];case"vtc":I[3]==="nl"?B[S][T]=!!+I[4]:B[S][T]=+I[4],I[2]=="vtf"&&(B[S][T]=[B[S][T],G])}}}return y&&y.sheetRows&&(B=B.slice(0,y.sheetRows)),B}function n(v,y){return Gc(r(v,y),y)}function i(v,y){return _o(n(v,y),y)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function d(v){if(!v||!v["!ref"])return"";for(var y=[],E=[],S,T="",A=Hc(v["!ref"]),B=Array.isArray(v),I=A.s.r;I<=A.e.r;++I)for(var C=A.s.c;C<=A.e.c;++C)if(T=tt({r:I,c:C}),S=B?(v[I]||[])[C]:v[T],!(!S||S.v==null||S.t==="z")){switch(E=["cell",T,"t"],S.t){case"s":case"str":E.push(e(S.v));break;case"n":S.f?(E[2]="vtf",E[3]="n",E[4]=S.v,E[5]=e(S.f)):(E[2]="v",E[3]=S.v);break;case"b":E[2]="vt"+(S.f?"f":"c"),E[3]="nl",E[4]=S.v?"1":"0",E[5]=e(S.f||(S.v?"TRUE":"FALSE"));break;case"d":var G=An(zr(S.v));E[2]="vtc",E[3]="nd",E[4]=""+G,E[5]=S.w||wa(S.z||ot[14],G);break;case"e":continue}y.push(E.join(":"))}return y.push("sheet:c:"+(A.e.c-A.s.c+1)+":r:"+(A.e.r-A.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function m(v){return[o,c,u,c,d(v),h].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:m}})(),Sf=(function(){function t(m,v,y,E,S){S.raw?v[y][E]=m:m===""||(m==="TRUE"?v[y][E]=!0:m==="FALSE"?v[y][E]=!1:isNaN($a(m))?isNaN(kc(m).getDate())?v[y][E]=m:v[y][E]=zr(m):v[y][E]=$a(m))}function e(m,v){var y=v||{},E=[];if(!m||m.length===0)return E;for(var S=m.split(/[\r\n]/),T=S.length-1;T>=0&&S[T].length===0;)--T;for(var A=10,B=0,I=0;I<=T;++I)B=S[I].indexOf(" "),B==-1?B=S[I].length:B++,A=Math.max(A,B);for(I=0;I<=T;++I){E[I]=[];var C=0;for(t(S[I].slice(0,A).trim(),E,I,C,y),C=1;C<=(S[I].length-A)/10+1;++C)t(S[I].slice(A+(C-1)*10,A+C*10).trim(),E,I,C,y)}return y.sheetRows&&(E=E.slice(0,y.sheetRows)),E}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(m){for(var v={},y=!1,E=0,S=0;E<m.length;++E)(S=m.charCodeAt(E))==34?y=!y:!y&&S in r&&(v[S]=(v[S]||0)+1);S=[];for(E in v)Object.prototype.hasOwnProperty.call(v,E)&&S.push([v[E],E]);if(!S.length){v=n;for(E in v)Object.prototype.hasOwnProperty.call(v,E)&&S.push([v[E],E])}return S.sort(function(T,A){return T[0]-A[0]||n[T[1]]-n[A[1]]}),r[S.pop()[1]]||44}function o(m,v){var y=v||{},E="",S=y.dense?[]:{},T={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(E=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(E=m.charAt(4),m=m.slice(6)):E=i(m.slice(0,1024)):y&&y.FS?E=y.FS:E=i(m.slice(0,1024));var A=0,B=0,I=0,C=0,G=0,K=E.charCodeAt(0),Y=!1,b=0,N=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var D=y.dateNF!=null?p8(y.dateNF):null;function U(){var P=m.slice(C,G),F={};if(P.charAt(0)=='"'&&P.charAt(P.length-1)=='"'&&(P=P.slice(1,-1).replace(/""/g,'"')),P.length===0)F.t="z";else if(y.raw)F.t="s",F.v=P;else if(P.trim().length===0)F.t="s",F.v=P;else if(P.charCodeAt(0)==61)P.charCodeAt(1)==34&&P.charCodeAt(P.length-1)==34?(F.t="s",F.v=P.slice(2,-1).replace(/""/g,'"')):H9(P)?(F.t="n",F.f=P.slice(1)):(F.t="s",F.v=P);else if(P=="TRUE")F.t="b",F.v=!0;else if(P=="FALSE")F.t="b",F.v=!1;else if(!isNaN(I=$a(P)))F.t="n",y.cellText!==!1&&(F.w=P),F.v=I;else if(!isNaN(kc(P).getDate())||D&&P.match(D)){F.z=y.dateNF||ot[14];var O=0;D&&P.match(D)&&(P=m8(P,y.dateNF,P.match(D)||[]),O=1),y.cellDates?(F.t="d",F.v=zr(P,O)):(F.t="n",F.v=An(zr(P,O))),y.cellText!==!1&&(F.w=wa(F.z,F.v instanceof Date?An(F.v):F.v)),y.cellNF||delete F.z}else F.t="s",F.v=P;if(F.t=="z"||(y.dense?(S[A]||(S[A]=[]),S[A][B]=F):S[tt({c:B,r:A})]=F),C=G+1,N=m.charCodeAt(C),T.e.c<B&&(T.e.c=B),T.e.r<A&&(T.e.r=A),b==K)++B;else if(B=0,++A,y.sheetRows&&y.sheetRows<=A)return!0}e:for(;G<m.length;++G)switch(b=m.charCodeAt(G)){case 34:N===34&&(Y=!Y);break;case K:case 10:case 13:if(!Y&&U())break e;break}return G-C>0&&U(),S["!ref"]=Et(T),S}function c(m,v){return!(v&&v.PRN)||v.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?o(m,v):Gc(e(m,v),v)}function u(m,v){var y="",E=v.type=="string"?[0,0,0,0]:Fx(m,v);switch(v.type){case"base64":y=aa(m);break;case"binary":y=m;break;case"buffer":v.codepage==65001?y=m.toString("utf8"):v.codepage&&typeof yf<"u"||(y=vt&&Buffer.isBuffer(m)?m.toString("binary"):pl(m));break;case"array":y=ll(m);break;case"string":y=m;break;default:throw new Error("Unrecognized type "+v.type)}return E[0]==239&&E[1]==187&&E[2]==191?y=$t(y.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?y=$t(y):v.type=="binary"&&typeof yf<"u",y.slice(0,19)=="socialcalc:version:"?nL.to_sheet(v.type=="string"?y:$t(y),v):c(y,v)}function h(m,v){return _o(u(m,v),v)}function d(m){for(var v=[],y=hr(m["!ref"]),E,S=Array.isArray(m),T=y.s.r;T<=y.e.r;++T){for(var A=[],B=y.s.c;B<=y.e.c;++B){var I=tt({r:T,c:B});if(E=S?(m[T]||[])[B]:m[I],!E||E.v==null){A.push("          ");continue}for(var C=(E.w||(os(E),E.w)||"").slice(0,10);C.length<10;)C+=" ";A.push(C+(B===0?" ":""))}v.push(A.join(""))}return v.join(`
`)}return{to_workbook:h,to_sheet:u,from_sheet:d}})();function aL(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=tL.to_workbook(t,r);return r.WTF=n,i}catch(o){if(r.WTF=n,!o.message.match(/SYLK bad record ID/)&&n)throw o;return Sf.to_workbook(t,e)}}var lf=(function(){function t(L,te,J){if(L){Jr(L,L.l||0);for(var ee=J.Enum||Le;L.l<L.length;){var xe=L.read_shift(2),Re=ee[xe]||ee[65535],Me=L.read_shift(2),Ie=L.l+Me,Oe=Re.f&&Re.f(L,Me,J);if(L.l=Ie,te(Oe,Re,xe))return}}}function e(L,te){switch(te.type){case"base64":return r(za(aa(L)),te);case"binary":return r(za(L),te);case"buffer":case"array":return r(L,te)}throw"Unsupported type "+te.type}function r(L,te){if(!L)return L;var J=te||{},ee=J.dense?[]:{},xe="Sheet1",Re="",Me=0,Ie={},Oe=[],ct=[],Z={s:{r:0,c:0},e:{r:0,c:0}},Vt=J.sheetRows||0;if(L[2]==0&&(L[3]==8||L[3]==9)&&L.length>=16&&L[14]==5&&L[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(L[2]==2)J.Enum=Le,t(L,function(Ve,Gt,St){switch(St){case 0:J.vers=Ve,Ve>=4096&&(J.qpro=!0);break;case 6:Z=Ve;break;case 204:Ve&&(Re=Ve);break;case 222:Re=Ve;break;case 15:case 51:J.qpro||(Ve[1].v=Ve[1].v.slice(1));case 13:case 14:case 16:St==14&&(Ve[2]&112)==112&&(Ve[2]&15)>1&&(Ve[2]&15)<15&&(Ve[1].z=J.dateNF||ot[14],J.cellDates&&(Ve[1].t="d",Ve[1].v=$d(Ve[1].v))),J.qpro&&Ve[3]>Me&&(ee["!ref"]=Et(Z),Ie[xe]=ee,Oe.push(xe),ee=J.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},Me=Ve[3],xe=Re||"Sheet"+(Me+1),Re="");var Dt=J.dense?(ee[Ve[0].r]||[])[Ve[0].c]:ee[tt(Ve[0])];if(Dt){Dt.t=Ve[1].t,Dt.v=Ve[1].v,Ve[1].z!=null&&(Dt.z=Ve[1].z),Ve[1].f!=null&&(Dt.f=Ve[1].f);break}J.dense?(ee[Ve[0].r]||(ee[Ve[0].r]=[]),ee[Ve[0].r][Ve[0].c]=Ve[1]):ee[tt(Ve[0])]=Ve[1];break}},J);else if(L[2]==26||L[2]==14)J.Enum=Q,L[2]==14&&(J.qpro=!0,L.l=0),t(L,function(Ve,Gt,St){switch(St){case 204:xe=Ve;break;case 22:Ve[1].v=Ve[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ve[3]>Me&&(ee["!ref"]=Et(Z),Ie[xe]=ee,Oe.push(xe),ee=J.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},Me=Ve[3],xe="Sheet"+(Me+1)),Vt>0&&Ve[0].r>=Vt)break;J.dense?(ee[Ve[0].r]||(ee[Ve[0].r]=[]),ee[Ve[0].r][Ve[0].c]=Ve[1]):ee[tt(Ve[0])]=Ve[1],Z.e.c<Ve[0].c&&(Z.e.c=Ve[0].c),Z.e.r<Ve[0].r&&(Z.e.r=Ve[0].r);break;case 27:Ve[14e3]&&(ct[Ve[14e3][0]]=Ve[14e3][1]);break;case 1537:ct[Ve[0]]=Ve[1],Ve[0]==Me&&(xe=Ve[1]);break}},J);else throw new Error("Unrecognized LOTUS BOF "+L[2]);if(ee["!ref"]=Et(Z),Ie[Re||xe]=ee,Oe.push(Re||xe),!ct.length)return{SheetNames:Oe,Sheets:Ie};for(var nt={},Tt=[],Je=0;Je<ct.length;++Je)Ie[Oe[Je]]?(Tt.push(ct[Je]||Oe[Je]),nt[ct[Je]]=Ie[ct[Je]]||Ie[Oe[Je]]):(Tt.push(ct[Je]),nt[ct[Je]]={"!ref":"A1"});return{SheetNames:Tt,Sheets:nt}}function n(L,te){var J=te||{};if(+J.codepage>=0&&Ga(+J.codepage),J.type=="string")throw new Error("Cannot write WK1 to JS string");var ee=t1(),xe=hr(L["!ref"]),Re=Array.isArray(L),Me=[];Va(ee,0,o(1030)),Va(ee,6,h(xe));for(var Ie=Math.min(xe.e.r,8191),Oe=xe.s.r;Oe<=Ie;++Oe)for(var ct=tn(Oe),Z=xe.s.c;Z<=xe.e.c;++Z){Oe===xe.s.r&&(Me[Z]=Nr(Z));var Vt=Me[Z]+ct,nt=Re?(L[Oe]||[])[Z]:L[Vt];if(!(!nt||nt.t=="z"))if(nt.t=="n")(nt.v|0)==nt.v&&nt.v>=-32768&&nt.v<=32767?Va(ee,13,E(Oe,Z,nt.v)):Va(ee,14,T(Oe,Z,nt.v));else{var Tt=os(nt);Va(ee,15,v(Oe,Z,Tt.slice(0,239)))}}return Va(ee,1),ee.end()}function i(L,te){var J=te||{};if(+J.codepage>=0&&Ga(+J.codepage),J.type=="string")throw new Error("Cannot write WK3 to JS string");var ee=t1();Va(ee,0,c(L));for(var xe=0,Re=0;xe<L.SheetNames.length;++xe)(L.Sheets[L.SheetNames[xe]]||{})["!ref"]&&Va(ee,27,ae(L.SheetNames[xe],Re++));var Me=0;for(xe=0;xe<L.SheetNames.length;++xe){var Ie=L.Sheets[L.SheetNames[xe]];if(!(!Ie||!Ie["!ref"])){for(var Oe=hr(Ie["!ref"]),ct=Array.isArray(Ie),Z=[],Vt=Math.min(Oe.e.r,8191),nt=Oe.s.r;nt<=Vt;++nt)for(var Tt=tn(nt),Je=Oe.s.c;Je<=Oe.e.c;++Je){nt===Oe.s.r&&(Z[Je]=Nr(Je));var Ve=Z[Je]+Tt,Gt=ct?(Ie[nt]||[])[Je]:Ie[Ve];if(!(!Gt||Gt.t=="z"))if(Gt.t=="n")Va(ee,23,U(nt,Je,Me,Gt.v));else{var St=os(Gt);Va(ee,22,b(nt,Je,Me,St.slice(0,239)))}}++Me}}return Va(ee,1),ee.end()}function o(L){var te=Dr(2);return te.write_shift(2,L),te}function c(L){var te=Dr(26);te.write_shift(2,4096),te.write_shift(2,4),te.write_shift(4,0);for(var J=0,ee=0,xe=0,Re=0;Re<L.SheetNames.length;++Re){var Me=L.SheetNames[Re],Ie=L.Sheets[Me];if(!(!Ie||!Ie["!ref"])){++xe;var Oe=Hc(Ie["!ref"]);J<Oe.e.r&&(J=Oe.e.r),ee<Oe.e.c&&(ee=Oe.e.c)}}return J>8191&&(J=8191),te.write_shift(2,J),te.write_shift(1,xe),te.write_shift(1,ee),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(1,1),te.write_shift(1,2),te.write_shift(4,0),te.write_shift(4,0),te}function u(L,te,J){var ee={s:{c:0,r:0},e:{c:0,r:0}};return te==8&&J.qpro?(ee.s.c=L.read_shift(1),L.l++,ee.s.r=L.read_shift(2),ee.e.c=L.read_shift(1),L.l++,ee.e.r=L.read_shift(2),ee):(ee.s.c=L.read_shift(2),ee.s.r=L.read_shift(2),te==12&&J.qpro&&(L.l+=2),ee.e.c=L.read_shift(2),ee.e.r=L.read_shift(2),te==12&&J.qpro&&(L.l+=2),ee.s.c==65535&&(ee.s.c=ee.e.c=ee.s.r=ee.e.r=0),ee)}function h(L){var te=Dr(8);return te.write_shift(2,L.s.c),te.write_shift(2,L.s.r),te.write_shift(2,L.e.c),te.write_shift(2,L.e.r),te}function d(L,te,J){var ee=[{c:0,r:0},{t:"n",v:0},0,0];return J.qpro&&J.vers!=20768?(ee[0].c=L.read_shift(1),ee[3]=L.read_shift(1),ee[0].r=L.read_shift(2),L.l+=2):(ee[2]=L.read_shift(1),ee[0].c=L.read_shift(2),ee[0].r=L.read_shift(2)),ee}function m(L,te,J){var ee=L.l+te,xe=d(L,te,J);if(xe[1].t="s",J.vers==20768){L.l++;var Re=L.read_shift(1);return xe[1].v=L.read_shift(Re,"utf8"),xe}return J.qpro&&L.l++,xe[1].v=L.read_shift(ee-L.l,"cstr"),xe}function v(L,te,J){var ee=Dr(7+J.length);ee.write_shift(1,255),ee.write_shift(2,te),ee.write_shift(2,L),ee.write_shift(1,39);for(var xe=0;xe<ee.length;++xe){var Re=J.charCodeAt(xe);ee.write_shift(1,Re>=128?95:Re)}return ee.write_shift(1,0),ee}function y(L,te,J){var ee=d(L,te,J);return ee[1].v=L.read_shift(2,"i"),ee}function E(L,te,J){var ee=Dr(7);return ee.write_shift(1,255),ee.write_shift(2,te),ee.write_shift(2,L),ee.write_shift(2,J,"i"),ee}function S(L,te,J){var ee=d(L,te,J);return ee[1].v=L.read_shift(8,"f"),ee}function T(L,te,J){var ee=Dr(13);return ee.write_shift(1,255),ee.write_shift(2,te),ee.write_shift(2,L),ee.write_shift(8,J,"f"),ee}function A(L,te,J){var ee=L.l+te,xe=d(L,te,J);if(xe[1].v=L.read_shift(8,"f"),J.qpro)L.l=ee;else{var Re=L.read_shift(2);G(L.slice(L.l,L.l+Re),xe),L.l+=Re}return xe}function B(L,te,J){var ee=te&32768;return te&=-32769,te=(ee?L:0)+(te>=8192?te-16384:te),(ee?"":"$")+(J?Nr(te):tn(te))}var I={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function G(L,te){Jr(L,0);for(var J=[],ee=0,xe="",Re="",Me="",Ie="";L.l<L.length;){var Oe=L[L.l++];switch(Oe){case 0:J.push(L.read_shift(8,"f"));break;case 1:Re=B(te[0].c,L.read_shift(2),!0),xe=B(te[0].r,L.read_shift(2),!1),J.push(Re+xe);break;case 2:{var ct=B(te[0].c,L.read_shift(2),!0),Z=B(te[0].r,L.read_shift(2),!1);Re=B(te[0].c,L.read_shift(2),!0),xe=B(te[0].r,L.read_shift(2),!1),J.push(ct+Z+":"+Re+xe)}break;case 3:if(L.l<L.length){console.error("WK1 premature formula end");return}break;case 4:J.push("("+J.pop()+")");break;case 5:J.push(L.read_shift(2));break;case 6:{for(var Vt="";Oe=L[L.l++];)Vt+=String.fromCharCode(Oe);J.push('"'+Vt.replace(/"/g,'""')+'"')}break;case 8:J.push("-"+J.pop());break;case 23:J.push("+"+J.pop());break;case 22:J.push("NOT("+J.pop()+")");break;case 20:case 21:Ie=J.pop(),Me=J.pop(),J.push(["AND","OR"][Oe-20]+"("+Me+","+Ie+")");break;default:if(Oe<32&&C[Oe])Ie=J.pop(),Me=J.pop(),J.push(Me+C[Oe]+Ie);else if(I[Oe]){if(ee=I[Oe][1],ee==69&&(ee=L[L.l++]),ee>J.length){console.error("WK1 bad formula parse 0x"+Oe.toString(16)+":|"+J.join("|")+"|");return}var nt=J.slice(-ee);J.length-=ee,J.push(I[Oe][0]+"("+nt.join(",")+")")}else return Oe<=7?console.error("WK1 invalid opcode "+Oe.toString(16)):Oe<=24?console.error("WK1 unsupported op "+Oe.toString(16)):Oe<=30?console.error("WK1 invalid opcode "+Oe.toString(16)):Oe<=115?console.error("WK1 unsupported function opcode "+Oe.toString(16)):console.error("WK1 unrecognized opcode "+Oe.toString(16))}}J.length==1?te[1].f=""+J[0]:console.error("WK1 bad formula parse |"+J.join("|")+"|")}function K(L){var te=[{c:0,r:0},{t:"n",v:0},0];return te[0].r=L.read_shift(2),te[3]=L[L.l++],te[0].c=L[L.l++],te}function Y(L,te){var J=K(L);return J[1].t="s",J[1].v=L.read_shift(te-4,"cstr"),J}function b(L,te,J,ee){var xe=Dr(6+ee.length);xe.write_shift(2,L),xe.write_shift(1,J),xe.write_shift(1,te),xe.write_shift(1,39);for(var Re=0;Re<ee.length;++Re){var Me=ee.charCodeAt(Re);xe.write_shift(1,Me>=128?95:Me)}return xe.write_shift(1,0),xe}function N(L,te){var J=K(L);J[1].v=L.read_shift(2);var ee=J[1].v>>1;if(J[1].v&1)switch(ee&7){case 0:ee=(ee>>3)*5e3;break;case 1:ee=(ee>>3)*500;break;case 2:ee=(ee>>3)/20;break;case 3:ee=(ee>>3)/200;break;case 4:ee=(ee>>3)/2e3;break;case 5:ee=(ee>>3)/2e4;break;case 6:ee=(ee>>3)/16;break;case 7:ee=(ee>>3)/64;break}return J[1].v=ee,J}function D(L,te){var J=K(L),ee=L.read_shift(4),xe=L.read_shift(4),Re=L.read_shift(2);if(Re==65535)return ee===0&&xe===3221225472?(J[1].t="e",J[1].v=15):ee===0&&xe===3489660928?(J[1].t="e",J[1].v=42):J[1].v=0,J;var Me=Re&32768;return Re=(Re&32767)-16446,J[1].v=(1-Me*2)*(xe*Math.pow(2,Re+32)+ee*Math.pow(2,Re)),J}function U(L,te,J,ee){var xe=Dr(14);if(xe.write_shift(2,L),xe.write_shift(1,J),xe.write_shift(1,te),ee==0)return xe.write_shift(4,0),xe.write_shift(4,0),xe.write_shift(2,65535),xe;var Re=0,Me=0,Ie=0,Oe=0;return ee<0&&(Re=1,ee=-ee),Me=Math.log2(ee)|0,ee/=Math.pow(2,Me-31),Oe=ee>>>0,(Oe&2147483648)==0&&(ee/=2,++Me,Oe=ee>>>0),ee-=Oe,Oe|=2147483648,Oe>>>=0,ee*=Math.pow(2,32),Ie=ee>>>0,xe.write_shift(4,Ie),xe.write_shift(4,Oe),Me+=16383+(Re?32768:0),xe.write_shift(2,Me),xe}function P(L,te){var J=D(L);return L.l+=te-14,J}function F(L,te){var J=K(L),ee=L.read_shift(4);return J[1].v=ee>>6,J}function O(L,te){var J=K(L),ee=L.read_shift(8,"f");return J[1].v=ee,J}function we(L,te){var J=O(L);return L.l+=te-10,J}function Ce(L,te){return L[L.l+te-1]==0?L.read_shift(te,"cstr"):""}function ne(L,te){var J=L[L.l++];J>te-1&&(J=te-1);for(var ee="";ee.length<J;)ee+=String.fromCharCode(L[L.l++]);return ee}function me(L,te,J){if(!(!J.qpro||te<21)){var ee=L.read_shift(1);L.l+=17,L.l+=1,L.l+=2;var xe=L.read_shift(te-21,"cstr");return[ee,xe]}}function _e(L,te){for(var J={},ee=L.l+te;L.l<ee;){var xe=L.read_shift(2);if(xe==14e3){for(J[xe]=[0,""],J[xe][0]=L.read_shift(2);L[L.l];)J[xe][1]+=String.fromCharCode(L[L.l]),L.l++;L.l++}}return J}function ae(L,te){var J=Dr(5+L.length);J.write_shift(2,14e3),J.write_shift(2,te);for(var ee=0;ee<L.length;++ee){var xe=L.charCodeAt(ee);J[J.l++]=xe>127?95:xe}return J[J.l++]=0,J}var Le={0:{n:"BOF",f:Cr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:S},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:A},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ce},222:{n:"SHEETNAMELP",f:ne},65535:{n:""}},Q={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:Y},23:{n:"NUMBER17",f:D},24:{n:"NUMBER18",f:N},25:{n:"FORMULA19",f:P},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:_e},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:F},38:{n:"??"},39:{n:"NUMBER27",f:O},40:{n:"FORMULA28",f:we},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ce},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:me},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}})();function iL(t){var e={},r=t.match(gn),n=0,i=!1;if(r)for(;n!=r.length;++n){var o=$e(r[n]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;e.cp=ux[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=o.val;break;case"<sz":e.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":o.rgb&&(e.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(o[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+o[0])}}return e}var sL=(function(){var t=Ef("t"),e=Ef("rPr");function r(o){var c=o.match(t);if(!c)return{t:"s",v:""};var u={t:"s",v:wt(c[1])},h=o.match(e);return h&&(u.s=iL(h[1])),u}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(c){return c.replace(n,"").split(i).map(r).filter(function(u){return u.v})}})(),oL=(function(){var e=/(\r\n|\n)/g;function r(i,o,c){var u=[];i.u&&u.push("text-decoration: underline;"),i.uval&&u.push("text-underline-style:"+i.uval+";"),i.sz&&u.push("font-size:"+i.sz+"pt;"),i.outline&&u.push("text-effect: outline;"),i.shadow&&u.push("text-shadow: auto;"),o.push('<span style="'+u.join("")+'">'),i.b&&(o.push("<b>"),c.push("</b>")),i.i&&(o.push("<i>"),c.push("</i>")),i.strike&&(o.push("<s>"),c.push("</s>"));var h=i.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(o.push("<"+h+">"),c.push("</"+h+">")),c.push("</span>"),i}function n(i){var o=[[],i.v,[]];return i.v?(i.s&&r(i.s,o[0],o[2]),o[0].join("")+o[1].replace(e,"<br/>")+o[2].join("")):""}return function(o){return o.map(n).join("")}})(),lL=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,cL=/<(?:\w+:)?r>/,uL=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Cx(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=wt($t(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=$t(t),r&&(n.h=xx(n.t))):t.match(cL)&&(n.r=$t(t),n.t=wt($t((t.replace(uL,"").match(lL)||[]).join("").replace(gn,""))),r&&(n.h=oL(sL(n.r)))),n):{t:""}}var fL=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,hL=/<(?:\w+:)?(?:si|sstItem)>/g,dL=/<\/(?:\w+:)?(?:si|sstItem)>/;function pL(t,e){var r=[],n="";if(!t)return r;var i=t.match(fL);if(i){n=i[2].replace(hL,"").split(dL);for(var o=0;o!=n.length;++o){var c=Cx(n[o].trim(),e);c!=null&&(r[r.length]=c)}i=$e(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function mL(t){return[t.read_shift(4),t.read_shift(4)]}function gL(t,e){var r=[],n=!1;return us(t,function(o,c,u){switch(u){case 159:r.Count=o[0],r.Unique=o[1];break;case 19:r.push(o);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(c.T,!n||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function Z4(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function es(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function xL(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=es(t,4),e.U=es(t,4),e.W=es(t,4),e}function vL(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),o=[];i-- >0;)o.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=o,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function yL(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(vL(t));return e}function _L(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function EL(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=es(t,4),e.U=es(t,4),e.W=es(t,4),e}function TL(t){var e=EL(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function eb(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function tb(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function SL(t){var e=es(t);switch(e.Minor){case 2:return[e.Minor,wL(t)];case 3:return[e.Minor,AL()];case 4:return[e.Minor,bL(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function wL(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=eb(t,r),i=tb(t,t.length-t.l);return{t:"Std",h:n,v:i}}function AL(){throw new Error("File is password-protected: ECMA-376 Extensible")}function bL(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(gn,function(o){var c=$e(o);switch(yi(c[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(u){n[u]=c[u]});break;case"<dataIntegrity":n.encryptedHmacKey=c.encryptedHmacKey,n.encryptedHmacValue=c.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=c.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(c);break;default:throw c[0]}}),n}function CL(t,e){var r={},n=r.EncryptionVersionInfo=es(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=eb(t,i),e-=i,r.EncryptionVerifier=tb(t,e),r}function RL(t){var e={},r=e.EncryptionVersionInfo=es(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function kL(t){var e=0,r,n=Z4(t),i=n.length+1,o,c,u,h,d;for(r=mo(i),r[0]=n.length,o=1;o!=i;++o)r[o]=n[o-1];for(o=i-1;o>=0;--o)c=r[o],u=(e&16384)===0?0:1,h=e<<1&32767,d=u|h,e=d^c;return e^52811}var rb=(function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(c){return(c/2|c*128)&255},i=function(c,u){return n(c^u)},o=function(c){for(var u=e[c.length-1],h=104,d=c.length-1;d>=0;--d)for(var m=c[d],v=0;v!=7;++v)m&64&&(u^=r[h]),m*=2,--h;return u};return function(c){for(var u=Z4(c),h=o(u),d=u.length,m=mo(16),v=0;v!=16;++v)m[v]=0;var y,E,S;for((d&1)===1&&(y=h>>8,m[d]=i(t[0],y),--d,y=h&255,E=u[u.length-1],m[d]=i(E,y));d>0;)--d,y=h>>8,m[d]=i(u[d],y),--d,y=h&255,m[d]=i(u[d],y);for(d=15,S=15-u.length;S>0;)y=h>>8,m[d]=i(t[S],y),--d,--S,y=h&255,m[d]=i(u[d],y),--d,--S;return m}})(),IL=function(t,e,r,n,i){i||(i=e),n||(n=rb(t));var o,c;for(o=0;o!=e.length;++o)c=e[o],c^=n[r],c=(c>>5|c<<3)&255,i[o]=c,++r;return[i,r,n]},DL=function(t){var e=0,r=rb(t);return function(n){var i=IL("",n,e,r);return e=i[1],i[0]}};function NL(t,e,r,n){var i={key:Cr(t),verificationBytes:Cr(t)};return r.password&&(i.verifier=kL(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=DL(r.password)),i}function OL(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=RL(t):n.Data=CL(t,e),n}function FL(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?OL(t,e-2,n):NL(t,r.biff>=8?e:e-2,r,n),n}var ML=(function(){function t(i,o){switch(o.type){case"base64":return e(aa(i),o);case"binary":return e(i,o);case"buffer":return e(vt&&Buffer.isBuffer(i)?i.toString("binary"):pl(i),o);case"array":return e(ll(i),o)}throw new Error("Unrecognized type "+o.type)}function e(i,o){var c=o||{},u=c.dense?[]:{},h=i.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(m,v){Array.isArray(u)&&(u[v]=[]);for(var y=/\\\w+\b/g,E=0,S,T=-1;S=y.exec(m);){switch(S[0]){case"\\cell":var A=m.slice(E,y.lastIndex-S[0].length);if(A[0]==" "&&(A=A.slice(1)),++T,A.length){var B={v:A,t:"s"};Array.isArray(u)?u[v][T]=B:u[tt({r:v,c:T})]=B}break}E=y.lastIndex}T>d.e.c&&(d.e.c=T)}),u["!ref"]=Et(d),u}function r(i,o){return _o(t(i,o),o)}function n(i){for(var o=["{\\rtf1\\ansi"],c=hr(i["!ref"]),u,h=Array.isArray(i),d=c.s.r;d<=c.e.r;++d){o.push("\\trowd\\trautofit1");for(var m=c.s.c;m<=c.e.c;++m)o.push("\\cellx"+(m+1));for(o.push("\\pard\\intbl"),m=c.s.c;m<=c.e.c;++m){var v=tt({r:d,c:m});u=h?(i[d]||[])[m]:i[v],!(!u||u.v==null&&(!u.f||u.F))&&(o.push(" "+(u.w||(os(u),u.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}})();function LL(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function wf(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function PL(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),o=Math.min(e,r,n),c=i-o;if(c===0)return[0,0,e];var u=0,h=0,d=i+o;switch(h=c/(d>1?2-d:d),i){case e:u=((r-n)/c+6)%6;break;case r:u=(n-e)/c+2;break;case n:u=(e-r)/c+4;break}return[u/6,h,d/2]}function BL(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),o=n-i/2,c=[o,o,o],u=6*e,h;if(r!==0)switch(u|0){case 0:case 6:h=i*u,c[0]+=i,c[1]+=h;break;case 1:h=i*(2-u),c[0]+=h,c[1]+=i;break;case 2:h=i*(u-2),c[1]+=i,c[2]+=h;break;case 3:h=i*(4-u),c[1]+=h,c[2]+=i;break;case 4:h=i*(u-4),c[2]+=i,c[0]+=h;break;case 5:h=i*(6-u),c[2]+=h,c[0]+=i;break}for(var d=0;d!=3;++d)c[d]=Math.round(c[d]*255);return c}function _d(t,e){if(e===0)return t;var r=PL(LL(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),wf(BL(r))}var nb=6,VL=15,UL=1,Tn=nb;function Ed(t){return Math.floor((t+Math.round(128/Tn)/256)*Tn)}function Td(t){return Math.floor((t-5)/Tn*100+.5)/100}function i1(t){return Math.round((t*Tn+5)/Tn*256)/256}function yg(t){return i1(Td(Ed(t)))}function Rx(t){var e=Math.abs(t-yg(t)),r=Tn;if(e>.005)for(Tn=UL;Tn<VL;++Tn)Math.abs(t-yg(t))<=e&&(e=Math.abs(t-yg(t)),r=Tn);Tn=r}function Ic(t){t.width?(t.wpx=Ed(t.width),t.wch=Td(t.wpx),t.MDW=Tn):t.wpx?(t.wch=Td(t.wpx),t.width=i1(t.wch),t.MDW=Tn):typeof t.wch=="number"&&(t.width=i1(t.wch),t.wpx=Ed(t.width),t.MDW=Tn),t.customWidth&&delete t.customWidth}var jL=96,ab=jL;function ib(t){return t*96/ab}function Af(t){return t*ab/96}var zL={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function HL(t,e,r,n){e.Borders=[];var i={},o=!1;(t[0].match(gn)||[]).forEach(function(c){var u=$e(c);switch(yi(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},u.diagonalUp&&(i.diagonalUp=nr(u.diagonalUp)),u.diagonalDown&&(i.diagonalDown=nr(u.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in borders")}})}function GL(t,e,r,n){e.Fills=[];var i={},o=!1;(t[0].match(gn)||[]).forEach(function(c){var u=$e(c);switch(yi(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":u.patternType&&(i.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),u.indexed&&(i.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(i.bgColor.theme=parseInt(u.theme,10)),u.tint&&(i.bgColor.tint=parseFloat(u.tint)),u.rgb&&(i.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),u.theme&&(i.fgColor.theme=parseInt(u.theme,10)),u.tint&&(i.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(i.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fills")}})}function qL(t,e,r,n){e.Fonts=[];var i={},o=!1;(t[0].match(gn)||[]).forEach(function(c){var u=$e(c);switch(yi(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":u.val&&(i.name=$t(u.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=u.val?nr(u.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=u.val?nr(u.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(u.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=u.val?nr(u.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=u.val?nr(u.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=u.val?nr(u.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=u.val?nr(u.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=u.val?nr(u.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":u.val&&(i.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(i.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(i.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(i.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=ux[parseInt(u.val,10)];break;case"<color":if(i.color||(i.color={}),u.auto&&(i.color.auto=nr(u.auto)),u.rgb)i.color.rgb=u.rgb.slice(-6);else if(u.indexed){i.color.index=parseInt(u.indexed,10);var h=tl[i.color.index];i.color.index==81&&(h=tl[1]),h||(h=tl[1]),i.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else u.theme&&(i.color.theme=parseInt(u.theme,10),u.tint&&(i.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=_d(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fonts")}})}function WL(t,e,r){e.NumberFmt=[];for(var n=vi(ot),i=0;i<n.length;++i)e.NumberFmt[n[i]]=ot[n[i]];var o=t[0].match(gn);if(o)for(i=0;i<o.length;++i){var c=$e(o[i]);switch(yi(c[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=wt($t(c.formatCode)),h=parseInt(c.numFmtId,10);if(e.NumberFmt[h]=u,h>0){if(h>392){for(h=392;h>60&&e.NumberFmt[h]!=null;--h);e.NumberFmt[h]=u}el(u,h)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+c[0]+" in numFmts")}}}var kh=["numFmtId","fillId","fontId","borderId","xfId"],Ih=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function YL(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(gn)||[]).forEach(function(o){var c=$e(o),u=0;switch(yi(c[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=c,delete n[0],u=0;u<kh.length;++u)n[kh[u]]&&(n[kh[u]]=parseInt(n[kh[u]],10));for(u=0;u<Ih.length;++u)n[Ih[u]]&&(n[Ih[u]]=nr(n[Ih[u]]));if(e.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[u]){n.numFmtId=u;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};c.vertical&&(h.vertical=c.vertical),c.horizontal&&(h.horizontal=c.horizontal),c.textRotation!=null&&(h.textRotation=c.textRotation),c.indent&&(h.indent=c.indent),c.wrapText&&(h.wrapText=nr(c.wrapText)),n.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+c[0]+" in cellXfs")}})}var XL=(function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,h,d){var m={};if(!u)return m;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var v;return(v=u.match(e))&&WL(v,m,d),(v=u.match(i))&&qL(v,m,h,d),(v=u.match(n))&&GL(v,m,h,d),(v=u.match(o))&&HL(v,m,h,d),(v=u.match(r))&&YL(v,m,d),m}})();function KL(t,e){var r=t.read_shift(2),n=dn(t);return[r,n]}function $L(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=sF(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var o=t.read_shift(2);switch(o===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var c=t.read_shift(1);c!=0&&(n.underline=c);var u=t.read_shift(1);u>0&&(n.family=u);var h=t.read_shift(1);switch(h>0&&(n.charset=h),t.l++,n.color=iF(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=dn(t),n}var QL=mn;function JL(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}var ZL=mn;function e9(t,e,r){var n={};n.NumberFmt=[];for(var i in ot)n.NumberFmt[i]=ot[i];n.CellXf=[],n.Fonts=[];var o=[],c=!1;return us(t,function(h,d,m){switch(m){case 44:n.NumberFmt[h[0]]=h[1],el(h[1],h[0]);break;case 43:n.Fonts.push(h),h.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(h.color.rgb=_d(e.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&n.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:o.push(m),c=!0;break;case 38:o.pop(),c=!1;break;default:if(d.T>0)o.push(m);else if(d.T<0)o.pop();else if(!c||r.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),n}var t9=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function r9(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(gn)||[]).forEach(function(i){var o=$e(i);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=o.val;break;case"<a:sysClr":n.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(e.themeElements.clrScheme[t9.indexOf(o[0])]=n,n={}):n.name=o[0].slice(3,o[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function n9(){}function a9(){}var i9=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,s9=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,o9=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function l9(t,e,r){e.themeElements={};var n;[["clrScheme",i9,r9],["fontScheme",s9,n9],["fmtScheme",o9,a9]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var c9=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function sb(t,e){(!t||t.length===0)&&(t=u9());var r,n={};if(!(r=t.match(c9)))throw new Error("themeElements not found in theme");return l9(r[0],n,e),n.raw=t,n}function u9(t,e){var r=[x4];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function f9(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var o=t.slice(t.l);t.l=n;var c;try{c=g4(o,{type:"array"})}catch{return}var u=ea(c,"theme/theme/theme1.xml",!0);if(u)return sb(u,r)}}function h9(t){return t.read_shift(4)}function d9(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=p9(t,4);break;case 2:e.xclrValue=W4(t);break;case 3:e.xclrValue=h9(t);break;case 4:t.l+=4;break}return t.l+=8,e}function p9(t,e){return mn(t,e)}function m9(t,e){return mn(t,e)}function g9(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=d9(t);break;case 6:n[1]=m9(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function x9(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),o=[];i-- >0;)o.push(g9(t,r-t.l));return{ixfe:n,ext:o}}function v9(t,e){e.forEach(function(r){r[0]})}function y9(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:dn(t)}}function _9(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function E9(t){return t.l+=4,t.read_shift(4)!=0}function T9(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},o=[],c=!1,u=2;return us(t,function(h,d,m){switch(m){case 335:n.Types.push({name:h.name});break;case 51:h.forEach(function(v){u==1?n.Cell.push({type:n.Types[v[0]-1].name,index:v[1]}):u==0&&n.Value.push({type:n.Types[v[0]-1].name,index:v[1]})});break;case 337:u=h?1:0;break;case 338:u=2;break;case 35:o.push(m),c=!0;break;case 36:o.pop(),c=!1;break;default:if(!d.T){if(!c||i.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),n}function S9(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,o=2,c;return t.replace(gn,function(u){var h=$e(u);switch(yi(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==h.name&&(c=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?n.Cell.push({type:n.Types[h.t-1].name,index:+h.v}):o==0&&n.Value.push({type:n.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!c)break;c.offsets||(c.offsets=[]),c.offsets.push(+h.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return u}),n}function w9(t){var e=[];if(!t)return e;var r=1;return(t.match(gn)||[]).forEach(function(n){var i=$e(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function A9(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=tt(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function b9(t,e,r){var n=[];return us(t,function(o,c,u){switch(u){case 63:n.push(o);break;default:if(!c.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function C9(t,e,r,n){if(!t)return t;var i=n||{},o=!1;us(t,function(u,h,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!h.T){if(!o||i.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},i)}function R9(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}function MT(t,e,r,n){var i=Array.isArray(t),o;e.forEach(function(c){var u=Sn(c.ref);if(i?(t[u.r]||(t[u.r]=[]),o=t[u.r][u.c]):o=t[c.ref],!o){o={t:"z"},i?t[u.r][u.c]=o:t[c.ref]=o;var h=hr(t["!ref"]||"BDWGO1000001:A1");h.s.r>u.r&&(h.s.r=u.r),h.e.r<u.r&&(h.e.r=u.r),h.s.c>u.c&&(h.s.c=u.c),h.e.c<u.c&&(h.e.c=u.c);var d=Et(h);d!==t["!ref"]&&(t["!ref"]=d)}o.c||(o.c=[]);var m={a:c.author,t:c.t,r:c.r,T:r};c.h&&(m.h=c.h);for(var v=o.c.length-1;v>=0;--v){if(!r&&o.c[v].T)return;r&&!o.c[v].T&&o.c.splice(v,1)}if(r&&n){for(v=0;v<n.length;++v)if(m.a==n[v].id){m.a=n[v].name||m.a;break}}o.c.push(m)})}function k9(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var o=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?comment[^>]*>/);if(u){var h=$e(u[0]),d={author:h.authorId&&r[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},m=Sn(h.ref);if(!(e.sheetRows&&e.sheetRows<=m.r)){var v=c.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),y=!!v&&!!v[1]&&Cx(v[1])||{r:"",t:"",h:""};d.r=y.r,y.r=="<t></t>"&&(y.t=y.h=""),d.t=(y.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(d.h=y.h),n.push(d)}}}}),n}function I9(t,e){var r=[],n=!1,i={},o=0;return t.replace(gn,function(u,h){var d=$e(u);switch(yi(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":o=h+u.length;break;case"</text>":i.t=t.slice(o,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return u}),r}function D9(t,e){var r=[],n=!1;return t.replace(gn,function(o){var c=$e(o);switch(yi(c[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:c.displayname,id:c.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function N9(t){var e={};e.iauthor=t.read_shift(4);var r=gl(t);return e.rfx=r.s,e.ref=tt(r.s),t.l+=16,e}var O9=dn;function F9(t,e){var r=[],n=[],i={},o=!1;return us(t,function(u,h,d){switch(d){case 632:n.push(u);break;case 635:i=u;break;case 637:i.t=u.t,i.h=u.h,i.r=u.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!o||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}var M9="application/vnd.ms-office.vbaProject";function L9(t){var e=_t.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");_t.utils.cfb_add(e,i,t.FileIndex[n].content)}}),_t.write(e)}function P9(){return{"!type":"dialog"}}function B9(){return{"!type":"dialog"}}function V9(){return{"!type":"macro"}}function U9(){return{"!type":"macro"}}var xc=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,o,c){var u=!1,h=!1;o.length==0?h=!0:o.charAt(0)=="["&&(h=!0,o=o.slice(1,-1)),c.length==0?u=!0:c.charAt(0)=="["&&(u=!0,c=c.slice(1,-1));var d=o.length>0?parseInt(o,10)|0:0,m=c.length>0?parseInt(c,10)|0:0;return u?m+=e.c:--m,h?d+=e.r:--d,i+(u?"":"$")+Nr(m)+(h?"":"$")+tn(d)}return function(i,o){return e=o,i.replace(t,r)}})(),ob=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,j9=(function(){return function(e,r){return e.replace(ob,function(n,i,o,c,u,h){var d=Ex(c)-(o?0:r.c),m=_x(h)-(u?0:r.r),v=m==0?"":u?m+1:"["+m+"]",y=d==0?"":o?d+1:"["+d+"]";return i+"R"+v+"C"+y})}})();function lb(t,e){return t.replace(ob,function(r,n,i,o,c,u){return n+(i=="$"?i+o:Nr(Ex(o)+e.c))+(c=="$"?c+u:tn(_x(u)+e.r))})}function z9(t,e,r){var n=Hc(e),i=n.s,o=Sn(r),c={r:o.r-i.r,c:o.c-i.c};return lb(t,c)}function H9(t){return t.length!=1}function LT(t){return t.replace(/_xlfn\./g,"")}function wr(t){t.l+=1}function go(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function cb(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return ub(t);r.biff==12&&(n=4)}var i=t.read_shift(n),o=t.read_shift(n),c=go(t),u=go(t);return{s:{r:i,c:c[0],cRel:c[1],rRel:c[2]},e:{r:o,c:u[0],cRel:u[1],rRel:u[2]}}}function ub(t){var e=go(t),r=go(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function G9(t,e,r){if(r.biff<8)return ub(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),o=go(t),c=go(t);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function fb(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return q9(t);var n=t.read_shift(r&&r.biff==12?4:2),i=go(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function q9(t){var e=go(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function W9(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Y9(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return X9(t);var i=t.read_shift(n>=12?4:2),o=t.read_shift(2),c=(o&16384)>>14,u=(o&32768)>>15;if(o&=16383,u==1)for(;i>524287;)i-=1048576;if(c==1)for(;o>8191;)o=o-16384;return{r:i,c:o,cRel:c,rRel:u}}function X9(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function K9(t,e,r){var n=(t[t.l++]&96)>>5,i=cb(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function $9(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),o=8;if(r)switch(r.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}var c=cb(t,o,r);return[n,i,c]}function Q9(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function J9(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),o=8;if(r)switch(r.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}return t.l+=o,[n,i]}function Z9(t,e,r){var n=(t[t.l++]&96)>>5,i=G9(t,e-1,r);return[n,i]}function eP(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function PT(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function tP(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],o=0;o<=n;++o)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function rP(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function nP(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function aP(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function iP(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function hb(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function sP(t){return t.read_shift(2),hb(t)}function oP(t){return t.read_shift(2),hb(t)}function lP(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=fb(t,0,r);return[n,i]}function cP(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=Y9(t,0,r);return[n,i]}function uP(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var o=fb(t,0,r);return[n,i,o]}function fP(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[h7[i],mb[i],n]}function hP(t,e,r){var n=t[t.l++],i=t.read_shift(1),o=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:dP(t);return[i,(o[0]===0?mb:f7)[o[1]]]}function dP(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function pP(t,e,r){t.l+=r&&r.biff==2?3:4}function mP(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function gP(t){return t.l++,xl[t.read_shift(1)]}function xP(t){return t.l++,t.read_shift(2)}function vP(t){return t.l++,t.read_shift(1)!==0}function yP(t){return t.l++,fn(t)}function _P(t,e,r){return t.l++,Yf(t,e-1,r)}function EP(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=gr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=xl[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=fn(t);break;case 2:r[1]=vl(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function TP(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],o=0;o!=n;++o)i.push((r.biff==12?gl:Qd)(t));return i}function SP(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var o=0,c=[];o!=n&&(c[o]=[]);++o)for(var u=0;u!=i;++u)c[o][u]=EP(t,r.biff);return c}function wP(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,o=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,o]}function AP(t,e,r){if(r.biff==5)return bP(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),o=t.read_shift(4);return[n,i,o]}function bP(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function CP(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function RP(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function kP(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function IP(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),o=4;if(r)switch(r.biff){case 5:o=15;break;case 12:o=6;break}return t.l+=o,[n,i]}var DP=mn,NP=mn,OP=mn;function Kf(t,e,r){return t.l+=2,[W9(t)]}function kx(t){return t.l+=6,[]}var FP=Kf,MP=kx,LP=kx,PP=Kf;function db(t){return t.l+=2,[Cr(t),t.read_shift(2)&1]}var BP=Kf,VP=db,UP=kx,jP=Kf,zP=Kf,HP=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function GP(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),o=t.read_shift(2),c=HP[r>>2&31];return{ixti:e,coltype:r&3,rt:c,idx:n,c:i,C:o}}function qP(t){return t.l+=2,[t.read_shift(4)]}function WP(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function YP(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function XP(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function KP(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function $P(t){return t.l+=4,[0,0]}var BT={1:{n:"PtgExp",f:mP},2:{n:"PtgTbl",f:OP},3:{n:"PtgAdd",f:wr},4:{n:"PtgSub",f:wr},5:{n:"PtgMul",f:wr},6:{n:"PtgDiv",f:wr},7:{n:"PtgPower",f:wr},8:{n:"PtgConcat",f:wr},9:{n:"PtgLt",f:wr},10:{n:"PtgLe",f:wr},11:{n:"PtgEq",f:wr},12:{n:"PtgGe",f:wr},13:{n:"PtgGt",f:wr},14:{n:"PtgNe",f:wr},15:{n:"PtgIsect",f:wr},16:{n:"PtgUnion",f:wr},17:{n:"PtgRange",f:wr},18:{n:"PtgUplus",f:wr},19:{n:"PtgUminus",f:wr},20:{n:"PtgPercent",f:wr},21:{n:"PtgParen",f:wr},22:{n:"PtgMissArg",f:wr},23:{n:"PtgStr",f:_P},26:{n:"PtgSheet",f:WP},27:{n:"PtgEndSheet",f:YP},28:{n:"PtgErr",f:gP},29:{n:"PtgBool",f:vP},30:{n:"PtgInt",f:xP},31:{n:"PtgNum",f:yP},32:{n:"PtgArray",f:eP},33:{n:"PtgFunc",f:fP},34:{n:"PtgFuncVar",f:hP},35:{n:"PtgName",f:wP},36:{n:"PtgRef",f:lP},37:{n:"PtgArea",f:K9},38:{n:"PtgMemArea",f:CP},39:{n:"PtgMemErr",f:DP},40:{n:"PtgMemNoMem",f:NP},41:{n:"PtgMemFunc",f:RP},42:{n:"PtgRefErr",f:kP},43:{n:"PtgAreaErr",f:Q9},44:{n:"PtgRefN",f:cP},45:{n:"PtgAreaN",f:Z9},46:{n:"PtgMemAreaN",f:XP},47:{n:"PtgMemNoMemN",f:KP},57:{n:"PtgNameX",f:AP},58:{n:"PtgRef3d",f:uP},59:{n:"PtgArea3d",f:$9},60:{n:"PtgRefErr3d",f:IP},61:{n:"PtgAreaErr3d",f:J9},255:{}},QP={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},JP={1:{n:"PtgElfLel",f:db},2:{n:"PtgElfRw",f:jP},3:{n:"PtgElfCol",f:FP},6:{n:"PtgElfRwV",f:zP},7:{n:"PtgElfColV",f:PP},10:{n:"PtgElfRadical",f:BP},11:{n:"PtgElfRadicalS",f:UP},13:{n:"PtgElfColS",f:MP},15:{n:"PtgElfColSV",f:LP},16:{n:"PtgElfRadicalLel",f:VP},25:{n:"PtgList",f:GP},29:{n:"PtgSxName",f:qP},255:{}},ZP={0:{n:"PtgAttrNoop",f:$P},1:{n:"PtgAttrSemi",f:iP},2:{n:"PtgAttrIf",f:nP},4:{n:"PtgAttrChoose",f:tP},8:{n:"PtgAttrGoto",f:rP},16:{n:"PtgAttrSum",f:pP},32:{n:"PtgAttrBaxcel",f:PT},33:{n:"PtgAttrBaxcel",f:PT},64:{n:"PtgAttrSpace",f:sP},65:{n:"PtgAttrSpaceSemi",f:oP},128:{n:"PtgAttrIfError",f:aP},255:{}};function $f(t,e,r,n){if(n.biff<8)return mn(t,e);for(var i=t.l+e,o=[],c=0;c!==r.length;++c)switch(r[c][0]){case"PtgArray":r[c][1]=SP(t,0,n),o.push(r[c][1]);break;case"PtgMemArea":r[c][2]=TP(t,r[c][1],n),o.push(r[c][2]);break;case"PtgExp":n&&n.biff==12&&(r[c][1][1]=t.read_shift(4),o.push(r[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[c][0]}return e=i-t.l,e!==0&&o.push(mn(t,e)),o}function Qf(t,e,r){for(var n=t.l+e,i,o,c=[];n!=t.l;)e=n-t.l,o=t[t.l],i=BT[o]||BT[QP[o]],(o===24||o===25)&&(i=(o===24?JP:ZP)[t[t.l+1]]),!i||!i.f?mn(t,e):c.push([i.n,i.f(t,e,r)]);return c}function e7(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],o=0;o<n.length;++o){var c=n[o];c?c[0]===2?i.push('"'+c[1].replace(/"/g,'""')+'"'):i.push(c[1]):i.push("")}e.push(i.join(","))}return e.join(";")}var t7={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function r7(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function pb(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function VT(t,e,r){var n=pb(t,e,r);return n=="#REF"?n:r7(n,r)}function cn(t,e,r,n,i){var o=i&&i.biff||8,c={s:{c:0,r:0}},u=[],h,d,m,v=0,y=0,E,S="";if(!t[0]||!t[0][0])return"";for(var T=-1,A="",B=0,I=t[0].length;B<I;++B){var C=t[0][B];switch(C[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=u.pop(),d=u.pop(),T>=0){switch(t[0][T][1][0]){case 0:A=fr(" ",t[0][T][1][1]);break;case 1:A=fr("\r",t[0][T][1][1]);break;default:if(A="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][T][1][0])}d=d+A,T=-1}u.push(d+t7[C[0]]+h);break;case"PtgIsect":h=u.pop(),d=u.pop(),u.push(d+" "+h);break;case"PtgUnion":h=u.pop(),d=u.pop(),u.push(d+","+h);break;case"PtgRange":h=u.pop(),d=u.pop(),u.push(d+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=nf(C[1][1],c,i),u.push(af(m,o));break;case"PtgRefN":m=r?nf(C[1][1],r,i):C[1][1],u.push(af(m,o));break;case"PtgRef3d":v=C[1][1],m=nf(C[1][2],c,i),S=VT(n,v,i),u.push(S+"!"+af(m,o));break;case"PtgFunc":case"PtgFuncVar":var G=C[1][0],K=C[1][1];G||(G=0),G&=127;var Y=G==0?[]:u.slice(-G);u.length-=G,K==="User"&&(K=Y.shift()),u.push(K+"("+Y.join(",")+")");break;case"PtgBool":u.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(C[1]);break;case"PtgNum":u.push(String(C[1]));break;case"PtgStr":u.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(C[1]);break;case"PtgAreaN":E=yT(C[1][1],r?{s:r}:c,i),u.push(xg(E,i));break;case"PtgArea":E=yT(C[1][1],c,i),u.push(xg(E,i));break;case"PtgArea3d":v=C[1][1],E=C[1][2],S=VT(n,v,i),u.push(S+"!"+xg(E,i));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=C[1][2];var b=(n.names||[])[y-1]||(n[0]||[])[y],N=b?b.Name:"SH33TJSNAME"+String(y);N&&N.slice(0,6)=="_xlfn."&&!i.xlfn&&(N=N.slice(6)),u.push(N);break;case"PtgNameX":var D=C[1][1];y=C[1][2];var U;if(i.biff<=5)D<0&&(D=-D),n[D]&&(U=n[D][y]);else{var P="";if(((n[D]||[])[0]||[])[0]==14849||(((n[D]||[])[0]||[])[0]==1025?n[D][y]&&n[D][y].itab>0&&(P=n.SheetNames[n[D][y].itab-1]+"!"):P=n.SheetNames[y-1]+"!"),n[D]&&n[D][y])P+=n[D][y].Name;else if(n[0]&&n[0][y])P+=n[0][y].Name;else{var F=(pb(n,D,i)||"").split(";;");F[y-1]?P=F[y-1]:P+="SH33TJSERRX"}u.push(P);break}U||(U={Name:"SH33TJSERRY"}),u.push(U.Name);break;case"PtgParen":var O="(",we=")";if(T>=0){switch(A="",t[0][T][1][0]){case 2:O=fr(" ",t[0][T][1][1])+O;break;case 3:O=fr("\r",t[0][T][1][1])+O;break;case 4:we=fr(" ",t[0][T][1][1])+we;break;case 5:we=fr("\r",t[0][T][1][1])+we;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][T][1][0])}T=-1}u.push(O+u.pop()+we);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":m={c:C[1][1],r:C[1][0]};var Ce={c:r.c,r:r.r};if(n.sharedf[tt(m)]){var ne=n.sharedf[tt(m)];u.push(cn(ne,c,Ce,n,i))}else{var me=!1;for(h=0;h!=n.arrayf.length;++h)if(d=n.arrayf[h],!(m.c<d[0].s.c||m.c>d[0].e.c)&&!(m.r<d[0].s.r||m.r>d[0].e.r)){u.push(cn(d[1],c,Ce,n,i)),me=!0;break}me||u.push(C[1])}break;case"PtgArray":u.push("{"+e7(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":T=B;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var _e=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&T>=0&&_e.indexOf(t[0][B][0])==-1){C=t[0][T];var ae=!0;switch(C[1][0]){case 4:ae=!1;case 0:A=fr(" ",C[1][1]);break;case 5:ae=!1;case 1:A=fr("\r",C[1][1]);break;default:if(A="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}u.push((ae?A:"")+u.pop()+(ae?"":A)),T=-1}}if(u.length>1&&i.WTF)throw new Error("bad formula stack");return u[0]}function n7(t,e,r){var n=t.l+e,i=r.biff==2?1:2,o,c=t.read_shift(i);if(c==65535)return[[],mn(t,e-2)];var u=Qf(t,c,r);return e!==c+i&&(o=$f(t,e-c-i,u,r)),t.l=n,[u,o]}function a7(t,e,r){var n=t.l+e,i=r.biff==2?1:2,o,c=t.read_shift(i);if(c==65535)return[[],mn(t,e-2)];var u=Qf(t,c,r);return e!==c+i&&(o=$f(t,e-c-i,u,r)),t.l=n,[u,o]}function i7(t,e,r,n){var i=t.l+e,o=Qf(t,n,r),c;return i!==t.l&&(c=$f(t,i-t.l,o,r)),[o,c]}function s7(t,e,r){var n=t.l+e,i,o=t.read_shift(2),c=Qf(t,o,r);return o==65535?[[],mn(t,e-2)]:(e!==o+2&&(i=$f(t,n-o-2,c,r)),[c,i])}function o7(t){var e;if(Ki(t,t.l+6)!==65535)return[fn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function _g(t,e,r){var n=t.l+e,i=_i(t);r.biff==2&&++t.l;var o=o7(t),c=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var u=a7(t,n-t.l,r);return{cell:i,val:o[0],formula:u,shared:c>>3&1,tt:o[1]}}function Jd(t,e,r){var n=t.read_shift(4),i=Qf(t,n,r),o=t.read_shift(4),c=o>0?$f(t,o,i,r):null;return[i,c]}var l7=Jd,Zd=Jd,c7=Jd,u7=Jd,f7={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},mb={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},h7={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function UT(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function Eg(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var cf={},vc={};function uf(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function gb(t,e,r,n,i,o){try{n.cellNF&&(t.z=ot[e])}catch(u){if(n.WTF)throw u}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=zr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(ot[e]==null&&el(d8[e]||"General",e),t.t==="e")t.w=t.w||xl[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=_f(t.v);else if(t.t==="d"){var c=An(t.v);(c|0)===c?t.w=c.toString(10):t.w=_f(c)}else{if(t.v===void 0)return"";t.w=ol(t.v,vc)}else t.t==="d"?t.w=wa(e,An(t.v),vc):t.w=wa(e,t.v,vc)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&r!=null)try{t.s=o.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=_d(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=_d(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&o.Fills)throw u}}}function d7(t,e){var r=hr(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Et(r))}var p7=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,m7=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,g7=/<(?:\w:)?hyperlink [^>]*>/mg,x7=/"(\w*:\w*)"/,v7=/<(?:\w:)?col\b[^>]*[\/]?>/g,y7=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,_7=/<(?:\w:)?pageMargins[^>]*\/>/g,xb=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,E7=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,T7=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function S7(t,e,r,n,i,o,c){if(!t)return t;n||(n={"!id":{}});var u=e.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",m="",v=t.match(m7);v?(d=t.slice(0,v.index),m=t.slice(v.index+v[0].length)):d=m=t;var y=d.match(xb);y?Ix(y[0],u,i,r):(y=d.match(E7))&&w7(y[0],y[1]||"",u,i,r);var E=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(E>0){var S=d.slice(E,E+50).match(x7);S&&d7(u,S[1])}var T=d.match(T7);T&&T[1]&&I7(T[1],i);var A=[];if(e.cellStyles){var B=d.match(v7);B&&C7(A,B)}v&&D7(v[1],u,e,h,o,c);var I=m.match(y7);I&&(u["!autofilter"]=R7(I[0]));var C=[],G=m.match(p7);if(G)for(E=0;E!=G.length;++E)C[E]=hr(G[E].slice(G[E].indexOf('"')+1));var K=m.match(g7);K&&A7(u,K,n);var Y=m.match(_7);if(Y&&(u["!margins"]=b7($e(Y[0]))),!u["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(u["!ref"]=Et(h)),e.sheetRows>0&&u["!ref"]){var b=hr(u["!ref"]);e.sheetRows<=+b.e.r&&(b.e.r=e.sheetRows-1,b.e.r>h.e.r&&(b.e.r=h.e.r),b.e.r<b.s.r&&(b.s.r=b.e.r),b.e.c>h.e.c&&(b.e.c=h.e.c),b.e.c<b.s.c&&(b.s.c=b.e.c),u["!fullref"]=u["!ref"],u["!ref"]=Et(b))}return A.length>0&&(u["!cols"]=A),C.length>0&&(u["!merges"]=C),u}function Ix(t,e,r,n){var i=$e(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=wt($t(i.codeName)))}function w7(t,e,r,n,i){Ix(t.slice(0,t.indexOf(">")),r,n,i)}function A7(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var o=$e($t(e[i]),!0);if(!o.ref)return;var c=((r||{})["!id"]||[])[o.id];c?(o.Target=c.Target,o.location&&(o.Target+="#"+wt(o.location))):(o.Target="#"+wt(o.location),c={Target:o.Target,TargetMode:"Internal"}),o.Rel=c,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var u=hr(o.ref),h=u.s.r;h<=u.e.r;++h)for(var d=u.s.c;d<=u.e.c;++d){var m=tt({c:d,r:h});n?(t[h]||(t[h]=[]),t[h][d]||(t[h][d]={t:"z",v:void 0}),t[h][d].l=o):(t[m]||(t[m]={t:"z",v:void 0}),t[m].l=o)}}}function b7(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function C7(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=$e(e[n],!0);i.hidden&&(i.hidden=nr(i.hidden));var o=parseInt(i.min,10)-1,c=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,Rx(i.width)),Ic(i);o<=c;)t[o++]=en(i)}}function R7(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var k7=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function I7(t,e){e.Views||(e.Views=[{}]),(t.match(k7)||[]).forEach(function(r,n){var i=$e(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),nr(i.rightToLeft)&&(e.Views[n].RTL=!0)})}var D7=(function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,o=Ef("v"),c=Ef("f");return function(h,d,m,v,y,E){for(var S=0,T="",A=[],B=[],I=0,C=0,G=0,K="",Y,b,N=0,D=0,U,P,F=0,O=0,we=Array.isArray(E.CellXf),Ce,ne=[],me=[],_e=Array.isArray(d),ae=[],Le={},Q=!1,L=!!m.sheetStubs,te=h.split(e),J=0,ee=te.length;J!=ee;++J){T=te[J].trim();var xe=T.length;if(xe!==0){var Re=0;e:for(S=0;S<xe;++S)switch(T[S]){case">":if(T[S-1]!="/"){++S;break e}if(m&&m.cellStyles){if(b=$e(T.slice(Re,S),!0),N=b.r!=null?parseInt(b.r,10):N+1,D=-1,m.sheetRows&&m.sheetRows<N)continue;Le={},Q=!1,b.ht&&(Q=!0,Le.hpt=parseFloat(b.ht),Le.hpx=Af(Le.hpt)),b.hidden=="1"&&(Q=!0,Le.hidden=!0),b.outlineLevel!=null&&(Q=!0,Le.level=+b.outlineLevel),Q&&(ae[N-1]=Le)}break;case"<":Re=S;break}if(Re>=S)break;if(b=$e(T.slice(Re,S),!0),N=b.r!=null?parseInt(b.r,10):N+1,D=-1,!(m.sheetRows&&m.sheetRows<N)){v.s.r>N-1&&(v.s.r=N-1),v.e.r<N-1&&(v.e.r=N-1),m&&m.cellStyles&&(Le={},Q=!1,b.ht&&(Q=!0,Le.hpt=parseFloat(b.ht),Le.hpx=Af(Le.hpt)),b.hidden=="1"&&(Q=!0,Le.hidden=!0),b.outlineLevel!=null&&(Q=!0,Le.level=+b.outlineLevel),Q&&(ae[N-1]=Le)),A=T.slice(S).split(t);for(var Me=0;Me!=A.length&&A[Me].trim().charAt(0)=="<";++Me);for(A=A.slice(Me),S=0;S!=A.length;++S)if(T=A[S].trim(),T.length!==0){if(B=T.match(r),I=S,C=0,G=0,T="<c "+(T.slice(0,1)=="<"?">":"")+T,B!=null&&B.length===2){for(I=0,K=B[1],C=0;C!=K.length&&!((G=K.charCodeAt(C)-64)<1||G>26);++C)I=26*I+G;--I,D=I}else++D;for(C=0;C!=T.length&&T.charCodeAt(C)!==62;++C);if(++C,b=$e(T.slice(0,C),!0),b.r||(b.r=tt({r:N-1,c:D})),K=T.slice(C),Y={t:""},(B=K.match(o))!=null&&B[1]!==""&&(Y.v=wt(B[1])),m.cellFormula){if((B=K.match(c))!=null&&B[1]!==""){if(Y.f=wt($t(B[1])).replace(/\r\n/g,`
`),m.xlfn||(Y.f=LT(Y.f)),B[0].indexOf('t="array"')>-1)Y.F=(K.match(i)||[])[1],Y.F.indexOf(":")>-1&&ne.push([hr(Y.F),Y.F]);else if(B[0].indexOf('t="shared"')>-1){P=$e(B[0]);var Ie=wt($t(B[1]));m.xlfn||(Ie=LT(Ie)),me[parseInt(P.si,10)]=[P,Ie,b.r]}}else(B=K.match(/<f[^>]*\/>/))&&(P=$e(B[0]),me[P.si]&&(Y.f=z9(me[P.si][1],me[P.si][2],b.r)));var Oe=Sn(b.r);for(C=0;C<ne.length;++C)Oe.r>=ne[C][0].s.r&&Oe.r<=ne[C][0].e.r&&Oe.c>=ne[C][0].s.c&&Oe.c<=ne[C][0].e.c&&(Y.F=ne[C][1])}if(b.t==null&&Y.v===void 0)if(Y.f||Y.F)Y.v=0,Y.t="n";else if(L)Y.t="z";else continue;else Y.t=b.t||"n";switch(v.s.c>D&&(v.s.c=D),v.e.c<D&&(v.e.c=D),Y.t){case"n":if(Y.v==""||Y.v==null){if(!L)continue;Y.t="z"}else Y.v=parseFloat(Y.v);break;case"s":if(typeof Y.v>"u"){if(!L)continue;Y.t="z"}else U=cf[parseInt(Y.v,10)],Y.v=U.t,Y.r=U.r,m.cellHTML&&(Y.h=U.h);break;case"str":Y.t="s",Y.v=Y.v!=null?$t(Y.v):"",m.cellHTML&&(Y.h=xx(Y.v));break;case"inlineStr":B=K.match(n),Y.t="s",B!=null&&(U=Cx(B[1]))?(Y.v=U.t,m.cellHTML&&(Y.h=U.h)):Y.v="";break;case"b":Y.v=nr(Y.v);break;case"d":m.cellDates?Y.v=zr(Y.v,1):(Y.v=An(zr(Y.v,1)),Y.t="n");break;case"e":(!m||m.cellText!==!1)&&(Y.w=Y.v),Y.v=B4[Y.v];break}if(F=O=0,Ce=null,we&&b.s!==void 0&&(Ce=E.CellXf[b.s],Ce!=null&&(Ce.numFmtId!=null&&(F=Ce.numFmtId),m.cellStyles&&Ce.fillId!=null&&(O=Ce.fillId))),gb(Y,F,O,m,y,E),m.cellDates&&we&&Y.t=="n"&&zc(ot[F])&&(Y.t="d",Y.v=$d(Y.v)),b.cm&&m.xlmeta){var ct=(m.xlmeta.Cell||[])[+b.cm-1];ct&&ct.type=="XLDAPR"&&(Y.D=!0)}if(_e){var Z=Sn(b.r);d[Z.r]||(d[Z.r]=[]),d[Z.r][Z.c]=Y}else d[b.r]=Y}}}}ae.length>0&&(d["!rows"]=ae)}})();function N7(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var o=t.read_shift(1);return t.l=n,o&7&&(r.level=o&7),o&16&&(r.hidden=!0),o&32&&(r.hpt=i/20),r}var O7=gl;function F7(){}function M7(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=nF(t),r}function L7(t){var e=Aa(t);return[e]}function P7(t){var e=ml(t);return[e]}function B7(t){var e=Aa(t),r=t.read_shift(1);return[e,r,"b"]}function V7(t){var e=ml(t),r=t.read_shift(1);return[e,r,"b"]}function U7(t){var e=Aa(t),r=t.read_shift(1);return[e,r,"e"]}function j7(t){var e=ml(t),r=t.read_shift(1);return[e,r,"e"]}function z7(t){var e=Aa(t),r=t.read_shift(4);return[e,r,"s"]}function H7(t){var e=ml(t),r=t.read_shift(4);return[e,r,"s"]}function G7(t){var e=Aa(t),r=fn(t);return[e,r,"n"]}function vb(t){var e=ml(t),r=fn(t);return[e,r,"n"]}function q7(t){var e=Aa(t),r=wx(t);return[e,r,"n"]}function W7(t){var e=ml(t),r=wx(t);return[e,r,"n"]}function Y7(t){var e=Aa(t),r=Tx(t);return[e,r,"is"]}function X7(t){var e=Aa(t),r=dn(t);return[e,r,"str"]}function K7(t){var e=ml(t),r=dn(t);return[e,r,"str"]}function $7(t,e,r){var n=t.l+e,i=Aa(t);i.r=r["!row"];var o=t.read_shift(1),c=[i,o,"b"];if(r.cellFormula){t.l+=2;var u=Zd(t,n-t.l,r);c[3]=cn(u,null,i,r.supbooks,r)}else t.l=n;return c}function Q7(t,e,r){var n=t.l+e,i=Aa(t);i.r=r["!row"];var o=t.read_shift(1),c=[i,o,"e"];if(r.cellFormula){t.l+=2;var u=Zd(t,n-t.l,r);c[3]=cn(u,null,i,r.supbooks,r)}else t.l=n;return c}function J7(t,e,r){var n=t.l+e,i=Aa(t);i.r=r["!row"];var o=fn(t),c=[i,o,"n"];if(r.cellFormula){t.l+=2;var u=Zd(t,n-t.l,r);c[3]=cn(u,null,i,r.supbooks,r)}else t.l=n;return c}function Z7(t,e,r){var n=t.l+e,i=Aa(t);i.r=r["!row"];var o=dn(t),c=[i,o,"str"];if(r.cellFormula){t.l+=2;var u=Zd(t,n-t.l,r);c[3]=cn(u,null,i,r.supbooks,r)}else t.l=n;return c}var eB=gl;function tB(t,e){var r=t.l+e,n=gl(t),i=Sx(t),o=dn(t),c=dn(t),u=dn(t);t.l=r;var h={rfx:n,relId:i,loc:o,display:u};return c&&(h.Tooltip=c),h}function rB(){}function nB(t,e,r){var n=t.l+e,i=M4(t),o=t.read_shift(1),c=[i];if(c[2]=o,r.cellFormula){var u=l7(t,n-t.l,r);c[1]=u}else t.l=n;return c}function aB(t,e,r){var n=t.l+e,i=gl(t),o=[i];if(r.cellFormula){var c=u7(t,n-t.l,r);o[1]=c,t.l=n}else t.l=n;return o}var iB=["left","right","top","bottom","header","footer"];function sB(t){var e={};return iB.forEach(function(r){e[r]=fn(t)}),e}function oB(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function lB(){}function cB(){}function uB(t,e,r,n,i,o,c){if(!t)return t;var u=e||{};n||(n={"!id":{}});var h=u.dense?[]:{},d,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=!1,y=!1,E,S,T,A,B,I,C,G,K,Y=[];u.biff=12,u["!row"]=0;var b=0,N=!1,D=[],U={},P=u.supbooks||i.supbooks||[[]];if(P.sharedf=U,P.arrayf=D,P.SheetNames=i.SheetNames||i.Sheets.map(function(_e){return _e.name}),!u.supbooks&&(u.supbooks=P,i.Names))for(var F=0;F<i.Names.length;++F)P[0][F+1]=i.Names[F];var O=[],we=[],Ce=!1;Sd[16]={n:"BrtShortReal",f:vb};var ne;if(us(t,function(ae,Le,Q){if(!y)switch(Q){case 148:d=ae;break;case 0:E=ae,u.sheetRows&&u.sheetRows<=E.r&&(y=!0),G=tn(A=E.r),u["!row"]=E.r,(ae.hidden||ae.hpt||ae.level!=null)&&(ae.hpt&&(ae.hpx=Af(ae.hpt)),we[ae.r]=ae);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(S={t:ae[2]},ae[2]){case"n":S.v=ae[1];break;case"s":C=cf[ae[1]],S.v=C.t,S.r=C.r;break;case"b":S.v=!!ae[1];break;case"e":S.v=ae[1],u.cellText!==!1&&(S.w=xl[S.v]);break;case"str":S.t="s",S.v=ae[1];break;case"is":S.t="s",S.v=ae[1].t;break}if((T=c.CellXf[ae[0].iStyleRef])&&gb(S,T.numFmtId,null,u,o,c),B=ae[0].c==-1?B+1:ae[0].c,u.dense?(h[A]||(h[A]=[]),h[A][B]=S):h[Nr(B)+G]=S,u.cellFormula){for(N=!1,b=0;b<D.length;++b){var L=D[b];E.r>=L[0].s.r&&E.r<=L[0].e.r&&B>=L[0].s.c&&B<=L[0].e.c&&(S.F=Et(L[0]),N=!0)}!N&&ae.length>3&&(S.f=ae[3])}if(m.s.r>E.r&&(m.s.r=E.r),m.s.c>B&&(m.s.c=B),m.e.r<E.r&&(m.e.r=E.r),m.e.c<B&&(m.e.c=B),u.cellDates&&T&&S.t=="n"&&zc(ot[T.numFmtId])){var te=Qo(S.v);te&&(S.t="d",S.v=new Date(te.y,te.m-1,te.d,te.H,te.M,te.S,te.u))}ne&&(ne.type=="XLDAPR"&&(S.D=!0),ne=void 0);break;case 1:case 12:if(!u.sheetStubs||v)break;S={t:"z",v:void 0},B=ae[0].c==-1?B+1:ae[0].c,u.dense?(h[A]||(h[A]=[]),h[A][B]=S):h[Nr(B)+G]=S,m.s.r>E.r&&(m.s.r=E.r),m.s.c>B&&(m.s.c=B),m.e.r<E.r&&(m.e.r=E.r),m.e.c<B&&(m.e.c=B),ne&&(ne.type=="XLDAPR"&&(S.D=!0),ne=void 0);break;case 176:Y.push(ae);break;case 49:ne=((u.xlmeta||{}).Cell||[])[ae-1];break;case 494:var J=n["!id"][ae.relId];for(J?(ae.Target=J.Target,ae.loc&&(ae.Target+="#"+ae.loc),ae.Rel=J):ae.relId==""&&(ae.Target="#"+ae.loc),A=ae.rfx.s.r;A<=ae.rfx.e.r;++A)for(B=ae.rfx.s.c;B<=ae.rfx.e.c;++B)u.dense?(h[A]||(h[A]=[]),h[A][B]||(h[A][B]={t:"z",v:void 0}),h[A][B].l=ae):(I=tt({c:B,r:A}),h[I]||(h[I]={t:"z",v:void 0}),h[I].l=ae);break;case 426:if(!u.cellFormula)break;D.push(ae),K=u.dense?h[A][B]:h[Nr(B)+G],K.f=cn(ae[1],m,{r:E.r,c:B},P,u),K.F=Et(ae[0]);break;case 427:if(!u.cellFormula)break;U[tt(ae[0].s)]=ae[1],K=u.dense?h[A][B]:h[Nr(B)+G],K.f=cn(ae[1],m,{r:E.r,c:B},P,u);break;case 60:if(!u.cellStyles)break;for(;ae.e>=ae.s;)O[ae.e--]={width:ae.w/256,hidden:!!(ae.flags&1),level:ae.level},Ce||(Ce=!0,Rx(ae.w/256)),Ic(O[ae.e+1]);break;case 161:h["!autofilter"]={ref:Et(ae)};break;case 476:h["!margins"]=ae;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),ae.name&&(i.Sheets[r].CodeName=ae.name),(ae.above||ae.left)&&(h["!outline"]={above:ae.above,left:ae.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),ae.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:v=!0;break;case 36:v=!1;break;case 37:v=!0;break;case 38:v=!1;break;default:if(!Le.T){if(!v||u.WTF)throw new Error("Unexpected record 0x"+Q.toString(16))}}},u),delete u.supbooks,delete u["!row"],!h["!ref"]&&(m.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(h["!ref"]=Et(d||m)),u.sheetRows&&h["!ref"]){var me=hr(h["!ref"]);u.sheetRows<=+me.e.r&&(me.e.r=u.sheetRows-1,me.e.r>m.e.r&&(me.e.r=m.e.r),me.e.r<me.s.r&&(me.s.r=me.e.r),me.e.c>m.e.c&&(me.e.c=m.e.c),me.e.c<me.s.c&&(me.s.c=me.e.c),h["!fullref"]=h["!ref"],h["!ref"]=Et(me))}return Y.length>0&&(h["!merges"]=Y),O.length>0&&(h["!cols"]=O),we.length>0&&(h["!rows"]=we),h}function fB(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var c=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);c&&(e[+c[1]]=r?+c[2]:c[2])});var i=wt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){n=o.replace(/<.*?>/g,"")}),[e,i,n]}function hB(t,e,r,n,i,o){var c=o||{"!type":"chart"};if(!t)return o;var u=0,h=0,d="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(v){var y=fB(v);m.s.r=m.s.c=0,m.e.c=u,d=Nr(u),y[0].forEach(function(E,S){c[d+tn(S)]={t:"n",v:E,z:y[1]},h=S}),m.e.r<h&&(m.e.r=h),++u}),u>0&&(c["!ref"]=Et(m)),c}function dB(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},c,u=t.match(xb);return u&&Ix(u[0],o,i,r),(c=t.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=c[1]),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}function pB(t,e){t.l+=10;var r=dn(t);return{name:r}}function mB(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},c=!1;return us(t,function(h,d,m){switch(m){case 550:o["!rel"]=h;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),h.name&&(i.Sheets[r].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!c||e.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},e),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}var yb=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],gB=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],xB=[],vB=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function jT(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var o=e[i];if(n[o[0]]==null)n[o[0]]=o[1];else switch(o[2]){case"bool":typeof n[o[0]]=="string"&&(n[o[0]]=nr(n[o[0]]));break;case"int":typeof n[o[0]]=="string"&&(n[o[0]]=parseInt(n[o[0]],10));break}}}function zT(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=nr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function _b(t){zT(t.WBProps,yb),zT(t.CalcPr,vB),jT(t.WBView,gB),jT(t.Sheets,xB),vc.date1904=nr(t.WBProps.date1904)}var yB="][*?/\\".split("");function _B(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return yB.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var EB=/<\w+:workbook/;function TB(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",o={},c=0;if(t.replace(gn,function(h,d){var m=$e(h);switch(yi(m[0])){case"<?xml":break;case"<workbook":h.match(EB)&&(i="xmlns"+h.match(/<(\w+):/)[1]),r.xmlns=m[i];break;case"</workbook>":break;case"<fileVersion":delete m[0],r.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":yb.forEach(function(v){if(m[v[0]]!=null)switch(v[2]){case"bool":r.WBProps[v[0]]=nr(m[v[0]]);break;case"int":r.WBProps[v[0]]=parseInt(m[v[0]],10);break;default:r.WBProps[v[0]]=m[v[0]]}}),m.codeName&&(r.WBProps.CodeName=$t(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],r.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=wt($t(m.name)),delete m[0],r.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":o={},o.Name=$t(m.name),m.comment&&(o.Comment=m.comment),m.localSheetId&&(o.Sheet=+m.localSheetId),nr(m.hidden||"0")&&(o.Hidden=!0),c=d+h.length;break;case"</definedName>":o.Ref=wt($t(t.slice(c,d))),r.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete m[0],r.CalcPr=m;break;case"<calcPr/>":delete m[0],r.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return h}),U8.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return _b(r),r}function SB(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=r1(t),r.name=dn(t),r}function wB(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?dn(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function AB(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function bB(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),o=aF(t),c=c7(t,0,r),u=Sx(t);t.l=n;var h={Name:o,Ptg:c};return i<268435455&&(h.Sheet=i),u&&(h.Comment=u),h}function CB(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var o=[],c=[[]];return c.SheetNames=[],c.XTI=[],Sd[16]={n:"BrtFRTArchID$",f:AB},us(t,function(h,d,m){switch(m){case 156:c.SheetNames.push(h.name),r.Sheets.push(h);break;case 153:r.WBProps=h;break;case 39:h.Sheet!=null&&(e.SID=h.Sheet),h.Ref=cn(h.Ptg,null,null,c,e),delete e.SID,delete h.Ptg,o.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:c[0].length?c.push([m,h]):c[0]=[m,h],c[c.length-1].XTI=[];break;case 362:c.length===0&&(c[0]=[],c[0].XTI=[]),c[c.length-1].XTI=c[c.length-1].XTI.concat(h),c.XTI=c.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(m),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(m),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!d.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},e),_b(r),r.Names=o,r.supbooks=c,r}function RB(t,e,r){return e.slice(-4)===".bin"?CB(t,r):TB(t,r)}function kB(t,e,r,n,i,o,c,u){return e.slice(-4)===".bin"?uB(t,n,r,i,o,c,u):S7(t,n,r,i,o,c,u)}function IB(t,e,r,n,i,o,c,u){return e.slice(-4)===".bin"?mB(t,n,r,i,o):dB(t,n,r,i,o)}function DB(t,e,r,n,i,o,c,u){return e.slice(-4)===".bin"?V9():U9()}function NB(t,e,r,n,i,o,c,u){return e.slice(-4)===".bin"?P9():B9()}function OB(t,e,r,n){return e.slice(-4)===".bin"?e9(t,r,n):XL(t,r,n)}function FB(t,e,r){return sb(t,r)}function MB(t,e,r){return e.slice(-4)===".bin"?gL(t,r):pL(t,r)}function LB(t,e,r){return e.slice(-4)===".bin"?F9(t,r):k9(t,r)}function PB(t,e,r){return e.slice(-4)===".bin"?b9(t):w9(t)}function BB(t,e,r,n){return r.slice(-4)===".bin"?C9(t,e,r,n):void 0}function VB(t,e,r){return e.slice(-4)===".bin"?T9(t,e,r):S9(t,e,r)}var Eb=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Tb=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ba(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(Eb),o,c,u,h;if(i)for(h=0;h!=i.length;++h)o=i[h].match(Tb),(c=o[1].indexOf(":"))===-1?n[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?u="xmlns"+o[1].slice(6):u=o[1].slice(c+1),n[u]=o[2].slice(1,o[2].length-1));return n}function UB(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(Eb),i,o,c,u;if(n)for(u=0;u!=n.length;++u)i=n[u].match(Tb),(o=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(o+1),r[c]=i[2].slice(1,i[2].length-1));return r}var ff;function jB(t,e){var r=ff[t]||wt(t);return r==="General"?ol(e):wa(r,e)}function zB(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=nr(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=zr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[wt(e)]=i}function HB(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||xl[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=_f(t.v):t.w=ol(t.v):t.w=jB(e||"General",t.v)}catch(o){if(r.WTF)throw o}try{var n=ff[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&zc(n)){var i=Qo(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(o){if(r.WTF)throw o}}}function GB(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=zL[n.Pattern]||n.Pattern)}t[e.ID]=e}function qB(t,e,r,n,i,o,c,u,h,d){var m="General",v=n.StyleID,y={};d=d||{};var E=[],S=0;for(v===void 0&&u&&(v=u.StyleID),v===void 0&&c&&(v=c.StyleID);o[v]!==void 0&&(o[v].nf&&(m=o[v].nf),o[v].Interior&&E.push(o[v].Interior),!!o[v].Parent);)v=o[v].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=nr(t);break;case"String":n.t="s",n.r=uT(wt(t)),n.v=t.indexOf("<")>-1?wt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(zr(t)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=wt(t):n.v<60&&(n.v=n.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=B4[t],d.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=uT(e||t));break}if(HB(n,m,d),d.cellFormula!==!1)if(n.Formula){var T=wt(n.Formula);T.charCodeAt(0)==61&&(T=T.slice(1)),n.f=xc(T,i),delete n.Formula,n.ArrayRange=="RC"?n.F=xc("RC:RC",i):n.ArrayRange&&(n.F=xc(n.ArrayRange,i),h.push([hr(n.F),n.F]))}else for(S=0;S<h.length;++S)i.r>=h[S][0].s.r&&i.r<=h[S][0].e.r&&i.c>=h[S][0].s.c&&i.c<=h[S][0].e.c&&(n.F=h[S][1]);d.cellStyles&&(E.forEach(function(A){!y.patternType&&A.patternType&&(y.patternType=A.patternType)}),n.s=y),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function WB(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Tg(t,e){var r=e||{};u4();var n=qu(vx(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=$t(n));var i=n.slice(0,1024).toLowerCase(),o=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var c=en(r);return c.type="string",Sf.to_workbook(n,c)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Gt){i.indexOf("<"+Gt)>=0&&(o=!0)}),o)return tV(n,r);ff={"General Number":"General","General Date":ot[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ot[15],"Short Date":ot[14],"Long Time":ot[19],"Medium Time":ot[18],"Short Time":ot[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ot[2],Standard:ot[4],Percent:ot[10],Scientific:ot[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,h=[],d,m={},v=[],y=r.dense?[]:{},E="",S={},T={},A=Ba('<Data ss:Type="String">'),B=0,I=0,C=0,G={s:{r:2e6,c:2e6},e:{r:0,c:0}},K={},Y={},b="",N=0,D=[],U={},P={},F=0,O=[],we=[],Ce={},ne=[],me,_e=!1,ae=[],Le=[],Q={},L=0,te=0,J={Sheets:[],WBProps:{date1904:!1}},ee={};Tf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var xe="";u=Tf.exec(n);)switch(u[3]=(xe=u[3]).toLowerCase()){case"data":if(xe=="data"){if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break}if(h[h.length-1][1])break;u[1]==="/"?qB(n.slice(B,u.index),b,A,h[h.length-1][0]=="comment"?Ce:S,{c:I,r:C},K,ne[I],T,ae,r):(b="",A=Ba(u[0]),B=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(we.length>0&&(S.c=we),(!r.sheetRows||r.sheetRows>C)&&S.v!==void 0&&(r.dense?(y[C]||(y[C]=[]),y[C][I]=S):y[Nr(I)+tn(C)]=S),S.HRef&&(S.l={Target:wt(S.HRef)},S.HRefScreenTip&&(S.l.Tooltip=S.HRefScreenTip),delete S.HRef,delete S.HRefScreenTip),(S.MergeAcross||S.MergeDown)&&(L=I+(parseInt(S.MergeAcross,10)|0),te=C+(parseInt(S.MergeDown,10)|0),D.push({s:{c:I,r:C},e:{c:L,r:te}})),!r.sheetStubs)S.MergeAcross?I=L+1:++I;else if(S.MergeAcross||S.MergeDown){for(var Re=I;Re<=L;++Re)for(var Me=C;Me<=te;++Me)(Re>I||Me>C)&&(r.dense?(y[Me]||(y[Me]=[]),y[Me][Re]={t:"z"}):y[Nr(Re)+tn(Me)]={t:"z"});I=L+1}else++I;else S=UB(u[0]),S.Index&&(I=+S.Index-1),I<G.s.c&&(G.s.c=I),I>G.e.c&&(G.e.c=I),u[0].slice(-2)==="/>"&&++I,we=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(C<G.s.r&&(G.s.r=C),C>G.e.r&&(G.e.r=C),u[0].slice(-2)==="/>"&&(T=Ba(u[0]),T.Index&&(C=+T.Index-1)),I=0,++C):(T=Ba(u[0]),T.Index&&(C=+T.Index-1),Q={},(T.AutoFitHeight=="0"||T.Height)&&(Q.hpx=parseInt(T.Height,10),Q.hpt=ib(Q.hpx),Le[C]=Q),T.Hidden=="1"&&(Q.hidden=!0,Le[C]=Q));break;case"worksheet":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));v.push(E),G.s.r<=G.e.r&&G.s.c<=G.e.c&&(y["!ref"]=Et(G),r.sheetRows&&r.sheetRows<=G.e.r&&(y["!fullref"]=y["!ref"],G.e.r=r.sheetRows-1,y["!ref"]=Et(G))),D.length&&(y["!merges"]=D),ne.length>0&&(y["!cols"]=ne),Le.length>0&&(y["!rows"]=Le),m[E]=y}else G={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=I=0,h.push([u[3],!1]),d=Ba(u[0]),E=wt(d.Name),y=r.dense?[]:{},D=[],ae=[],Le=[],ee={name:E,Hidden:0},J.Sheets.push(ee);break;case"table":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else{if(u[0].slice(-2)=="/>")break;h.push([u[3],!1]),ne=[],_e=!1}break;case"style":u[1]==="/"?GB(K,Y,r):Y=Ba(u[0]);break;case"numberformat":Y.nf=wt(Ba(u[0]).Format||"General"),ff[Y.nf]&&(Y.nf=ff[Y.nf]);for(var Ie=0;Ie!=392&&ot[Ie]!=Y.nf;++Ie);if(Ie==392){for(Ie=57;Ie!=392;++Ie)if(ot[Ie]==null){el(Y.nf,Ie);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(me=Ba(u[0]),me.Hidden&&(me.hidden=!0,delete me.Hidden),me.Width&&(me.wpx=parseInt(me.Width,10)),!_e&&me.wpx>10){_e=!0,Tn=nb;for(var Oe=0;Oe<ne.length;++Oe)ne[Oe]&&Ic(ne[Oe])}_e&&Ic(me),ne[me.Index-1||ne.length]=me;for(var ct=0;ct<+me.Span;++ct)ne[ne.length]=en(me);break;case"namedrange":if(u[1]==="/")break;J.Names||(J.Names=[]);var Z=$e(u[0]),Vt={Name:Z.Name,Ref:xc(Z.RefersTo.slice(1),{r:0,c:0})};J.Sheets.length>0&&(Vt.Sheet=J.Sheets.length-1),J.Names.push(Vt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?b+=n.slice(N,u.index):N=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;Y.Interior=Ba(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?kF(U,xe,n.slice(F,u.index)):F=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else h.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));WB(Ce),we.push(Ce)}else h.push([u[3],!1]),d=Ba(u[0]),Ce={a:d.Author};break;case"autofilter":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var nt=Ba(u[0]);y["!autofilter"]={ref:xc(nt.Range).replace(/\$/g,"")},h.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"null":break;default:if(h.length==0&&u[3]=="document"||h.length==0&&u[3]=="uof")return XT(n,r);var Tt=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Tt=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Tt=!1}break;case"excelworkbook":switch(u[3]){case"date1904":J.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Tt=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:Tt=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(F,u.index)){case"SheetHidden":ee.Hidden=1;break;case"SheetVeryHidden":ee.Hidden=2;break}else F=u.index+u[0].length;break;case"header":y["!margins"]||uf(y["!margins"]={},"xlml"),isNaN(+$e(u[0]).Margin)||(y["!margins"].header=+$e(u[0]).Margin);break;case"footer":y["!margins"]||uf(y["!margins"]={},"xlml"),isNaN(+$e(u[0]).Margin)||(y["!margins"].footer=+$e(u[0]).Margin);break;case"pagemargins":var Je=$e(u[0]);y["!margins"]||uf(y["!margins"]={},"xlml"),isNaN(+Je.Top)||(y["!margins"].top=+Je.Top),isNaN(+Je.Left)||(y["!margins"].left=+Je.Left),isNaN(+Je.Right)||(y["!margins"].right=+Je.Right),isNaN(+Je.Bottom)||(y["!margins"].bottom=+Je.Bottom);break;case"displayrighttoleft":J.Views||(J.Views=[]),J.Views[0]||(J.Views[0]={}),J.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Tt=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Tt=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Tt=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Tt=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Tt=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Tt=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Tt=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Tt=!1}break;case"smarttags":break;default:Tt=!1;break}if(Tt||u[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?zB(P,xe,O,n.slice(F,u.index)):(O=u,F=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+h.join("|")}var Ve={};return!r.bookSheets&&!r.bookProps&&(Ve.Sheets=m),Ve.SheetNames=v,Ve.Workbook=J,Ve.SSF=en(ot),Ve.Props=U,Ve.Custprops=P,Ve}function s1(t,e){switch(Ox(e=e||{}),e.type||"base64"){case"base64":return Tg(aa(t),e);case"binary":case"buffer":case"file":return Tg(t,e);case"array":return Tg(pl(t),e)}}function YB(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=oF(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=lF(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var XB=[60,1084,2066,2165,2175];function KB(t,e,r,n,i){var o=n,c=[],u=r.slice(r.l,r.l+o);if(i&&i.enc&&i.enc.insitu&&u.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(u)}c.push(u),r.l+=o;for(var h=Ki(r,r.l),d=o1[h],m=0;d!=null&&XB.indexOf(h)>-1;)o=Ki(r,r.l+2),m=r.l+4,h==2066?m+=4:(h==2165||h==2175)&&(m+=12),u=r.slice(m,r.l+4+o),c.push(u),r.l+=4+o,d=o1[h=Ki(r,r.l)];var v=Ks(c);Jr(v,0);var y=0;v.lens=[];for(var E=0;E<c.length;++E)v.lens.push(y),y+=c[E].length;if(v.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+v.length+" < "+n;return e.f(v,v.length,i)}function ui(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=ot[n])}catch(o){if(e.WTF)throw o}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||xl[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=_f(t.v):t.w=ol(t.v):t.w=wa(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(o){if(e.WTF)throw o}if(e.cellDates&&n&&t.t=="n"&&zc(ot[n]||String(n))){var i=Qo(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Dh(t,e,r){return{v:t,ixfe:e,t:r}}function $B(t,e){var r={opts:{}},n={},i=e.dense?[]:{},o={},c={},u=null,h=[],d="",m={},v,y="",E,S,T,A,B={},I=[],C,G,K=[],Y=[],b={Sheets:[],WBProps:{date1904:!1},Views:[{}]},N={},D=function(at){return at<8?tl[at]:at<64&&Y[at-8]||tl[at]},U=function(at,Yt,qr){var Ct=Yt.XF.data;if(!(!Ct||!Ct.patternType||!qr||!qr.cellStyles)){Yt.s={},Yt.s.patternType=Ct.patternType;var Qt;(Qt=wf(D(Ct.icvFore)))&&(Yt.s.fgColor={rgb:Qt}),(Qt=wf(D(Ct.icvBack)))&&(Yt.s.bgColor={rgb:Qt})}},P=function(at,Yt,qr){if(!(Q>1)&&!(qr.sheetRows&&at.r>=qr.sheetRows)){if(qr.cellStyles&&Yt.XF&&Yt.XF.data&&U(at,Yt,qr),delete Yt.ixfe,delete Yt.XF,v=at,y=tt(at),(!c||!c.s||!c.e)&&(c={s:{r:0,c:0},e:{r:0,c:0}}),at.r<c.s.r&&(c.s.r=at.r),at.c<c.s.c&&(c.s.c=at.c),at.r+1>c.e.r&&(c.e.r=at.r+1),at.c+1>c.e.c&&(c.e.c=at.c+1),qr.cellFormula&&Yt.f){for(var Ct=0;Ct<I.length;++Ct)if(!(I[Ct][0].s.c>at.c||I[Ct][0].s.r>at.r)&&!(I[Ct][0].e.c<at.c||I[Ct][0].e.r<at.r)){Yt.F=Et(I[Ct][0]),(I[Ct][0].s.c!=at.c||I[Ct][0].s.r!=at.r)&&delete Yt.f,Yt.f&&(Yt.f=""+cn(I[Ct][1],c,at,ae,F));break}}qr.dense?(i[at.r]||(i[at.r]=[]),i[at.r][at.c]=Yt):i[y]=Yt}},F={enc:!1,sbcch:0,snames:[],sharedf:B,arrayf:I,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(F.password=e.password);var O,we=[],Ce=[],ne=[],me=[],_e=!1,ae=[];ae.SheetNames=F.snames,ae.sharedf=F.sharedf,ae.arrayf=F.arrayf,ae.names=[],ae.XTI=[];var Le=0,Q=0,L=0,te=[],J=[],ee;F.codepage=1200,Ga(1200);for(var xe=!1;t.l<t.length-1;){var Re=t.l,Me=t.read_shift(2);if(Me===0&&Le===10)break;var Ie=t.l===t.length?0:t.read_shift(2),Oe=o1[Me];if(Oe&&Oe.f){if(e.bookSheets&&Le===133&&Me!==133)break;if(Le=Me,Oe.r===2||Oe.r==12){var ct=t.read_shift(2);if(Ie-=2,!F.enc&&ct!==Me&&((ct&255)<<8|ct>>8)!==Me)throw new Error("rt mismatch: "+ct+"!="+Me);Oe.r==12&&(t.l+=10,Ie-=10)}var Z={};if(Me===10?Z=Oe.f(t,Ie,F):Z=KB(Me,Oe,t,Ie,F),Q==0&&[9,521,1033,2057].indexOf(Le)===-1)continue;switch(Me){case 34:r.opts.Date1904=b.WBProps.date1904=Z;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(F.enc||(t.l=0),F.enc=Z,!e.password)throw new Error("File is password-protected");if(Z.valid==null)throw new Error("Encryption scheme unsupported");if(!Z.valid)throw new Error("Password is incorrect");break;case 92:F.lastuser=Z;break;case 66:var Vt=Number(Z);switch(Vt){case 21010:Vt=1200;break;case 32768:Vt=1e4;break;case 32769:Vt=1252;break}Ga(F.codepage=Vt),xe=!0;break;case 317:F.rrtabid=Z;break;case 25:F.winlocked=Z;break;case 439:r.opts.RefreshAll=Z;break;case 12:r.opts.CalcCount=Z;break;case 16:r.opts.CalcDelta=Z;break;case 17:r.opts.CalcIter=Z;break;case 13:r.opts.CalcMode=Z;break;case 14:r.opts.CalcPrecision=Z;break;case 95:r.opts.CalcSaveRecalc=Z;break;case 15:F.CalcRefMode=Z;break;case 2211:r.opts.FullCalc=Z;break;case 129:Z.fDialog&&(i["!type"]="dialog"),Z.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),Z.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:K.push(Z);break;case 430:ae.push([Z]),ae[ae.length-1].XTI=[];break;case 35:case 547:ae[ae.length-1].push(Z);break;case 24:case 536:ee={Name:Z.Name,Ref:cn(Z.rgce,c,null,ae,F)},Z.itab>0&&(ee.Sheet=Z.itab-1),ae.names.push(ee),ae[0]||(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].push(Z),Z.Name=="_xlnm._FilterDatabase"&&Z.itab>0&&Z.rgce&&Z.rgce[0]&&Z.rgce[0][0]&&Z.rgce[0][0][0]=="PtgArea3d"&&(J[Z.itab-1]={ref:Et(Z.rgce[0][0][1][2])});break;case 22:F.ExternCount=Z;break;case 23:ae.length==0&&(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].XTI=ae[ae.length-1].XTI.concat(Z),ae.XTI=ae.XTI.concat(Z);break;case 2196:if(F.biff<8)break;ee!=null&&(ee.Comment=Z[1]);break;case 18:i["!protect"]=Z;break;case 19:Z!==0&&F.WTF&&console.error("Password verifier: "+Z);break;case 133:o[Z.pos]=Z,F.snames.push(Z.name);break;case 10:{if(--Q)break;if(c.e){if(c.e.r>0&&c.e.c>0){if(c.e.r--,c.e.c--,i["!ref"]=Et(c),e.sheetRows&&e.sheetRows<=c.e.r){var nt=c.e.r;c.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=Et(c),c.e.r=nt}c.e.r++,c.e.c++}we.length>0&&(i["!merges"]=we),Ce.length>0&&(i["!objects"]=Ce),ne.length>0&&(i["!cols"]=ne),me.length>0&&(i["!rows"]=me),b.Sheets.push(N)}d===""?m=i:n[d]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(F.biff===8&&(F.biff={9:2,521:3,1033:4}[Me]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Z.BIFFVer]||8),F.biffguess=Z.BIFFVer==0,Z.BIFFVer==0&&Z.dt==4096&&(F.biff=5,xe=!0,Ga(F.codepage=28591)),F.biff==8&&Z.BIFFVer==0&&Z.dt==16&&(F.biff=2),Q++)break;if(i=e.dense?[]:{},F.biff<8&&!xe&&(xe=!0,Ga(F.codepage=e.codepage||1252)),F.biff<5||Z.BIFFVer==0&&Z.dt==4096){d===""&&(d="Sheet1"),c={s:{r:0,c:0},e:{r:0,c:0}};var Tt={pos:t.l-Ie,name:d};o[Tt.pos]=Tt,F.snames.push(d)}else d=(o[Re]||{name:""}).name;Z.dt==32&&(i["!type"]="chart"),Z.dt==64&&(i["!type"]="macro"),we=[],Ce=[],F.arrayf=I=[],ne=[],me=[],_e=!1,N={Hidden:(o[Re]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[Z.r]||[])[Z.c]:i[tt({c:Z.c,r:Z.r})])&&++Z.c,C={ixfe:Z.ixfe,XF:K[Z.ixfe]||{},v:Z.val,t:"n"},L>0&&(C.z=te[C.ixfe>>8&63]),ui(C,e,r.opts.Date1904),P({c:Z.c,r:Z.r},C,e);break;case 5:case 517:C={ixfe:Z.ixfe,XF:K[Z.ixfe],v:Z.val,t:Z.t},L>0&&(C.z=te[C.ixfe>>8&63]),ui(C,e,r.opts.Date1904),P({c:Z.c,r:Z.r},C,e);break;case 638:C={ixfe:Z.ixfe,XF:K[Z.ixfe],v:Z.rknum,t:"n"},L>0&&(C.z=te[C.ixfe>>8&63]),ui(C,e,r.opts.Date1904),P({c:Z.c,r:Z.r},C,e);break;case 189:for(var Je=Z.c;Je<=Z.C;++Je){var Ve=Z.rkrec[Je-Z.c][0];C={ixfe:Ve,XF:K[Ve],v:Z.rkrec[Je-Z.c][1],t:"n"},L>0&&(C.z=te[C.ixfe>>8&63]),ui(C,e,r.opts.Date1904),P({c:Je,r:Z.r},C,e)}break;case 6:case 518:case 1030:{if(Z.val=="String"){u=Z;break}if(C=Dh(Z.val,Z.cell.ixfe,Z.tt),C.XF=K[C.ixfe],e.cellFormula){var Gt=Z.formula;if(Gt&&Gt[0]&&Gt[0][0]&&Gt[0][0][0]=="PtgExp"){var St=Gt[0][0][1][0],Dt=Gt[0][0][1][1],Lr=tt({r:St,c:Dt});B[Lr]?C.f=""+cn(Z.formula,c,Z.cell,ae,F):C.F=((e.dense?(i[St]||[])[Dt]:i[Lr])||{}).F}else C.f=""+cn(Z.formula,c,Z.cell,ae,F)}L>0&&(C.z=te[C.ixfe>>8&63]),ui(C,e,r.opts.Date1904),P(Z.cell,C,e),u=Z}break;case 7:case 519:if(u)u.val=Z,C=Dh(Z,u.cell.ixfe,"s"),C.XF=K[C.ixfe],e.cellFormula&&(C.f=""+cn(u.formula,c,u.cell,ae,F)),L>0&&(C.z=te[C.ixfe>>8&63]),ui(C,e,r.opts.Date1904),P(u.cell,C,e),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{I.push(Z);var Ei=tt(Z[0].s);if(E=e.dense?(i[Z[0].s.r]||[])[Z[0].s.c]:i[Ei],e.cellFormula&&E){if(!u||!Ei||!E)break;E.f=""+cn(Z[1],c,Z[0],ae,F),E.F=Et(Z[0])}}break;case 1212:{if(!e.cellFormula)break;if(y){if(!u)break;B[tt(u.cell)]=Z[0],E=e.dense?(i[u.cell.r]||[])[u.cell.c]:i[tt(u.cell)],(E||{}).f=""+cn(Z[0],c,v,ae,F)}}break;case 253:C=Dh(h[Z.isst].t,Z.ixfe,"s"),h[Z.isst].h&&(C.h=h[Z.isst].h),C.XF=K[C.ixfe],L>0&&(C.z=te[C.ixfe>>8&63]),ui(C,e,r.opts.Date1904),P({c:Z.c,r:Z.r},C,e);break;case 513:e.sheetStubs&&(C={ixfe:Z.ixfe,XF:K[Z.ixfe],t:"z"},L>0&&(C.z=te[C.ixfe>>8&63]),ui(C,e,r.opts.Date1904),P({c:Z.c,r:Z.r},C,e));break;case 190:if(e.sheetStubs)for(var Un=Z.c;Un<=Z.C;++Un){var Ot=Z.ixfe[Un-Z.c];C={ixfe:Ot,XF:K[Ot],t:"z"},L>0&&(C.z=te[C.ixfe>>8&63]),ui(C,e,r.opts.Date1904),P({c:Un,r:Z.r},C,e)}break;case 214:case 516:case 4:C=Dh(Z.val,Z.ixfe,"s"),C.XF=K[C.ixfe],L>0&&(C.z=te[C.ixfe>>8&63]),ui(C,e,r.opts.Date1904),P({c:Z.c,r:Z.r},C,e);break;case 0:case 512:Q===1&&(c=Z);break;case 252:h=Z;break;case 1054:if(F.biff==4){te[L++]=Z[1];for(var Gr=0;Gr<L+163&&ot[Gr]!=Z[1];++Gr);Gr>=163&&el(Z[1],L+163)}else el(Z[1],Z[0]);break;case 30:{te[L++]=Z;for(var bn=0;bn<L+163&&ot[bn]!=Z;++bn);bn>=163&&el(Z,L+163)}break;case 229:we=we.concat(Z);break;case 93:Ce[Z.cmo[0]]=F.lastobj=Z;break;case 438:F.lastobj.TxO=Z;break;case 127:F.lastobj.ImData=Z;break;case 440:for(A=Z[0].s.r;A<=Z[0].e.r;++A)for(T=Z[0].s.c;T<=Z[0].e.c;++T)E=e.dense?(i[A]||[])[T]:i[tt({c:T,r:A})],E&&(E.l=Z[1]);break;case 2048:for(A=Z[0].s.r;A<=Z[0].e.r;++A)for(T=Z[0].s.c;T<=Z[0].e.c;++T)E=e.dense?(i[A]||[])[T]:i[tt({c:T,r:A})],E&&E.l&&(E.l.Tooltip=Z[1]);break;case 28:{if(F.biff<=5&&F.biff>=2)break;E=e.dense?(i[Z[0].r]||[])[Z[0].c]:i[tt(Z[0])];var ba=Ce[Z[2]];E||(e.dense?(i[Z[0].r]||(i[Z[0].r]=[]),E=i[Z[0].r][Z[0].c]={t:"z"}):E=i[tt(Z[0])]={t:"z"},c.e.r=Math.max(c.e.r,Z[0].r),c.s.r=Math.min(c.s.r,Z[0].r),c.e.c=Math.max(c.e.c,Z[0].c),c.s.c=Math.min(c.s.c,Z[0].c)),E.c||(E.c=[]),S={a:Z[1],t:ba.TxO.t},E.c.push(S)}break;case 2173:v9(K[Z.ixfe],Z.ext);break;case 125:{if(!F.cellStyles)break;for(;Z.e>=Z.s;)ne[Z.e--]={width:Z.w/256,level:Z.level||0,hidden:!!(Z.flags&1)},_e||(_e=!0,Rx(Z.w/256)),Ic(ne[Z.e+1])}break;case 520:{var er={};Z.level!=null&&(me[Z.r]=er,er.level=Z.level),Z.hidden&&(me[Z.r]=er,er.hidden=!0),Z.hpt&&(me[Z.r]=er,er.hpt=Z.hpt,er.hpx=Af(Z.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||uf(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Me]]=Z;break;case 161:i["!margins"]||uf(i["!margins"]={}),i["!margins"].header=Z.header,i["!margins"].footer=Z.footer;break;case 574:Z.RTL&&(b.Views[0].RTL=!0);break;case 146:Y=Z;break;case 2198:O=Z;break;case 140:G=Z;break;case 442:d?N.CodeName=Z||N.name:b.WBProps.CodeName=Z||"ThisWorkbook";break}}else Oe||console.error("Missing Info for XLS Record 0x"+Me.toString(16)),t.l+=Ie}return r.SheetNames=vi(o).sort(function(Cn,at){return Number(Cn)-Number(at)}).map(function(Cn){return o[Cn].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&m["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=m)):r.Preamble=m,r.Sheets&&J.forEach(function(Cn,at){r.Sheets[r.SheetNames[at]]["!autofilter"]=Cn}),r.Strings=h,r.SSF=en(ot),F.enc&&(r.Encryption=F.enc),O&&(r.Themes=O),r.Metadata={},G!==void 0&&(r.Metadata.Country=G),ae.names.length>0&&(b.Names=ae.names),r.Workbook=b,r}var HT={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function QB(t,e,r){var n=_t.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=bT(n,pF,HT.DSI);for(var o in i)e[o]=i[o]}catch(d){if(r.WTF)throw d}var c=_t.find(t,"/!SummaryInformation");if(c&&c.size>0)try{var u=bT(c,mF,HT.SI);for(var h in u)e[h]==null&&(e[h]=u[h])}catch(d){if(r.WTF)throw d}e.HeadingPairs&&e.TitlesOfParts&&(U4(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function Sb(t,e){e||(e={}),Ox(e),JA(),e.codepage&&fx(e.codepage);var r,n;if(t.FullPaths){if(_t.find(t,"/encryption"))throw new Error("File is password-protected");r=_t.find(t,"!CompObj"),n=_t.find(t,"/Workbook")||_t.find(t,"/Book")}else{switch(e.type){case"base64":t=za(aa(t));break;case"binary":t=za(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Jr(t,0),n={content:t}}var i,o;if(r&&YB(r),e.bookProps&&!e.bookSheets)i={};else{var c=vt?"buffer":"array";if(n&&n.content)i=$B(n.content,e);else if((o=_t.find(t,"PerfectOffice_MAIN"))&&o.content)i=lf.to_workbook(o.content,(e.type=c,e));else if((o=_t.find(t,"NativeContent_MAIN"))&&o.content)i=lf.to_workbook(o.content,(e.type=c,e));else throw(o=_t.find(t,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&_t.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=L9(t))}var u={};return t.FullPaths&&QB(t,u,e),i.Props=i.Custprops=u,e.bookFiles&&(i.cfb=t),i}var Sd={0:{f:N7},1:{f:L7},2:{f:q7},3:{f:U7},4:{f:B7},5:{f:G7},6:{f:X7},7:{f:z7},8:{f:Z7},9:{f:J7},10:{f:$7},11:{f:Q7},12:{f:P7},13:{f:W7},14:{f:j7},15:{f:V7},16:{f:vb},17:{f:K7},18:{f:H7},19:{f:Tx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:bB},40:{},42:{},43:{f:$L},44:{f:KL},45:{f:QL},46:{f:ZL},47:{f:JL},48:{},49:{f:eF},50:{},51:{f:_9},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:J4},62:{f:Y7},63:{f:A9},64:{f:lB},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:mn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:oB},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:M7},148:{f:O7,p:16},151:{f:rB},152:{},153:{f:wB},154:{},155:{},156:{f:SB},157:{},158:{},159:{T:1,f:mL},160:{T:-1},161:{T:1,f:gl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:eB},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:y9},336:{T:-1},337:{f:E9,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:r1},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Q4},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:nB},427:{f:aB},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:sB},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:F7},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:tB},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:r1},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:O9},633:{T:1},634:{T:-1},635:{T:1,f:N9},636:{T:-1},637:{f:rF},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:pB},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:cB},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},o1={6:{f:_g},10:{f:Gs},12:{f:Cr},13:{f:Cr},14:{f:gr},15:{f:gr},16:{f:fn},17:{f:gr},18:{f:gr},19:{f:Cr},20:{f:IT},21:{f:IT},23:{f:Q4},24:{f:NT},25:{f:gr},26:{},27:{},28:{f:IM},29:{},34:{f:gr},35:{f:DT},38:{f:fn},39:{f:fn},40:{f:fn},41:{f:fn},42:{f:gr},43:{f:gr},47:{f:FL},49:{f:fM},51:{f:Cr},60:{},61:{f:lM},64:{f:gr},65:{f:uM},66:{f:Cr},77:{},80:{},81:{},82:{},85:{f:Cr},89:{},90:{},91:{},92:{f:eM},93:{f:NM},94:{},95:{f:gr},96:{},97:{},99:{f:gr},125:{f:J4},128:{f:EM},129:{f:tM},130:{f:Cr},131:{f:gr},132:{f:gr},133:{f:rM},134:{},140:{f:BM},141:{f:Cr},144:{},146:{f:UM},151:{},152:{},153:{},154:{},155:{},156:{f:Cr},157:{},158:{},160:{f:qM},161:{f:zM},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:xM},190:{f:vM},193:{f:Gs},197:{},198:{},199:{},200:{},201:{},202:{f:gr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Cr},220:{},221:{f:gr},222:{},224:{f:_M},225:{f:ZF},226:{f:Gs},227:{},229:{f:DM},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:nM},253:{f:hM},255:{f:aM},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:q4},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:gr},353:{f:Gs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:SM},431:{f:gr},432:{},433:{},434:{},437:{},438:{f:MM},439:{f:gr},440:{f:LM},441:{},442:{f:Xf},443:{},444:{f:Cr},445:{},446:{},448:{f:Gs},449:{f:oM,r:2},450:{f:Gs},512:{f:RT},513:{f:GM},515:{f:TM},516:{f:dM},517:{f:kT},519:{f:WM},520:{f:iM},523:{},545:{f:OT},549:{f:CT},566:{},574:{f:cM},638:{f:gM},659:{},1048:{},1054:{f:pM},1084:{},1212:{f:CM},2048:{f:PM},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Rh},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Gs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:jM,r:12},2173:{f:x9,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:gr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:bM,r:12},2197:{},2198:{f:f9,r:12},2199:{},2200:{},2201:{},2202:{f:RM,r:12},2203:{f:Gs},2204:{},2205:{},2206:{},2207:{},2211:{f:sM},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Cr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:HM},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:VM},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:RT},1:{},2:{f:$M},3:{f:KM},4:{f:XM},5:{f:kT},7:{f:QM},8:{},9:{f:Rh},11:{},22:{f:Cr},30:{f:mM},31:{},32:{},33:{f:OT},36:{},37:{f:CT},50:{f:JM},62:{},52:{},67:{},68:{f:Cr},69:{},86:{},126:{},127:{f:YM},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:ZM},223:{},234:{},354:{},421:{},518:{f:_g},521:{f:Rh},536:{f:NT},547:{f:DT},561:{},579:{},1030:{f:_g},1033:{f:Rh},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Va(t,e,r,n){var i=e;if(!isNaN(i)){var o=(r||[]).length||0,c=t.next(4);c.write_shift(2,i),c.write_shift(2,o),o>0&&N4(r)&&t.push(r)}}function GT(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var o=t.match(/<\/table/i),c=i.index,u=o&&o.index||t.length,h=T8(t.slice(c,u),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,m=0,v=0,y=0,E={s:{r:1e7,c:1e7},e:{r:0,c:0}},S=[];for(c=0;c<h.length;++c){var T=h[c].trim(),A=T.slice(0,3).toLowerCase();if(A=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}m=0;continue}if(!(A!="<td"&&A!="<th")){var B=T.split(/<\/t[dh]>/i);for(u=0;u<B.length;++u){var I=B[u].trim();if(I.match(/<t[dh]/i)){for(var C=I,G=0;C.charAt(0)=="<"&&(G=C.indexOf(">"))>-1;)C=C.slice(G+1);for(var K=0;K<S.length;++K){var Y=S[K];Y.s.c==m&&Y.s.r<d&&d<=Y.e.r&&(m=Y.e.c+1,K=-1)}var b=$e(I.slice(0,I.indexOf(">")));y=b.colspan?+b.colspan:1,((v=+b.rowspan)>1||y>1)&&S.push({s:{r:d,c:m},e:{r:d+(v||1)-1,c:m+y-1}});var N=b.t||b["data-t"]||"";if(!C.length){m+=y;continue}if(C=y4(C),E.s.r>d&&(E.s.r=d),E.e.r<d&&(E.e.r=d),E.s.c>m&&(E.s.c=m),E.e.c<m&&(E.e.c=m),!C.length){m+=y;continue}var D={t:"s",v:C};r.raw||!C.trim().length||N=="s"||(C==="TRUE"?D={t:"b",v:!0}:C==="FALSE"?D={t:"b",v:!1}:isNaN($a(C))?isNaN(kc(C).getDate())||(D={t:"d",v:zr(C)},r.cellDates||(D={t:"n",v:An(D.v)}),D.z=r.dateNF||ot[14]):D={t:"n",v:$a(C)}),r.dense?(n[d]||(n[d]=[]),n[d][m]=D):n[tt({r:d,c:m})]=D,m+=y}}}}return n["!ref"]=Et(E),S.length&&(n["!merges"]=S),n}function JB(t,e,r,n){for(var i=t["!merges"]||[],o=[],c=e.s.c;c<=e.e.c;++c){for(var u=0,h=0,d=0;d<i.length;++d)if(!(i[d].s.r>r||i[d].s.c>c)&&!(i[d].e.r<r||i[d].e.c<c)){if(i[d].s.r<r||i[d].s.c<c){u=-1;break}u=i[d].e.r-i[d].s.r+1,h=i[d].e.c-i[d].s.c+1;break}if(!(u<0)){var m=tt({r,c}),v=n.dense?(t[r]||[])[c]:t[m],y=v&&v.v!=null&&(v.h||xx(v.w||(os(v),v.w)||""))||"",E={};u>1&&(E.rowspan=u),h>1&&(E.colspan=h),n.editable?y='<span contenteditable="true">'+y+"</span>":v&&(E["data-t"]=v&&v.t||"z",v.v!=null&&(E["data-v"]=v.v),v.z!=null&&(E["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+v.l.Target+'">'+y+"</a>")),E.id=(n.id||"sjs")+"-"+m,o.push(B8("td",y,E))}}var S="<tr>";return S+o.join("")+"</tr>"}var ZB='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',eV="</body></html>";function tV(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return _o(GT(r[0],e),e);var n=Mx();return r.forEach(function(i,o){Lx(n,GT(i,e),"Sheet"+(o+1))}),n}function rV(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function nV(t,e){var r=e||{},n=r.header!=null?r.header:ZB,i=r.footer!=null?r.footer:eV,o=[n],c=Hc(t["!ref"]);r.dense=Array.isArray(t),o.push(rV(t,c,r));for(var u=c.s.r;u<=c.e.r;++u)o.push(JB(t,c,u,r));return o.push("</table>"+i),o.join("")}function wb(t,e,r){var n=r||{},i=0,o=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?Sn(n.origin):n.origin;i=c.r,o=c.c}var u=e.getElementsByTagName("tr"),h=Math.min(n.sheetRows||1e7,u.length),d={s:{r:0,c:0},e:{r:i,c:o}};if(t["!ref"]){var m=Hc(t["!ref"]);d.s.r=Math.min(d.s.r,m.s.r),d.s.c=Math.min(d.s.c,m.s.c),d.e.r=Math.max(d.e.r,m.e.r),d.e.c=Math.max(d.e.c,m.e.c),i==-1&&(d.e.r=i=m.e.r+1)}var v=[],y=0,E=t["!rows"]||(t["!rows"]=[]),S=0,T=0,A=0,B=0,I=0,C=0;for(t["!cols"]||(t["!cols"]=[]);S<u.length&&T<h;++S){var G=u[S];if(qT(G)){if(n.display)continue;E[T]={hidden:!0}}var K=G.children;for(A=B=0;A<K.length;++A){var Y=K[A];if(!(n.display&&qT(Y))){var b=Y.hasAttribute("data-v")?Y.getAttribute("data-v"):Y.hasAttribute("v")?Y.getAttribute("v"):y4(Y.innerHTML),N=Y.getAttribute("data-z")||Y.getAttribute("z");for(y=0;y<v.length;++y){var D=v[y];D.s.c==B+o&&D.s.r<T+i&&T+i<=D.e.r&&(B=D.e.c+1-o,y=-1)}C=+Y.getAttribute("colspan")||1,((I=+Y.getAttribute("rowspan")||1)>1||C>1)&&v.push({s:{r:T+i,c:B+o},e:{r:T+i+(I||1)-1,c:B+o+(C||1)-1}});var U={t:"s",v:b},P=Y.getAttribute("data-t")||Y.getAttribute("t")||"";b!=null&&(b.length==0?U.t=P||"z":n.raw||b.trim().length==0||P=="s"||(b==="TRUE"?U={t:"b",v:!0}:b==="FALSE"?U={t:"b",v:!1}:isNaN($a(b))?isNaN(kc(b).getDate())||(U={t:"d",v:zr(b)},n.cellDates||(U={t:"n",v:An(U.v)}),U.z=n.dateNF||ot[14]):U={t:"n",v:$a(b)})),U.z===void 0&&N!=null&&(U.z=N);var F="",O=Y.getElementsByTagName("A");if(O&&O.length)for(var we=0;we<O.length&&!(O[we].hasAttribute("href")&&(F=O[we].getAttribute("href"),F.charAt(0)!="#"));++we);F&&F.charAt(0)!="#"&&(U.l={Target:F}),n.dense?(t[T+i]||(t[T+i]=[]),t[T+i][B+o]=U):t[tt({c:B+o,r:T+i})]=U,d.e.c<B+o&&(d.e.c=B+o),B+=C}}++T}return v.length&&(t["!merges"]=(t["!merges"]||[]).concat(v)),d.e.r=Math.max(d.e.r,T-1+i),t["!ref"]=Et(d),T>=h&&(t["!fullref"]=Et((d.e.r=u.length-S+T-1+i,d))),t}function Ab(t,e){var r=e||{},n=r.dense?[]:{};return wb(n,t,e)}function aV(t,e){return _o(Ab(t,e),e)}function qT(t){var e="",r=iV(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function iV(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function sV(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=wt(e.replace(/<[^>]*>/g,""));return[r]}var WT={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function bb(t,e){var r=e||{},n=vx(t),i=[],o,c,u={name:""},h="",d=0,m,v,y={},E=[],S=r.dense?[]:{},T,A,B={value:""},I="",C=0,G=[],K=-1,Y=-1,b={s:{r:1e6,c:1e7},e:{r:0,c:0}},N=0,D={},U=[],P={},F=0,O=0,we=[],Ce=1,ne=1,me=[],_e={Names:[]},ae={},Le=["",""],Q=[],L={},te="",J=0,ee=!1,xe=!1,Re=0;for(Tf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");T=Tf.exec(n);)switch(T[3]=T[3].replace(/_.*$/,"")){case"table":case"":T[1]==="/"?(b.e.c>=b.s.c&&b.e.r>=b.s.r?S["!ref"]=Et(b):S["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=b.e.r&&(S["!fullref"]=S["!ref"],b.e.r=r.sheetRows-1,S["!ref"]=Et(b)),U.length&&(S["!merges"]=U),we.length&&(S["!rows"]=we),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),E.push(m.name),y[m.name]=S,xe=!1):T[0].charAt(T[0].length-2)!=="/"&&(m=$e(T[0],!1),K=Y=-1,b.s.r=b.s.c=1e7,b.e.r=b.e.c=0,S=r.dense?[]:{},U=[],we=[],xe=!0);break;case"table-row-group":T[1]==="/"?--N:++N;break;case"table-row":case"":if(T[1]==="/"){K+=Ce,Ce=1;break}if(v=$e(T[0],!1),v.?K=v.-1:K==-1&&(K=0),Ce=+v["number-rows-repeated"]||1,Ce<10)for(Re=0;Re<Ce;++Re)N>0&&(we[K+Re]={level:N});Y=-1;break;case"covered-table-cell":T[1]!=="/"&&++Y,r.sheetStubs&&(r.dense?(S[K]||(S[K]=[]),S[K][Y]={t:"z"}):S[tt({r:K,c:Y})]={t:"z"}),I="",G=[];break;case"table-cell":case"":if(T[0].charAt(T[0].length-2)==="/")++Y,B=$e(T[0],!1),ne=parseInt(B["number-columns-repeated"]||"1",10),A={t:"z",v:null},B.formula&&r.cellFormula!=!1&&(A.f=UT(wt(B.formula))),(B.||B["value-type"])=="string"&&(A.t="s",A.v=wt(B["string-value"]||""),r.dense?(S[K]||(S[K]=[]),S[K][Y]=A):S[tt({r:K,c:Y})]=A),Y+=ne-1;else if(T[1]!=="/"){++Y,I="",C=0,G=[],ne=1;var Me=Ce?K+Ce-1:K;if(Y>b.e.c&&(b.e.c=Y),Y<b.s.c&&(b.s.c=Y),K<b.s.r&&(b.s.r=K),Me>b.e.r&&(b.e.r=Me),B=$e(T[0],!1),Q=[],L={},A={t:B.||B["value-type"],v:null},r.cellFormula)if(B.formula&&(B.formula=wt(B.formula)),B["number-matrix-columns-spanned"]&&B["number-matrix-rows-spanned"]&&(F=parseInt(B["number-matrix-rows-spanned"],10)||0,O=parseInt(B["number-matrix-columns-spanned"],10)||0,P={s:{r:K,c:Y},e:{r:K+F-1,c:Y+O-1}},A.F=Et(P),me.push([P,A.F])),B.formula)A.f=UT(B.formula);else for(Re=0;Re<me.length;++Re)K>=me[Re][0].s.r&&K<=me[Re][0].e.r&&Y>=me[Re][0].s.c&&Y<=me[Re][0].e.c&&(A.F=me[Re][1]);switch((B["number-columns-spanned"]||B["number-rows-spanned"])&&(F=parseInt(B["number-rows-spanned"],10)||0,O=parseInt(B["number-columns-spanned"],10)||0,P={s:{r:K,c:Y},e:{r:K+F-1,c:Y+O-1}},U.push(P)),B["number-columns-repeated"]&&(ne=parseInt(B["number-columns-repeated"],10)),A.t){case"boolean":A.t="b",A.v=nr(B["boolean-value"]);break;case"float":A.t="n",A.v=parseFloat(B.value);break;case"percentage":A.t="n",A.v=parseFloat(B.value);break;case"currency":A.t="n",A.v=parseFloat(B.value);break;case"date":A.t="d",A.v=zr(B["date-value"]),r.cellDates||(A.t="n",A.v=An(A.v)),A.z="m/d/yy";break;case"time":A.t="n",A.v=y8(B["time-value"])/86400,r.cellDates&&(A.t="d",A.v=$d(A.v)),A.z="HH:MM:SS";break;case"number":A.t="n",A.v=parseFloat(B.);break;default:if(A.t==="string"||A.t==="text"||!A.t)A.t="s",B["string-value"]!=null&&(I=wt(B["string-value"]),G=[]);else throw new Error("Unsupported value type "+A.t)}}else{if(ee=!1,A.t==="s"&&(A.v=I||"",G.length&&(A.R=G),ee=C==0),ae.Target&&(A.l=ae),Q.length>0&&(A.c=Q,Q=[]),I&&r.cellText!==!1&&(A.w=I),ee&&(A.t="z",delete A.v),(!ee||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=K))for(var Ie=0;Ie<Ce;++Ie){if(ne=parseInt(B["number-columns-repeated"]||"1",10),r.dense)for(S[K+Ie]||(S[K+Ie]=[]),S[K+Ie][Y]=Ie==0?A:en(A);--ne>0;)S[K+Ie][Y+ne]=en(A);else for(S[tt({r:K+Ie,c:Y})]=A;--ne>0;)S[tt({r:K+Ie,c:Y+ne})]=en(A);b.e.c<=Y&&(b.e.c=Y)}ne=parseInt(B["number-columns-repeated"]||"1",10),Y+=ne-1,ne=0,A={},I="",G=[]}ae={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(T[1]==="/"){if((o=i.pop())[0]!==T[3])throw"Bad state: "+o}else T[0].charAt(T[0].length-2)!=="/"&&i.push([T[3],!0]);break;case"annotation":if(T[1]==="/"){if((o=i.pop())[0]!==T[3])throw"Bad state: "+o;L.t=I,G.length&&(L.R=G),L.a=te,Q.push(L)}else T[0].charAt(T[0].length-2)!=="/"&&i.push([T[3],!1]);te="",J=0,I="",C=0,G=[];break;case"creator":T[1]==="/"?te=n.slice(J,T.index):J=T.index+T[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(T[1]==="/"){if((o=i.pop())[0]!==T[3])throw"Bad state: "+o}else T[0].charAt(T[0].length-2)!=="/"&&i.push([T[3],!1]);I="",C=0,G=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(T[1]==="/"){if(D[u.name]=h,(o=i.pop())[0]!==T[3])throw"Bad state: "+o}else T[0].charAt(T[0].length-2)!=="/"&&(h="",u=$e(T[0],!1),i.push([T[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":c=$e(T[0],!1),h+=WT[T[3]][c.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":c=$e(T[0],!1),h+=WT[T[3]][c.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(T[0].slice(-2)==="/>")break;if(T[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":h+=n.slice(d,T.index);break}else d=T.index+T[0].length;break;case"named-range":c=$e(T[0],!1),Le=Eg(c["cell-range-address"]);var Oe={Name:c.name,Ref:Le[0]+"!"+Le[1]};xe&&(Oe.Sheet=E.length),_e.Names.push(Oe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(T[1]==="/"&&(!B||!B["string-value"])){var ct=sV(n.slice(C,T.index));I=(I.length>0?I+`
`:"")+ct[0]}else $e(T[0],!1),C=T.index+T[0].length;break;case"s":break;case"database-range":if(T[1]==="/")break;try{Le=Eg($e(T[0])["target-range-address"]),y[Le[0]]["!autofilter"]={ref:Le[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(T[1]!=="/"){if(ae=$e(T[0],!1),!ae.href)break;ae.Target=wt(ae.href),delete ae.href,ae.Target.charAt(0)=="#"&&ae.Target.indexOf(".")>-1?(Le=Eg(ae.Target.slice(1)),ae.Target="#"+Le[0]+"!"+Le[1]):ae.Target.match(/^\.\.[\\\/]/)&&(ae.Target=ae.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(T[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(T)}}var Z={Sheets:y,SheetNames:E,Workbook:_e};return r.bookSheets&&delete Z.Sheets,Z}function YT(t,e){e=e||{},Ta(t,"META-INF/manifest.xml")&&TF(br(t,"META-INF/manifest.xml"),e);var r=ea(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=bb($t(r),e);return Ta(t,"meta.xml")&&(n.Props=V4(br(t,"meta.xml"))),n}function XT(t,e){return bb(t,e)}function Dx(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function l1(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):$t(pl(t))}function c1(t){var e=t.reduce(function(i,o){return i+o.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function KT(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function oV(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function bf(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Fr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function hn(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=bf(t,r),o=i&7;i=Math.floor(i/8);var c=0,u;if(i==0)break;switch(o){case 0:{for(var h=r[0];t[r[0]++]>=128;);u=t.slice(h,r[0])}break;case 5:c=4,u=t.slice(r[0],r[0]+c),r[0]+=c;break;case 1:c=8,u=t.slice(r[0],r[0]+c),r[0]+=c;break;case 2:c=bf(t,r),u=t.slice(r[0],r[0]+c),r[0]+=c;break;default:throw new Error("PB Type ".concat(o," for Field ").concat(i," at offset ").concat(n))}var d={data:u,type:o};e[i]==null?e[i]=[d]:e[i].push(d)}return e}function Nx(t,e){return t?.map(function(r){return e(r.data)})||[]}function lV(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=bf(t,n),o=hn(t.slice(n[0],n[0]+i));n[0]+=i;var c={id:Fr(o[1][0].data),messages:[]};o[2].forEach(function(u){var h=hn(u.data),d=Fr(h[3][0].data);c.messages.push({meta:h,data:t.slice(n[0],n[0]+d)}),n[0]+=d}),(e=o[3])!=null&&e[0]&&(c.merge=Fr(o[3][0].data)>>>0>0),r.push(c)}return r}function cV(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=bf(e,r),i=[];r[0]<e.length;){var o=e[r[0]]&3;if(o==0){var c=e[r[0]++]>>2;if(c<60)++c;else{var u=c-59;c=e[r[0]],u>1&&(c|=e[r[0]+1]<<8),u>2&&(c|=e[r[0]+2]<<16),u>3&&(c|=e[r[0]+3]<<24),c>>>=0,c++,r[0]+=u}i.push(e.slice(r[0],r[0]+c)),r[0]+=c;continue}else{var h=0,d=0;if(o==1?(d=(e[r[0]]>>2&7)+4,h=(e[r[0]++]&224)<<3,h|=e[r[0]++]):(d=(e[r[0]++]>>2)+1,o==2?(h=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(h=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[c1(i)],h==0)throw new Error("Invalid offset 0");if(h>i[0].length)throw new Error("Invalid offset beyond length");if(d>=h)for(i.push(i[0].slice(-h)),d-=h;d>=i[i.length-1].length;)i.push(i[i.length-1]),d-=i[i.length-1].length;i.push(i[0].slice(-h,-h+d))}}var m=c1(i);if(m.length!=n)throw new Error("Unexpected length: ".concat(m.length," != ").concat(n));return m}function uV(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(cV(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return c1(e)}function fV(t,e,r,n){var i=Dx(t),o=i.getUint32(4,!0),c=(n>1?12:8)+KT(o&(n>1?3470:398))*4,u=-1,h=-1,d=NaN,m=new Date(2001,0,1);o&512&&(u=i.getUint32(c,!0),c+=4),c+=KT(o&(n>1?12288:4096))*4,o&16&&(h=i.getUint32(c,!0),c+=4),o&32&&(d=i.getFloat64(c,!0),c+=8),o&64&&(m.setTime(m.getTime()+i.getFloat64(c,!0)*1e3),c+=8);var v;switch(t[2]){case 0:break;case 2:v={t:"n",v:d};break;case 3:v={t:"s",v:e[h]};break;case 5:v={t:"d",v:m};break;case 6:v={t:"b",v:d>0};break;case 7:v={t:"n",v:d/86400};break;case 8:v={t:"e",v:0};break;case 9:if(u>-1)v={t:"s",v:r[u]};else if(h>-1)v={t:"s",v:e[h]};else if(!isNaN(d))v={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return v}function hV(t,e,r){var n=Dx(t),i=n.getUint32(8,!0),o=12,c=-1,u=-1,h=NaN,d=NaN,m=new Date(2001,0,1);i&1&&(h=oV(t,o),o+=16),i&2&&(d=n.getFloat64(o,!0),o+=8),i&4&&(m.setTime(m.getTime()+n.getFloat64(o,!0)*1e3),o+=8),i&8&&(u=n.getUint32(o,!0),o+=4),i&16&&(c=n.getUint32(o,!0),o+=4);var v;switch(t[1]){case 0:break;case 2:v={t:"n",v:h};break;case 3:v={t:"s",v:e[u]};break;case 5:v={t:"d",v:m};break;case 6:v={t:"b",v:d>0};break;case 7:v={t:"n",v:d/86400};break;case 8:v={t:"e",v:0};break;case 9:if(c>-1)v={t:"s",v:r[c]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:v={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return v}function dV(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return fV(t,e,r,t[0]);case 5:return hV(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function so(t){var e=hn(t);return bf(e[1][0].data)}function $T(t,e){var r=hn(e.data),n=Fr(r[1][0].data),i=r[3],o=[];return(i||[]).forEach(function(c){var u=hn(c.data),h=Fr(u[1][0].data)>>>0;switch(n){case 1:o[h]=l1(u[3][0].data);break;case 8:{var d=t[so(u[9][0].data)][0],m=hn(d.data),v=t[so(m[1][0].data)][0],y=Fr(v.meta[1][0].data);if(y!=2001)throw new Error("2000 unexpected reference to ".concat(y));var E=hn(v.data);o[h]=E[3].map(function(S){return l1(S.data)}).join("")}break}}),o}function pV(t,e){var r,n,i,o,c,u,h,d,m,v,y,E,S,T,A=hn(t),B=Fr(A[1][0].data)>>>0,I=Fr(A[2][0].data)>>>0,C=((n=(r=A[8])==null?void 0:r[0])==null?void 0:n.data)&&Fr(A[8][0].data)>0||!1,G,K;if((o=(i=A[7])==null?void 0:i[0])!=null&&o.data&&e!=0)G=(u=(c=A[7])==null?void 0:c[0])==null?void 0:u.data,K=(d=(h=A[6])==null?void 0:h[0])==null?void 0:d.data;else if((v=(m=A[4])==null?void 0:m[0])!=null&&v.data&&e!=1)G=(E=(y=A[4])==null?void 0:y[0])==null?void 0:E.data,K=(T=(S=A[3])==null?void 0:S[0])==null?void 0:T.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var Y=C?4:1,b=Dx(G),N=[],D=0;D<G.length/2;++D){var U=b.getUint16(D*2,!0);U<65535&&N.push([D,U])}if(N.length!=I)throw"Expected ".concat(I," cells, found ").concat(N.length);var P=[];for(D=0;D<N.length-1;++D)P[N[D][0]]=K.subarray(N[D][1]*Y,N[D+1][1]*Y);return N.length>=1&&(P[N[N.length-1][0]]=K.subarray(N[N.length-1][1]*Y)),{R:B,cells:P}}function mV(t,e){var r,n=hn(e.data),i=(r=n?.[7])!=null&&r[0]?Fr(n[7][0].data)>>>0>0?1:0:-1,o=Nx(n[5],function(c){return pV(c,i)});return{nrows:Fr(n[4][0].data)>>>0,data:o.reduce(function(c,u){return c[u.R]||(c[u.R]=[]),u.cells.forEach(function(h,d){if(c[u.R][d])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(d));c[u.R][d]=h}),c},[])}}function gV(t,e,r){var n,i=hn(e.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(Fr(i[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(o.e.c=(Fr(i[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=Et(o);var c=hn(i[4][0].data),u=$T(t,t[so(c[4][0].data)][0]),h=(n=c[17])!=null&&n[0]?$T(t,t[so(c[17][0].data)][0]):[],d=hn(c[3][0].data),m=0;d[1].forEach(function(v){var y=hn(v.data),E=t[so(y[2][0].data)][0],S=Fr(E.meta[1][0].data);if(S!=6002)throw new Error("6001 unexpected reference to ".concat(S));var T=mV(t,E);T.data.forEach(function(A,B){A.forEach(function(I,C){var G=tt({r:m+B,c:C}),K=dV(I,u,h);K&&(r[G]=K)})}),m+=T.nrows})}function xV(t,e){var r=hn(e.data),n={"!ref":"A1"},i=t[so(r[2][0].data)],o=Fr(i[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return gV(t,i[0],n),n}function vV(t,e){var r,n=hn(e.data),i={name:(r=n[1])!=null&&r[0]?l1(n[1][0].data):"",sheets:[]},o=Nx(n[2],so);return o.forEach(function(c){t[c].forEach(function(u){var h=Fr(u.meta[1][0].data);h==6e3&&i.sheets.push(xV(t,u))})}),i}function yV(t,e){var r=Mx(),n=hn(e.data),i=Nx(n[1],so);if(i.forEach(function(o){t[o].forEach(function(c){var u=Fr(c.meta[1][0].data);if(u==2){var h=vV(t,c);h.sheets.forEach(function(d,m){Lx(r,d,m==0?h.name:h.name+"_"+m,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Sg(t){var e,r,n,i,o={},c=[];if(t.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var d;try{d=uV(h.content)}catch(v){return console.log("?? "+h.content.length+" "+(v.message||v))}var m;try{m=lV(d)}catch(v){return console.log("## "+(v.message||v))}m.forEach(function(v){o[v.id]=v.messages,c.push(v.id)})}}),!c.length)throw new Error("File has no messages");var u=((i=(n=(r=(e=o?.[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Fr(o[1][0].meta[1][0].data)==1&&o[1][0];if(u||c.forEach(function(h){o[h].forEach(function(d){var m=Fr(d.meta[1][0].data)>>>0;if(m==1)if(!u)u=d;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return yV(o,u)}function _V(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function Ox(t){_V([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function EV(t){return fc.WS.indexOf(t)>-1?"sheet":t==fc.CS?"chart":t==fc.DS?"dialog":t==fc.MS?"macro":t&&t.length?t:"sheet"}function TV(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,EV(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function SV(t,e,r,n,i,o,c,u,h,d,m,v){try{o[n]=sf(ea(t,r,!0),e);var y=br(t,e),E;switch(u){case"sheet":E=kB(y,e,i,h,o[n],d,m,v);break;case"chart":if(E=IB(y,e,i,h,o[n],d,m,v),!E||!E["!drawel"])break;var S=Yu(E["!drawel"].Target,e),T=n1(S),A=R9(ea(t,S,!0),sf(ea(t,T,!0),S)),B=Yu(A,S),I=n1(B);E=hB(ea(t,B,!0),B,h,sf(ea(t,I,!0),B),d,E);break;case"macro":E=DB(y,e,i,h,o[n],d,m,v);break;case"dialog":E=NB(y,e,i,h,o[n],d,m,v);break;default:throw new Error("Unrecognized sheet type "+u)}c[n]=E;var C=[];o&&o[n]&&vi(o[n]).forEach(function(G){var K="";if(o[n][G].Type==fc.CMNT){K=Yu(o[n][G].Target,e);var Y=LB(br(t,K,!0),K,h);if(!Y||!Y.length)return;MT(E,Y,!1)}o[n][G].Type==fc.TCMNT&&(K=Yu(o[n][G].Target,e),C=C.concat(I9(br(t,K,!0),h)))}),C&&C.length&&MT(E,C,!0,h.people||[])}catch(G){if(h.WTF)throw G}}function _a(t){return t.charAt(0)=="/"?t.slice(1):t}function wV(t,e){if(u4(),e=e||{},Ox(e),Ta(t,"META-INF/manifest.xml")||Ta(t,"objectdata.xml"))return YT(t,e);if(Ta(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Sg<"u"){if(t.FileIndex)return Sg(t);var r=_t.utils.cfb_new();return lT(t).forEach(function(we){A8(r,we,w8(t,we))}),Sg(r)}throw new Error("Unsupported NUMBERS file")}if(!Ta(t,"[Content_Types].xml"))throw Ta(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ta(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=lT(t),i=_F(ea(t,"[Content_Types].xml")),o=!1,c,u;if(i.workbooks.length===0&&(u="xl/workbook.xml",br(t,u,!0)&&i.workbooks.push(u)),i.workbooks.length===0){if(u="xl/workbook.bin",!br(t,u,!0))throw new Error("Could not find workbook");i.workbooks.push(u),o=!0}i.workbooks[0].slice(-3)=="bin"&&(o=!0);var h={},d={};if(!e.bookSheets&&!e.bookProps){if(cf=[],i.sst)try{cf=MB(br(t,_a(i.sst)),i.sst,e)}catch(we){if(e.WTF)throw we}e.cellStyles&&i.themes.length&&(h=FB(ea(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(d=OB(br(t,_a(i.style)),i.style,h,e))}i.links.map(function(we){try{var Ce=sf(ea(t,n1(_a(we))),we);return BB(br(t,_a(we)),Ce,we,e)}catch{}});var m=RB(br(t,_a(i.workbooks[0])),i.workbooks[0],e),v={},y="";i.coreprops.length&&(y=br(t,_a(i.coreprops[0]),!0),y&&(v=V4(y)),i.extprops.length!==0&&(y=br(t,_a(i.extprops[0]),!0),y&&AF(y,v,e)));var E={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(y=ea(t,_a(i.custprops[0]),!0),y&&(E=CF(y,e)));var S={};if((e.bookSheets||e.bookProps)&&(m.Sheets?c=m.Sheets.map(function(Ce){return Ce.name}):v.Worksheets&&v.SheetNames.length>0&&(c=v.SheetNames),e.bookProps&&(S.Props=v,S.Custprops=E),e.bookSheets&&typeof c<"u"&&(S.SheetNames=c),e.bookSheets?S.SheetNames:e.bookProps))return S;c={};var T={};e.bookDeps&&i.calcchain&&(T=PB(br(t,_a(i.calcchain)),i.calcchain));var A=0,B={},I,C;{var G=m.Sheets;v.Worksheets=G.length,v.SheetNames=[];for(var K=0;K!=G.length;++K)v.SheetNames[K]=G[K].name}var Y=o?"bin":"xml",b=i.workbooks[0].lastIndexOf("/"),N=(i.workbooks[0].slice(0,b+1)+"_rels/"+i.workbooks[0].slice(b+1)+".rels").replace(/^\//,"");Ta(t,N)||(N="xl/_rels/workbook."+Y+".rels");var D=sf(ea(t,N,!0),N.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=VB(br(t,_a(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=D9(br(t,_a(i.people[0])),e)),D&&(D=TV(D,m.Sheets));var U=br(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(A=0;A!=v.Worksheets;++A){var P="sheet";if(D&&D[A]?(I="xl/"+D[A][1].replace(/[\/]?xl\//,""),Ta(t,I)||(I=D[A][1]),Ta(t,I)||(I=N.replace(/_rels\/.*$/,"")+D[A][1]),P=D[A][2]):(I="xl/worksheets/sheet"+(A+1-U)+"."+Y,I=I.replace(/sheet0\./,"sheet.")),C=I.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(A!=e.sheets)continue e;break;case"string":if(v.SheetNames[A].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var F=!1,O=0;O!=e.sheets.length;++O)typeof e.sheets[O]=="number"&&e.sheets[O]==A&&(F=1),typeof e.sheets[O]=="string"&&e.sheets[O].toLowerCase()==v.SheetNames[A].toLowerCase()&&(F=1);if(!F)continue e}}SV(t,I,C,v.SheetNames[A],A,B,c,P,e,m,h,d)}return S={Directory:i,Workbook:m,Props:v,Custprops:E,Deps:T,Sheets:c,SheetNames:v.SheetNames,Strings:cf,Styles:d,Themes:h,SSF:en(ot)},e&&e.bookFiles&&(t.files?(S.keys=n,S.files=t.files):(S.keys=[],S.files={},t.FullPaths.forEach(function(we,Ce){we=we.replace(/^Root Entry[\/]/,""),S.keys.push(we),S.files[we]=t.FileIndex[Ce]}))),e&&e.bookVBA&&(i.vba.length>0?S.vbaraw=br(t,_a(i.vba[0]),!0):i.defaults&&i.defaults.bin===M9&&(S.vbaraw=br(t,"xl/vbaProject.bin",!0))),S}function AV(t,e){var r=e||{},n="Workbook",i=_t.find(t,n);try{if(n="/!DataSpaces/Version",i=_t.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(xL(i.content),n="/!DataSpaces/DataSpaceMap",i=_t.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=yL(i.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=_t.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=_L(i.content);if(c.length!=1||c[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=_t.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);TL(i.content)}catch{}if(n="/EncryptionInfo",i=_t.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=SL(i.content);if(n="/EncryptedPackage",i=_t.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],i.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function Fx(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=aa(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function bV(t,e){return _t.find(t,"EncryptedPackage")?AV(t,e):Sb(t,e)}function CV(t,e){var r,n=t,i=e||{};return i.type||(i.type=vt&&Buffer.isBuffer(t)?"buffer":"base64"),r=g4(n,i),wV(r,i)}function Cb(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return s1(t.slice(r),e);default:break e}return Sf.to_workbook(t,e)}function RV(t,e){var r="",n=Fx(t,e);switch(e.type){case"base64":r=aa(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=ll(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=$t(r)),e.type="binary",Cb(r,e)}function kV(t,e){var r=t;return e.type=="base64"&&(r=aa(r)),r=yf.utils.decode(1200,r.slice(2),"str"),e.type="binary",Cb(r,e)}function IV(t){return t.match(/[^\x00-\x7F]/)?Xu(t):t}function wg(t,e,r,n){return n?(r.type="string",Sf.to_workbook(t,r)):Sf.to_workbook(e,r)}function u1(t,e){JA();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return u1(new Uint8Array(t),(r=en(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],o=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),vc={},r.dateNF&&(vc.dateNF=r.dateNF),r.type||(r.type=vt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=vt?"buffer":"binary",n=x8(t),typeof Uint8Array<"u"&&!vt&&(r.type="array")),r.type=="string"&&(o=!0,r.type="binary",r.codepage=65001,n=IV(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var c=new ArrayBuffer(3),u=new Uint8Array(c);if(u.foo="bar",!u.foo)return r=en(r),r.type="array",u1(hx(n),r)}switch((i=Fx(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return bV(_t.read(n,r),r);break;case 9:if(i[1]<=8)return Sb(n,r);break;case 60:return s1(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return aL(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return rL.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?CV(n,r):wg(t,n,r,o);case 239:return i[3]===60?s1(n,r):wg(t,n,r,o);case 255:if(i[1]===254)return kV(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return lf.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return lf.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return FT.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return ML.to_workbook(n,r);break;case 10:case 13:case 32:return RV(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return eL.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?FT.to_workbook(n,r):wg(t,n,r,o)}function DV(t,e,r,n,i,o,c,u){var h=tn(r),d=u.defval,m=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),v=!0,y=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:r,enumerable:!1})}catch{y.__rowNum__=r}else y.__rowNum__=r;if(!c||t[r])for(var E=e.s.c;E<=e.e.c;++E){var S=c?t[r][E]:t[n[E]+h];if(S===void 0||S.t===void 0){if(d===void 0)continue;o[E]!=null&&(y[o[E]]=d);continue}var T=S.v;switch(S.t){case"z":if(T==null)break;continue;case"e":T=T==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+S.t)}if(o[E]!=null){if(T==null)if(S.t=="e"&&T===null)y[o[E]]=null;else if(d!==void 0)y[o[E]]=d;else if(m&&T===null)y[o[E]]=null;else continue;else y[o[E]]=m&&(S.t!=="n"||S.t==="n"&&u.rawNumbers!==!1)?T:os(S,T,u);T!=null&&(v=!1)}}return{row:y,isempty:v}}function f1(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,o=[],c=0,u="",h={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},m=d.range!=null?d.range:t["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof m){case"string":h=hr(m);break;case"number":h=hr(t["!ref"]),h.s.r=m;break;default:h=m}n>0&&(i=0);var v=tn(h.s.r),y=[],E=[],S=0,T=0,A=Array.isArray(t),B=h.s.r,I=0,C={};A&&!t[B]&&(t[B]=[]);var G=d.skipHidden&&t["!cols"]||[],K=d.skipHidden&&t["!rows"]||[];for(I=h.s.c;I<=h.e.c;++I)if(!(G[I]||{}).hidden)switch(y[I]=Nr(I),r=A?t[B][I]:t[y[I]+v],n){case 1:o[I]=I-h.s.c;break;case 2:o[I]=y[I];break;case 3:o[I]=d.header[I-h.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=c=os(r,null,d),T=C[c]||0,!T)C[c]=1;else{do u=c+"_"+T++;while(C[u]);C[c]=T,C[u]=1}o[I]=u}for(B=h.s.r+i;B<=h.e.r;++B)if(!(K[B]||{}).hidden){var Y=DV(t,h,B,y,n,o,A,d);(Y.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(E[S++]=Y.row)}return E.length=S,E}var QT=/"/g;function NV(t,e,r,n,i,o,c,u){for(var h=!0,d=[],m="",v=tn(r),y=e.s.c;y<=e.e.c;++y)if(n[y]){var E=u.dense?(t[r]||[])[y]:t[n[y]+v];if(E==null)m="";else if(E.v!=null){h=!1,m=""+(u.rawNumbers&&E.t=="n"?E.v:os(E,null,u));for(var S=0,T=0;S!==m.length;++S)if((T=m.charCodeAt(S))===i||T===o||T===34||u.forceQuotes){m='"'+m.replace(QT,'""')+'"';break}m=="ID"&&(m='"ID"')}else E.f!=null&&!E.F?(h=!1,m="="+E.f,m.indexOf(",")>=0&&(m='"'+m.replace(QT,'""')+'"')):m="";d.push(m)}return u.blankrows===!1&&h?null:d.join(c)}function Rb(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=hr(t["!ref"]),o=n.FS!==void 0?n.FS:",",c=o.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,h=u.charCodeAt(0),d=new RegExp((o=="|"?"\\|":o)+"+$"),m="",v=[];n.dense=Array.isArray(t);for(var y=n.skipHidden&&t["!cols"]||[],E=n.skipHidden&&t["!rows"]||[],S=i.s.c;S<=i.e.c;++S)(y[S]||{}).hidden||(v[S]=Nr(S));for(var T=0,A=i.s.r;A<=i.e.r;++A)(E[A]||{}).hidden||(m=NV(t,i,A,v,c,h,o,n),m!=null&&(n.strip&&(m=m.replace(d,"")),(m||n.blankrows!==!1)&&r.push((T++?u:"")+m)));return delete n.dense,r.join("")}function OV(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=Rb(t,e);return r}function FV(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=hr(t["!ref"]),o="",c=[],u,h=[],d=Array.isArray(t);for(u=i.s.c;u<=i.e.c;++u)c[u]=Nr(u);for(var m=i.s.r;m<=i.e.r;++m)for(o=tn(m),u=i.s.c;u<=i.e.c;++u)if(e=c[u]+o,r=d?(t[m]||[])[u]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}h[h.length]=e+"="+n}return h}function kb(t,e,r){var n=r||{},i=+!n.skipHeader,o=t||{},c=0,u=0;if(o&&n.origin!=null)if(typeof n.origin=="number")c=n.origin;else{var h=typeof n.origin=="string"?Sn(n.origin):n.origin;c=h.r,u=h.c}var d,m={s:{c:0,r:0},e:{c:u,r:c+e.length-1+i}};if(o["!ref"]){var v=hr(o["!ref"]);m.e.c=Math.max(m.e.c,v.e.c),m.e.r=Math.max(m.e.r,v.e.r),c==-1&&(c=v.e.r+1,m.e.r=c+e.length-1+i)}else c==-1&&(c=0,m.e.r=e.length-1+i);var y=n.header||[],E=0;e.forEach(function(T,A){vi(T).forEach(function(B){(E=y.indexOf(B))==-1&&(y[E=y.length]=B);var I=T[B],C="z",G="",K=tt({c:u+E,r:c+A+i});d=Cf(o,K),I&&typeof I=="object"&&!(I instanceof Date)?o[K]=I:(typeof I=="number"?C="n":typeof I=="boolean"?C="b":typeof I=="string"?C="s":I instanceof Date?(C="d",n.cellDates||(C="n",I=An(I)),G=n.dateNF||ot[14]):I===null&&n.nullError&&(C="e",I=0),d?(d.t=C,d.v=I,delete d.w,delete d.R,G&&(d.z=G)):o[K]=d={t:C,v:I},G&&(d.z=G))})}),m.e.c=Math.max(m.e.c,u+y.length-1);var S=tn(c);if(i)for(E=0;E<y.length;++E)o[Nr(E+u)+S]={t:"s",v:y[E]};return o["!ref"]=Et(m),o}function MV(t,e){return kb(null,t,e)}function Cf(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Sn(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Cf(t,tt(e)):Cf(t,tt({r:e,c:r||0}))}function LV(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Mx(){return{SheetNames:[],Sheets:{}}}function Lx(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var o=r.match(/(^.*?)(\d+)$/);i=o&&+o[2]||0;var c=o&&o[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=c+i)!=-1;++i);}if(_B(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function PV(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=LV(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function BV(t,e){return t.z=e,t}function Ib(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function VV(t,e,r){return Ib(t,"#"+e,r)}function UV(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function jV(t,e,r,n){for(var i=typeof e!="string"?e:hr(e),o=typeof e=="string"?e:Et(e),c=i.s.r;c<=i.e.r;++c)for(var u=i.s.c;u<=i.e.c;++u){var h=Cf(t,c,u);h.t="n",h.F=o,delete h.v,c==i.s.r&&u==i.s.c&&(h.f=r,n&&(h.D=!0))}return t}var zV={encode_col:Nr,encode_row:tn,encode_cell:tt,encode_range:Et,decode_col:Ex,decode_row:_x,split_cell:Z8,decode_cell:Sn,decode_range:Hc,format_cell:os,sheet_add_aoa:F4,sheet_add_json:kb,sheet_add_dom:wb,aoa_to_sheet:Gc,json_to_sheet:MV,table_to_sheet:Ab,table_to_book:aV,sheet_to_csv:Rb,sheet_to_txt:OV,sheet_to_json:f1,sheet_to_html:nV,sheet_to_formulae:FV,sheet_to_row_object_array:f1,sheet_get_cell:Cf,book_new:Mx,book_append_sheet:Lx,book_set_sheet_visibility:PV,cell_set_number_format:BV,cell_set_hyperlink:Ib,cell_set_internal_link:VV,cell_add_comment:UV,sheet_set_array_formula:jV,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function HV(){const t=sa(),[e,r]=se.useState(!1),[n,i]=se.useState(""),[o,c]=se.useState("debt"),u=d=>{if(!n){alert("Please enter the Bank Name first."),d.target.value="";return}const m=d.target.files[0];if(!m)return;r(!0);const v=new FileReader;v.onload=y=>{try{const E=y.target.result,S=u1(E,{type:"binary"}),T=S.SheetNames[0],A=S.Sheets[T],B=zV.sheet_to_json(A);h(B)}catch(E){console.error(E),alert("Error parsing file."),r(!1)}},v.readAsBinaryString(m)},h=async d=>{if(!d||d.length===0){alert("No data found."),r(!1);return}const m=d[0],v=Object.keys(m);let y=v.find(K=>/Month & Year/i.test(K)),E=v.find(K=>/Total Monthly Payment/i.test(K)),S=v.find(K=>/Principal Component/i.test(K)),T=v.find(K=>/Interest Component/i.test(K)),A=v.find(K=>/Outstanding Principal|Balance/i.test(K));if(!y||!E){alert(`Could not detect columns. Found: ${v.join(", ")}`),r(!1);return}const B=d.map(K=>{let Y=K[y],b;try{typeof Y=="number"&&Y>2e4?b=new Date((Y-25569)*86400*1e3).toISOString():b=new Date(Y).toISOString()}catch{b=new Date().toISOString()}return{uid:sr.currentUser?.uid,bank:n,date:b,amount:parseFloat(K[E])||0,principal:parseFloat(K[S])||0,interest:parseFloat(K[T])||0,balance:parseFloat(K[A])||0,category:o,originalRow:JSON.stringify(K),createdAt:new Date().toISOString()}}).filter(K=>K.amount>0),I=Cc(It),C=Zr(It,"emis");let G=0;B.forEach(K=>{if(G<490){const Y=ra(C);I.set(Y,K),G++}});try{await I.commit(),alert(`Successfully imported ${G} records for ${n}!`),t("/tracker")}catch(K){console.error("Firestore Save Error:",K),alert("Error saving to cloud: "+K.message)}finally{r(!1)}};return R.jsxs("div",{className:"container fade-in",children:[R.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"32px",gap:"16px"},children:[R.jsx("div",{onClick:()=>t("/dashboard"),style:{width:"48px",height:"48px",borderRadius:"16px",background:"rgba(255,255,255,0.05)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",border:"1px solid rgba(255,255,255,0.1)"},children:R.jsx("span",{style:{fontSize:"20px"},children:""})}),R.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700"},children:"Upload Data"})]}),R.jsxs("div",{className:"glass-card",style:{padding:"28px"},children:[R.jsxs("div",{style:{marginBottom:"24px"},children:[R.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"rgba(255,255,255,0.5)",textTransform:"uppercase"},children:"Bank / Institution Name"}),R.jsx("input",{type:"text",placeholder:"e.g. HDFC Home Loan",value:n,onChange:d=>i(d.target.value),style:{marginBottom:0}})]}),R.jsxs("div",{style:{marginBottom:"24px"},children:[R.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"rgba(255,255,255,0.5)",textTransform:"uppercase"},children:"Category"}),R.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"8px"},children:["debt","planned","investment"].map(d=>R.jsx("button",{onClick:()=>c(d),className:"btn-secondary",style:{background:o===d?"#fff":"rgba(255,255,255,0.05)",color:o===d?"#000":"rgba(255,255,255,0.6)",padding:"12px 0",borderRadius:"12px",fontSize:"12px",textTransform:"capitalize",border:o===d?"1px solid #fff":"1px solid transparent"},children:d==="debt"?"Loan / Debt":d==="planned"?"Planned Exp":"Investment"},d))})]}),R.jsxs("div",{style:{marginBottom:"8px"},children:[R.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"rgba(255,255,255,0.5)",textTransform:"uppercase"},children:"Select Schedule File (CSV/XLSX)"}),R.jsxs("div",{style:{border:"2px dashed rgba(255,255,255,0.1)",borderRadius:"24px",padding:"60px 20px",textAlign:"center",position:"relative",background:"rgba(0,0,0,0.15)",transition:"all 0.3s ease"},children:[R.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:""}),R.jsx("p",{style:{margin:0,fontWeight:"700",fontSize:"18px",color:"#fff"},children:e?"Processing Cloud Sync...":"Tap or Drop File"}),R.jsx("p",{style:{margin:"8px 0 0",fontSize:"14px",color:"rgba(255,255,255,0.4)"},children:"Supports XLS, XLSX and CSV formats"}),R.jsx("input",{type:"file",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",onChange:u,style:{opacity:0,position:"absolute",top:0,left:0,width:"100%",height:"100%",cursor:"pointer"},disabled:e})]})]})]})]})}function GV(){const t=sa(),[e,r]=se.useState([]),[n,i]=se.useState(new Date().getFullYear()),[o,c]=se.useState(new Date().getMonth()),[u,h]=se.useState(!0),d=async(I,C)=>{try{const G=ra(It,"emis",I);await Jo(G,{status:C==="paid"?"unpaid":"paid"})}catch(G){console.error("Error updating status:",G)}};se.useEffect(()=>{const I=sr.onAuthStateChanged(C=>{if(!C)return;const G=Xa(Zr(It,"emis"),Pn("uid","==",C.uid)),K=Ji(G,Y=>{const b=Y.docs.map(N=>({id:N.id,...N.data()}));r(b),h(!1)},Y=>{console.error("Firestore Error:",Y),h(!1)});return()=>K()});return()=>I()},[]);const m=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],y=e.filter(I=>{try{const C=new Date(I.date);return isNaN(C.getTime())?!1:C.getFullYear()===parseInt(n)&&C.getMonth()===o}catch{return!1}}),E=y.reduce((I,C)=>I+(parseFloat(C.amount)||0),0),S=y.filter(I=>I.status==="paid"||I.status===void 0&&new Date(I.date)<=new Date).reduce((I,C)=>I+(parseFloat(C.amount)||0),0),T=new Date().getFullYear(),A=new Set(e.map(I=>{try{return new Date(I.date).getFullYear()}catch{return T}}));A.add(T),A.add(n);const B=[...A].sort().filter(I=>!isNaN(I)&&I>1900&&I<2100);return R.jsxs("div",{className:"container fade-in",style:{paddingBottom:"100px"},children:[R.jsx("div",{style:{display:"flex",alignItems:"center",marginBottom:"32px",justifyContent:"space-between"},children:R.jsx("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:R.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700"},children:"My Tracker"})})}),R.jsxs("div",{className:"glass-card",style:{marginBottom:"32px",padding:"24px"},children:[R.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[R.jsx("p",{style:{fontSize:"12px",fontWeight:"700",color:"rgba(255,255,255,0.5)",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Analysis period"}),R.jsx("select",{value:n,onChange:I=>i(parseInt(I.target.value)),style:{width:"auto",padding:"6px 16px",fontSize:"14px",background:"rgba(255,255,255,0.1)",border:"none",marginBottom:0,height:"36px"},children:B.map(I=>R.jsx("option",{value:I,style:{background:"#222"},children:I},I))})]}),R.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"10px"},children:[0,1,2].map(I=>{const C=new Date,G=new Date(C.getFullYear(),C.getMonth()+I,1),K=G.getMonth(),Y=G.getFullYear(),b=m[K],N=o===K&&n===Y;return R.jsxs("div",{onClick:()=>{c(K),i(Y)},style:{padding:"12px 0",textAlign:"center",borderRadius:"14px",fontSize:"13px",fontWeight:N?"700":"500",cursor:"pointer",background:N?"#fff":"rgba(255,255,255,0.05)",color:N?"#000":"rgba(255,255,255,0.6)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",border:N?"1px solid #fff":"1px solid transparent",transform:N?"scale(1.02)":"scale(1)"},children:[b," ",Y!==new Date().getFullYear()?Y:""]},`${K}-${Y}`)})})]}),R.jsx("div",{className:"glass-card",style:{marginBottom:"32px",background:"linear-gradient(135deg, rgba(74, 222, 128, 0.15) 0%, rgba(255,255,255,0.02) 100%)",borderLeft:"8px solid #4ade80",padding:"28px"},children:R.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[R.jsxs("div",{children:[R.jsxs("p",{style:{fontSize:"11px",color:"rgba(74, 222, 128, 0.8)",fontWeight:"700",textTransform:"uppercase",marginBottom:"10px",letterSpacing:"0.05em"},children:["Total Obligations (",m[o]," ",n,")"]}),R.jsx("h1",{style:{fontSize:"32px",margin:0,fontWeight:"800",letterSpacing:"-0.02em"},children:E.toLocaleString("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0})})]}),R.jsxs("div",{style:{textAlign:"right"},children:[R.jsx("p",{style:{fontSize:"11px",color:"rgba(255,255,255,0.5)",fontWeight:"700",textTransform:"uppercase",marginBottom:"10px",letterSpacing:"0.05em"},children:"Paid"}),R.jsx("h1",{style:{fontSize:"24px",margin:0,fontWeight:"800",color:"#4ade80"},children:S.toLocaleString("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0})})]})]})}),R.jsx("div",{style:{marginTop:"20px"},children:u?R.jsx("p",{style:{textAlign:"center"},children:"Loading from Cloud..."}):y.length===0?R.jsx("p",{style:{textAlign:"center",color:"var(--text-muted)"},children:"No EMIs found for this period."}):["debt","planned","investment"].map(I=>{const C=y.filter(G=>(G.category||"debt")===I);return C.length===0?null:R.jsxs("div",{style:{marginBottom:"32px"},children:[R.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px"},children:[R.jsx("div",{style:{padding:"4px 12px",borderRadius:"20px",fontSize:"11px",fontWeight:"700",textTransform:"uppercase",background:I==="debt"?"rgba(239, 68, 68, 0.1)":I==="planned"?"rgba(59, 130, 246, 0.1)":"rgba(16, 185, 129, 0.1)",color:I==="debt"?"var(--danger)":I==="planned"?"var(--primary)":"var(--success)",border:"1px solid currentColor"},children:I==="debt"?"Loans":I==="planned"?"Planned Expenses":"Investments"}),R.jsx("div",{style:{flex:1,height:"1px",background:"var(--border)"}})]}),C.map((G,K)=>{const Y=G.status==="paid"||G.status===void 0&&new Date(G.date)<=new Date;return R.jsxs("div",{className:"glass-card",onClick:()=>t(`/schedule/${encodeURIComponent(G.bank)}`),style:{padding:"16px",marginBottom:"10px",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer",opacity:Y?.7:1},children:[R.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[R.jsx("div",{onClick:b=>{b.stopPropagation(),d(G.id,G.status)},style:{width:"28px",height:"28px",borderRadius:"50%",border:Y?"none":"2px solid rgba(255,255,255,0.2)",background:Y?"#4ade80":"transparent",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.3s ease"},children:Y&&R.jsx("span",{style:{color:"#000",fontSize:"14px",fontWeight:"900"},children:""})}),R.jsxs("div",{children:[R.jsx("h4",{style:{marginBottom:"4px",textDecoration:Y?"line-through":"none",color:Y?"rgba(255,255,255,0.4)":"#fff"},children:G.bank}),R.jsx("p",{style:{fontSize:"12px",color:Y?"#4ade80":"var(--text-muted)",fontWeight:Y?"700":"400"},children:Y?"PAID":new Date(G.date).toLocaleDateString()})]})]}),R.jsx("div",{style:{fontWeight:600,fontSize:"18px",textDecoration:Y?"line-through":"none",color:Y?"rgba(255,255,255,0.4)":"#fff"},children:G.amount.toLocaleString("en-IN",{style:"currency",currency:"INR"})})]},G.id||K)})]},I)})}),R.jsx(qf,{})]})}function qV(){const t=sa(),{bankName:e}=ZR(),[r,n]=se.useState([]),[i,o]=se.useState(!0),[c,u]=se.useState(!1),[h,d]=se.useState(""),[m,v]=se.useState(""),[y,E]=se.useState(""),S=()=>{d(decodeURIComponent(e)),v(r[0]?.category||"debt"),u(!0)},T=async()=>{if(!h)return alert("Name is required");o(!0);try{const I=Cc(It),C=Xa(Zr(It,"emis"),Pn("uid","==",sr.currentUser.uid),Pn("bank","==",decodeURIComponent(e)));(await Qg(C)).docs.forEach(K=>{const Y={bank:h,category:m};y&&!isNaN(parseFloat(y))&&(Y.amount=parseFloat(y)),I.update(K.ref,Y)}),await I.commit(),u(!1),h!==decodeURIComponent(e)&&t(`/schedule/${encodeURIComponent(h)}`,{replace:!0})}catch(I){console.error("Error updating loan:",I),alert("Failed to update records.")}finally{o(!1)}},A=async(I,C)=>{try{const G=ra(It,"emis",I);await Jo(G,{status:C==="paid"?"unpaid":"paid"})}catch(G){console.error("Error updating status:",G)}},B=async()=>{if(window.confirm(`Are you sure you want to delete all records for ${decodeURIComponent(e)}? This cannot be undone.`))try{const I=decodeURIComponent(e),C=Xa(Zr(It,"emis"),Pn("uid","==",sr.currentUser.uid),Pn("bank","==",I)),G=await Qg(C),K=Cc(It);G.docs.forEach(Y=>{K.delete(Y.ref)}),await K.commit(),alert("Loan deleted successfully."),t("/tracker")}catch(I){console.error("Error deleting loan:",I),alert("Failed to delete loan.")}};return se.useEffect(()=>{if(!sr.currentUser||!e)return;const I=decodeURIComponent(e),C=Xa(Zr(It,"emis"),Pn("uid","==",sr.currentUser.uid),Pn("bank","==",I)),G=Ji(C,K=>{const Y=K.docs.map(b=>({id:b.id,...b.data()}));Y.sort((b,N)=>new Date(N.date)-new Date(b.date)),n(Y),o(!1)},K=>{console.error("Firestore Error:",K),o(!1)});return()=>G()},[e]),R.jsxs("div",{className:"container fade-in",children:[R.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"32px",justifyContent:"space-between",gap:"16px"},children:[R.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",flex:1,minWidth:0},children:[R.jsx("div",{onClick:()=>t("/tracker"),style:{width:"48px",height:"48px",borderRadius:"16px",background:"rgba(255,255,255,0.05)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",border:"1px solid rgba(255,255,255,0.1)",flexShrink:0},children:R.jsx("span",{style:{fontSize:"20px"},children:""})}),c?R.jsx("input",{value:h,onChange:I=>d(I.target.value),style:{margin:0,fontSize:"18px",padding:"8px 12px",height:"48px"}}):R.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"800",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:decodeURIComponent(e)})]}),R.jsx("div",{style:{display:"flex",gap:"8px"},children:c?R.jsxs(R.Fragment,{children:[R.jsx("button",{onClick:T,style:{background:"var(--primary)",color:"#fff",padding:"12px 16px",borderRadius:"16px",cursor:"pointer",fontSize:"13px",fontWeight:"800",width:"auto",border:"none"},children:"SAVE"}),R.jsx("button",{onClick:()=>u(!1),className:"btn-secondary",style:{padding:"12px 16px",borderRadius:"16px",fontSize:"13px",fontWeight:"800",width:"auto"},children:""})]}):R.jsxs(R.Fragment,{children:[R.jsx("button",{onClick:S,className:"btn-secondary",style:{padding:"12px 16px",borderRadius:"16px",fontSize:"13px",fontWeight:"800",width:"auto"},children:"EDIT"}),R.jsx("button",{onClick:B,style:{background:"rgba(239, 68, 68, 0.1)",color:"#ef4444",border:"1px solid rgba(239, 68, 68, 0.2)",padding:"12px 16px",borderRadius:"16px",cursor:"pointer",fontSize:"13px",fontWeight:"800",width:"auto"},children:"PURGE"})]})})]}),c&&R.jsxs("div",{className:"glass-card",style:{marginBottom:"24px",padding:"20px"},children:[R.jsxs("div",{style:{marginBottom:"16px"},children:[R.jsx("label",{className:"label",style:{marginBottom:"4px",fontSize:"11px"},children:"Change Category"}),R.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"8px"},children:["debt","planned","investment"].map(I=>R.jsx("button",{onClick:()=>v(I),className:"btn-secondary",style:{background:m===I?"#fff":"rgba(255,255,255,0.05)",color:m===I?"#000":"#fff",fontSize:"11px",padding:"8px 0",borderRadius:"12px",border:m===I?"1px solid #fff":"1px solid transparent"},children:I==="debt"?"LOAN":I==="planned"?"PLANNED":"INVEST"},I))})]}),R.jsxs("div",{children:[R.jsx("label",{className:"label",style:{marginBottom:"4px",fontSize:"11px"},children:"Update Amount (Leave blank to keep current)"}),R.jsx("input",{type:"number",placeholder:"New Monthly Amount",value:y,onChange:I=>E(I.target.value),style:{marginBottom:0}})]})]}),R.jsxs("div",{className:"glass-card",style:{marginBottom:"32px",padding:"28px",background:"rgba(255,255,255,0.02)"},children:[R.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:R.jsxs("div",{children:[R.jsx("p",{style:{fontSize:"12px",fontWeight:"600",color:"rgba(255,255,255,0.5)",textTransform:"uppercase",marginBottom:"8px"},children:"Total Obligations"}),R.jsx("h2",{style:{fontSize:"24px",fontWeight:"800",margin:0,letterSpacing:"-0.02em"},children:r.reduce((I,C)=>I+(parseFloat(C.amount)||0),0).toLocaleString("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0})})]})}),R.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px",paddingTop:"20px",borderTop:"1px solid rgba(255,255,255,0.05)"},children:[R.jsxs("div",{children:[R.jsx("p",{style:{fontSize:"12px",fontWeight:"600",color:"rgba(255,255,255,0.5)",textTransform:"uppercase",marginBottom:"8px"},children:"Outstanding"}),R.jsx("h2",{style:{fontSize:"22px",fontWeight:"800",margin:0,color:"#f87171",letterSpacing:"-0.02em"},children:(()=>{const I=new Date,C=r.find(Y=>{const b=new Date(Y.date);return b.getMonth()===I.getMonth()&&b.getFullYear()===I.getFullYear()});if(C)return(parseFloat(C.balance)||0).toLocaleString("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0});const G=r.find(Y=>new Date(Y.date)<=I);if(G)return(parseFloat(G.balance)||0).toLocaleString("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0});const K=r[r.length-1];return(parseFloat(K?.balance)||0).toLocaleString("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0})})()})]}),R.jsxs("div",{style:{textAlign:"right"},children:[R.jsx("p",{style:{fontSize:"12px",fontWeight:"600",color:"rgba(255,255,255,0.5)",textTransform:"uppercase",marginBottom:"8px"},children:"Tenure"}),R.jsxs("h2",{style:{fontSize:"22px",fontWeight:"800",margin:0},children:[r.length," ",R.jsx("span",{style:{fontSize:"13px",fontWeight:"500",opacity:.5},children:"M"})]})]})]}),r.length>0&&R.jsxs("div",{children:[R.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"14px",marginBottom:"12px",fontWeight:"700"},children:[R.jsxs("span",{style:{color:"#4ade80"},children:["Paid: ",r.filter(I=>I.status==="paid"||I.status===void 0&&new Date(I.date)<=new Date).reduce((I,C)=>I+(parseFloat(C.amount)||0),0).toLocaleString("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0})]}),R.jsxs("span",{style:{color:"rgba(255,255,255,0.5)"},children:[Math.round(r.filter(I=>I.status==="paid"||I.status===void 0&&new Date(I.date)<=new Date).length/r.length*100),"% Complete"]})]}),R.jsx("div",{style:{width:"100%",height:"12px",background:"rgba(255,255,255,0.08)",borderRadius:"10px",overflow:"hidden"},children:R.jsx("div",{style:{width:`${Math.min(100,r.filter(I=>I.status==="paid"||I.status===void 0&&new Date(I.date)<=new Date).reduce((I,C)=>I+(parseFloat(C.amount)||0),0)/r.reduce((I,C)=>I+(parseFloat(C.amount)||0),1)*100)}%`,height:"100%",background:"linear-gradient(90deg, #4ade80, #22c55e)",transition:"width 1.5s cubic-bezier(0.175, 0.885, 0.32, 1.275)"}})}),R.jsxs("p",{style:{fontSize:"11px",color:"rgba(255,255,255,0.3)",fontWeight:"600",marginTop:"8px",textAlign:"right",textTransform:"uppercase"},children:["RECOVERY RATE: ",(r.filter(I=>I.status==="paid"||I.status===void 0&&new Date(I.date)<=new Date).reduce((I,C)=>I+(parseFloat(C.amount)||0),0)/r.reduce((I,C)=>I+(parseFloat(C.amount)||0),1)*100).toFixed(1),"%"]})]})]}),R.jsx("div",{children:i?R.jsx("p",{style:{textAlign:"center"},children:"Loading..."}):r.length===0?R.jsx("p",{style:{textAlign:"center",color:"var(--text-muted)"},children:"No records found."}):r.map(I=>{const C=I.status==="paid"||I.status===void 0&&new Date(I.date)<=new Date;return R.jsxs("div",{className:"glass-card",style:{padding:"16px",marginBottom:"10px",display:"flex",justifyContent:"space-between",alignItems:"center",opacity:C?.7:1},children:[R.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[R.jsx("div",{onClick:()=>A(I.id,I.status),style:{width:"28px",height:"28px",borderRadius:"50%",border:C?"none":"2px solid rgba(255,255,255,0.2)",background:C?"#4ade80":"transparent",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.3s ease"},children:C&&R.jsx("span",{style:{color:"#000",fontSize:"14px",fontWeight:"900"},children:""})}),R.jsxs("div",{children:[R.jsx("p",{style:{fontSize:"14px",fontWeight:"500",textDecoration:C?"line-through":"none",color:C?"rgba(255,255,255,0.4)":"#fff"},children:new Date(I.date).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}),R.jsx("p",{style:{fontSize:"10px",color:C?"#4ade80":"var(--text-muted)",marginTop:"4px",fontWeight:"700"},children:C?"PAID":new Date(I.date)>new Date?"UPCOMING":"DUE"})]})]}),R.jsx("div",{style:{fontWeight:600,fontSize:"16px",textDecoration:C?"line-through":"none",color:C?"rgba(255,255,255,0.4)":"#fff"},children:I.amount.toLocaleString("en-IN",{style:"currency",currency:"INR"})})]},I.id)})})]})}function WV(){sa();const[t,e]=se.useState([]),[r,n]=se.useState({name:"",principal:"",roi:"",tenure:""}),[i,o]=se.useState(!1);se.useEffect(()=>{if(!sr.currentUser)return;const u=Xa(Zr(It,"investments"),Pn("uid","==",sr.currentUser.uid)),h=Ji(u,d=>{e(d.docs.map(m=>({id:m.id,...m.data()})))});return()=>h()},[]);const c=async u=>{if(u.preventDefault(),!r.name||!r.principal||!r.roi||!r.tenure)return;const h=parseFloat(r.principal),d=parseFloat(r.roi)/100,m=parseFloat(r.tenure),v=h*Math.pow(1+d,m);await Wd(Zr(It,"investments"),{uid:sr.currentUser.uid,name:r.name,principal:h,roi:parseFloat(r.roi),tenure:m,maturityAmount:v,createdAt:new Date().toISOString()}),n({name:"",principal:"",roi:"",tenure:""}),o(!1)};return R.jsxs("div",{className:"container fade-in",style:{paddingBottom:"100px"},children:[R.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"32px",justifyContent:"space-between"},children:[R.jsx("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:R.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700"},children:"Investment"})}),R.jsx("div",{onClick:()=>o(!i),style:{width:"56px",height:"56px",borderRadius:"20px",background:"#6366f1",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",boxShadow:"0 8px 16px rgba(99, 102, 241, 0.3)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},children:R.jsx("span",{style:{fontSize:"32px",color:"#fff",fontWeight:"400",lineHeight:1},children:i?"":"+"})})]}),i&&R.jsxs("div",{className:"glass-card",style:{marginBottom:"32px",padding:"28px",border:"1px solid rgba(99, 102, 241, 0.2)"},children:[R.jsx("h3",{style:{marginBottom:"24px",fontSize:"20px",fontWeight:"700"},children:"Add New Plan"}),R.jsxs("form",{onSubmit:c,children:[R.jsxs("div",{style:{marginBottom:"20px"},children:[R.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"rgba(255,255,255,0.5)",textTransform:"uppercase"},children:"Asset Name"}),R.jsx("input",{type:"text",placeholder:"e.g. FD, SIP, Mutual Fund",value:r.name,onChange:u=>n({...r,name:u.target.value}),required:!0})]}),R.jsxs("div",{style:{marginBottom:"20px"},children:[R.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"700",color:"rgba(255,255,255,0.5)",textTransform:"uppercase"},children:"Principal Amount ()"}),R.jsx("input",{type:"number",placeholder:"0.00",value:r.principal,onChange:u=>n({...r,principal:u.target.value}),required:!0})]}),R.jsxs("div",{style:{display:"flex",gap:"12px",marginBottom:"24px"},children:[R.jsxs("div",{style:{flex:1},children:[R.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"700",color:"rgba(255,255,255,0.5)",textTransform:"uppercase"},children:"ROI (%)"}),R.jsx("input",{type:"number",step:"0.1",placeholder:"8.5",value:r.roi,onChange:u=>n({...r,roi:u.target.value}),required:!0})]}),R.jsxs("div",{style:{flex:1},children:[R.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"700",color:"rgba(255,255,255,0.5)",textTransform:"uppercase"},children:"Tenure (Yrs)"}),R.jsx("input",{type:"number",placeholder:"5",value:r.tenure,onChange:u=>n({...r,tenure:u.target.value}),required:!0})]})]}),R.jsx("button",{type:"submit",className:"btn-primary",style:{background:"#6366f1",color:"#fff"},children:"Save Investment"})]})]}),R.jsx("div",{style:{display:"grid",gap:"16px"},children:t.length===0?R.jsxs("div",{className:"glass-card",style:{textAlign:"center",padding:"60px 20px",border:"1px dashed rgba(255,255,255,0.1)"},children:[R.jsx("div",{style:{fontSize:"48px",marginBottom:"16px",opacity:.5},children:""}),R.jsx("p",{style:{color:"rgba(255,255,255,0.4)",fontWeight:"600"},children:"No investments added yet."})]}):t.map(u=>R.jsxs("div",{className:"glass-card",style:{padding:"24px",borderLeft:"8px solid #6366f1"},children:[R.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"20px",alignItems:"flex-start"},children:[R.jsx("h3",{style:{fontSize:"18px",margin:0,fontWeight:"700"},children:u.name}),R.jsxs("span",{style:{background:"rgba(99, 102, 241, 0.15)",color:"#818cf8",padding:"6px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"700"},children:[u.roi,"% RoI"]})]}),R.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end"},children:[R.jsxs("div",{children:[R.jsx("p",{style:{fontSize:"11px",color:"rgba(255,255,255,0.4)",fontWeight:"600",textTransform:"uppercase",marginBottom:"6px"},children:"Invested"}),R.jsx("p",{style:{fontSize:"16px",fontWeight:"600"},children:u.principal.toLocaleString("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0})})]}),R.jsxs("div",{style:{textAlign:"right"},children:[R.jsx("p",{style:{fontSize:"11px",color:"rgba(255,255,255,0.4)",fontWeight:"600",textTransform:"uppercase",marginBottom:"6px"},children:"Maturity"}),R.jsx("p",{style:{fontSize:"22px",fontWeight:"800",color:"#fff",letterSpacing:"-0.01em"},children:Math.round(u.maturityAmount).toLocaleString("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0})})]})]})]},u.id))}),R.jsx(qf,{})]})}function YV(){const t=sa(),[e,r]=se.useState(""),[n,i]=se.useState(""),[o,c]=se.useState(""),[u,h]=se.useState(""),[d,m]=se.useState("debt"),[v,y]=se.useState(!1),E=async S=>{if(S.preventDefault(),!e||!n||!o||!u){alert("All fields are required.");return}const T=new Date(n),A=new Date(o),B=parseFloat(u);if(T>A){alert("Start date must be before end date.");return}if(isNaN(B)||B<=0){alert("Please enter a valid amount.");return}y(!0);try{const I=Cc(It),C=Zr(It,"emis");let G=new Date(T),K=0;for(;G<=A;){const Y=ra(C),b={uid:sr.currentUser.uid,bank:e,date:G.toISOString(),amount:B,category:d,type:"manual_schedule",createdAt:new Date().toISOString()};I.set(Y,b);const N=new Date(G);N.setMonth(N.getMonth()+1),G=N,K++}await I.commit(),alert(`Successfully scheduled ${K} payments for ${e}!`),t("/tracker")}catch(I){console.error("Error saving schedule:",I),alert("Failed to save schedule.")}finally{y(!1)}};return R.jsxs("div",{className:"container fade-in",children:[R.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"32px",gap:"16px"},children:[R.jsx("div",{onClick:()=>t("/dashboard"),style:{width:"48px",height:"48px",borderRadius:"16px",background:"rgba(255,255,255,0.05)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",border:"1px solid rgba(255,255,255,0.1)"},children:R.jsx("span",{style:{fontSize:"20px"},children:""})}),R.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700"},children:"Schedule"})]}),R.jsx("div",{className:"glass-card",children:R.jsxs("form",{onSubmit:E,children:[R.jsxs("div",{style:{marginBottom:"20px"},children:[R.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"rgba(255,255,255,0.5)",textTransform:"uppercase"},children:"Description / Holder"}),R.jsx("input",{type:"text",value:e,onChange:S=>r(S.target.value),placeholder:"e.g. Car Loan, Rent, LIC",required:!0})]}),R.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"20px"},children:[R.jsxs("div",{children:[R.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"700",color:"rgba(255,255,255,0.5)",textTransform:"uppercase"},children:"Start Date"}),R.jsx("input",{type:"date",value:n,onChange:S=>i(S.target.value),required:!0})]}),R.jsxs("div",{children:[R.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"700",color:"rgba(255,255,255,0.5)",textTransform:"uppercase"},children:"End Date"}),R.jsx("input",{type:"date",value:o,onChange:S=>c(S.target.value),required:!0})]})]}),R.jsxs("div",{style:{marginBottom:"24px"},children:[R.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"rgba(255,255,255,0.5)",textTransform:"uppercase"},children:"Monthly Amount ()"}),R.jsx("input",{type:"number",value:u,onChange:S=>h(S.target.value),placeholder:"0.00",required:!0})]}),R.jsxs("div",{style:{marginBottom:"32px"},children:[R.jsx("label",{style:{display:"block",marginBottom:"12px",fontSize:"14px",fontWeight:"700",color:"rgba(255,255,255,0.5)",textTransform:"uppercase"},children:"Type of commitment"}),R.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"8px"},children:[R.jsx("div",{onClick:()=>m("debt"),style:{background:d==="debt"?"#fff":"rgba(255,255,255,0.05)",color:d==="debt"?"#000":"rgba(255,255,255,0.6)",padding:"12px 8px",borderRadius:"14px",cursor:"pointer",textAlign:"center",fontWeight:"800",fontSize:"11px",border:d==="debt"?"1px solid #fff":"1px solid transparent",transition:"all 0.3s ease"},children:"Loan / Debt"}),R.jsx("div",{onClick:()=>m("planned"),style:{background:d==="planned"?"#fff":"rgba(255,255,255,0.05)",color:d==="planned"?"#000":"rgba(255,255,255,0.6)",padding:"12px 8px",borderRadius:"14px",cursor:"pointer",textAlign:"center",fontWeight:"800",fontSize:"11px",border:d==="planned"?"1px solid #fff":"1px solid transparent",transition:"all 0.3s ease"},children:"Planned Expense"}),R.jsx("div",{onClick:()=>m("investment"),style:{background:d==="investment"?"#fff":"rgba(255,255,255,0.05)",color:d==="investment"?"#000":"rgba(255,255,255,0.6)",padding:"12px 8px",borderRadius:"14px",cursor:"pointer",textAlign:"center",fontWeight:"800",fontSize:"11px",border:d==="investment"?"1px solid #fff":"1px solid transparent",transition:"all 0.3s ease"},children:"Investment"})]})]}),R.jsx("button",{type:"submit",className:"btn-primary",disabled:v,style:{height:"60px",fontSize:"18px",background:"#fff",color:"#000"},children:v?"Building Amortization...":"Deploy Schedule"})]})})]})}function XV(){sa();const t=new Date,[e,r]=se.useState(""),[n,i]=se.useState(""),[o,c]=se.useState(t.getMonth()),[u,h]=se.useState(t.getFullYear()),[d,m]=se.useState(t.getMonth()),[v,y]=se.useState(t.getFullYear()),[E,S]=se.useState([]),[T,A]=se.useState(!0),[B,I]=se.useState(!1),[C,G]=se.useState(null);se.useEffect(()=>{const O=sr.onAuthStateChanged(we=>{if(!we)return;const Ce=Xa(Zr(It,"income"),Pn("uid","==",we.uid)),ne=Ji(Ce,me=>{const _e=me.docs.map(ae=>({id:ae.id,...ae.data()}));S(_e),A(!1)});return()=>ne()});return()=>O()},[]);const K=async O=>{if(O.preventDefault(),!(!e||!n))try{const we=new Date(v,d,1).toISOString();C?(await Jo(ra(It,"income",C),{name:e,amount:parseFloat(n),date:we,updatedAt:new Date().toISOString()}),G(null)):await Wd(Zr(It,"income"),{uid:sr.currentUser.uid,name:e,amount:parseFloat(n),date:we,createdAt:new Date().toISOString()}),r(""),i(""),I(!1)}catch(we){console.error("Error saving income:",we),alert("Failed to save income.")}},Y=O=>{const we=new Date(O.date||O.createdAt);r(O.name),i(O.amount),m(we.getMonth()),y(we.getFullYear()),G(O.id),I(!0),window.scrollTo({top:0,behavior:"smooth"})},b=async O=>{if(window.confirm("Delete this income source?"))try{await Z1(ra(It,"income",O))}catch(we){console.error("Error deleting income:",we)}},N=async()=>{let O=o-1,we=u;O<0&&(O=11,we=u-1);const Ce=E.filter(ne=>{const me=new Date(ne.date||ne.createdAt);return me.getMonth()===O&&me.getFullYear()===we});if(Ce.length===0){alert(`No records found for ${P[O]} ${we} to copy.`);return}if(window.confirm(`Copy ${Ce.length} records from ${P[O]} to ${P[o]}?`))try{const ne=Cc(It),me=new Date(u,o,1).toISOString();Ce.forEach(_e=>{const ae=ra(Zr(It,"income"));ne.set(ae,{uid:sr.currentUser.uid,name:_e.name,amount:_e.amount,date:me,createdAt:new Date().toISOString(),isCopy:!0})}),await ne.commit(),alert("Incomes copied successfully!")}catch(ne){console.error("Error copying incomes:",ne),alert("Failed to copy incomes.")}},D=E.filter(O=>{const we=new Date(O.date||O.createdAt);return we.getMonth()===parseInt(o)&&we.getFullYear()===parseInt(u)}),U=D.reduce((O,we)=>O+(parseFloat(we.amount)||0),0),P=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],F=Array.from({length:11},(O,we)=>t.getFullYear()-5+we);return R.jsxs("div",{className:"container fade-in",style:{paddingBottom:"100px"},children:[R.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"32px",justifyContent:"space-between"},children:[R.jsx("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:R.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700"},children:"Income"})}),R.jsx("div",{onClick:()=>{B&&(G(null),r(""),i("")),I(!B)},style:{width:"56px",height:"56px",borderRadius:"20px",background:"#4ade80",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",boxShadow:"0 8px 16px rgba(74, 222, 128, 0.3)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},children:R.jsx("span",{style:{fontSize:"32px",color:"#000",fontWeight:"400",lineHeight:1},children:B?"":"+"})})]}),R.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"10px"},children:[R.jsx("select",{value:o,onChange:O=>c(O.target.value),style:{flex:1},children:P.map((O,we)=>R.jsx("option",{value:we,children:O},O))}),R.jsx("select",{value:u,onChange:O=>h(O.target.value),style:{flex:1},children:F.map(O=>R.jsx("option",{value:O,children:O},O))})]}),R.jsx("button",{onClick:N,style:{width:"100%",marginBottom:"20px",padding:"10px",background:"rgba(255,255,255,0.05)",fontSize:"12px"},children:" Copy from Previous Month"}),R.jsxs("div",{className:"glass-card",style:{marginBottom:"32px",borderLeft:"8px solid #4ade80",background:"linear-gradient(135deg, rgba(74, 222, 128, 0.1) 0%, rgba(255,255,255,0.02) 100%)",padding:"28px"},children:[R.jsxs("p",{style:{fontSize:"12px",color:"rgba(74, 222, 128, 0.8)",fontWeight:"700",textTransform:"uppercase",marginBottom:"10px",letterSpacing:"0.05em"},children:["Monthly Total (",P[o]," ",u,")"]}),R.jsx("h2",{style:{fontSize:"clamp(28px, 9vw, 36px)",margin:0,fontWeight:"800",letterSpacing:"-0.02em"},children:U.toLocaleString("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0})})]}),B&&R.jsxs("div",{className:"glass-card",style:{marginBottom:"32px",border:C?"2px solid #4ade80":"1px solid rgba(255,255,255,0.1)",padding:"28px"},children:[R.jsx("h3",{style:{marginBottom:"24px",fontSize:"20px",fontWeight:"700"},children:C?"Edit Income":"Add New Income"}),R.jsxs("form",{onSubmit:K,children:[R.jsxs("div",{style:{marginBottom:"20px"},children:[R.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"700",color:"rgba(255,255,255,0.5)",textTransform:"uppercase"},children:"Source Name"}),R.jsx("input",{type:"text",value:e,onChange:O=>r(O.target.value),placeholder:"e.g. Primary Salary",required:!0})]}),R.jsxs("div",{style:{display:"flex",gap:"12px",marginBottom:"20px"},children:[R.jsxs("div",{style:{flex:1},children:[R.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"700",color:"rgba(255,255,255,0.5)",textTransform:"uppercase"},children:"Month"}),R.jsx("select",{value:d,onChange:O=>m(parseInt(O.target.value)),children:P.map((O,we)=>R.jsx("option",{value:we,style:{background:"#222"},children:O},O))})]}),R.jsxs("div",{style:{flex:1},children:[R.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"700",color:"rgba(255,255,255,0.5)",textTransform:"uppercase"},children:"Year"}),R.jsx("select",{value:v,onChange:O=>y(parseInt(O.target.value)),children:F.map(O=>R.jsx("option",{value:O,style:{background:"#222"},children:O},O))})]})]}),R.jsxs("div",{style:{marginBottom:"24px"},children:[R.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"700",color:"rgba(255,255,255,0.5)",textTransform:"uppercase"},children:"Monthly Amount ()"}),R.jsx("input",{type:"number",value:n,onChange:O=>i(O.target.value),placeholder:"0.00",required:!0})]}),R.jsxs("div",{style:{display:"flex",gap:"12px"},children:[R.jsx("button",{type:"submit",className:"btn-primary",style:{flex:2,background:"#4ade80",color:"#000"},children:C?"Update Income":"Add Income"}),C&&R.jsx("button",{type:"button",onClick:()=>{G(null),I(!1),r(""),i("")},style:{flex:1,background:"rgba(255,255,255,0.1)",color:"#fff"},children:"Cancel"})]})]})]}),R.jsx("div",{style:{display:"grid",gap:"10px"},children:T?R.jsx("p",{style:{textAlign:"center"},children:"Loading..."}):D.length===0?R.jsx("p",{style:{textAlign:"center",color:"var(--text-muted)"},children:"No income records for this period."}):D.map(O=>R.jsxs("div",{className:"glass-card",style:{padding:"15px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[R.jsxs("div",{children:[R.jsx("p",{style:{fontWeight:"500",fontSize:"16px"},children:O.name}),R.jsxs("p",{style:{fontSize:"12px",color:"var(--text-muted)"},children:[P[new Date(O.date||O.createdAt).getMonth()]," ",new Date(O.date||O.createdAt).getFullYear()]})]}),R.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[R.jsx("span",{style:{fontWeight:"600",color:"#4ade80",marginRight:"5px"},children:O.amount.toLocaleString("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0})}),R.jsx("button",{onClick:()=>Y(O),style:{background:"none",border:"none",cursor:"pointer",fontSize:"16px"},title:"Edit",children:""}),R.jsx("button",{onClick:()=>b(O.id),style:{background:"none",border:"none",color:"#ef4444",cursor:"pointer",fontSize:"16px"},title:"Delete",children:""})]})]},O.id))}),R.jsx(qf,{})]})}function KV(){sa();const t=new Date,[e,r]=se.useState([]),[n,i]=se.useState(!0),[o,c]=se.useState(!1),[u,h]=se.useState(null),[d,m]=se.useState(""),[v,y]=se.useState(""),[E,S]=se.useState(t.toISOString().split("T")[0]),[T,A]=se.useState(null),[B,I]=se.useState(""),[C,G]=se.useState(t.toISOString().split("T")[0]),[K,Y]=se.useState(""),[b,N]=se.useState(null),[D,U]=se.useState("");se.useEffect(()=>{const _e=sr.onAuthStateChanged(ae=>{if(!ae)return;const Le=Xa(Zr(It,"borrowers"),Pn("uid","==",ae.uid)),Q=Ji(Le,L=>{const te=L.docs.map(J=>({id:J.id,...J.data()}));te.sort((J,ee)=>J.status==="active"&&ee.status==="closed"?-1:J.status==="closed"&&ee.status==="active"?1:new Date(ee.borrowedDate)-new Date(J.borrowedDate)),r(te),i(!1)});return()=>Q()});return()=>_e()},[]);const P=async _e=>{if(_e.preventDefault(),!(!d||!v))try{u?(await Jo(ra(It,"borrowers",u.id),{name:d,amount:parseFloat(v),borrowedDate:E,updatedAt:new Date().toISOString()}),h(null)):await Wd(Zr(It,"borrowers"),{uid:sr.currentUser.uid,name:d,amount:parseFloat(v),borrowedDate:E,status:"active",settlements:[],createdAt:new Date().toISOString()}),m(""),y(""),S(t.toISOString().split("T")[0]),c(!1)}catch(ae){console.error("Error saving borrower:",ae),alert("Failed to save borrower.")}},F=async _e=>{if(_e.preventDefault(),!(!B||!T))try{const ae=ra(It,"borrowers",T);await Jo(ae,{settlements:_A({amount:parseFloat(B),date:C,note:K,id:Date.now().toString()})}),A(null),I(""),Y("")}catch(ae){console.error("Error adding settlement:",ae),alert("Failed to add settlement.")}},O=async _e=>{if(_e.preventDefault(),!!b)try{const ae=ra(It,"borrowers",b);await Jo(ae,{status:"closed",closureDescription:D,closedAt:new Date().toISOString()}),N(null),U("")}catch(ae){console.error("Error closing borrower:",ae),alert("Failed to close borrower.")}},we=async _e=>{if(window.confirm("Delete this borrower record?"))try{await Z1(ra(It,"borrowers",_e))}catch(ae){console.error("Error deleting borrower:",ae)}},Ce=e.reduce((_e,ae)=>_e+(parseFloat(ae.amount)||0),0),ne=e.reduce((_e,ae)=>{const Le=ae.settlements?.reduce((Q,L)=>Q+(parseFloat(L.amount)||0),0)||0;return _e+Le},0),me=Ce-ne;return R.jsxs("div",{className:"container fade-in",style:{paddingBottom:"100px"},children:[R.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"32px",justifyContent:"space-between"},children:[R.jsx("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:R.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700"},children:"Borrowers"})}),R.jsx("div",{onClick:()=>{o&&h(null),c(!o)},style:{width:"56px",height:"56px",borderRadius:"20px",background:"#6366f1",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",boxShadow:"0 8px 16px rgba(99, 102, 241, 0.3)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},children:R.jsx("span",{style:{fontSize:"32px",color:"#fff",fontWeight:"400",lineHeight:1},children:o?"":"+"})})]}),R.jsxs("div",{className:"glass-card",style:{marginBottom:"32px",borderLeft:"8px solid #6366f1",background:"linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(255,255,255,0.02) 100%)",padding:"28px"},children:[R.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px"},children:[R.jsxs("div",{children:[R.jsx("p",{style:{fontSize:"11px",color:"rgba(99, 102, 241, 0.8)",fontWeight:"700",textTransform:"uppercase",marginBottom:"8px"},children:"Total Lent"}),R.jsxs("h2",{style:{fontSize:"24px",margin:0,fontWeight:"800"},children:["",Ce.toLocaleString("en-IN")]})]}),R.jsxs("div",{children:[R.jsx("p",{style:{fontSize:"11px",color:"#4ade80",fontWeight:"700",textTransform:"uppercase",marginBottom:"8px"},children:"Recovered"}),R.jsxs("h2",{style:{fontSize:"24px",margin:0,fontWeight:"800",color:"#4ade80"},children:["",ne.toLocaleString("en-IN")]})]})]}),R.jsxs("div",{style:{marginTop:"20px",paddingTop:"20px",borderTop:"1px solid rgba(255,255,255,0.05)"},children:[R.jsx("p",{style:{fontSize:"11px",color:"rgba(255,255,255,0.4)",fontWeight:"700",textTransform:"uppercase",marginBottom:"8px"},children:"Outstanding Balance"}),R.jsxs("h2",{style:{fontSize:"32px",margin:0,fontWeight:"800",color:"#f87171"},children:["",me.toLocaleString("en-IN")]})]})]}),o&&R.jsxs("div",{className:"glass-card",style:{marginBottom:"32px",border:u?"2px solid #6366f1":"1px solid rgba(255,255,255,0.1)",padding:"28px"},children:[R.jsx("h3",{style:{marginBottom:"24px",fontSize:"20px",fontWeight:"700"},children:u?"Edit Record":"Lend Money"}),R.jsxs("form",{onSubmit:P,children:[R.jsxs("div",{style:{marginBottom:"20px"},children:[R.jsx("label",{className:"label",children:"Borrower Name"}),R.jsx("input",{type:"text",value:d,onChange:_e=>m(_e.target.value),placeholder:"Who is borrowing?",required:!0})]}),R.jsxs("div",{style:{marginBottom:"20px"},children:[R.jsx("label",{className:"label",children:"Amount ()"}),R.jsx("input",{type:"number",value:v,onChange:_e=>y(_e.target.value),placeholder:"0.00",required:!0})]}),R.jsxs("div",{style:{marginBottom:"24px"},children:[R.jsx("label",{className:"label",children:"Date"}),R.jsx("input",{type:"date",value:E,onChange:_e=>S(_e.target.value),required:!0})]}),R.jsxs("div",{style:{display:"flex",gap:"12px"},children:[R.jsx("button",{type:"submit",className:"btn-primary",style:{flex:1,background:"#6366f1"},children:u?"Update":"Save"}),R.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{c(!1),h(null)},style:{flex:1},children:"Cancel"})]})]})]}),R.jsx("div",{style:{display:"grid",gap:"16px"},children:n?R.jsx("p",{style:{textAlign:"center"},children:"Loading..."}):e.length===0?R.jsx("p",{style:{textAlign:"center",color:"var(--text-muted)"},children:"No borrower records found."}):e.map(_e=>{const ae=_e.settlements?.reduce((L,te)=>L+(parseFloat(te.amount)||0),0)||0,Le=(parseFloat(_e.amount)||0)-ae,Q=_e.status==="closed";return R.jsxs("div",{className:"glass-card",style:{padding:"24px",position:"relative",opacity:Q?.6:1},children:[R.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"16px"},children:[R.jsxs("div",{children:[R.jsx("h3",{style:{margin:0,fontSize:"18px",fontWeight:"700"},children:_e.name}),R.jsxs("p",{style:{fontSize:"12px",color:"var(--text-muted)",marginTop:"4px"},children:["Borrowed on ",new Date(_e.borrowedDate).toLocaleDateString()]})]}),R.jsx("div",{style:{textAlign:"right"},children:R.jsx("span",{style:{fontSize:"10px",fontWeight:"900",padding:"4px 10px",borderRadius:"8px",background:Q?"rgba(255,255,255,0.05)":"rgba(99, 102, 241, 0.2)",color:Q?"rgba(255,255,255,0.4)":"#6366f1",textTransform:"uppercase"},children:_e.status})})]}),R.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"10px",marginBottom:"20px"},children:[R.jsxs("div",{children:[R.jsx("p",{style:{fontSize:"10px",color:"var(--text-muted)",textTransform:"uppercase",marginBottom:"4px"},children:"Principal"}),R.jsxs("p",{style:{fontWeight:"700"},children:["",parseFloat(_e.amount).toLocaleString("en-IN")]})]}),R.jsxs("div",{children:[R.jsx("p",{style:{fontSize:"10px",color:"var(--text-muted)",textTransform:"uppercase",marginBottom:"4px"},children:"Settled"}),R.jsxs("p",{style:{fontWeight:"700",color:"#4ade80"},children:["",ae.toLocaleString("en-IN")]})]}),R.jsxs("div",{children:[R.jsx("p",{style:{fontSize:"10px",color:"var(--text-muted)",textTransform:"uppercase",marginBottom:"4px"},children:"Balance"}),R.jsxs("p",{style:{fontWeight:"700",color:Le>0?"#f87171":"#4ade80"},children:["",Le.toLocaleString("en-IN")]})]})]}),R.jsx("div",{style:{width:"100%",height:"6px",background:"rgba(255,255,255,0.05)",borderRadius:"3px",overflow:"hidden",marginBottom:"20px"},children:R.jsx("div",{style:{width:`${Math.min(100,ae/parseFloat(_e.amount)*100)}%`,height:"100%",background:"#4ade80",transition:"width 1s ease"}})}),!Q&&R.jsxs("div",{style:{display:"flex",gap:"10px"},children:[R.jsx("button",{className:"btn-secondary",style:{flex:1,padding:"10px",fontSize:"12px"},onClick:()=>A(_e.id),children:"Recover"}),R.jsx("button",{className:"btn-secondary",style:{flex:1,padding:"10px",fontSize:"12px"},onClick:()=>N(_e.id),children:"Close"})]}),Q&&_e.closureDescription&&R.jsxs("div",{style:{background:"rgba(255,255,255,0.03)",padding:"12px",borderRadius:"12px",fontSize:"12px",color:"rgba(255,255,255,0.5)"},children:['" ',_e.closureDescription,' "']}),_e.settlements?.length>0&&R.jsxs("div",{style:{marginTop:"16px",borderTop:"1px solid rgba(255,255,255,0.05)",paddingTop:"16px"},children:[R.jsx("p",{style:{fontSize:"11px",color:"var(--text-muted)",fontWeight:"700",textTransform:"uppercase",marginBottom:"10px"},children:"History"}),_e.settlements.map(L=>R.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px",fontSize:"13px"},children:[R.jsxs("span",{children:[new Date(L.date).toLocaleDateString(void 0,{month:"short",day:"numeric"})," ",R.jsxs("span",{style:{opacity:.4,fontSize:"11px"},children:[" - ",L.note]})]}),R.jsxs("span",{style:{fontWeight:"600",color:"#4ade80"},children:["+",L.amount.toLocaleString()]})]},L.id))]}),R.jsxs("div",{style:{position:"absolute",top:"10px",right:"10px",display:"flex",gap:"8px"},children:[R.jsx("button",{onClick:()=>{h(_e),m(_e.name),y(_e.amount),S(_e.borrowedDate),c(!0),window.scrollTo({top:0,behavior:"smooth"})},style:{background:"none",border:"none",cursor:"pointer",opacity:.3},children:""}),R.jsx("button",{onClick:()=>we(_e.id),style:{background:"none",border:"none",cursor:"pointer",opacity:.3},children:""})]})]},_e.id)})}),T&&R.jsx("div",{className:"modal-overlay",onClick:()=>A(null),children:R.jsxs("div",{className:"glass-card modal-content",onClick:_e=>_e.stopPropagation(),style:{width:"90%",maxWidth:"400px"},children:[R.jsx("h3",{style:{marginBottom:"24px",fontSize:"18px",fontWeight:"700"},children:"Add Settlement"}),R.jsxs("form",{onSubmit:F,children:[R.jsxs("div",{style:{marginBottom:"16px"},children:[R.jsx("label",{className:"label",children:"Amount Received ()"}),R.jsx("input",{type:"number",value:B,onChange:_e=>I(_e.target.value),required:!0,placeholder:"0.00"})]}),R.jsxs("div",{style:{marginBottom:"16px"},children:[R.jsx("label",{className:"label",children:"Date"}),R.jsx("input",{type:"date",value:C,onChange:_e=>G(_e.target.value),required:!0})]}),R.jsxs("div",{style:{marginBottom:"24px"},children:[R.jsx("label",{className:"label",children:"Note"}),R.jsx("input",{type:"text",value:K,onChange:_e=>Y(_e.target.value),placeholder:"e.g. UPI, Cash"})]}),R.jsxs("div",{style:{display:"flex",gap:"12px"},children:[R.jsx("button",{type:"submit",className:"btn-primary",style:{flex:1,background:"#4ade80",color:"#000"},children:"Save"}),R.jsx("button",{type:"button",className:"btn-secondary",style:{flex:1},onClick:()=>A(null),children:"Cancel"})]})]})]})}),b&&R.jsx("div",{className:"modal-overlay",onClick:()=>N(null),children:R.jsxs("div",{className:"glass-card modal-content",onClick:_e=>_e.stopPropagation(),style:{width:"90%",maxWidth:"400px"},children:[R.jsx("h3",{style:{marginBottom:"24px",fontSize:"18px",fontWeight:"700"},children:"Close Settlement"}),R.jsx("p",{style:{fontSize:"14px",color:"rgba(255,255,255,0.6)",marginBottom:"20px"},children:"Are you sure you want to close this record? No more recoveries can be added."}),R.jsxs("form",{onSubmit:O,children:[R.jsxs("div",{style:{marginBottom:"24px"},children:[R.jsx("label",{className:"label",children:"Closing Description"}),R.jsx("textarea",{value:D,onChange:_e=>U(_e.target.value),placeholder:"e.g. Account settled in full",style:{width:"100%",height:"80px",padding:"12px",borderRadius:"12px",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",color:"#fff"}})]}),R.jsxs("div",{style:{display:"flex",gap:"12px"},children:[R.jsx("button",{type:"submit",className:"btn-primary",style:{flex:1,background:"#f87171"},children:"Close Now"}),R.jsx("button",{type:"button",className:"btn-secondary",style:{flex:1},onClick:()=>N(null),children:"Cancel"})]})]})]})}),R.jsx("style",{children:`
                .modal-overlay {
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background: rgba(0,0,0,0.8);
                    backdrop-filter: blur(10px);
                    z-index: 3000;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                }
                .label {
                    display: block;
                    margin-bottom: 8px;
                    font-size: 13px;
                    font-weight: 700;
                    color: rgba(255,255,255,0.5);
                    text-transform: uppercase;
                }
            `}),R.jsx(qf,{})]})}const $V="modulepreload",QV=function(t,e){return new URL(t,e).href},JT={},ZT=function(e,r,n){let i=Promise.resolve();if(r&&r.length>0){let d=function(m){return Promise.all(m.map(v=>Promise.resolve(v).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};const c=document.getElementsByTagName("link"),u=document.querySelector("meta[property=csp-nonce]"),h=u?.nonce||u?.getAttribute("nonce");i=d(r.map(m=>{if(m=QV(m,n),m in JT)return;JT[m]=!0;const v=m.endsWith(".css"),y=v?'[rel="stylesheet"]':"";if(n)for(let S=c.length-1;S>=0;S--){const T=c[S];if(T.href===m&&(!v||T.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${y}`))return;const E=document.createElement("link");if(E.rel=v?"stylesheet":$V,v||(E.as="script"),E.crossOrigin="",E.href=m,h&&E.setAttribute("nonce",h),document.head.appendChild(E),v)return new Promise((S,T)=>{E.addEventListener("load",S),E.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${m}`)))})}))}function o(c){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=c,window.dispatchEvent(u),!u.defaultPrevented)throw c}return i.then(c=>{for(const u of c||[])u.status==="rejected"&&o(u.reason);return e().catch(o)})};function JV(){const t=sa(),[e,r]=se.useState({apiKey:"",authDomain:"",projectId:"",storageBucket:"",messagingSenderId:"",appId:""});se.useEffect(()=>{const o=localStorage.getItem("firebaseConfig");o&&r(JSON.parse(o))},[]);const n=o=>{r({...e,[o.target.name]:o.target.value})},i=()=>{localStorage.setItem("firebaseConfig",JSON.stringify(e)),alert("Configuration Saved! Reloading app..."),window.location.href="/"};return R.jsxs("div",{className:"container fade-in",children:[R.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"20px"},children:[R.jsx("button",{onClick:()=>t("/"),style:{width:"auto",padding:"8px",marginRight:"10px"},children:""}),R.jsx("h2",{children:"Settings"})]}),R.jsxs("div",{className:"glass-card",children:[R.jsx("h3",{children:"Firebase Configuration"}),R.jsxs("p",{style:{fontSize:"12px",color:"var(--text-muted)",marginBottom:"16px"},children:["Create a free project at ",R.jsx("a",{href:"https://console.firebase.google.com",target:"_blank",style:{color:"#fff"},children:"console.firebase.google.com"}),".",R.jsx("br",{}),'Go to Project Settings and copy the "firebaseConfig" values here.']}),Object.keys(e).map(o=>R.jsxs("div",{style:{marginBottom:"10px"},children:[R.jsx("label",{style:{fontSize:"12px",textTransform:"capitalize"},children:o}),R.jsx("input",{type:"text",name:o,value:e[o],onChange:n,placeholder:`Enter ${o}`})]},o)),R.jsx("button",{onClick:i,className:"btn-primary",children:"Save & Reload"}),R.jsxs("div",{style:{marginTop:"30px",padding:"20px",background:"rgba(255,255,255,0.05)",borderRadius:"20px"},children:[R.jsx("h3",{style:{fontSize:"16px",marginBottom:"10px"},children:"Current Session Info"}),R.jsx("p",{style:{fontSize:"12px",color:"rgba(255,255,255,0.5)",marginBottom:"5px"},children:"Logged in as:"}),R.jsx("p",{style:{fontSize:"14px",fontWeight:"700",wordBreak:"break-all"},children:auth?.currentUser?.email||"Not logged in"}),R.jsx("p",{style:{fontSize:"12px",color:"rgba(255,255,255,0.5)",marginTop:"10px",marginBottom:"5px"},children:"User ID (UID):"}),R.jsx("code",{style:{fontSize:"11px",background:"#000",padding:"4px 8px",borderRadius:"4px",display:"block",wordBreak:"break-all"},children:auth?.currentUser?.uid||"N/A"}),R.jsx("p",{style:{fontSize:"10px",color:"#4ade80",marginTop:"10px"},children:" If your data is missing, it's likely linked to your OLD UID."})]}),R.jsx("hr",{style:{margin:"20px 0",border:"none",borderTop:"1px solid rgba(255,255,255,0.1)"}}),R.jsx("h3",{style:{color:"#ef4444"},children:"Danger Zone"}),R.jsx("p",{style:{fontSize:"12px",color:"var(--text-muted)",marginBottom:"10px"},children:"This will delete ALL your uploaded EMIs and Investments. This action cannot be undone."}),R.jsx("button",{onClick:async()=>{if(confirm("Are you SURE you want to delete ALL your data? This cannot be undone."))try{const{collection:o,query:c,where:u,getDocs:h,writeBatch:d,deleteDoc:m}=await ZT(async()=>{const{collection:I,query:C,where:G,getDocs:K,writeBatch:Y,deleteDoc:b}=await Promise.resolve().then(()=>L6);return{collection:I,query:C,where:G,getDocs:K,writeBatch:Y,deleteDoc:b}},[],import.meta.url),{db:v,auth:y}=await ZT(async()=>{const{db:I,auth:C}=await Promise.resolve().then(()=>BO);return{db:I,auth:C}},void 0,import.meta.url);if(!y.currentUser)return;const E=d(v),S=c(o(v,"emis"),u("uid","==",y.currentUser.uid));(await h(S)).forEach(I=>E.delete(I.ref));const A=c(o(v,"investments"),u("uid","==",y.currentUser.uid));(await h(A)).forEach(I=>E.delete(I.ref)),await E.commit(),alert("All data deleted."),window.location.href="/"}catch(o){console.error(o),alert("Error deleting data. You might have too many records. Deleting what I can...")}},style:{background:"rgba(239, 68, 68, 0.2)",color:"#ef4444",border:"1px solid rgba(239, 68, 68, 0.5)",padding:"12px",borderRadius:"12px",width:"100%",cursor:"pointer"},children:"Reset & Delete All Data"})]})]})}function qs({children:t}){const[e,r]=se.useState(null),[n,i]=se.useState(!0);return se.useEffect(()=>{if(!sr){i(!1);return}return wN(sr,c=>{r(c),i(!1)})},[]),hd()?n?R.jsx("div",{className:"container",style:{textAlign:"center",marginTop:"50px"},children:"Loading..."}):e?t:R.jsx(v2,{to:"/",replace:!0}):R.jsx(v2,{to:"/settings",replace:!0})}function ZV(){return R.jsx(Bk,{children:R.jsxs(pk,{children:[R.jsx(Ua,{path:"/settings",element:R.jsx(JV,{})}),R.jsx(Ua,{path:"/",element:R.jsx(VO,{})}),R.jsx(Ua,{path:"/dashboard",element:R.jsx(qs,{children:R.jsx(UO,{})})}),R.jsx(Ua,{path:"/schedule/:bankName",element:R.jsx(qs,{children:R.jsx(qV,{})})}),R.jsx(Ua,{path:"/upload",element:R.jsx(qs,{children:R.jsx(HV,{})})}),R.jsx(Ua,{path:"/investments",element:R.jsx(qs,{children:R.jsx(WV,{})})}),R.jsx(Ua,{path:"/income",element:R.jsx(qs,{children:R.jsx(XV,{})})}),R.jsx(Ua,{path:"/add-schedule",element:R.jsx(qs,{children:R.jsx(YV,{})})}),R.jsx(Ua,{path:"/borrowers",element:R.jsx(qs,{children:R.jsx(KV,{})})}),R.jsx(Ua,{path:"/tracker",element:R.jsx(qs,{children:R.jsx(GV,{})})})]})})}gR.createRoot(document.getElementById("root")).render(R.jsx(se.StrictMode,{children:R.jsx(ZV,{})}));
